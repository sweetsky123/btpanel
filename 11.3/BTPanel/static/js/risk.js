import{c as e,s as l,g as s,r as a,w as t,I as n,x as i,y as o,A as r,z as c,G as m,L as d,D as u,B as p,O as x,C as f,e as v,R as y,J as g,K as b,F as h,b1 as w,M as k,H as _,V as C,cf as V,bA as T,b6 as j,ay as S}from"./base-lib.js?v=1763689792";import{u as I,M as L,e as H,l as M,$ as D,j as U,_ as A}from"./utils-lib.js?v=1763689792";import{_ as P}from"./index423.js?v=1763689792";import{H as R}from"./index344.js?v=1763689792";import{p as B,dc as F}from"./validator.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";const O={class:"h-full p-2rem"},z={class:"scan-header flex items-center"},G={class:"flex items-center w-full"},J={key:0,class:"w-[10rem] h-[10rem] relative flex-shrink-0"},K={key:1,class:"w-[10rem] h-[10rem] relative flex-shrink-0"},N={class:"w-full text-default text-extraLarge flex flex-col ml-[3rem]"},$={class:"flex items-center w-full justify-between"},q=["innerHTML"],E={key:0},Q={class:"mx-[4px] text-subtitleLarge mx-[4px] text-danger"},W={class:"flex items-center"},X={key:0,class:"text-base text-secondary mt-[1rem]"},Y={key:2,class:"text-base text-secondary mt-[1rem]"},Z={key:4,class:"text-base mt-[12px] text-secondary flex items-center"},ee={key:5,class:"text-base mt-[12px] text-warning flex items-center"},le={key:0,class:"text-base w-full mt-[2rem] flex items-center justify-between"},se={class:"items-center flex"},ae={class:"flex items-center"},te=["v-bt-loading:title"],ne={class:"module-head flex items-center h-[5.4rem] justify-between border-b-1 pr-[0.8rem] w-full"},ie={class:"w-full flex items-center"},oe=["title"],re={key:0,class:"text-secondary !text-small ml-[5rem] flex"},ce={class:"flex items-center text-small"},me=["onClick"],de=["onClick"],ue={class:"px-[3rem] py-[3.2rem] bg-light"},pe={class:"flex items-center"},xe={class:"text-default"},fe=["innerHTML"],ve={class:"flex mt-[16px] items-center"},ye={key:0,class:"collapse-item flex-col !items-start"},ge={key:1,class:"collapse-item"},be={class:"flex mt-[16px] items-center"},he={class:"collapse-item"},we={class:"flex flex-col p-[20px]"},ke={class:"text-medium mb-[20px]"},_e={class:"text-primary"},Ce={class:"text-danger"},Ve={class:"text-secondary"},Te={class:"p-[12px] flex flex-col items-start"},je={class:"mt-4px"},Se={key:0,class:"scan-body p-[2rem]"},Ie={class:"module-list overflow-auto h-[38rem]"},Le={class:"module-head flex items-center h-[5.4rem] justify-between border-b-1 pr-[0.8rem] w-full"},He={class:"w-full flex items-center"},Me=["title"],De={class:"flex items-center"},Ue={class:"px-[3rem] py-[3.2rem] bg-light"},Ae={class:"flex items-center"},Pe={class:"text-default"},Re=["innerHTML"],Be={class:"flex mt-[16px] items-center"},Fe={key:0,class:"collapse-item flex-col !items-start"},Oe={key:1,class:"collapse-item"},ze={class:"flex mt-[16px] items-center"},Ge={class:"collapse-item"},Je={class:"w-full bg-white flex items-center justify-between"},Ke=A(e({__name:"risk",setup(e){const A=R(),{handleIgnore:Ke,onToggle:Ne,vulnerabilityInvolvesSoftware:$e}=A,{showAnimation:qe,scanScore:Ee,scanTextClass:Qe,scanOuterClass:We,animateFlag:Xe,scanPreText:Ye,riskNum:Ze,scanButtonType:el,repairAutoRiskButton:ll,cookieRepair:sl,scanItemText:al,processData:tl,lastScanTime:nl,scanSelectShow:il,allSelect:ol,allSelectionDis:rl,isFirst:cl,emptyDetail:ml,loading:dl,loadingText:ul,isShow:pl,isIgnoreAll:xl,ignoreData:fl,activeMent:vl,activeMentIgnore:yl,is_autofix:gl,levelData:bl,allData:hl,repairData:wl,resultConfirm:kl,resultItemLength:_l,resultTable:Cl,resultColumn:Vl}=l(A),{mainHeight:Tl,payment:jl}=I(),Sl=s(()=>hl.value.filter(e=>1==e.selection).map(e=>e.m_name).length),Il=a(!1),Ll=async()=>{if("ltd"===jl.value.authType)try{const e=await F();if(!e.data.status)return L.error(e.data.msg);window.open("/download?filename=".concat(e.data.path),"_blank","noopener,noreferrer")}catch(e){}else B({sourceId:68})};return t(Ze,e=>{e!==A.tootipTotal.risk&&A.getScanTotal()}),(e,l)=>{const s=_,a=H,t=P,I=C,L=V,R=T,B=M,F=D,Tl=U,jl=j,Hl=S,Ml=n("bt-loading");return i(),o("div",null,[l[46]||(l[46]=r("div",{class:"text-large mb-6"},"安全风险",-1)),r("div",O,[r("div",z,[r("div",G,[c(qe)?m("",!0):(i(),o("div",J,[...l[13]||(l[13]=[r("span",{class:"inline-block scan-icon-img icon-img-safe"},null,-1),r("span",{class:"scan-icon-img-bg"},null,-1),r("span",{class:"text-iconLarge h-[4.4rem] w-[0.7rem] text-primary font-bold absolute-center"},"i",-1)])])),c(qe)?(i(),o("div",K,[r("p",{class:d("box-text w-[5.8rem] "+c(Qe))},[u(p(c(Ee))+" ",1),l[14]||(l[14]=r("span",null,"分",-1))],2),r("span",{class:d("scan-icon-img icon-img-"+c(We))},null,2),l[17]||(l[17]=r("span",{class:"circle-inner"},null,-1)),r("span",{class:d("circle-outer "+c(We))},null,2),r("div",{class:d("animate-box"+c(Xe))},[r("div",{class:d("animate-box-left linear-"+c(We))},null,2),l[15]||(l[15]=r("div",{class:"animate-box-right"},null,-1)),l[16]||(l[16]=r("div",{class:"animate-box-bottom"},null,-1))],2)])):m("",!0),r("div",N,[r("div",$,[r("span",null,[r("span",{innerHTML:c(Ye)},null,8,q),c(Ze)?(i(),o("span",E,[l[18]||(l[18]=u("已检测到",-1)),r("span",Q,p(c(Ze)),1),l[19]||(l[19]=u("个风险",-1))])):m("",!0)]),r("div",W,[c(ll)&&c(sl)?m("",!0):(i(),x(s,{key:0,class:d("w-[9rem] "+("info"==c(el)?"bg-darker":"")),type:c(el),round:"",onClick:c(A).scanningProcess},{default:f(()=>[u(p("info"==c(el)?"停止扫描":"立即扫描"),1)]),_:1},8,["class","type","onClick"])),c(ll)&&c(sl)?(i(),o("span",{key:1,round:"",onClick:l[0]||(l[0]=(...e)=>c(A).scanningProcess&&c(A).scanningProcess(...e)),class:"!p-[0] bt-link text-small mr-4px"}," 重新扫描 ")):m("",!0),c(ll)&&c(sl)?(i(),x(s,{key:2,class:"w-[9rem]",round:"",type:c(el),onClick:c(A).handleRepairAutoRisk},{default:f(()=>[...l[20]||(l[20]=[u(" 一键修复 ",-1)])]),_:1},8,["type","onClick"])):m("",!0)])]),"info"===c(el)||c(ll)?m("",!0):(i(),o("span",X," 扫描后将自动修复所有可修复的风险项，并获取最新安全扫描报告 ")),"info"===c(el)||c(ll)?m("",!0):(i(),x(a,{key:1,class:"!p-0 !mt-[12px] w-[150px]",onClick:l[1]||(l[1]=e=>Il.value=!0)},{default:f(()=>[...l[21]||(l[21]=[u(" >>查看当前安全扫描报告 ",-1)])]),_:1})),"info"==c(el)?(i(),o("span",Y,p(c(al)),1)):m("",!0),"info"==c(el)?(i(),x(t,{key:3,class:"mt-[1.6rem] h-[1rem]","process-color":c(tl).processColor,percentage:c(tl).processPercentage,"stroke-width":10,"show-text":!1},null,8,["process-color","percentage"])):m("",!0),c(ll)?(i(),o("span",Z," 上次扫描时间："+p(c(nl)),1)):m("",!0),c(ll)&&c(sl)?(i(),o("span",ee," 若安装了【系统加固】，请先关闭再进行一键修复 ")):m("",!0)])])]),c(il)?(i(),o("div",le,[r("div",se,[v(I,{onChange:c(A).handelAllSelection,class:"text-secondary font-500 text-small",modelValue:c(ol),"onUpdate:modelValue":l[2]||(l[2]=e=>y(ol)?ol.value=e:null),disabled:c(rl)},{default:f(()=>[...l[22]||(l[22]=[u("全选",-1)])]),_:1},8,["onChange","modelValue","disabled"]),g(v(a,{onClick:l[3]||(l[3]=e=>c(A).handleRepair(!1,null)),link:"",class:d(c(Sl)?"ml-[20px] text-base mt-[1px]":"ml-[20px] text-base text-tertiary mt-[1px] cursor-not-allowed ")},{default:f(()=>[...l[23]||(l[23]=[u("修复选中项 ",-1)])]),_:1},8,["class"]),[[b,!c(cl)]])]),r("div",ae,[v(a,{onClick:l[4]||(l[4]=e=>xl.value=!0)},{default:f(()=>[...l[24]||(l[24]=[u("忽略扫描项",-1)])]),_:1}),l[26]||(l[26]=r("span",{class:"text-tertiary mx-[1.2rem]"},"|",-1)),v(s,{type:"primary",link:"",onClick:l[5]||(l[5]=e=>Il.value=!0)},{default:f(()=>[...l[25]||(l[25]=[r("i",{class:"svgtofont-icon-safe-report text-base text-primary"},null,-1),u(" 查看安全扫描报告",-1)])]),_:1})])])):m("",!0),c(ml)?m("",!0):g((i(),o("div",{key:1,"v-bt-loading:title":c(ul),class:d([c(pl)?"h-[24rem]":"h-[34rem]","scan-body my-[2rem]"])},[v(R,{modelValue:c(vl),"onUpdate:modelValue":l[7]||(l[7]=e=>y(vl)?vl.value=e:null),accordion:""},{default:f(()=>[r("div",{class:d(["module-list overflow-auto",c(pl)?"h-[24rem]":"h-[34rem]"])},[(i(!0),o(h,null,w(c(hl),(e,s)=>(i(),o("div",{class:"module-item text-small",key:"".concat(s)},[r("div",ne,[r("div",ie,[v(I,{modelValue:e.selection,"onUpdate:modelValue":l=>e.selection=l,onChange:l=>c(A).changeSelectValue(e.selection),disabled:c(cl)||!c(gl).includes(e.m_name)},null,8,["modelValue","onUpdate:modelValue","onChange","disabled"]),r("span",{class:"text-small h-[2.2rem] flex items-center px-[8px] rounded-small ml-[8px] mr-[1rem]",style:k({color:c(bl)[e.level].color,backgroundColor:c(bl)[e.level].bg})},p(c(bl)[e.level].text),5),r("div",{class:"w-[20rem] max-w-[20rem] truncate",style:k({color:c(bl)[e.level].color}),title:e.ps?e.ps:e.vuln_name},p(e.ps?e.ps:e.vuln_name),13,oe),c(gl).includes(e.m_name)?m("",!0):(i(),o("div",re,[l[28]||(l[28]=u("无法自动修复，请手动处理或",-1)),v(a,{onClick:l[6]||(l[6]=e=>c(A).onlineServiceDialog())},{default:f(()=>[...l[27]||(l[27]=[u("联系人工",-1)])]),_:1})]))]),r("div",ce,[g(r("span",{onClick:l=>c(A).handleRepair(!0,e),class:"w-[4.2rem] bt-link"},[...l[29]||(l[29]=[u(" 修复",-1),r("span",{class:"text-tertiary mx-[4px]"},"|",-1)])],8,me),[[b,!c(cl)&&!!c(gl).includes(e.m_name)]]),r("span",{underline:!1,onClick:l=>c(A).handleIgnore(e,!1),class:"w-[4.2rem] cursor-pointer text-tertiary"},[...l[30]||(l[30]=[u(" 忽略 ",-1),r("span",{class:"text-tertiary mx-4px"},"|",-1)])],8,de),v(a,{onClick:l=>c(A).onToggle(e,c(hl)),class:"w-[5.4rem] flex items-center"},{default:f(()=>[u(p(e.show?"折叠":"详情"),1),r("i",{class:d("text-base text-tertiary ml-[4px] svgtofont-el-arrow-"+(e.show?"up":"down"))},null,2)]),_:2},1032,["onClick"])])]),v(L,null,{default:f(()=>[g(r("div",ue,[r("div",pe,[r("div",xe,p(e.ps?"风险描述":"涉及软件\t"),1),g(r("div",{class:"collapse-item",innerHTML:e.msg},null,8,fe),[[b,e.msg]]),g(r("div",{class:"collapse-item"},p(e.soft_name?c(A).vulnerabilityInvolvesSoftware(e):""),513),[[b,e.soft_name]])]),r("div",ve,[l[31]||(l[31]=r("div",null,"解决方案",-1)),e.tips?(i(),o("div",ye,[(i(!0),o(h,null,w(e.tips,(e,l)=>(i(),o("p",{key:l,class:d(0==l?"":"mt-[4px]")},p(l+1)+"、"+p(e),3))),128))])):m("",!0),e.vuln_solution?(i(),o("div",ge,p(e.vuln_solution),1)):m("",!0)]),g(r("div",be,[l[32]||(l[32]=r("div",null,"温馨提示",-1)),r("div",he,p(e.remind),1)],512),[[b,e.remind]])],512),[[b,e.show]])]),_:2},1024)]))),128))],2)]),_:1},8,["modelValue"])],10,te)),[[Ml,c(dl)]]),c(ml)?(i(),o("div",{key:2,class:d([c(pl)?"h-[32rem]":"h-[40rem]","scan-body flex justify-center flex-col my-[4rem] relative"])},[l[33]||(l[33]=r("span",{class:"bg-light h-[3rem] w-[33%] mb-[12px]"},null,-1)),(i(),o(h,null,w(4,(e,l)=>r("span",{class:"bg-light h-[3rem] w-full mb-[12px]",key:l})),64)),l[34]||(l[34]=r("span",{class:"bg-light h-[3rem] w-[60%] mb-[12px]"},null,-1)),(i(),o(h,null,w(3,(e,l)=>r("span",{class:"bg-light h-[3rem] w-full mb-[12px]",key:l})),64)),l[35]||(l[35]=r("span",{class:"bg-light h-[3rem] w-[40%] mb-[12px]"},null,-1))],2)):m("",!0),v(Tl,{title:"结果确认","show-footer":!1,area:54,modelValue:c(kl),"onUpdate:modelValue":l[8]||(l[8]=e=>y(kl)?kl.value=e:null)},{default:f(()=>[r("div",we,[r("span",ke,[l[36]||(l[36]=u("修复结果：修复成功",-1)),r("span",_e,p(c(_l).success),1),l[37]||(l[37]=u("项，修复失败",-1)),r("span",Ce,p(c(_l).failed),1),l[38]||(l[38]=u("项，忽略",-1)),r("span",Ve,p(c(_l).cannot_automatically),1),l[39]||(l[39]=u("项",-1))]),v(B,{"max-height":400,data:c(Cl),column:c(Vl)},null,8,["data","column"]),v(F,{options:[{content:"如有修复失败项，请关闭当前窗口，根据解决方案手动进行修复"}],"list-style":"none",class:"ml-[8px] mt-[12px]"})])]),_:1},8,["modelValue"]),v(Tl,{title:!1,"show-footer":!1,area:54,modelValue:c(wl).repairProgress,"onUpdate:modelValue":l[9]||(l[9]=e=>c(wl).repairProgress=e),showClose:!1},{default:f(()=>[r("div",Te,[v(jl,{class:"!w-full",color:"var(--el-color-primary)","text-inside":!0,"stroke-width":20,percentage:c(wl).progress},null,8,["percentage"]),r("span",je,p(c(wl).repairText),1)])]),_:1},8,["modelValue"]),v(Tl,{title:"忽略风险项",area:66,modelValue:c(xl),"onUpdate:modelValue":l[11]||(l[11]=e=>y(xl)?xl.value=e:null),"show-footer":!1},{default:f(()=>[c(ml)?m("",!0):(i(),o("div",Se,[v(R,{modelValue:c(yl),"onUpdate:modelValue":l[10]||(l[10]=e=>y(yl)?yl.value=e:null),accordion:"",class:d("".concat(c(fl).length?"":"!border-none"))},{default:f(()=>[r("div",Ie,[(i(!0),o(h,null,w(c(fl),(e,s)=>(i(),o("div",{class:"module-item text-small",key:"".concat(s)},[r("div",Le,[r("div",He,[r("span",{class:"text-small h-[2.2rem] flex items-center px-[8px] rounded-small ml-[8px] mr-[1rem]",style:k({color:c(bl)[e.level].color,backgroundColor:c(bl)[e.level].bg})},p(c(bl)[e.level].text),5),r("div",{class:"w-[36rem] max-w-[36rem] truncate",style:k({color:c(bl)[e.level].color}),title:e.ps?e.ps:e.vuln_name},p(e.ps?e.ps:e.vuln_name),13,Me)]),r("div",De,[v(a,{onClick:l=>c(Ke)(e,!0),class:"w-[6.6rem]"},{default:f(()=>[...l[40]||(l[40]=[u(" 移除忽略 ",-1),r("span",{class:"text-tertiary mx-[4px]"},"|",-1)])]),_:1},8,["onClick"]),v(a,{onClick:l=>c(Ne)(e,c(fl)),class:"w-[5.4rem] flex items-center"},{default:f(()=>[u(p(e.show?"折叠":"详情"),1),r("i",{class:d("text-base text-tertiary ml-[4px] svgtofont-el-arrow-"+(e.show?"up":"down"))},null,2)]),_:2},1032,["onClick"])])]),v(L,null,{default:f(()=>[g(r("div",Ue,[r("div",Ae,[r("div",Pe,p(e.ps?"风险描述":"涉及软件"),1),g(r("div",{class:"collapse-item",innerHTML:e.msg},null,8,Re),[[b,e.msg]]),g(r("div",{class:"collapse-item"},p(e.soft_name?c($e)(e):""),513),[[b,e.soft_name]])]),r("div",Be,[l[41]||(l[41]=r("div",null,"解决方案",-1)),e.tips?(i(),o("div",Fe,[(i(!0),o(h,null,w(e.tips,(e,l)=>(i(),o("p",{key:l,class:d(0==l?"":"mt-[4px]")},p(l+1)+"、"+p(e),3))),128))])):m("",!0),e.vuln_solution?(i(),o("div",Oe,p(e.vuln_solution),1)):m("",!0)]),g(r("div",ze,[l[42]||(l[42]=r("div",null,"温馨提示",-1)),r("div",Ge,p(e.remind),1)],512),[[b,e.remind]])],512),[[b,e.show]])]),_:2},1024)]))),128)),c(fl).length?m("",!0):(i(),x(Hl,{key:0,description:"暂无忽略的风险项"}))])]),_:1},8,["modelValue","class"])]))]),_:1},8,["modelValue"]),v(Tl,{title:"安全扫描报告","show-footer":!1,area:[100,80],modelValue:c(Il),"onUpdate:modelValue":l[12]||(l[12]=e=>y(Il)?Il.value=e:null)},{default:f(()=>[l[45]||(l[45]=r("div",{class:"box"},[r("iframe",{src:"/project/security/report/html",frameborder:"0",width:"200%",height:"200%"})],-1)),r("div",Je,[l[44]||(l[44]=r("span",null,null,-1)),v(a,{onClick:Ll,class:"border border-solid border-primary py-8px px-12px rounded-small mr-20px my-8px"},{default:f(()=>[...l[43]||(l[43]=[r("i",{class:"svgtofont-icon-ltd text-ltd mt-2px"},null,-1),u(" 下载报告",-1)])]),_:1})])]),_:1},8,["modelValue"])])])}}}),[["__scopeId","data-v-1d9de49d"]]);export{Ke as default};
