import{u as e,Q as a,V as s,H as t,n as l,d as n,e as c,f as r,_ as i}from"./utils-lib.js?v=1763689792";import{c as o,s as m,t as d,r as u,W as p,w as v,x as f,y as b,A as h,z as g,G as x,e as y,O as w,B as _,C as S,D as k,bb as C,F as T,b1 as j,R as M,H as B,b2 as H,be as P,bz as z,bA as D}from"./base-lib.js?v=1763689792";import{H as L}from"./index344.js?v=1763689792";import{B as O}from"./firewall.js?v=1763689792";import{dg as V}from"./validator.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";const A={class:"p-[1rem]"},E={class:"head mb-[2rem]"},I={class:"scan-header flex flex-row flex-wrap items-center justify-between"},Z={class:"flex flex-row flex-wrap justify-center items-center"},F={key:0,class:"relative scan-header-cont"},R={key:0,class:"animate-spin absolute top-0 border-primary border-b-2 rounded-full h-full w-full"},W={class:"scan-header-cont flex justify-between flex-col px-[2rem]"},q=["innerHTML"],N={class:"scan-subtitle text-medium mt-[1.2rem]"},G={class:"scan-header-cont justify-end relative"},K={class:"text-base"},Q={class:"content"},U={key:0,class:"info"},X={class:"webedit-con flex items-center justify-center"},Y={key:1,class:"scan"},J={key:0,class:"scan-success border-[0.1rem] p-[2rem] h-[38rem] border-light flex items-center justify-center"},$={class:"flex flex-column items-center"},ee={key:1,class:"scan-dangerous"},ae={class:"overflow-auto h-[36rem]"},se={class:"flex items-center"},te={class:"w-[26rem] flex items-center justify-start"},le={class:"ml-[1.2rem]"},ne={class:"flex items-center justify-between w-full"},ce={class:"flex items-center ml-[1.2rem]"},re={class:"text-tertiary ml-[1.2rem]"},ie={class:"bg-light text-tertiary p-[2rem] ml-[1.2rem]"},oe={class:"mt-[1.2rem] ml-[2rem]"},me={class:"flex items-center"},de=i(o({__name:"web",props:{compData:{default:()=>({isSiteModule:!1})}},setup(i){const o=i,{payment:de}=e(),ue=L(),{repairTypeActive:pe}=m(ue),{authType:ve}=d(de.value),fe=u(!0),be=u(!1),he=u({scanTitle:"立即进行漏洞扫描，确保您的网站安全。",scanTime:"您还未进行漏洞扫描!",scanCheckButton:"立即扫描"}),ge=u(["1"]),xe=p([]),ye={4:["danger","严重"],3:["warning","高危"],2:["info","中危"],1:["success","低危"]},we=u("success"),_e=u(!1),Se=async()=>{if("ltd"!==ve.value)return ue.openPayView();we.value="loading",he.value.scanTitle="正在扫描中，请稍后...";try{const{data:e}=await a({request:O(),loading:_e});if(he.value.scanTitle="扫描完成",he.value.scanTime="扫描时间：".concat(s(e.time)),he.value.scanCheckButton="重新检测",fe.value=!1,e.info.length?(be.value=!1,xe.value=e.info,we.value="danger",he.value.scanCheckButton="重新检测",he.value.scanTitle="全部【".concat(e.site_num,"个】网站存在风险项<span class='text-danger'>").concat(e.loophole_num,"</span>个")):(be.value=!0,he.value.scanTitle="当前网站没有风险项"),e.loophole_num!==ue.tootipTotal.web&&ue.getScanTotal(),!1!==(null==e?void 0:e.status)&&!0===o.compData.isSiteModule){const{useSitePhpStore:a}=await t(()=>import("./useController5.js?v=1763689792").then(e=>e.w),__vite__mapDeps([]),import.meta.url),{scanData:s}=a();Object.assign(s.value,e)}}catch(e){we.value="success"}};v(pe,e=>{"web"===e&&(async()=>{const{data:e}=await V(),{loophole_num:a,site_num:s,time:t}=e.data;a>0?(he.value.scanTitle="<span class='text-danger'>".concat(a,"</span>个高危网站漏洞待处理！ 总扫描网站数量").concat(s,"个"),he.value.scanTime="上一次扫描时间:".concat(t),we.value="danger",he.value.scanCheckButton="立即查看"):(he.value.scanTitle="未扫描到网站漏洞，总扫描网站数量".concat(s,"个"),he.value.scanTime="上一次扫描时间:".concat(t),he.value.scanCheckButton="重新检测",we.value="success")})()});const ke=()=>l({title:"设置自动扫描",area:54,component:()=>t(()=>import("./index523.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),showFooter:!0});return(e,a)=>{const s=n,t=c,l=B,i=H,o=r,m=P,d=z,u=D;return f(),b("div",null,[a[9]||(a[9]=h("div",{class:"text-large mb-6"},"网站漏洞检测",-1)),h("div",A,[h("div",E,[h("div",I,[h("div",Z,["loading"==g(we)?(f(),b("div",F,[g(_e)?(f(),b("div",R)):x("",!0),y(s,{icon:"scanning-scan",size:60,color:"var(--el-color-primary)"})])):x("",!0),"success"==g(we)?(f(),w(s,{key:1,icon:"scanning-success",size:60,color:"var(--el-color-primary)"})):x("",!0),"danger"==g(we)?(f(),w(s,{key:2,icon:"scanning-danger",size:60,color:"#ef0808"})):x("",!0),h("div",W,[h("div",{class:"scan-title text-extraLarge font-bold",innerHTML:g(he).scanTitle},null,8,q),h("div",N,_(g(he).scanTime),1)])]),h("div",G,[y(t,{class:"btlink setScanAlarm absolute top-[5rem] right-1rem",onClick:ke},{default:S(()=>[...a[1]||(a[1]=[k(" 自动扫描>> ",-1)])]),_:1}),y(l,{class:"scan-btn h-[4rem] w-[10rem]",type:"loading"==g(we)?"default":"primary",size:"large",onClick:Se},{default:S(()=>[h("span",K,_(g(he).scanCheckButton),1)]),_:1},8,["type"])])])]),y(i,{class:"!mt-0"}),h("div",Q,[g(fe)?(f(),b("div",U,[h("div",X,[y(o,{class:"max-w-[90rem] mr-[4rem] w-[36rem]",src:"/preview/site_scanning.png"}),a[2]||(a[2]=C('<div class="thumbnail-introduce mt-[0rem]" data-v-95e8545a><span class="text-large font-bold" data-v-95e8545a>漏洞扫描工具介绍：</span><ul class="block leading-[2.6rem] mx-[2rem] list-square mt-[2rem]" data-v-95e8545a><li data-v-95e8545a> 可识别多款开源CMS程序，支持如下： <br data-v-95e8545a> 迅睿CMS、pbootcms、苹果CMS、eyoucms、海洋CMS、 <br data-v-95e8545a> ThinkCMF、zfaka、dedecms、MetInfo、emlog、 <br data-v-95e8545a>帝国CMS、discuz、Thinkphp、Wordpress、Z-Blog、 <br data-v-95e8545a>极致CMS、ShopXO、HYBBS、ECShop、SchoolCMS、 <br data-v-95e8545a>phpcms、likeshop、iCMS、WellCMS、chanzhiEPS、 <br data-v-95e8545a>PHPOK、LaySNS、骑士CMS、openSNS、齐博CMS、 <br data-v-95e8545a>ZZZCMS、prestashop、ThinkphpSHOP、DouPHP、 <br data-v-95e8545a>cmseasy、piwigo、phpwind、行云海CMS </li><li data-v-95e8545a>可扫描网站中存在的漏洞</li><li data-v-95e8545a>提供修复/提供付费解决方案</li></ul></div>',1))])])):(f(),b("div",Y,[g(be)?(f(),b("div",J,[h("div",$,[y(o,{src:"/firewall/secure.png",class:"w-[34.0rem] h-[30.1rem]"}),a[3]||(a[3]=h("span",{class:"absolute mt-[10.5rem] text-extraLarge leading-[0.14rem]"}," 当前处于【安全状态】，请继续保持！ ",-1))])])):(f(),b("div",ee,[a[6]||(a[6]=h("div",{class:"flex items-center mb-[2rem] text-default"},[h("span",{class:"w-[26rem]"},"网站"),h("span",null,"类型")],-1)),h("div",ae,[y(u,{modelValue:g(ge),"onUpdate:modelValue":a[0]||(a[0]=e=>M(ge)?ge.value=e:null),accordion:""},{default:S(()=>[(f(!0),b(T,null,j(g(xe),(e,s)=>(f(),w(d,{key:s},{title:S(()=>[h("div",se,[h("div",te,[y(m,{type:e.cms.length>0?"warning":"success",effect:"dark"},{default:S(()=>[k(_(e.cms.length)+"项 ",1)]),_:2},1032,["type"]),h("span",le,_(e.name),1)]),h("span",null,_(e.cms_name+"--"+e.version_info),1),a[4]||(a[4]=h("div",{class:"text-secondary text-small ml-[6rem]"},"无法自动修复,请在网站后台更新该软件版本。",-1))])]),default:S(()=>[y(u,{accordion:""},{default:S(()=>[(f(!0),b(T,null,j(e.cms,(e,s)=>(f(),w(d,{key:s},{title:S(()=>[h("div",ne,[h("div",ce,[y(m,{type:ye[e.dangerous][0]},{default:S(()=>[k(_(ye[e.dangerous][1]),1)]),_:2},1032,["type"]),h("span",re,_(e.ps),1)]),y(t,{class:"mb-[.2rem] mr-[1.6rem]"},{default:S(()=>[...a[5]||(a[5]=[k("详情",-1)])]),_:1})])]),default:S(()=>[h("div",ie,"修复建议："+_(e.repair),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"])])]))])),h("div",oe,[h("div",me,[a[8]||(a[8]=k(" 如需支持其他cms程序，请发帖反馈： ",-1)),y(t,{href:"https://www.bt.cn/bbs/thread-89149-1-1.html"},{default:S(()=>[...a[7]||(a[7]=[k(" https://www.bt.cn/bbs/thread-89149-1-1.html ",-1)])]),_:1})])])])])])}}}),[["__scopeId","data-v-95e8545a"]]);export{de as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
