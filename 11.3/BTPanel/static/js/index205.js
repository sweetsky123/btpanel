import{M as a,Q as e,iI as l,iJ as s,p,bW as t,iK as o,aH as n,aK as r,iL as d,aI as i,aJ as m,iM as c,iN as u,$ as h,_ as v,k as y,aC as f}from"./utils-lib.js?v=1763689792";import{r as g,o as b,c as w,x as S,y as V,A as x,z as _,e as k,aJ as C,v as P,O as L,C as q,R as A,D as U,b1 as M,F as N,G as D,V as j,aD as I,an as H,H as J,ap as B,U as K,ad as z,ab as F,am as G}from"./base-lib.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";const O=g(!1),Q=g([]),R=g(""),W=g("phpService"),$=b({phpPort:8888,onSSL:!0,phpSSL:"",phpPass:!0}),E=g(!1),T=b({username:"",password:"",repass:""}),X=async()=>{T.password.length<3||T.username.length<3?a.error("输入的账号密码需要大于三位"):T.password===T.repass?await e({loading:"正在保存密码，请稍后...",request:l({...T,siteName:"phpmyadmin"}),message:!0,success:()=>{E.value=$.phpPass}}):a.error("两次输入的密码不一致")},Y=async()=>{await e({request:u(),data:{status:Boolean,port:String,auth:Boolean},success:a=>{$.onSSL=a.status,$.phpSSL=a.port,$.phpPass=a.auth,E.value=$.phpPass}})},Z=async()=>{await e({loading:"正在保存SSL端口，请稍后...",request:s({port:$.phpSSL}),message:!0})},aa=async a=>{await p({title:"提示",icon:"warning-filled",width:"35rem",content:"您真的要".concat(a?"启动":"停止","phpmyadmin服务吗？")}),await e({loading:"正在".concat(a?"启动":"停止","phpmyadmin服务..."),request:t({name:"phpmyadmin",type:a?"start":"stop"}),message:!0})},ea=async a=>{await e({loading:"正在".concat(a?"开启":"关闭","，请稍后..."),request:o({v:$.onSSL?1:0}),message:!0,success:Y})},la=async a=>{await e({loading:"正在保存配置，请稍后...",request:l(a),message:!0})},sa=async()=>{W.value="phpService";try{const a=await n({sName:"phpmyadmin"});O.value=a.data.status,R.value=Array.isArray(a.data.ext.phpversion)?a.data.ext.phpversion[0]:a.data.ext.phpversion,$.phpPort=Number(a.data.ext.port)}catch(a){r(a)}},pa=async a=>{!a&&E.value&&($.phpPass=!a,await p({title:"提示",icon:"warning-filled",content:"您真的要关闭访问认证吗?"}),e({loading:"正在设置状态，请稍后...",request:l({password:"close",siteName:"phpmyadmin"}),message:!0,success:()=>{$.phpPass=a,E.value=$.phpPass}}))},ta=(a,l)=>{W.value=a,"phpService"==a?sa():"phpVersion"==a?(async()=>{await e({request:c(),data:[Array,Q]})})():"phpSafety"==a&&Y()},oa=[{content:"面板访问需要登录面板后，才能通过面板访问phpMyAdmin"},{content:"若通过面板为phpMyAdmin开启了密码访问，请使用【通过公共访问】"},{content:"如通过面板访问无响应，请使用通过公共访问进行访问phpmyadmin"},{content:"如访问出现502，请检查php运行是否正常或尝试更换其他php版本进行访问"},{content:"关闭公共访问权限可提升安全性，可到软件商店->phpMyAdmin中关闭",class:"text-danger"}],na=async l=>{try{const{data:s}=await n({sName:"phpmyadmin"});if("panel"===l){if(null==s?void 0:s.ext.auth)return void a.error("当前phpMyAdmin已开启密码访问，请使用【通过公共访问】进行访问");if("false"===(null==s?void 0:s.setup))return void a.error("当前phpMyAdmin未安装，请先安装phpMyAdmin");e({loading:"正在跳转phpMyAdmin，请稍后...",request:d({table:"config",key:"mysql_root",id:1}),success:a=>{i("root",a.data)}})}else s.status?e({loading:"正在跳转phpMyAdmin，请稍后...",request:d({table:"config",key:"mysql_root",id:1}),success:a=>{m("","root",a.data,s.ext.url)}}):a.error("未开启公共访问权限，请开启后再访问")}catch(s){r(s)}},ra={class:"p-[16px]"},da={class:"flex items-center w-full mb-[16px]"},ia={class:"relative w-[14rem] bg-darker h-[4.2rem] mr-[24px] rounded-small"},ma={class:"relative w-[14rem] bg-darker h-[4.2rem] rounded-small"},ca=v(w({__name:"service",setup:a=>(a,e)=>{const l=h;return S(),V("div",ra,[x("div",da,[x("div",ia,[x("div",{class:"h-[4rem] leading-[4rem] text-center w-full cursor-pointer link-hover",onClick:e[0]||(e[0]=a=>_(na)("panel"))},"通过面板访问"),e[2]||(e[2]=x("span",{class:"bg-contain inline-block recommend-bg absolute -top-[0.1rem] -left-[0.1rem]"},null,-1))]),x("div",ma,[x("div",{class:"h-[4rem] leading-[4rem] text-center w-full cursor-pointer link-hover",onClick:e[1]||(e[1]=a=>_(na)())},"通过公共访问")])]),k(l,{options:_(oa),class:"pl-2rem list-disc"},null,8,["options"])])}}),[["__scopeId","data-v-14118ac3"]]),ua={class:"php-bottom mb-[12px]"},ha={class:"p-[20px]"},va={class:"php-bottom flex items-center"},ya={class:"php-bottom flex flex-col"},fa={class:"flex items-center"},ga={class:"php-bottom flex-col"},ba=v(w({__name:"index",props:{compData:{default:{}}},setup(a){const e=a;return C(()=>{"string"==typeof e.compData&&(W.value=e.compData)}),P(sa),(a,e)=>{const l=j,s=I,p=G,t=H,o=J,n=y,r=B,d=K,i=z,m=F,c=f;return S(),L(c,{modelValue:_(W),"onUpdate:modelValue":e[11]||(e[11]=a=>A(W)?W.value=a:null),type:"left-bg-card",onChange:_(ta)},{default:q(()=>[k(s,{label:"服务",name:"phpService"},{default:q(()=>[x("div",ua,[k(l,{modelValue:_(O),"onUpdate:modelValue":e[0]||(e[0]=a=>A(O)?O.value=a:null),onChange:_(aa)},{default:q(()=>[...e[12]||(e[12]=[U("启用公共访问权限",-1)])]),_:1},8,["modelValue","onChange"])]),k(ca)]),_:1}),k(s,{label:"php版本",name:"phpVersion"},{default:q(()=>[x("div",ha,[e[14]||(e[14]=x("span",null,"php版本",-1)),k(t,{class:"mx-[12px] !w-[15.6rem]",modelValue:_(R),"onUpdate:modelValue":e[1]||(e[1]=a=>A(R)?R.value=a:null),placeholder:"请选择"},{default:q(()=>[(S(!0),V(N,null,M(_(Q),a=>(S(),L(p,{key:a.version,label:a.name,value:a.version},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),k(o,{type:"primary",onClick:e[2]||(e[2]=a=>_(la)({phpversion:_(R)}))},{default:q(()=>[...e[13]||(e[13]=[U("保存",-1)])]),_:1})])]),_:1}),k(s,{label:"安全设置",name:"phpSafety"},{default:q(()=>[x("div",va,[e[16]||(e[16]=x("span",{class:"mr-[12px]"},"访问端口",-1)),k(n,{class:"!mb-0 mr-[12px] !w-[14rem]",modelValue:_($).phpPort,"onUpdate:modelValue":e[3]||(e[3]=a=>_($).phpPort=a),width:"14rem",type:"number"},null,8,["modelValue"]),k(o,{type:"primary",onClick:e[4]||(e[4]=a=>_(la)({port:_($).phpPort}))},{default:q(()=>[...e[15]||(e[15]=[U("保存",-1)])]),_:1})]),x("div",ya,[x("div",fa,[e[17]||(e[17]=x("span",{class:"mr-[12px]"},"开启SSL",-1)),k(r,{modelValue:_($).onSSL,"onUpdate:modelValue":e[5]||(e[5]=a=>_($).onSSL=a),onChange:_(ea),"active-color":"var(--el-color-primary)","inactive-color":"#cdcdcd",class:"!m-0"},null,8,["modelValue","onChange"])]),x("div",null,[e[19]||(e[19]=x("span",{class:"mr-[12px]"},"SSL端口",-1)),k(n,{class:"!mb-0 mr-[12px] !w-[14rem]",modelValue:_($).phpSSL,"onUpdate:modelValue":e[6]||(e[6]=a=>_($).phpSSL=a),width:"14rem",type:"number"},null,8,["modelValue"]),k(o,{type:"primary",onClick:_(Z)},{default:q(()=>[...e[18]||(e[18]=[U("保存",-1)])]),_:1},8,["onClick"])])]),x("div",ga,[x("div",null,[e[20]||(e[20]=x("span",{class:"mr-[12px]"},"密码访问",-1)),k(r,{modelValue:_($).phpPass,"onUpdate:modelValue":e[7]||(e[7]=a=>_($).phpPass=a),"active-color":"var(--el-color-primary)","inactive-color":"#cdcdcd",onChange:_(pa),class:"!m-0"},null,8,["modelValue","onChange"])]),x("div",null,[_($).phpPass?(S(),L(m,{key:0,"label-position":"right","label-width":"80px",class:"-ml-3.2rem",model:_(T)},{default:q(()=>[k(i,{label:"授权账号"},{default:q(()=>[k(d,{modelValue:_(T).username,"onUpdate:modelValue":e[8]||(e[8]=a=>_(T).username=a),placeholder:"不修改请留空"},null,8,["modelValue"])]),_:1}),k(i,{label:"访问密码"},{default:q(()=>[k(d,{type:"password",modelValue:_(T).password,"onUpdate:modelValue":e[9]||(e[9]=a=>_(T).password=a),placeholder:"不修改请留空"},null,8,["modelValue"])]),_:1}),k(i,{label:"重复密码"},{default:q(()=>[k(d,{type:"password",modelValue:_(T).repass,"onUpdate:modelValue":e[10]||(e[10]=a=>_(T).repass=a),placeholder:"不修改请留空"},null,8,["modelValue"])]),_:1}),k(i,{label:" "},{default:q(()=>[k(o,{type:"primary",onClick:_(X)},{default:q(()=>[...e[21]||(e[21]=[U("保存",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])):D("",!0)])])]),_:1})]),_:1},8,["modelValue","onChange"])}}}),[["__scopeId","data-v-98d4aac7"]]);export{ba as default};
