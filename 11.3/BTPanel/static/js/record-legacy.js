!function(){function t(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,n,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",c=a.toStringTag||"@@toStringTag";function i(e,a,o,c){var i=a&&a.prototype instanceof s?a:s,l=Object.create(i.prototype);return r(l,"_invoke",function(e,r,a){var o,c,i,s=0,l=a||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(n,e){return o=n,c=0,i=t,p.n=e,u}};function d(e,r){for(c=e,i=r,n=0;!f&&s&&!a&&n<l.length;n++){var a,o=l[n],d=p.p,v=o[2];e>3?(a=v===r)&&(i=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((a=e<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<v&&(a=e<3||o[0]>r||r>v)&&(o[4]=e,o[5]=r,p.n=v,c=0))}if(a||e>1)return u;throw f=!0,r}return function(a,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,i=v;(n=c<2?t:i)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,i)):p.n=i:p.v=i);try{if(s=2,o){if(c||(a="next"),n=o[a]){if(!(n=n.call(o,i)))throw TypeError("iterator result is not an object");if(!n.done)return n;i=n.value,c<2&&(c=0)}else 1===c&&(n=o.return)&&n.call(o),c<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),c=1);o=t}else if((n=(f=p.n<0)?i:e.call(r,p))!==u)break}catch(n){o=t,c=1,i=n}finally{s=1}}return{value:n,done:f}}}(e,o,c),!0),l}var u={};function s(){}function l(){}function f(){}n=Object.getPrototypeOf;var p=[][o]?n(n([][o]())):(r(n={},o,function(){return this}),n),d=f.prototype=s.prototype=Object.create(p);function v(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,r(t,c,"GeneratorFunction")),t.prototype=Object.create(d),t}return l.prototype=f,r(d,"constructor",f),r(f,"constructor",l),l.displayName="GeneratorFunction",r(f,c,"GeneratorFunction"),r(d),r(d,c,"Generator"),r(d,o,function(){return this}),r(d,"toString",function(){return"[object Generator]"}),(e=function(){return{w:i,m:v}})()}function r(t,n,e,a){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}r=function(t,n,e,a){function c(n,e){r(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!a,configurable:!a,writable:!a}):t[n]=e:(c("next",0),c("throw",1),c("return",2))},r(t,n,e,a)}function a(t,n,e,r,a,o,c){try{var i=t[o](c),u=i.value}catch(t){return void e(t)}i.done?n(u):Promise.resolve(u).then(r,a)}function o(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var c=t.apply(n,e);function i(t){a(c,r,o,i,u,"next",t)}function u(t){a(c,r,o,i,u,"throw",t)}i(void 0)})}}System.register(["./index-legacy109.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./index.vue_vue_type_script_setup_true_lang-legacy5.js?v=1763689792","./index-legacy118.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./column-legacy.js?v=1763689792","./config-legacy.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792"],function(n,r){"use strict";var a,c,i,u,s,l,f,p,d,v,y,g,m,b,_,h,w,j,x,k,O,S,T,A,C,D,G,M,z,P,E,I,F,H,U,V,q;return{setters:[function(t){a=t._},function(t){c=t.u,i=t.V,u=t.p,s=t.Q,l=t.M,f=t.l,p=t.j,d=t._},function(t){v=t._},function(t){y=t._},function(t){g=t.c,m=t.r,b=t.o,_=t.e,h=t.aE,w=t.aT,j=t.D,x=t.v,k=t.I,O=t.x,S=t.y,T=t.C,A=t.J,C=t.z,D=t.R,G=t.A,M=t.F,z=t.b1,P=t.B,E=t.L,I=t.G,F=t.H},function(t){H=t.u},function(t){U=t.an,V=t.ao,q=t.ap},null,null],execute:function(){var r={class:"p-[2rem]"},J={class:"p-[2rem]"},L={class:"item"},N={key:0,class:"border border-light rounded-base max-h-[20rem] overflow-y-auto"},R={key:0,class:"w-[50%]"},B={key:1,class:"w-[50%]"},Q={class:"w-[50%] truncate"},$={key:1,class:"box"},K={class:"item"},W=["innerHTML"],X=g({__name:"record",props:{compData:{default:function(){}}},setup:function(n){var d=n,g=c().push,X=m({}),Y=m(!1),Z=m([]),tt=m(!1),nt=m([]),et=b({page:1,size:10,total:0}),rt=function(){var t=o(e().m(function t(n){return e().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,u({title:"清空记录【".concat(d.compData.title,"】"),content:"您真的要清空【".concat(d.compData.title,"】的所有告警记录吗？")});case 1:return t.n=2,s({loading:"正在清空记录，请稍后...",request:U({task_id:d.compData.id,record_ids:JSON.stringify([n.id])}),message:!0});case 2:ot(),t.n=4;break;case 3:t.p=3,t.v;case 4:return t.a(2)}},t,null,[[0,3]])}));return function(n){return t.apply(this,arguments)}}(),at=function(){var t=o(e().m(function t(n){return e().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,u({title:"删除记录",content:"您真的要删除这条告警记录吗？"});case 1:return t.n=2,s({loading:"正在删除记录，请稍后...",request:V({task_id:d.compData.id,record_ids:JSON.stringify([n.id])}),message:!0});case 2:ot(),t.n=4;break;case 3:t.p=3,t.v;case 4:return t.a(2)}},t,null,[[0,3]])}));return function(n){return t.apply(this,arguments)}}(),ot=function(){var t=o(e().m(function t(){return e().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,s({loading:tt,request:q({task_id:d.compData.id,page:et.page,size:et.size}),success:function(t){var n=t.data;nt.value=n.data.list,et.total=n.data.count}});case 1:t.n=3;break;case 2:t.p=2,t.v;case 3:return t.a(2)}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}(),ct=[{label:"发送时间",render:function(t){return _("span",null,[i(t.create_time)])}},{label:"发送状态",render:function(t){var n=t.result.stop_msg;if(t.do_send){var e=Object.values(t.result.send_data).reduce(function(t,n){return"number"==typeof n&&1===n?t.success++:"string"==typeof n&&t.fail++,t},{success:0,fail:0});n="发送成功"+e.success+"次，发送失败"+e.fail+"次"}return h(w,{popperClass:"softTooltip",effect:"light",enterable:!1,placement:"top-end",content:n},function(){return h("span",{class:t.do_send?"text-primary":"text-danger"},t.do_send?"已发送":"未发送")})}},{label:"告警详情",render:function(t){return _("span",{class:"bt-link",onClick:function(){return function(t){X.value=t;var n=l.load("正在获取告警详情，请稍后...");try{var e=new Map([["wx_account","微信公众号"],["feishu","飞书"],["mail","邮箱"],["sms","短信通知"],["dingding","钉钉"],["weixin","企业微信"],["webhook","自定义消息通道"]]),r=Object.entries(t.result.send_data).map(function(t){var n=t.at(0),r=g.value.config.find(function(t){return t.id===n});return{result:1===t.at(1),resultMsg:1===t.at(1)?"发送成功":t.at(1),accounts:{title:e.get(null==r?void 0:r.sender_type)||"",account:null==r?void 0:r.data.title}}});Z.value=r,Y.value=!0}catch(a){}finally{n.close()}}(t)}},[j("点击查看")])}},H([{onClick:at,title:"删除"}])];return x(function(){return ot()}),function(n,e){var o=F,c=f,i=y,u=v,s=p,l=a,d=k("bt-loading");return O(),S("div",r,[_(l,null,{"header-left":T(function(){return[_(o,{onClick:rt},{default:T(function(){return t(e[3]||(e[3]=[j("清空记录",-1)]))}),_:1})]}),content:T(function(){return[A(_(c,{ref:"alarmRecordRef",column:ct,data:C(nt),description:"记录为空","max-height":"42rem"},null,8,["data"]),[[d,C(tt)],[d,"正在获取告警记录，请稍候...","title"]])]}),"footer-right":T(function(){return[_(i,{total:C(et).total,page:C(et).page,"onUpdate:page":e[0]||(e[0]=function(t){return C(et).page=t}),row:C(et).size,"onUpdate:row":e[1]||(e[1]=function(t){return C(et).size=t}),onChange:ot},null,8,["total","page","row"])]}),popup:T(function(){return[_(s,{modelValue:C(Y),"onUpdate:modelValue":e[2]||(e[2]=function(t){return D(Y)?Y.value=t:null}),area:48,title:"告警详情"},{default:T(function(){return[G("div",J,[G("div",L,[e[5]||(e[5]=G("div",{class:"title"},"发送情况",-1)),C(Z).length>0?(O(),S("div",N,[e[4]||(e[4]=G("div",{class:"table-box"},[G("span",{class:"w-[50%]"},"发送账号"),G("span",{class:"w-[50%]"},"发送结果")],-1)),(O(!0),S(M,null,z(C(Z),function(t,n){return O(),S("div",{class:"table-box",key:n},[t.accounts.account&&t.accounts.title?(O(),S("span",R,P("".concat(t.accounts.account,"(").concat(t.accounts.title,")")),1)):(O(),S("span",B,P("".concat(t.accounts.title)),1)),G("span",Q,[_(u,{popperClass:"w-[400px]",placement:"left",class:E(t.result?"text-primary":"text-danger"),text:t.resultMsg},null,8,["class","text"])])])}),128))])):I("",!0),0==C(Z).length?(O(),S("div",$,P(C(X).result.stop_msg),1)):I("",!0)]),G("div",K,[e[6]||(e[6]=G("div",{class:"title"},"告警信息",-1)),G("div",{class:"box",innerHTML:C(X).send_data.msg_list.join("<br>")},null,8,W)])])]}),_:1},8,["modelValue"])]}),_:1})])}}});n("default",d(X,[["__scopeId","data-v-14c26f62"]]))}}})}();
