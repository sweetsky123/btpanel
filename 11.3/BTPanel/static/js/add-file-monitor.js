import{Q as a,$ as e}from"./utils-lib.js?v=1763689792";import{c as t,o as s,r as o,g as l,v as i,x as r,y as p,e as d,C as n,z as c,F as m,b1 as u,ad as f,ag as h,ab as b,A as g,B as _,V as D}from"./base-lib.js?v=1763689792";import{_ as j}from"./index107.js?v=1763689792";import{bN as y}from"./firewall.js?v=1763689792";import{f as w}from"./validator.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";const x={class:"p-20px"},v=t({__name:"add-file-monitor",props:{compData:{default:()=>{}}},setup(t,{expose:v}){const V=t,C=s({path:"",type:"dir",domain:V.compData.name,actions:[]}),k=o(),q=l(()=>"dir"===C.type),F=[{name:"read",title:"读取"},{name:"del",title:"删除"},{name:"reit",title:"修改/增加"}],N={path:[{required:!0,message:"请选择监测路径",trigger:"blur"}],actions:[{required:!0,message:"请选择告警操作",trigger:"change"}]},U=()=>{V.compData.row||w({type:"all",path:C.path,change:(a,e)=>{C.path=a,C.type=e,C.actions="dir"===e?["read"]:["read","del","reit"]}})};return i(()=>(()=>{if(V.compData.path&&(C.path=V.compData.path.replace("//","/")),V.compData.row){const a=["del","read","reit"],e=[];Object.entries(V.compData.row).forEach(([t,s])=>{a.includes(t)&&Number(s)&&e.push(t)}),C.type=V.compData.row.type,C.actions=e}})()),v({onConfirm:async e=>{await k.value.validate();let t={...C},s=[0,0,0,0];C.actions.includes("read")&&(s[0]=1),C.actions.includes("del")&&(s[1]=1),C.actions.includes("reit")&&(s[2]=1,s[3]=1),t.actions=s.join(","),await a({loading:"正在添加文件监视器，请稍后...",request:y(!!V.compData.row,{...t}),message:!0,success:a=>{a.status&&(V.compData.refresh&&V.compData.refresh(),e())}})}}),(a,t)=>{const s=j,o=f,l=D,i=h,y=b,w=e;return r(),p("div",x,[d(y,{model:c(C),ref_key:"addFileMonitorRef",ref:k,rules:N},{default:n(()=>[d(o,{prop:"path",label:"监测路径"},{default:n(()=>[d(s,{modelValue:c(C).path,"onUpdate:modelValue":t[0]||(t[0]=a=>c(C).path=a),class:"!w-[28rem]",icon:"icon-file_mode",onIconClick:U,disabled:!!V.compData.row,onChangePassive:t[1]||(t[1]=a=>{C.path=C.path.replace(/\s+/g,"")}),placeholder:"请选择文件目录"},null,8,["modelValue","disabled"])]),_:1}),d(o,{label:"告警操作",prop:"actions"},{default:n(()=>[d(i,{modelValue:c(C).actions,"onUpdate:modelValue":t[2]||(t[2]=a=>c(C).actions=a)},{default:n(()=>[(r(),p(m,null,u(F,(a,e)=>d(l,{key:e,label:a.name,disabled:c(q)&&e>0},{default:n(()=>[g("div",null,[g("span",null,_(a.title),1)])]),_:2},1032,["label","disabled"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),d(w,{options:[{content:"目录暂时只支持读取告警操作"}],class:"ml-20px mt-20px","list-style":"disc"})])}}});export{v as default};
