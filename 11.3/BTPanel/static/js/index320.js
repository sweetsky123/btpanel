import{_ as a}from"./index109.js?v=1763689792";import{u as e,Q as l,p as s,l as t,k as r,$ as o,j as n}from"./utils-lib.js?v=1763689792";import{c as d,r as i,o as m,e as u,v as c,I as p,x as f,y as b,C as _,D as g,J as w,z as h,R as j,H as y,ad as v,ab as x}from"./base-lib.js?v=1763689792";import{aN as V,aO as k,aP as q}from"./firewall.js?v=1763689792";import{u as C}from"./column.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";const H=d({__name:"index",setup(d){e();const H=i(!1),P=i([]),R=i(!1),U=m({cmd:""}),z=i(),A={cmd:[{trigger:["blur","change"],required:!0,message:"请输入进程名称"}]},D=async()=>{await l({loading:H,request:V(),data:[Array,P]})},F=async()=>{await z.value.validate(),await l({loading:"正在添加进程白名单，请稍后...",request:q(U),message:!0}),D(),R.value=!1,U.cmd=""},I=[{label:"进程名",render:a=>u("span",null,[a])},C([{onClick:async a=>{await s({icon:"warning-filled",title:"删除进程白名单【"+a+"】",width:"34rem",content:"删除选中的进程后，该进程将不再进行收到保护，是否继续操作？"}),await l({loading:"正在删除进程白名单，请稍后...",request:k({cmd:a}),message:!0}),D()},title:"删除"}])];return c(()=>{D()}),(e,l)=>{const s=y,d=t,i=r,m=v,c=o,V=x,k=n,q=a,C=p("bt-loading");return f(),b("div",null,[u(q,null,{"header-left":_(()=>[u(s,{type:"primary",onClick:l[0]||(l[0]=a=>R.value=!0)},{default:_(()=>[...l[3]||(l[3]=[g(" 添加进程白名单 ",-1)])]),_:1})]),content:_(()=>[w(u(d,{column:I,data:h(P),description:"进程白名单列表为空"},null,8,["data"]),[[C,h(H)],[C,"正在加载进程白名单列表，请稍后...","title"]])]),popup:_(()=>[u(k,{title:"添加进程",modelValue:h(R),"onUpdate:modelValue":l[2]||(l[2]=a=>j(R)?R.value=a:null),area:42,onConfirm:F,showFooter:""},{default:_(()=>[u(V,{ref_key:"addProcessWhiteRef",ref:z,rules:A,model:h(U),class:"p-[2rem]","label-width":"5rem"},{default:_(()=>[u(m,{label:"进程名称",prop:"cmd"},{default:_(()=>[u(i,{modelValue:h(U).cmd,"onUpdate:modelValue":l[1]||(l[1]=a=>h(U).cmd=a),width:"20rem",placeholder:"例:/bin/bash",clearable:""},null,8,["modelValue"])]),_:1}),u(c,{options:[{class:"text-danger",content:"命令需要填写全路径例如：/usr/bin/curl"}],class:"pl-[3.6rem] pt-[.4rem]"})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1})])}}});export{H as default};
