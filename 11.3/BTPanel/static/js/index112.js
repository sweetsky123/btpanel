import{u as e,r as a,bL as l,t as r,bE as s,k as t,e as o,N as i,bM as n,b as d,_ as c}from"./utils-lib.js?v=1763689792";import{_ as u}from"./index110.js?v=1763689792";import{B as m}from"./index106.js?v=1763689792";import{c as p,r as v,o as f,v as w,aG as b,I as g,x as h,O as _,C as y,e as x,A as k,B as D,L as j,J as V,z,Q as C,y as I,D as q,G as E,K as L,F as K}from"./base-lib.js?v=1763689792";import{u as U,b as B}from"./useController.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";const G={class:"flex !justify-center !w-full items-center"},M={class:"text-extraLarge text-default inline-block mr-2 font-bold my-[10px]"},O={key:0,class:"absolute el-form-item__error"},W={class:"flex justify-end items-center mt-6 text-small"},$={class:"flex justify-center items-center mt-2"},A=c(p({__name:"index",props:{compData:{default:()=>({title:"",btn:"",isDialog:!0,redirect:""})}},setup(c,{expose:p}){var A;const{getGlobalInfo:F}=e(),H=d(),J=c,{qrcodeLoading:N,openWechatLogin:Q,onCancelWechat:R}=U(null==(A=J.compData)?void 0:A.redirect),T=v(!1),P=v("获取验证码"),S=f({username:"",password:"",code:""}),X=f({username:!1,password:!1,code:!1}),Y=v(""),Z=v(),ee=v(),ae=v(!1),le=v({username:[{validator:(e,a,l)=>{var r,s;if((null==(r=J.compData)?void 0:r.title)&&(ae.value=!1),/^1[3456789]\d{9}$/.test(a))l();else if(""===a)l(new Error("请输入宝塔官网账号"));else{if(null==(s=J.compData)?void 0:s.title)return ae.value=!0,void l(new Error(" "));l(new Error("请输入正确的手机号"))}},trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:["blur","change"]},{validator:(e,a,l)=>{a.length>=8?l():l(new Error("请输入至少8位密码"))},trigger:["blur","change"]}],token:[{required:!1,message:"请输入验证码",trigger:["blur","change"]},{validator:(e,a,l)=>{T.value||l(),6===a.length?l():l(new Error("请输入6位验证码，不可为空"))},trigger:["blur","change"]}]}),re=()=>{ee.value.validate(async e=>{e&&B({isCheck:T,userInfo:S,userToken:Y})})},se=async()=>{if(!S.username||!S.password)return void H.error("请先输入手机号和密码");X.username=!0,X.password=!0,(e=>{Z.value&&clearInterval(Z.value);const a=()=>{if(--e<=0)return clearInterval(Z.value),P.value="获取验证码",void(X.code=!1);P.value="重新获取验证码(".concat(e,"s)")};a(),Z.value=setInterval(a,1e3),X.code=!0})(60);const e=await l({username:S.username,token:Y.value});H.request(e)},te=()=>{ee.value.clearValidate(),R()};return p({onOpen:()=>{r(ee.value.$el,"username")},onCancel:te}),w(()=>{var e;null==(e=ee.value)||e.clearValidate(),F()}),b(()=>{Z.value&&(clearInterval(Z.value),Z.value=null),R()}),(e,l)=>{var r;const d=m,p=s,v=t,f=o,w=i,b=u,U=n,B=g("focus");return h(),_(U,{ref_key:"bindUserRef",ref:ee,size:"default",rules:z(le),model:z(S),class:j({"bind-form":!!(null==(r=c.compData)?void 0:r.title),"bind-user-info":!0})},{default:y(()=>{var e,r;return[x(p,{class:"!mb-5 flex !justify-center"},{default:y(()=>{var e;return[k("div",G,[k("h3",M,D((null==(e=c.compData)?void 0:e.title)||"切换宝塔官网账号"),1),x(d,{placement:"top-start",width:"200",trigger:"hover",content:"宝塔面板许多功能都依赖于官网，绑定仅限于为您提供更好的面板服务体验，不涉及您服务器任何敏感信息，请放心使用。",class:"inline-block relative -top-1.5"},{reference:y(()=>[...l[9]||(l[9]=[k("a",{class:"bt-ico-ask align-middle inline-block",href:"javascript:;"}," ? ",-1)])]),_:1})])]}),_:1}),(h(),_(p,{key:1,prop:"username",class:j({"!mb-[3rem]":!!(null==(e=c.compData)?void 0:e.title)})},{default:y(()=>{var e;return[V(x(v,{modelValue:z(S).username,"onUpdate:modelValue":l[0]||(l[0]=e=>z(S).username=e),clearable:"",required:"",name:"username",placeholder:"宝塔官网账号",class:"h-[4rem] leading-[4rem] w-full",disabled:z(X).username,onKeyup:l[1]||(l[1]=C(e=>re(),["enter"]))},null,8,["modelValue","disabled"]),[[B]]),(null==(e=c.compData)?void 0:e.title)&&z(ae)?(h(),I("span",O,[l[11]||(l[11]=k("span",null,"请使用宝塔官网登录账号进行登录，若未有账号，可进行",-1)),x(f,{class:"!text-small",href:"https://www.bt.cn/register"},{default:y(()=>[...l[10]||(l[10]=[q(" 免费注册 ",-1)])]),_:1})])):E("",!0)]}),_:1},8,["class"])),(h(),_(p,{key:2,prop:"password"},{default:y(()=>[x(v,{modelValue:z(S).password,"onUpdate:modelValue":l[2]||(l[2]=e=>z(S).password=e),clearable:"",required:"",type:"password",name:"password",placeholder:"密码",class:"h-[4rem] leading-[4rem] w-full","show-password":!0,disabled:z(X).password,onKeyup:l[3]||(l[3]=C(e=>re(),["enter"]))},null,8,["modelValue","disabled"])]),_:1})),V(x(p,{prop:"code"},{default:y(()=>[x(v,{modelValue:z(S).code,"onUpdate:modelValue":l[4]||(l[4]=e=>z(S).code=e),clearable:"",placeholder:"验证码",type:"text",onKeyup:l[5]||(l[5]=C(e=>re(),["enter"]))},{append:y(()=>[x(w,{class:"relative top-0 rounded-none rounded-r-small w-full !h-[auto]",size:"large",type:"primary",disabled:z(X).code,plain:"",onClick:se},{default:y(()=>[q(D(z(P)),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1},512),[[L,z(T)]]),x(w,{type:"primary",class:"w-[100%] mt-[1.2rem]",size:"large",onClick:l[6]||(l[6]=e=>re())},{default:y(()=>{var e,a;return[q(D((null==(e=c.compData)?void 0:e.btn)||((null==(a=c.compData)?void 0:a.title)?"绑定账号":"切换账号")),1)]}),_:1}),k("div",W,[(null==(r=c.compData)?void 0:r.isDialog)?E("",!0):(h(),I(K,{key:0},[x(f,{onClick:l[7]||(l[7]=e=>(a.push("/"),void te()))},{default:y(()=>[...l[12]||(l[12]=[q("暂不绑定",-1)])]),_:1}),x(b)],64)),x(f,{href:"https://www.bt.cn/register"},{default:y(()=>[...l[13]||(l[13]=[q("注册账号",-1)])]),_:1}),x(b),x(f,{href:"https://www.bt.cn/login.html?page=reset"},{default:y(()=>[...l[14]||(l[14]=[q("忘记密码",-1)])]),_:1}),x(b),x(f,{href:"https://www.bt.cn/bbs"},{default:y(()=>[...l[15]||(l[15]=[q("问题反馈",-1)])]),_:1})]),l[17]||(l[17]=k("div",{class:"divider-container"},[k("div",{class:"divider-line"}),k("div",{class:"divider-text"},"第三方登录"),k("div",{class:"divider-line"})],-1)),k("div",$,[k("div",{class:"wechat-login-container",onClick:l[8]||(l[8]=(...e)=>z(Q)&&z(Q)(...e))},[...l[16]||(l[16]=[k("div",{class:"wechat-icon-circle"},[k("i",{class:"wechat-icon"},[k("svg",{t:"1749545795651",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"9096",width:"20",height:"20"},[k("path",{d:"M391.95 175.27c-159.03 0-289.29 108.4-289.29 246.04 0 79.45 43.35 144.67 115.74 195.2l-28.93 87.05 101.12-50.74c36.19 7.19 65.22 14.54 101.33 14.54 9.08 0 18.09-0.45 27.01-1.16-5.64-19.37-8.92-39.61-8.92-60.62 0-126.32 108.54-228.89 245.97-228.89 9.37 0 18.64 0.69 27.86 1.71C658.8 261.87 534.2 175.27 391.95 175.27z m-93.97 195.31c-21.67 0-43.56-14.52-43.56-36.21 0-21.77 21.89-36.09 43.56-36.09s36.12 14.33 36.12 36.09c-0.02 21.69-14.45 36.21-36.12 36.21z m202.46 0c-21.69 0-43.45-14.52-43.45-36.21 0-21.77 21.76-36.09 43.45-36.09 21.79 0 36.21 14.33 36.21 36.09 0 21.69-14.43 36.21-36.21 36.21z m0 0",fill:"var(--el-color-primary)","p-id":"9097"}),k("path",{d:"M920.01 602.12c0-115.59-115.74-209.86-245.72-209.86-137.64 0-246.05 94.27-246.05 209.86 0 115.84 108.41 209.92 246.05 209.92 28.81 0 57.85-7.25 86.79-14.51l79.36 43.44-21.76-72.3c58.06-43.53 101.33-101.3 101.33-166.55z m-325.5-36.14c-14.41 0-28.95-14.31-28.95-28.92 0-14.44 14.54-28.96 28.95-28.96 21.89 0 36.21 14.52 36.21 28.96 0 14.61-14.33 28.92-36.21 28.92z m159.13 0c-14.31 0-28.74-14.31-28.74-28.92 0-14.44 14.43-28.96 28.74-28.96 21.67 0 36.21 14.52 36.21 28.96 0 14.61-14.54 28.92-36.21 28.92z m0 0",fill:"var(--el-color-primary)","p-id":"9098"})])])],-1)])])])]}),_:1},8,["rules","model","class"])}}}),[["__scopeId","data-v-b1121c13"]]);export{A as default};
