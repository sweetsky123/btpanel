import{c as e,s as a,o as s,r as t,v as r,x as l,y as o,e as m,C as i,z as n,F as d,b1 as u,O as p,A as c,B as f,S as v,am as b,an as N,ad as _,ab as h}from"./base-lib.js?v=1763689792";import{verifyTrustAsiaCret as y}from"./site.js?v=1763689792";import{b as I}from"./utils-lib.js?v=1763689792";import{u as O}from"./useStore11.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";const j={class:"p-[16px]"},w={style:{float:"left"}},D=e({__name:"index",props:{compData:{type:Object,default:()=>{}}},setup(e,{expose:D}){const{activeTabs:x,sslIsRefresh:C,testIsRefresh:g,encryptIsRefresh:R,otherIsRefresh:S}=a(O()),z=I(),V=e,A=s({siteName:"",partnerOrderId:""}),E=t([]),T=()=>{A.siteName="",A.partnerOrderId=""};return r(()=>{(async()=>{var e;E.value=V.compData.row.domainName,A.partnerOrderId=V.compData.row.partnerOrderId,(null==(e=V.compData.row.domainName)?void 0:e.length)&&(A.siteName=V.compData.row.domainName[0])})()}),D({onConfirm:async e=>{var a;if(!A.siteName)return void z.error("请选择验证域名");let s;try{s=z.load("正在验证证书申请状态，请稍后...");const{data:t,msg:r,status:l}=await y({partnerOrderId:A.partnerOrderId,siteName:A.siteName});if(z.request({status:l,msg:r}),l)if(T(),e(),"COMPLETED"===t.stateCode){z.success("验证成功");const e={ssl:()=>C.value=!0,test:()=>g.value=!0,encrypt:()=>R.value=!0,other:()=>S.value=!0};null==(a=e[x.value])||a.call(e)}else z.success("等待CA验证中，若长时间未能成功验证，请登录官网使用DNS方式重新申请...")}catch(t){}finally{s&&s.close()}}}),(e,a)=>{const s=b,t=N,r=_,y=h;return l(),o("div",j,[m(y,{model:n(A),class:"relative w-full","label-position":"right",size:"small",onSubmit:a[1]||(a[1]=v(()=>{},["prevent"]))},{default:i(()=>[m(r,{label:"验证域名",prop:"dns_name"},{default:i(()=>[m(t,{modelValue:n(A).siteName,"onUpdate:modelValue":a[0]||(a[0]=e=>n(A).siteName=e),class:"!w-[33rem]",filterable:"","default-first-option":"",size:"default",placeholder:"请选择验证域名"},{default:i(()=>[(l(!0),o(d,null,u(n(E),e=>(l(),p(s,{key:e,label:e,value:e},{default:i(()=>[c("span",w,f(e),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])])}}});export{D as default};
