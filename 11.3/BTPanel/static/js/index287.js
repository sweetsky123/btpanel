import{c as e,o as a,g as l,r as o,v as d,x as s,y as r,e as n,C as t,A as i,z as m,D as _,B as p,F as c,b1 as u,S as f,U as v,am as y,an as A,ad as b,ab as h}from"./base-lib.js?v=1763689792";import{F as w}from"./ssl.js?v=1763689792";import{b as k}from"./utils-lib.js?v=1763689792";import{g as T}from"./useStore5.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";const V={class:"p-[16px]"},g={class:"flex items-center"},j=e({__name:"index",props:{compData:{type:Object,default:()=>{}}},emits:["close"],setup(e,{expose:j,emit:C}){const x=k(),{refs:{isRefreshDomainList:D}}=T(),E=e,U=C,z=a({domain_name:"",domain_dns_value:"",dns_id:"",record_type:"A",domain:""}),S=[{title:"A",key:"A",placeholderTip:"将域名指向IPv4地址"},{title:"TXT",key:"TXT",placeholderTip:"设置文本记录"},{title:"CNAME",key:"CNAME",placeholderTip:"将域名指向另外一个域名"},{title:"CAA",key:"CAA",placeholderTip:"CA证书颁发机构授权校验"},{title:"AAAA",key:"AAAA",placeholderTip:"用来指定主机名（或域名）对应的IPv6地址（例如：ff06:0:0:0:0:0:0:c3）记录。"}],F=l(()=>{var e;return null==(e=S.find(e=>e.key===z.record_type))?void 0:e.placeholderTip}),I=o(null),M={domain_name:[{validator:(e,a,l)=>{a?l():l(new Error("请填写域名前缀"))},trigger:"blur"}],domain_dns_value:[{validator:(e,a,l)=>{a?l():l(new Error("请输入记录值"))},trigger:"blur"}]};return d(()=>{E.compData.row.dns_id&&(z.dns_id=E.compData.row.dns_id,z.domain=".".concat(E.compData.row.domain))}),j({onConfirm:async()=>{try{await I.value.validate();const e=x.load("正在解析域名，请稍候..."),a=await w({dns_id:z.dns_id,domain_name:"".concat(z.domain_name).concat(z.domain),domain_dns_value:z.domain_dns_value,record_type:z.record_type,fun_name:"create_dns_record"});x.request(a),e&&e.close(),a.status&&(D.value=!0,z.domain_name="",z.domain_dns_value="",z.dns_id="",z.record_type="A",z.domain="",U("close"))}catch(e){}}}),(e,a)=>{const l=v,o=y,d=A,w=b,k=h;return s(),r("div",V,[n(k,{ref_key:"formRef",ref:I,size:"small",rules:M,model:m(z),class:"relative w-full","label-position":"right",onSubmit:a[3]||(a[3]=f(()=>{},["prevent"]))},{default:t(()=>[n(w,{label:"主机记录",prop:"domain_name"},{default:t(()=>[i("div",g,[n(l,{modelValue:m(z).domain_name,"onUpdate:modelValue":a[0]||(a[0]=e=>m(z).domain_name=e),class:"!w-[34rem]",placeholder:"请填写域名前缀，支持多级，如：ab.cd.ef"},{append:t(()=>[_(p(m(z).domain),1)]),_:1},8,["modelValue"]),n(d,{size:"small",modelValue:m(z).record_type,"onUpdate:modelValue":a[1]||(a[1]=e=>m(z).record_type=e),class:"!w-[8rem] ml-[1rem]",placeholder:"请选择"},{default:t(()=>[(s(),r(c,null,u(S,e=>n(o,{key:e.key,label:e.title,value:e.key},null,8,["label","value"])),64))]),_:1},8,["modelValue"])])]),_:1}),n(w,{label:"记录值",prop:"domain_dns_value"},{default:t(()=>[n(l,{modelValue:m(z).domain_dns_value,"onUpdate:modelValue":a[2]||(a[2]=e=>m(z).domain_dns_value=e),class:"!w-[43rem]",placeholder:m(F)},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["model"])])}}});export{j as default};
