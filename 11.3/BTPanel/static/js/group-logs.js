import{aC as a,b as l}from"./utils-lib.js?v=1763689792";import{c as e,aB as n,r as t,g as s,w as u,v as r,x as i,y as o,A as d,e as m,C as v,D as c,B as p,z as g,J as _,K as f,F as b,b1 as j,R as x,bP as y,bO as h,H as C,O as w,aD as k}from"./base-lib.js?v=1763689792";import{_ as D}from"./index123.js?v=1763689792";import{getProjectLogs as H}from"./site.js?v=1763689792";import{j as O}from"./group-detail.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index109.js?v=1763689792";import"./column.js?v=1763689792";import"./index110.js?v=1763689792";const S={class:"p-[2rem]"},V={class:"text-medium text-secondary mb-[2rem] mt-[1.6rem] font-bold flex justify-between"},B={class:"mt-[2rem]"},J=e({__name:"group-logs",props:{compData:{default:{}}},setup(e){const J=l(),R=n("popupClose",()=>{}),z=t(""),A=s(()=>{var a;return(null==(a=O.value.running_step)?void 0:a.names)||[]}),F=t(!1),K=t(""),N=s(()=>!A.value.length);let P=s(()=>!O.value.running);u(()=>O.value.running_step,a=>{a&&(z.value=A.value[0],U(z.value))},{immediate:!0}),u(P,a=>{a&&(J.success("项目组已经执行完毕"),R())});const T=s(()=>{var a,l;return(null==(a=O.value.running_step)?void 0:a.msg)||(null==(l=O.value.running_data)?void 0:l.msg)||O.value.msg||"--"}),U=async a=>{F.value=!0;try{const l=await H({data:JSON.stringify({project_name:a})},"java");l.status?K.value=l.data.data:J.error(l.msg)}catch(l){}finally{F.value=!1}};return r(()=>{}),(l,e)=>{const n=y,t=h,s=C,u=D,r=k,H=a;return i(),o("div",S,[d("div",null,[m(t,{title:"项目组信息",border:"",column:3,class:"table-descriptions"},{default:v(()=>[m(n,{label:"总项目数"},{default:v(()=>{var a,l,e,n;return[c(p((null==(l=null==(a=g(O))?void 0:a.running_data)?void 0:l.length)>-1?null==(n=null==(e=g(O))?void 0:e.running_data)?void 0:n.length:"--"),1)]}),_:1}),m(n,{label:"未执行的项目数"},{default:v(()=>{var a,l,e,n;return[c(p((null==(l=null==(a=g(O))?void 0:a.running_data)?void 0:l.remaining)>-1?null==(n=null==(e=g(O))?void 0:e.running_data)?void 0:n.remaining:"--"),1)]}),_:1}),m(n,{label:"正在执行中的项目数"},{default:v(()=>{var a,l,e,n;return[c(p((null==(l=null==(a=g(O))?void 0:a.running_data)?void 0:l.executing)>-1?null==(n=null==(e=g(O))?void 0:e.running_data)?void 0:n.executing:"--"),1)]}),_:1}),m(n,{label:"当前执行步骤"},{default:v(()=>[c(p(g(T)),1)]),_:1})]),_:1})]),d("div",V,[e[4]||(e[4]=c(" 项目日志 ",-1)),_(m(s,{type:"default",onClick:e[0]||(e[0]=a=>U(g(z)))},{default:v(()=>[...e[3]||(e[3]=[c("刷新",-1)])]),_:1},512),[[f,!g(P)&&!g(N)]])]),_(m(H,{class:"h-[30rem]",type:"card",modelValue:g(z),"onUpdate:modelValue":e[1]||(e[1]=a=>x(z)?z.value=a:null),onTabClick:e[2]||(e[2]=a=>U(g(z)))},{default:v(()=>[(i(!0),o(b,null,j(g(A),a=>(i(),w(r,{key:a,label:a,name:a},{default:v(()=>[m(u,{content:g(K),isHtml:!0,class:"mt-16x",fullScreen:{title:"全屏查看【项目】日志",onRefresh:()=>U(g(z))},style:{height:"48rem",width:"99.5%"}},null,8,["content","fullScreen"])]),_:1},8,["label","name"]))),128))]),_:1},8,["modelValue"]),[[f,!g(N)]]),_(d("span",B,"暂无日志",512),[[f,g(N)]])])}}});export{J as default};
