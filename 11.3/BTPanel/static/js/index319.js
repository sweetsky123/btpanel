import{u as a,Q as e,M as s,n as t,H as o,l,$ as n}from"./utils-lib.js?v=1763689792";import{_ as r}from"./index109.js?v=1763689792";import{u as i}from"./column.js?v=1763689792";import{c as p,aB as m,R as d,r as u,e as c,aE as _,ap as g,w as f,I as w,x as b,y as x,C as y,J as j,z as h}from"./base-lib.js?v=1763689792";import{a3 as q,a4 as v,a1 as C}from"./firewall.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";const I=p({__name:"index",setup(p){a();const I=m("infoData"),z=m("getIntrusionInfo",()=>{}),D=d(!1),E=u(),O=[{content:"开启防提权，系统会针对该用户操作命令进行限制，并记录跟踪"},{content:"不开启防提权，系统只针对该用户操作过的命令做记录跟踪"},{content:"目前防提权默认只针对www,redis,mysql操作引起的提权问题进行处理"},{class:"text-warning",content:"消息推送需要更新至最新面板的版本(2020-06-17日之后安装的版本|或者2020-06-17日之后点击过修复面板)"}],T=[{label:"用户",prop:"0"},{label:"总次数",prop:"4",render:a=>c("span",{class:a[4].totla>0?"!text-danger":""},[a[4].totla])},{label:"当日次数",prop:"4",render:a=>c("span",{class:a[4].day_totla>0?"!text-danger":""},[a[4].day_totla])},{label:"防入侵",prop:"3",render:a=>_(g,{modelValue:a[3],size:"small",onChange:s=>(async(a,s)=>{await e({loading:"正在"+(s?"开启":"关闭")+"防入侵，请稍后...",request:q(!a[3],{user:a[0]}),message:!0}),z()})(a,s)})},{label:"日志状态",prop:"5",render:(a,s)=>_(g,{modelValue:a[5],size:"small",onChange:s=>(async(a,s,t)=>{await e({loading:"正在"+(t?"开启":"关闭")+"日志状态，请稍后...",request:v(!a[5],{uid:a[1]}),message:!0}),z()})(a,0,s)})},{label:"描述",prop:"6",showOverflowTooltip:!0},i([{onClick:async a=>{const l=await e({loading:"正在获取日志，请稍后...",request:C({user:a[0]}),data:Array});if(!l.length)return s.error("当前暂无日志");t({title:"命令日志",area:72,component:()=>o(()=>import("./index487.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:{user:a[0],dateTime:l[0],dateOptions:l.map(a=>({title:a,key:a}))}})},title:"命令日志",width:70}])];return f(()=>I.value,a=>{a&&(E.value=a.system_user)},{immediate:!0,deep:!0}),(a,e)=>{const s=l,t=r,o=n,i=w("bt-loading");return b(),x("div",null,[c(t,null,{content:y(()=>[j(c(s,{ref:"table",column:T,data:h(E),description:"概览列表为空"},null,8,["data"]),[[i,h(D)],[i,"正在加载概览列表，请稍后...","title"]])]),popup:y(()=>[...e[0]||(e[0]=[])]),_:1}),c(o,{options:O,class:"mx-[1.6rem]"})])}}});export{I as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
