!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){u(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function u(t,r,n){return(r=function(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,r||"default");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}System.register(["./base-lib-legacy.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./site-legacy.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792"],function(e,r){"use strict";var n,u,l,a,i,c,s,m,f,d,p,y,b,h,w,v,g,_,k,V,j,x,O,D,S;return{setters:[function(e){n=e.c,u=e.r,l=e.o,a=e.v,i=e.x,c=e.O,s=e.C,m=e.e,f=e.z,d=e.A,p=e.y,y=e.b1,b=e.F,h=e.G,w=e.D,v=e.ad,g=e.am,_=e.an,k=e.V,V=e.aA,j=e.ab},function(e){x=e.Q,O=e.k},function(e){D=e.modifyCrontab,S=e.addCrontab},null],execute:function(){var r={class:"flex items-center"},P={class:"flex items-center"};e("default",n({__name:"add-crontab",props:{compData:{default:{}}},setup:function(e,n){var H=n.expose,M=e,A=u(!!M.compData.row),U=u(),B=u(!1),q=l({cron_name:"",type:"week",week:"1",where1:"3",hour:"1",minute:"30",flock:!1,sBody:""}),C=l({cron_name:[{required:!0,message:"请输入计划任务名称",trigger:"blur"}],hour:[{required:!0,message:"请输入执行时间",trigger:"blur"}],minute:[{required:!0,message:"请输入执行时间",trigger:"blur"}],sBody:[{required:!0,message:"请输入脚本内容",trigger:"blur"}]}),E=u(5),I=u([{type:"day",text:"每天",showDay:!1,showHour:!0,showMinute:!0},{type:"day-n",text:"N天",showDay:!0,showHour:!0,showMinute:!0},{type:"hour",text:"每小时",showDay:!1,showHour:!1,showMinute:!0},{type:"hour-n",text:"N小时",showDay:!1,showHour:!0,showMinute:!0},{type:"minute-n",text:"N分钟",showDay:!1,showHour:!1,showMinute:!0},{type:"week",text:"每周",showDay:!1,showHour:!0,showMinute:!0},{type:"month",text:"每月",showDay:!0,showHour:!0,showMinute:!0}]),N=function(e){q.type=e,E.value=I.value.findIndex(function(t){return t.type===e}),"minute-n"===q.type&&(q.where1=q.minute),"hour-n"===q.type&&(q.where1=q.hour),U.value&&U.value.clearValidate()};return a(function(){A.value=!!M.compData.row;var e=M.compData.row,t=e.type,r=e.where1,n=e.where_hour,o=e.where_minute,u=e.flock,l=e.sBody,a=e.rname,i=e.name;Object.assign(q,{cron_name:a||i||"",type:t||"week",week:"week"===t?r:"1",where1:r||"3",hour:n||"1",minute:o||"30",flock:!!u,sBody:l||""}),N(q.type)}),H({onConfirm:function(e){U.value.validate(function(t){if(t){B.value=!0;var r=o(o({sitename:M.compData.sitename},q),{},{flock:q.flock?1:0});A.value&&(r.id=M.compData.row.id);var n=A.value?D:S;x({loading:"正在".concat(A.value?"修改":"添加","计划任务，请稍候..."),request:n(r),message:!0,success:function(t){B.value=!1,t.status&&(e(),M.compData.refreshEvent())}})}})}}),function(e,n){var o=O,u=v,l=g,a=_,x=k,D=V,S=j;return i(),c(S,{ref_key:"crontabFormRef",ref:U,model:f(q),rules:f(C),disabled:f(B),"label-width":"80px",class:"p-2rem"},{default:s(function(){return[m(u,{label:"任务名称",prop:"cron_name"},{default:s(function(){return[m(o,{modelValue:f(q).cron_name,"onUpdate:modelValue":n[0]||(n[0]=function(e){return f(q).cron_name=e}),placeholder:"请输入计划任务名称",width:"36rem"},null,8,["modelValue"])]}),_:1}),m(u,{label:"执行周期"},{default:s(function(){var e,v,g;return[d("div",r,[m(a,{onChange:n[1]||(n[1]=function(e){return N(f(q).type,!0)}),class:"!w-[8rem] mr-1rem",modelValue:f(q).type,"onUpdate:modelValue":n[2]||(n[2]=function(e){return f(q).type=e})},{default:s(function(){return[(i(!0),p(b,null,y(f(I),function(e,t){return i(),c(l,{key:t,label:e.text,value:e.type},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"]),"week"==f(q).type?(i(),c(u,{key:0,class:"el-form-item-item mr-1rem"},{default:s(function(){return[m(a,{class:"!w-[8rem]",modelValue:f(q).week,"onUpdate:modelValue":n[3]||(n[3]=function(e){return f(q).week=e})},{default:s(function(){return[m(l,{label:"周一",value:"1"}),m(l,{label:"周二",value:"2"}),m(l,{label:"周三",value:"3"}),m(l,{label:"周四",value:"4"}),m(l,{label:"周五",value:"5"}),m(l,{label:"周六",value:"6"}),m(l,{label:"周日",value:"7"})]}),_:1},8,["modelValue"])]}),_:1})):h("",!0),null!==(e=f(I)[f(E)])&&void 0!==e&&e.showDay?(i(),c(u,{key:1,class:"el-form-item-item mr-1rem",prop:"where1"},{default:s(function(){return[m(o,{modelValue:f(q).where1,"onUpdate:modelValue":n[4]||(n[4]=function(e){return f(q).where1=e}),min:1,width:"12rem",type:"number"},{append:s(function(){return t(n[9]||(n[9]=[w("天",-1)]))}),_:1},8,["modelValue"])]}),_:1})):h("",!0),null!==(v=f(I)[f(E)])&&void 0!==v&&v.showHour?(i(),c(u,{key:2,class:"el-form-item-item mr-1rem",prop:"hour"},{default:s(function(){var e;return[null!==(e=f(I)[f(E)])&&void 0!==e&&e.showHour?(i(),c(o,{key:0,modelValue:f(q).hour,"onUpdate:modelValue":n[5]||(n[5]=function(e){return f(q).hour=e}),width:"12rem",max:"23",min:"0",type:"number"},{append:s(function(){return t(n[10]||(n[10]=[w("小时",-1)]))}),_:1},8,["modelValue"])):h("",!0)]}),_:1})):h("",!0),null!==(g=f(I)[f(E)])&&void 0!==g&&g.showMinute?(i(),c(u,{key:3,class:"el-form-item-item",prop:"minute"},{default:s(function(){var e;return[null!==(e=f(I)[f(E)])&&void 0!==e&&e.showMinute?(i(),c(o,{key:0,modelValue:f(q).minute,"onUpdate:modelValue":n[6]||(n[6]=function(e){return f(q).minute=e}),width:"12rem",max:"59",min:"0",type:"number"},{append:s(function(){return t(n[11]||(n[11]=[w("分钟",-1)]))}),_:1},8,["modelValue"])):h("",!0)]}),_:1})):h("",!0)])]}),_:1}),m(u,{label:" ","label-width":"0rem"},{default:s(function(){return[d("div",P,[m(x,{modelValue:f(q).flock,"onUpdate:modelValue":n[7]||(n[7]=function(e){return f(q).flock=e}),disabled:f(A)},{default:s(function(){return t(n[12]||(n[12]=[w("开启进程锁",-1)]))}),_:1},8,["modelValue","disabled"]),m(D,{placement:"right-start",width:"440","popper-class":"white-tips-popover",trigger:"hover",content:""},{reference:s(function(){return t(n[13]||(n[13]=[d("i",{class:"svgtofont-el-question-filled text-warning ml-[12px]"},null,-1)]))}),default:s(function(){return[n[14]||(n[14]=d("div",{class:"p-[12px]"},[d("span",{class:"text-secondary"},"在同一时间内只用一个进程在执行，若上一个进程未执行结束，下一次不执行")],-1))]}),_:1})])]}),_:1}),m(u,{label:"脚本内容",prop:"sBody"},{default:s(function(){return[m(o,{width:"58rem",placeholder:"请输入脚本内容",type:"textarea",modelValue:f(q).sBody,"onUpdate:modelValue":n[8]||(n[8]=function(e){return f(q).sBody=e}),resize:"both",rows:10},null,8,["modelValue"])]}),_:1})]}),_:1},8,["model","rules","disabled"])}}}))}}})}();
