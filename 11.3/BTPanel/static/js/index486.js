import{j as e,b as a,_ as l}from"./utils-lib.js?v=1763689792";import{c as s,r as d,aB as n,W as t,g as r,w as u,x as o,O as i,C as m,A as p,e as v,z as f,y as c,b1 as _,F as b,G as h,S as g,R as w,an as V,ad as y,U as S,ab as C,am as U}from"./base-lib.js?v=1763689792";import{C as k,D}from"./ssl.js?v=1763689792";const N={class:"py-[16px]"},j=l(s({__name:"index",props:{title:{type:String,default:"添加NDS验证"}},setup(l){const s=a(),j=d({dns_name:"",ps:""}),x=d(null),R=n("isShowForm",t(!1)),q=n("formParams",t([])),z=n("isRefreshDNSList",t(!1)),L=n("formRow",t({})),O=d([]),F=r(()=>!!L.value.id),J=e=>{var a;O.value=(null==(a=q.value.find(a=>a.id.toLowerCase()===e.toLowerCase()))?void 0:a.params)||[],A()},P=d({dns_name:[{required:!0,message:"请选择验证类型",trigger:"change"}]}),A=()=>{O.value.forEach(e=>{P.value[e]=[{required:!0,message:"请输入".concat(e),trigger:"blur"}]})},B=()=>{j.value={dns_name:"",ps:""},L.value={dns_name:"DNSPodDns"}},E=async()=>{const e=x.value;if(!(await e.validate().catch(()=>!1)))return!1;try{let e,a={...j.value};if(j.value.id){e=await k({dns_id:a.id,ps:a.ps||"",pdata:JSON.stringify(a)})}else{e=await D({dns_name:a.dns_name,ps:a.ps||"",pdata:JSON.stringify(a)})}s.request(e),R.value=!1,z.value=!0,B()}catch(a){return s.error(a),!1}},G=async()=>{B()};return u(q,e=>{e.length&&(j.value.dns_name=e[0].id,J(e[0].id))}),u(L,e=>{j.value={...e},e.dns_name&&J(e.dns_name)},{immediate:!0}),u(R,e=>{e&&(L.value.dns_name?(j.value={...L.value},J(L.value.dns_name)):(j.value={dns_name:"",ps:""},q.value.length>0&&(j.value.dns_name=q.value[0].id,J(q.value[0].id))))}),(a,s)=>{const d=U,n=V,t=y,r=S,u=C,k=e;return o(),i(k,{title:l.title,modelValue:f(R),"onUpdate:modelValue":s[3]||(s[3]=e=>w(R)?R.value=e:null),area:["50rem"],"show-footer":"",onCancel:G,onConfirm:E},{default:m(()=>[p("div",N,[v(u,{ref_key:"dnsformRef",ref:x,size:"small",model:f(j),rules:f(P),class:"relative w-full","label-position":"right",onSubmit:s[2]||(s[2]=g(()=>{},["prevent"]))},{default:m(()=>[v(t,{label:"验证类型",prop:"dns_name","label-width":"100"},{default:m(()=>[v(n,{modelValue:f(j).dns_name,"onUpdate:modelValue":s[0]||(s[0]=e=>f(j).dns_name=e),class:"!w-[33rem]",size:"default",filterable:"","default-first-option":"",placeholder:"请选择验证类型",disabled:f(F),onChange:J},{default:m(()=>[(o(!0),c(b,null,_(f(q),e=>(o(),i(d,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),f(O).length?(o(!0),c(b,{key:0},_(f(O),(e,a)=>(o(),i(t,{key:a,label:e,prop:e,"label-width":"100"},{default:m(()=>[v(r,{modelValue:f(j)[e],"onUpdate:modelValue":a=>f(j)[e]=a,class:"!w-[33rem]",placeholder:"请输入".concat(e)},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"]))),128)):h("",!0),v(t,{prop:"ps",label:"备注","label-width":"100"},{default:m(()=>[v(r,{modelValue:f(j).ps,"onUpdate:modelValue":s[1]||(s[1]=e=>f(j).ps=e),placeholder:"请输入备注",clearable:"",class:"remark-input !w-[33rem]"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["title","modelValue"])}}}),[["__scopeId","data-v-98ba7463"]]);export{j as a};
