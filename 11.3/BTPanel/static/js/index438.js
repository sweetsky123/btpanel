import{b as e}from"./validator.js?v=1763689792";import"./utils-lib.js?v=1763689792";import{c as t,r as l,g as a,v as o,a8 as r,x as s,y as n,A as i,B as c,L as u,D as d,F as p,b1 as x,M as v}from"./base-lib.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index107.js?v=1763689792";const m={class:"relative bg-[var(--el-bg-color)] rounded-medium overflow-hidden shadow-2xl transform transition-all duration-500 scale-100"},b={class:"py-[40px] px-[20px]"},f={class:"flex flex-col items-center mb-[24px]"},g={class:"flex items-end"},h={class:"text-[var(--bt-pro-color)] text-large50 font-bold -mb-[12px]"},w={class:"bg-light rounded-large p-[12px] mb-[20px]"},y={class:"flex justify-center space-x-[8px] items-center"},j=["disabled"],S="bt-coupon-countdown",I="bt-coupon-open-time",M=t({__name:"index",emits:["close"],setup(t,{emit:M}){const k=l(600),_=l(99),D=l(!1),z=l(!1),C=l([]),L=l("200～400"),T=M;let A=null;const B=()=>{const e={totalSeconds:k.value,milliseconds:_.value,timestamp:Date.now()};localStorage.setItem(S,JSON.stringify(e))},F=()=>{localStorage.removeItem(S),localStorage.removeItem(I)},H=()=>{const e=localStorage.getItem(I),t=Date.now();if(e)try{const l=parseInt(e,10),a=l+6e5-t;return a>0?(k.value=Math.floor(a/1e3),void(_.value=Math.floor(a%1e3/10))):(F(),void T("close"))}catch(l){F()}k.value=600,_.value=99,localStorage.setItem(I,Date.now().toString())},J=a(()=>Math.floor(k.value/60).toString().padStart(2,"0")),N=a(()=>(k.value%60).toString().padStart(2,"0")),O=a(()=>_.value.toString().padStart(2,"0")),q=a(()=>k.value<=0&&_.value<=0),E=()=>{q.value||(G(),F(),T("close"),e("绑定宝塔账号，享受更多服务","/?model=bind-cupon"))},G=()=>{z.value=!0,C.value=[];for(let e=0;e<50;e++)setTimeout(()=>{const t={id:Date.now()+e,x:100*Math.random(),y:100*Math.random(),size:8*Math.random()+4,color:K()};C.value.push(t),setTimeout(()=>{const e=C.value.findIndex(e=>e.id===t.id);e>-1&&C.value.splice(e,1)},1e3)},50*e);setTimeout(()=>{z.value=!1,C.value=[]},3e3)},K=()=>{const e=["var(--bt-pro-color)","var(--bt-pro-light-color)","var(--bt-pro-sub-color)","var(--bt-pro-light-bg-color)","var(--bt-pro-color)"];return e[Math.floor(Math.random()*e.length)]};return o(()=>{H(),A=setInterval(()=>{if(_.value-=1,_.value<0&&(_.value=99,k.value--),k.value<=0&&_.value<=0)return A&&(clearInterval(A),A=null),F(),void T("close");B()},10)}),r(()=>{A&&clearInterval(A),B()}),(e,t)=>(s(),n("div",null,[i("div",{ref:"couponModal",class:u(["w-full relative overflow-hidden rounded-medium",{"scale-95 opacity-0":D.value}])},[i("div",m,[i("div",b,[t[7]||(t[7]=i("div",{class:"flex items-center justify-center mb-[16px]"},[i("i",{class:"fa fa-ticket text-[var(--bt-pro-color)] text-subtitleLarge mr-[8px]"}),i("h2",{class:"text-[clamp(1.2rem,2.5vw,1.8rem)] font-bold text-default text-shadow"},"绑定账号领取限时优惠券")],-1)),i("div",f,[t[2]||(t[2]=i("p",{class:"text-gray-500 text-small mb-[4px]"},"领取随机金额优惠券",-1)),i("div",g,[t[0]||(t[0]=i("span",{class:"text-[var(--bt-pro-color)] text-subtitleLarge font-bold mr-[4px]"},"¥",-1)),i("span",h,c(L.value),1),t[1]||(t[1]=i("span",{class:"text-[var(--bt-pro-color)] text-medium font-bold ml-[4px] mb-[4px]"},"元",-1))]),t[3]||(t[3]=i("p",{class:"text-gray-500 text-small mt-[8px]"},"满1399元可用",-1))]),i("div",w,[t[6]||(t[6]=i("p",{class:"text-center text-gray-600 text-base mb-[8px]"},"优惠券将在以下时间后过期",-1)),i("div",y,[i("div",{class:u(["text-white rounded-large w-[56px] h-[40px] flex items-center justify-center font-bold text-medium",k.value<10?"bg-red-500":"bg-warning"])},[i("span",null,c(J.value),1)],2),t[4]||(t[4]=i("span",{class:"text-[var(--bt-pro-color)] font-bold"},":",-1)),i("div",{class:u(["text-white rounded-large w-[56px] h-[40px] flex items-center justify-center font-bold text-medium",k.value<10?"bg-red-500":"bg-warning"])},[i("span",null,c(N.value),1)],2),t[5]||(t[5]=i("span",{class:"text-[var(--bt-pro-color)] font-bold"},":",-1)),i("div",{class:u(["text-white rounded-large w-[56px] h-[40px] flex items-center justify-center font-bold text-medium",k.value<10?"bg-red-500":"bg-warning"])},[i("span",null,c(O.value),1)],2)])]),t[8]||(t[8]=i("div",{class:"mb-5"},[i("h3",{class:"text-gray-700 font-semibold text-base mb-[8px] flex items-center"},[i("i",{class:"fa fa-info-circle text-[var(--bt-pro-color)] mr-2"}),d(" 使用规则 ")]),i("ul",{class:"text-gray-600 text-small space-y-1 pl-[20px] list-disc"},[i("li",null,"用户绑定账号专属优惠"),i("li",null,"有效期10分钟")])],-1)),i("button",{disabled:q.value,class:u(["w-full py-[10px] rounded-large font-bold text-medium shadow-lg transform transition-all duration-300 flex items-center justify-center",q.value?"bg-gray-400 text-gray-600 opacity-50 cursor-not-allowed":"bg-gradient-to-r from-[var(--bt-pro-color)] to-[var(--bt-pro-light-color)] text-white hover:shadow-xl hover:-translate-y-1"]),onClick:E},[i("i",{class:u(q.value?"fa fa-clock-o mr-[8px]":"fa fa-gift mr-[8px]")},null,2),d(" "+c(q.value?"已过期":"立即领取优惠券"),1)],10,j)])]),t[9]||(t[9]=i("div",{class:"absolute -top-[20px] -right-[20px] w-[64px] h-[64px] bg-[var(--bt-pro-light-color)] rounded-full opacity-20 animate-pulse-slow"},null,-1)),t[10]||(t[10]=i("div",{class:"absolute -bottom-[24px] -left-[24px] w-[96px] h-[96px] bg-warning rounded-full opacity-10 animate-pulse-slow"},null,-1))],2),i("div",{ref:"fireworksContainer",class:u(["fixed inset-0 pointer-events-none",{hidden:!z.value}])},[(s(!0),n(p,null,x(C.value,e=>(s(),n("div",{key:e.id,class:"absolute rounded-full",style:v({width:e.size+"px",height:e.size+"px",backgroundColor:e.color,left:e.x+"%",top:e.y+"%",animation:"firework 1s ease-out forwards"})},null,4))),128))],2)]))}});export{M as default};
