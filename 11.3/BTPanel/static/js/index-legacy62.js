!function(){function n(n){return function(n){if(Array.isArray(n))return r(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||e(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){var e=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var r,a,o,u,i=[],c=!0,l=!1;try{if(o=(e=e.call(n)).next,0===t){if(Object(e)!==e)return;c=!1}else for(;!(c=(r=o.call(e)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(n){l=!0,a=n}finally{try{if(!c&&null!=e.return&&(u=e.return(),Object(u)!==u))return}finally{if(l)throw a}}return i}}(n,t)||e(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(n,t){if(n){if("string"==typeof n)return r(n,t);var e={}.toString.call(n).slice(8,-1);return"Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e?Array.from(n):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(n,t):void 0}}function r(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=Array(t);e<t;e++)r[e]=n[e];return r}function a(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var n,t,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",u=e.toStringTag||"@@toStringTag";function i(e,r,a,u){var i=r&&r.prototype instanceof l?r:l,s=Object.create(i.prototype);return o(s,"_invoke",function(e,r,a){var o,u,i,l=0,s=a||[],f=!1,v={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(t,e){return o=t,u=0,i=n,v.n=e,c}};function p(e,r){for(u=e,i=r,t=0;!f&&l&&!a&&t<s.length;t++){var a,o=s[t],p=v.p,d=o[2];e>3?(a=d===r)&&(i=o[(u=o[4])?5:(u=3,3)],o[4]=o[5]=n):o[0]<=p&&((a=e<2&&p<o[1])?(u=0,v.v=r,v.n=o[1]):p<d&&(a=e<3||o[0]>r||r>d)&&(o[4]=e,o[5]=r,v.n=d,u=0))}if(a||e>1)return c;throw f=!0,r}return function(a,s,d){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,d),u=s,i=d;(t=u<2?n:i)||!f;){o||(u?u<3?(u>1&&(v.n=-1),p(u,i)):v.n=i:v.v=i);try{if(l=2,o){if(u||(a="next"),t=o[a]){if(!(t=t.call(o,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,u<2&&(u=0)}else 1===u&&(t=o.return)&&t.call(o),u<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),u=1);o=n}else if((t=(f=v.n<0)?i:e.call(r,v))!==c)break}catch(t){o=n,u=1,i=t}finally{l=1}}return{value:t,done:f}}}(e,a,u),!0),s}var c={};function l(){}function s(){}function f(){}t=Object.getPrototypeOf;var v=[][r]?t(t([][r]())):(o(t={},r,function(){return this}),t),p=f.prototype=l.prototype=Object.create(v);function d(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,o(n,u,"GeneratorFunction")),n.prototype=Object.create(p),n}return s.prototype=f,o(p,"constructor",f),o(f,"constructor",s),s.displayName="GeneratorFunction",o(f,u,"GeneratorFunction"),o(p),o(p,u,"Generator"),o(p,r,function(){return this}),o(p,"toString",function(){return"[object Generator]"}),(a=function(){return{w:i,m:d}})()}function o(n,t,e,r){var a=Object.defineProperty;try{a({},"",{})}catch(n){a=0}o=function(n,t,e,r){function u(t,e){o(n,t,function(n){return this._invoke(t,e,n)})}t?a?a(n,t,{value:e,enumerable:!r,configurable:!r,writable:!r}):n[t]=e:(u("next",0),u("throw",1),u("return",2))},o(n,t,e,r)}function u(n,t,e,r,a,o,u){try{var i=n[o](u),c=i.value}catch(n){return void e(n)}i.done?t(c):Promise.resolve(c).then(r,a)}function i(n){return function(){var t=this,e=arguments;return new Promise(function(r,a){var o=n.apply(t,e);function i(n){u(o,r,a,i,c,"next",n)}function c(n){u(o,r,a,i,c,"throw",n)}i(void 0)})}}System.register(["./index-legacy109.js?v=1763689792","./index-legacy118.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./useMethod-legacy9.js?v=1763689792","./column-legacy.js?v=1763689792"],function(e,r){"use strict";var o,u,c,l,s,f,v,p,d,m,h,b,y,w,g,_,k,j,M,O,C,S,E,A,q,x,P,T,I,L,z,G,B,W,D,F,R,U,H,V,$,X,Z,J,N,Y;return{setters:[function(n){o=n._},function(n){u=n._},function(n){c=n.H,l=n.x,s=n.fW,f=n.M,v=n.p,p=n.fX,d=n.fb,m=n.R,h=n.f8,b=n.u,y=n.n,w=n.fY,g=n.ak,_=n.aA,k=n.fZ,j=n.B,M=n.f_,O=n.f$,C=n.l},function(n){S=n.j,E=n.aH,A=n.o,q=n.e,x=n.D,P=n.ap,T=n.r,I=n.s,L=n.a9,z=n.aE,G=n.c,B=n.n,W=n.a8,D=n.I,F=n.x,R=n.O,U=n.C,H=n.z,V=n.J,$=n.H},function(n){X=n.a,Z=n.b,J=n.g},function(n){N=n.i,Y=n.u}],execute:function(){var K=S("MAIL_MAILBOX",function(){var n,t,e,o,u=E(),p=A({p:1,size:10}),d=X("添加邮箱",{isEdit:!1,row:void 0,onRefresh:(n=i(a().m(function n(){return a().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,c(function(){return Promise.resolve().then(function(){return hn})},void 0,r.meta.url);case 1:(0,n.v.getList)();case 2:return n.a(2)}},n)})),function(){return n.apply(this,arguments)})}),m=A({id:0,site_name:"",status:!1,ssl_status:!1}),h=Z([{prop:"username",label:"用户名",showOverflowTooltip:!0},N(),{prop:"info",label:"登录信息",width:180,render:function(n){return q("a",{class:"bt-link",href:"javascript:;",onClick:(t=i(a().m(function t(){return a().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,c(function(){return Promise.resolve().then(function(){return hn})},void 0,r.meta.url);case 1:(0,t.v.onCopy)(n);case 2:return t.a(2)}},t)})),function(){return t.apply(this,arguments)})},[x("复制")]);var t}},{prop:"quota",label:"邮箱配额",render:function(n){return l(n.quota)}},{prop:"is_admin",label:"类型",render:function(n){return 1===n.is_admin?"管理员":"普通用户"}},{prop:"active",label:"状态",render:function(n){return q(P,{modelValue:n.active,"onUpdate:modelValue":function(t){return n.active=t},size:"small",activeValue:1,inactiveValue:0,onChange:(t=i(a().m(function t(e){var r,o;return a().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,s({username:n.username,full_name:n.full_name,quota:l(n.quota),active:e,is_admin:n.is_admin});case 1:r=t.v,o=r.data,n.active=e,f.request(o);case 2:return t.a(2)}},t)})),function(n){return t.apply(this,arguments)})},null);var t}},Y([{title:"WebMail",onClick:(o=i(a().m(function n(t){return a().w(function(n){for(;;)switch(n.p=n.n){case 0:if(!m.status){n.n=2;break}return n.n=1,c(function(){return Promise.resolve().then(function(){return hn})},void 0,r.meta.url);case 1:(0,n.v.onLogin)(t),n.n=5;break;case 2:return n.p=2,n.n=3,v({title:"WebMail未激活",content:function(){return q("div",null,[x('WebMail尚未激活，请前往"'),q("a",{class:"bt-link",href:"javascript:;",onClick:function(){u.push("/mail/setting")}},[x("邮局 > 设置")]),x('" 激活并安装它')])}});case 3:u.push({name:"mail-setting"}),n.n=5;break;case 4:n.p=4,n.v;case 5:return n.a(2)}},n,null,[[2,4]])})),function(n){return o.apply(this,arguments)})},{title:"编辑",onClick:(e=i(a().m(function n(t){return a().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,c(function(){return Promise.resolve().then(function(){return hn})},void 0,r.meta.url);case 1:(0,n.v.onShowEdit)(t);case 2:return n.a(2)}},n)})),function(n){return e.apply(this,arguments)})},{title:"删除",onClick:(t=i(a().m(function n(t){return a().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,c(function(){return Promise.resolve().then(function(){return hn})},void 0,r.meta.url);case 1:(0,n.v.onDel)(t);case 2:return n.a(2)}},n)})),function(n){return t.apply(this,arguments)})}],{width:200,fixed:"right",label:"操作"})]),b=h.table,y=h.columns;return{search:p,formModal:d,info:m,table:b,columns:y,reset:function(){p.p=1,p.size=10,m.id=0,m.status=!1,m.ssl_status=!1,m.site_name="",d.data.row=void 0,d.data.isEdit=!1,b.data=[]}}}),Q=e("M",S("MAIL_MAILBOX_ADD",function(){var n=T(null),e=A({full_name:"",domain:null,quota:5,quota_unit:"GB",is_admin:0,username:"",password:"",active:1}),r=T({}),o=T([]),u={full_name:[{trigger:["blur","input"],validator:function(n,t,e){if(!t||""===t.trim())return e(new Error("用户名不能为空!"));e()}}],username:[{trigger:["blur","input"],validator:function(n,t,e){if(!t||""===t.trim())return e(new Error("邮箱地址不能为空!"));e()}}],quota:[{trigger:["blur","input"],validator:function(n,t,e){if(!t)return e(new Error("邮箱配额大小不能为空!"));e()}}],password:[{trigger:["blur","input"],validator:function(n,t,e){if(r.value.isEdit){if(t){if(t.trim().length<8)return e(new Error("当前邮箱用户密码长度小于8位，请重新输入"));if(!/^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z]).{8,}$/.test(t))return e(new Error("当前邮箱用户密码必须至少包含大小写字母和数字，请重新输入"))}}else{if(!t||t.trim().length<8)return e(new Error("当前邮箱用户密码长度小于8位，请重新输入"));if(!/^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z]).{8,}$/.test(t))return e(new Error("当前邮箱用户密码必须至少包含大小写字母和数字，请重新输入"))}e()}}]},c=function(){return{full_name:e.full_name,quota:e.quota+" "+e.quota_unit,is_admin:e.is_admin,username:e.username+"@"+e.domain,password:e.password,active:e.active}},v=function(){var t=i(a().m(function t(){var e,o,u;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.n=1,null===(e=n.value)||void 0===e?void 0:e.validate();case 1:if(t.p=1,!r.value.isEdit){t.n=3;break}return t.n=2,s(c());case 2:o=t.v,t.n=5;break;case 3:return t.n=4,p(c());case 4:o=t.v;case 5:if(u=o.data,f.request(u),!u.status){t.n=6;break}r.value.onRefresh&&r.value.onRefresh(),b(),t.n=7;break;case 6:return t.a(2,!1);case 7:t.n=9;break;case 8:t.p=8,t.v;case 9:return t.a(2)}},t,null,[[1,8]])}));return function(){return t.apply(this,arguments)}}(),h=function(){var n=i(a().m(function n(){var t,r;return a().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,d();case 1:t=n.v,r=t.data,m(r.data)&&(o.value=r.data.map(function(n){return{label:n,value:n}}),null===e.domain&&(e.domain=r.data[0]));case 2:return n.a(2)}},n)}));return function(){return n.apply(this,arguments)}}(),b=function(){e.full_name="",e.domain=null,e.quota=5,e.quota_unit="GB",e.is_admin=0,e.username="",e.password="",e.active=1};return{form:e,domainOptions:o,unitOptions:[{label:"GB",value:"GB"},{label:"MB",value:"MB"}],typeOptions:[{label:"普通用户",value:0},{label:"管理员",value:1}],rules:u,getParams:c,onConfirm:v,getDomainOptions:h,initForm:function(n){var a=n.row,o=n.isEdit;if(r.value=n,b(),o&&a){e.full_name=a.full_name,e.is_admin=a.is_admin,e.username=a.username.split("@")[0],e.active=a.active;var u=t(a.username.split("@"),2),i=u[0],c=u[1];e.username=i,e.domain=c;var s=t(l(a.quota).split(" "),2),f=s[0],v=s[1];e.quota=J(f),e.quota_unit=v}},formRef:n}})),nn=h().refs.tabActive,tn=I(K()),en=tn.formModal,rn=tn.info,an=tn.table,on=tn.search,un=Q().onConfirm,cn=b().payment,ln=function(){en.value.data.isEdit=!1,en.value.data.row=void 0,en.value.title="添加邮箱",y({title:en.value.title,area:48,showFooter:!0,component:function(){return c(function(){return r.import("./index-legacy362.js?v=1763689792")},void 0,r.meta.url)},compData:en.value.data,onConfirm:un})},sn=function(){var n=E(),t=function(){var t=i(a().m(function t(){return a().w(function(t){for(;;)switch(t.n){case 0:if(rn.value.site_name){t.n=1;break}return t.a(2,f.msg({customClass:"bt-message-error-html",dangerouslyUseHTMLString:!0,type:"error",message:z("div",{class:"flex items-center leading-3rem mt-[4px]"},["请先在【系统设置】-【WebMail】中配置",z("span",{class:"bt-link",onClick:function(){n.push("/mail/setting"),nn.value="mail-setting"}}," WebMail")]),showClose:!0}));case 1:window.open("".concat(rn.value.ssl_status?"https":"http","://").concat(rn.value.site_name),"_blank","noopener,noreferrer");case 2:return t.a(2)}},t)}));return function(){return t.apply(this,arguments)}}();return{onLoginMail:t}},fn=function(){var n=i(a().m(function n(t){var e,r;return a().w(function(n){for(;;)switch(n.n){case 0:if("ltd"===cn.value.authType){n.n=1;break}return n.a(2,f.warn("请先购买企业版"));case 1:return n.n=2,M({rc_user:t.username,rc_pass:t.password});case 2:e=n.v,r=e.data,g(r)&&window.open("".concat(rn.value.ssl_status?"https":"http","://").concat(r.data),"_blank","noopener,noreferrer");case 3:return n.a(2)}},n)}));return function(t){return n.apply(this,arguments)}}(),vn=function(){var n=i(a().m(function n(t){var e,r;return a().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,v({title:"删除邮箱",content:"是否删除【".concat(t.username,"】邮箱?")});case 1:return n.n=2,O({username:t.username});case 2:e=n.v,r=e.data,f.request(r),dn(),n.n=4;break;case 3:n.p=3,n.v;case 4:return n.a(2)}},n,null,[[0,3]])}));return function(t){return n.apply(this,arguments)}}(),pn=function(){var n=i(a().m(function n(){var t,e;return a().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,k();case 1:t=n.v,e=t.data,g(e)&&(rn.value.id=e.id,rn.value.status=e.status,rn.value.site_name=e.site_name,rn.value.ssl_status=e.ssl_status);case 2:return n.a(2)}},n)}));return function(){return n.apply(this,arguments)}}(),dn=function(){var n=i(a().m(function n(){var t,e;return a().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,an.value.loading=!0,n.n=1,w(L(on.value));case 1:t=n.v,e=t.data,g(e.data)&&(an.value.data=m(e.data.data)?e.data.data:[],an.value.total=_(e.data.page));case 2:return n.p=2,an.value.loading=!1,n.f(2);case 3:return n.a(2)}},n,null,[[0,,2,3]])}));return function(){return n.apply(this,arguments)}}(),mn=function(){var n=i(a().m(function n(){return a().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,an.value.loading=!0,n.n=1,pn();case 1:return n.n=2,dn();case 2:return n.p=2,an.value.loading=!1,n.f(2);case 3:return n.a(2)}},n,null,[[0,,2,3]])}));return function(){return n.apply(this,arguments)}}(),hn=Object.freeze(Object.defineProperty({__proto__:null,getInfo:pn,getList:dn,init:mn,onCopy:function(n){j({value:"WebMail: ".concat(rn.value.site_name?"".concat(rn.value.ssl_status?"https":"http","://").concat(rn.value.site_name):"未配置WebMail","\n用户名: ").concat(n.username,"\n密码: ").concat(n.password,"\nPOP 服务 [ 地址：").concat(n.mx," 端口：110/995 ]\nIMAP 服务 [ 地址：").concat(n.mx," 端口：143/993 ]\nSMTP 服务 [ 地址：").concat(n.mx," 端口：25/465/587 ]\n")})},onDel:vn,onLogin:fn,onShowAdd:ln,onShowEdit:function(n){en.value.data.isEdit=!0,en.value.data.row=n,en.value.title="编辑邮箱 【".concat(n.username,"】"),y({title:en.value.title,area:48,showFooter:!0,component:function(){return c(function(){return r.import("./index-legacy362.js?v=1763689792")},void 0,r.meta.url)},compData:en.value.data,onConfirm:un})},useMailMethods:sn},Symbol.toStringTag,{value:"Module"})),bn=G({__name:"index",setup:function(t){var e=sn().onLoginMail,r=I(K()),a=r.search,i=r.table,c=r.columns,l=K().reset;return B(function(){mn()}),W(function(){l()}),function(t,r){var l=$,s=C,f=u,v=o,p=D("bt-loading");return F(),R(v,null,{"header-left":U(function(){return[q(l,{type:"primary",onClick:H(ln)},{default:U(function(){return n(r[2]||(r[2]=[x("添加邮箱",-1)]))}),_:1},8,["onClick"]),q(l,{onClick:H(e)},{default:U(function(){return n(r[3]||(r[3]=[x("WebMail",-1)]))}),_:1},8,["onClick"])]}),content:U(function(){return[V(q(s,{data:H(i).data,column:H(c)},null,8,["data","column"]),[[p,H(i).loading]])]}),"footer-right":U(function(){return[q(f,{page:H(a).p,"onUpdate:page":r[0]||(r[0]=function(n){return H(a).p=n}),row:H(a).size,"onUpdate:row":r[1]||(r[1]=function(n){return H(a).size=n}),total:H(i).total,onChange:H(dn)},null,8,["page","row","total","onChange"])]}),_:1})}}}),yn=Object.freeze(Object.defineProperty({__proto__:null,default:bn},Symbol.toStringTag,{value:"Module"}));e("i",yn)}}})}();
