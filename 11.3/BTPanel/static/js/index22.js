import{n as a,H as t,Q as e,l as s,ah as o,p as l}from"./utils-lib.js?v=1763689792";import{_ as n}from"./index109.js?v=1763689792";import{c as i,r,e as c,w as m,v as p,I as u,x as d,y as _,C as b,D as f,J as h,z as y,H as v}from"./base-lib.js?v=1763689792";import{a as j,d as k,h as w,u as q,c as x}from"./column.js?v=1763689792";import{getModulesList as C,deleteDatabase as g,backupSqliteData as D,deleteSqliteData as E}from"./database.js?v=1763689792";import{g as R}from"./useStore2.js?v=1763689792";import{i as T,o as I,h as L}from"./validator.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./index107.js?v=1763689792";const A=i({__name:"index",setup(i){const{refs:{isRefreshTable:A},resetRefresh:H}=R(),O=r(),P=r(!1),V=r([]),z=async(a,t,e,s,o)=>{const{label:l,value:n}=s;await a({title:"批量".concat(l),content:"批量".concat(l,"已选数据库，是否继续操作！"),column:[{prop:"name",label:"数据库名"},x()],onConfirm:async()=>{const a=await(async()=>{const a={back:D,delete:E}[n],t=e.value.map(a=>({path:a.path,name:a.name})),s=L([],[],!1,{params:{database_list:t}});if(a)return await a(s)})();S();const{data:t}=T(a.data);I(t,{title:"".concat(l)}),o&&o()}})},Q=()=>{a({title:"添加SQLite数据库",area:48,btn:!0,component:()=>t(()=>import("./add-sqlite.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},S=async()=>{try{const a=await e({request:C({},"sqlite"),loading:P});V.value=null==a?void 0:a.data}catch(a){}},W=[j({type:"page",key:"name"}),{label:"数据库名称",prop:"name",minWidth:90},{label:"备份",minWidth:180,isCustom:!0,render:e=>c("span",{class:"cursor-pointer",style:{color:e.backup_count>0?"var(--el-color-primary)":"#f0ad4e"},onClick:()=>(e=>{a({title:"数据库备份详情【"+e.name+"】",area:70,compData:e,component:()=>t(()=>import("./back-sqlite.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})})(e)},[e.backup_count>0?"有备份(".concat(e.backup_count,")"):"点击备份"])},k({prop:"path"}),w({prop:"size",width:100}),q([{onClick:e=>{a({title:"管理",area:[114,65],compData:{...e,list:V.value},component:()=>t(()=>import("./index144.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},title:"管理"},{onClick:async a=>{try{await l({title:"删除数据库文件【"+(null==a?void 0:a.name)+"】",content:"删除选中的数据库文件后，该数据库文件将不在列表中显示，是否继续操作？"}),await e({request:g({path:a.path},"sqlite"),loading:"正在删除数据库,请稍后...",message:!0}),S()}catch(t){}},title:"删除"}])],J=[{label:"备份数据库",value:"back",event:z},{label:"删除数据库",value:"delete",event:z}];return m(()=>A.value,async a=>{a&&await S(),H()}),p(()=>{S()}),(a,t)=>{const e=v,l=s,i=o,r=n,m=u("bt-loading");return d(),_("div",null,[c(r,null,{"header-left":b(()=>[c(e,{type:"primary",onClick:Q},{default:b(()=>[...t[0]||(t[0]=[f(" 添加数据库文件 ",-1)])]),_:1})]),content:b(()=>[h(c(l,{ref_key:"sqliteTableRef",ref:O,column:W,data:y(V)},null,8,["data"]),[[m,y(P)],[m,"正在加载数据库列表...","title"]])]),"footer-left":b(()=>[c(i,{"table-ref":y(O),options:J},null,8,["table-ref"])]),_:1})])}}});export{A as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
