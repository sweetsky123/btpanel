import{c as e,s as a,r as s,v as t,x as l,y as r,e as c,C as i,z as u,F as o,b1 as m,O as p,am as f,an as n,ad as v,ab as d}from"./base-lib.js?v=1763689792";import{b as y}from"./utils-lib.js?v=1763689792";import{g as b}from"./useStore5.js?v=1763689792";import{G as _,H as h}from"./ssl.js?v=1763689792";import{u as V}from"./useStore11.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";const j={class:"p-[2rem] flex justify-center flex-col"},g=e({__name:"index",props:{compData:{type:Object,default:()=>{}}},emits:["close"],setup(e,{expose:g,emit:D}){const w=y(),{activeTabs:x,sslIsRefresh:R,testIsRefresh:I,encryptIsRefresh:L,otherIsRefresh:O}=a(V()),{refs:{isRefreshDomainList:S,typeList:k}}=b(),q=e,C=D,H=s(),J=s({selectValue:""}),N={selectValue:[{required:!0,message:"请选择".concat("certificate"===q.compData.type?"证书分组":"域名分类"),trigger:"change"}]},z=s([]),F=s([]),G=async e=>{var a;let s;try{switch(e){case"certificate":if(F.value=q.compData.itemList.map(e=>({id:e.id,type:e.type})),s=await h({ids:JSON.stringify(F.value),group_id:J.value.selectValue}),s.status){const e={ssl:()=>R.value=!0,test:()=>I.value=!0,encrypt:()=>L.value=!0,other:()=>O.value=!0};null==(a=e[x.value])||a.call(e)}break;case"domain":F.value=q.compData.itemList.map(e=>e.id),s=await _({ids:JSON.stringify(F.value),type_id:J.value.selectValue}),s.status&&(S.value=!0)}}catch(t){}return s};return g({onConfirm:async()=>{if(H.value)try{await H.value.validate();const e=w.load("正在".concat("certificate"===q.compData.type?"设置证书分组":"设置域名分类","，请稍候..."));try{const e=await G(q.compData.type);w.request(e),e.status&&C("close")}finally{e.close()}}catch(e){return!1}}}),t(()=>{z.value=k.value.filter(e=>"all"!==e.value)}),(a,s)=>{const t=f,y=n,b=v,_=d;return l(),r("div",j,[c(_,{ref_key:"formRef",ref:H,model:u(J),rules:N},{default:i(()=>[c(b,{label:"certificate"===e.compData.type?"证书分组":"域名分类",prop:"selectValue"},{default:i(()=>[c(y,{modelValue:u(J).selectValue,"onUpdate:modelValue":s[0]||(s[0]=e=>u(J).selectValue=e),class:"!w-[31rem]"},{default:i(()=>[(l(!0),r(o,null,m(u(z),e=>(l(),p(t,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])])}}});export{g as default};
