!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,u,l,o=[],i=!0,c=!1;try{if(u=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=u.call(n)).done)&&(o.push(r.value),o.length!==t);i=!0);}catch(e){c=!0,a=e}finally{try{if(!i&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw a}}return o}}(e,t)||r(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function o(t,n,r){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,n||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function u(n,r,a,u){var i=r&&r.prototype instanceof o?r:o,s=Object.create(i.prototype);return c(s,"_invoke",function(n,r,a){var u,o,i,c=0,s=a||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return u=t,o=0,i=e,d.n=n,l}};function p(n,r){for(o=n,i=r,t=0;!f&&c&&!a&&t<s.length;t++){var a,u=s[t],p=d.p,m=u[2];n>3?(a=m===r)&&(i=u[(o=u[4])?5:(o=3,3)],u[4]=u[5]=e):u[0]<=p&&((a=n<2&&p<u[1])?(o=0,d.v=r,d.n=u[1]):p<m&&(a=n<3||u[0]>r||r>m)&&(u[4]=n,u[5]=r,d.n=m,o=0))}if(a||n>1)return l;throw f=!0,r}return function(a,s,m){if(c>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,m),o=s,i=m;(t=o<2?e:i)||!f;){u||(o?o<3?(o>1&&(d.n=-1),p(o,i)):d.n=i:d.v=i);try{if(c=2,u){if(o||(a="next"),t=u[a]){if(!(t=t.call(u,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,o<2&&(o=0)}else 1===o&&(t=u.return)&&t.call(u),o<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),o=1);u=e}else if((t=(f=d.n<0)?i:n.call(r,d))!==l)break}catch(t){u=e,o=1,i=t}finally{c=1}}return{value:t,done:f}}}(n,a,u),!0),s}var l={};function o(){}function s(){}function f(){}t=Object.getPrototypeOf;var d=[][r]?t(t([][r]())):(c(t={},r,function(){return this}),t),p=f.prototype=o.prototype=Object.create(d);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,a,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=f,c(p,"constructor",f),c(f,"constructor",s),s.displayName="GeneratorFunction",c(f,a,"GeneratorFunction"),c(p),c(p,a,"Generator"),c(p,r,function(){return this}),c(p,"toString",function(){return"[object Generator]"}),(i=function(){return{w:u,m:m}})()}function c(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}c=function(e,t,n,r){function u(t,n){c(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(u("next",0),u("throw",1),u("return",2))},c(e,t,n,r)}function s(e,t,n,r,a,u,l){try{var o=e[u](l),i=o.value}catch(e){return void n(e)}o.done?t(i):Promise.resolve(i).then(r,a)}function f(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var u=e.apply(t,n);function l(e){s(u,r,a,l,o,"next",e)}function o(e){s(u,r,a,l,o,"throw",e)}l(void 0)})}}System.register(["./index-legacy123.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./validator-legacy.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./index-legacy109.js?v=1763689792","./index-legacy118.js?v=1763689792","./index-legacy130.js?v=1763689792","./useController-legacy6.js?v=1763689792","./useStore-legacy4.js?v=1763689792","./site-legacy.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./column-legacy.js?v=1763689792","./index-legacy107.js?v=1763689792"],function(e,r){"use strict";var a,u,o,c,s,d,p,m,v,y,h,b,g,w,_,k,V,x,j,O,C,D,S,N,P,A,T,U,q,E,M,I,G,L,F,R,$,H,Y,B,J,z,W,K,Q,Z,X,ee,te,ne,re,ae,ue,le,oe,ie,ce,se,fe,de,pe,me,ve,ye,he,be,ge,we,_e,ke,Ve,xe,je,Oe,Ce,De,Se;return{setters:[function(e){a=e._},function(e){u=e.c,o=e.r,c=e.x,s=e.y,d=e.e,p=e.C,m=e.F,v=e.b1,y=e.z,h=e.O,b=e.D,g=e.B,w=e.R,_=e.L,k=e.H,V=e.b9,x=e.ba,j=e.c9,O=e.o,C=e.aB,D=e.W,S=e.g,N=e.w,P=e.aG,A=e.v,T=e.I,U=e.J,q=e.A,E=e.G,M=e.n,I=e.am,G=e.an,L=e.aA,F=e.aZ,R=e.ap,$=e.b2,H=e.ad,Y=e.ab},function(e){B=e._},function(e){J=e.V,z=e._,W=e.u,K=e.e,Q=e.Q,Z=e.aK,X=e.p,ee=e.aA,te=e.aC,ne=e.l,re=e.$,ae=e.k,ue=e.j,le=e.b},function(e){oe=e._},function(e){ie=e._},function(e){ce=e._},function(e){se=e.t},function(e){fe=e.u},function(e){de=e.addExcloud,pe=e.setSiteStatusProof,me=e.modifyPathConfig,ve=e.multiCreate,ye=e.setTamperAlarm,he=e.setPushStatus,be=e.setPushConfig,ge=e.getGlabalTotal,we=e.getTamperRuleByPath,_e=e.delTempClose,ke=e.setTempClose,Ve=e.modifyGlobalConfig,xe=e.getTamperCoreLogs,je=e.getTamperAlarm,Oe=e.getPushList,Ce=e.delLogs,De=e.getProofIndex,Se=e.getProofLog},null,null,null,null],execute:function(){var r={class:"time flex"},Ne=z(u({__name:"day-cut",props:{days:{default:""}},emits:["cut-day","cut-day-click"],setup:function(e,t){var n=t.emit,a=o(""),u=o(1),l=o(),i=o([{content:"昨天",active:!1,event:function(){u.value=0;var e=J(new Date((new Date).getTime()-864e5),"yyyy-MM-dd");n("cut-day",0,e),f.value=""}},{content:"今天",active:!0,event:function(e){u.value=1;var t=J(new Date,"yyyy-MM-dd");n("cut-day",1,t),f.value=""}}]),f=o(""),j=function(e){return e.getTime()>Date.now()},O=function(e){a.value="自定义时间",u.value=2,n("cut-day",2,J(e,"yyyy-MM-dd"))};return function(e,t){var n=k,a=V,o=x;return c(),s("div",r,[d(a,{class:"control-btn"},{default:p(function(){return[(c(!0),s(m,null,v(y(i),function(e,t){return c(),h(n,{key:t,type:y(u)===t?"primary":"",onClick:e.event},{default:p(function(){return[b(g(e.content),1)]}),_:2},1032,["type","onClick"])}),128))]}),_:1}),d(o,{align:"right",type:"date",modelValue:y(f),"onUpdate:modelValue":t[0]||(t[0]=function(e){return w(f)?f.value=e:null}),placeholder:"自定义时间",ref_key:"player",ref:l,class:_(["auto-time !w-[13rem]","".concat(2===y(u)?"active":"")]),onChange:O,"disabled-date":j},null,8,["modelValue","class"])])}}}),[["__scopeId","data-v-deb01e80"]]),Pe={key:0,class:"flex justify-between mb-[1.6rem]"},Ae={class:"flex items-center"},Te={class:"flex items-center"},Ue={class:"bt-danger"},qe={key:1,class:"flex items-center justify-center mb-[1.6rem]"},Ee={class:"flex items-center flex-1 mr-1rem"},Me={key:0,class:"flex-1"},Ie={class:"flex items-center"},Ge={class:"current-box"},Le={class:"current-box-item"},Fe=["title"],Re={class:"current-box-item"},$e=["title"],He={key:0,class:"flex justify-between"},Ye={class:"flex items-center"},Be={class:"flex items-center"},Je={class:"flex items-center"},ze={class:"flex items-center"},We={class:"flex items-center"},Ke={class:"mt-8 leading-10 list-disc pl-2rem"},Qe={class:"flex-wrap"},Ze=u({__name:"overview",props:{compData:{default:{}}},setup:function(e,r){var u=r.expose,_=e,V=le(),z=W().getSenderAlarmListInfo,Ze=fe().siteInfo,Xe=o(!1),et=j(),tt=o(!1),nt=o(1),rt=o(J(new Date,"yyyy-MM-dd")),at=o({}),ut=O({p:1,rows:10,total:0}),lt=o(!1),ot=o([]),it=o([]),ct=o({logContent:"",logDialog:!1,name:""}),st=[{content:"如果需要频繁修改当前文件，确认提交即可。"},{content:"如果需要频繁修改该文件同级文件内容，请删除路径尾部文件名，确认提交即可。"},{content:d(m,null,[b("若大量临时缓存文件被拦截，可参考："),d("code",null,[b("/www/wwwroot/bt.cn/cache/bt_1234.php")]),b("，直接添加"),d("code",null,[b("/www/wwwroot/bt.cn/cache/bt*.php")]),b("即可")])},{content:"注意：以上操作会解除对文件或目录的限制，请确保你信任这些内容，以防止安全问题。"}],ft=o(!1),dt=o(),pt=o(!1),mt=O({path:""}),vt=O({path:[{required:!0,message:"请输入目录/文件",trigger:"blur"}]}),yt=C("kernelModuleStatus",D(!0)),ht=o({}),bt=o(!1),gt=o(!1),wt=o(),_t=O({expire:30,unit:"minute"}),kt=o(),Vt=o(!1),xt=O({name:Ze.value.path+"/"+Ze.value.name,cycle:30,count:3,interval:600,push_count:1,module:[],limit:["sms"]}),jt=S(function(){return"tamper_proof_refactored"===_.compData.type?[{content:"如果开启防篡改后您的网站出现异常，请尝试排除网站日志、缓存、临时文件、上传等目录后重试，或直接关闭异常网站防篡改功能"}]:[{content:"开启防篡改后，部分项目【无法更新，文件无法上传，无法操作等】，需要关闭防篡改或添加白名单"}]}),Ot=O({cycle:[{required:!0,message:"请输入时间",trigger:"blur"},{validator:function(e,t,n){/^[1-9]\d*$/.test(t)?n():n(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],count:[{required:!0,message:"请输入次数",trigger:"blur"},{validator:function(e,t,n){/^[1-9]\d*$/.test(t)?n():n(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],push_count:[{required:!0,message:"请输入次数",trigger:"blur"},{validator:function(e,t,n){/^[1-9]\d*$/.test(t)?n():n(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],interval:[{required:!0,message:"请输入时间",trigger:"blur"},{validator:function(e,t,n){/^[1-9]\d*$/.test(t)?n():n(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],module:[{validator:function(e,t,n){0===xt.module.length?n(new Error("请选择告警方式")):n()},trigger:["change"]}]}),Ct=o("log"),Dt=o([{label:"日志",name:"log",lazy:!0,render:function(){}}]),St=O({expire:[{required:!0,message:"请输入时间",trigger:"blur"},{validator:function(e,t,n){/^[1-9]\d*$/.test(t)?n():n(new Error("时间必须为大于0的整数"))},trigger:["blur","change"]}]}),Nt=o(),Pt=o(!1),At=O({date:""}),Tt=O({date:[{required:!0,message:"请选择日期",trigger:"blur"}]}),Ut=function(e){return e.getTime()>Date.now()},qt=[{label:"关闭防护",value:0},{label:"拦截模式",value:1},{label:"观察模式",value:2}],Et=O({create:"创建",delete:"删除",modify:"修改",move:"移动",rename:"重命名",chmod:"权限变更"}),Mt=O({0:"关闭",1:"拦截",2:"观察"}),It=o([{label:"时间",prop:"time",width:150,render:function(e){return J(e[0])}},{label:"模式",prop:"mode",width:60,render:function(e){return d("span",{class:"text-[".concat(1===e[1]?"#20a53a":"#f0ad4e","]")},[Mt[e[1]]])}},{label:"类型",prop:"type",width:70,render:function(e){return Et[e[2]]}},{label:"文件",prop:"type",showOverflowTooltip:!0,render:function(e){return d("div",{class:"truncate"},[e[3]])}},{label:"溯源日志",prop:"ip",width:78,render:function(e){return d("span",{class:"bt-link cursor-pointer",onClick:function(){ct.value.logContent=e[4]&&e[4].length?e[4].join("\n"):"当前日志为空",ct.value.name=e[3],ct.value.logDialog=!0}},[b("溯源日志")])}},{label:"状态",prop:"action",width:75,render:function(e){return"防护成功"}},{label:"操作",align:"right",width:90,render:function(e){return d(K,{onClick:function(){mt.path=e[3],ft.value=!0}},{default:function(){return[b("加入白名单")]}})}}]),Gt=o([{label:"时间",prop:"date",width:150},{label:"目录",prop:"content"},{label:"类型",prop:"type",width:100,render:function(e){return d("span",null,[se[e.type]])}},{label:"用户",prop:"user",width:90},{label:"进程",prop:"process",width:90}]),Lt=function(){var e=f(i().m(function e(){return i().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,dt.value.validate();case 1:return e.n=2,Q({loading:pt,request:de({siteName:Ze.value.name,excludePath:mt.path}),message:!0});case 2:e.v.status&&(ft.value=!1);case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Ft=function(){var e=f(i().m(function e(t){var n,r,a,u,l;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,tt.value=!0,e.n=1,De({day:t});case 1:a=e.v,u=a.data,at.value=null===(n=u.sites)||void 0===n?void 0:n.find(function(e){return e.siteName==Ze.value.name}),at.value.totalNum=at.value.total.site.total,at.value.theNum=at.value.total.day.total,at.value.open=at.value.open,it.value=null===(r=u.sites)||void 0===r?void 0:r.map(function(e){return{siteName:e.siteName,path:e.path}}),e.n=3;break;case 2:e.p=2,l=e.v,Z(l);case 3:return e.p=3,tt.value=!1,e.f(3);case 4:return e.a(2)}},e,null,[[0,2,3,4]])}));return function(t){return e.apply(this,arguments)}}(),Rt=function(){var e=f(i().m(function e(t){return i().w(function(e){for(;;)switch(e.n){case 0:Q({loading:lt,request:Se({day:t,siteName:Ze.value.name}),data:{logs:[Array,ot]}});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),$t=function(){var e=f(i().m(function e(t){var n,r,a;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return at.value.open=t,e.p=1,e.n=2,pe({siteName:Ze.value.name,status:t});case 2:r=e.v,null!==(n=r.data)&&void 0!==n&&n.length?(V.request(r.data[0]),r.status&&Ft(rt.value)):V.request(r),e.n=4;break;case 3:e.p=3,a=e.v,Z(a);case 4:return e.a(2)}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}(),Ht=function(){_t.expire=30,_t.unit="minute",gt.value=!0},Yt=function(){var e=f(i().m(function e(t){var n,r,a;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,X({title:"".concat(t?"开启":"关闭","保护目录配置【").concat(Ze.value.name,"】"),content:t?"启用该保护目录配置后，目录将受到保护，是否继续操作？":"关闭该保护目录配置后，目录将失去保护，是否继续操作？",icon:"warning"});case 1:if(null===(n=at.value)||void 0===n||!n.path){e.n=3;break}return e.n=2,Q({loading:"正在设置防篡改，请稍侯...",request:me({path_id:at.value.pid,key:"status",value:t?1:0}),message:!0});case 2:e.v.status&&Zt(),e.n=5;break;case 3:return e.n=4,ve({paths:JSON.stringify([{path:Ze.value.path+"/",ps:Ze.value.name}])});case 4:r=e.v,(a=r.data).length&&a[0].status?(V.success("开启防篡改成功"),Zt()):V.error("开启防篡改失败");case 5:e.n=7;break;case 6:e.p=6,"cancel"===e.v&&M(function(){at.value=l(l({},at.value),{},{open:!t})});case 7:return e.a(2)}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}(),Bt=function(){var e=f(i().m(function e(t){var n;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:if(null!==(n=at.value)&&void 0!==n&&n.path){e.n=1;break}return V.warn("请先开启防篡改开关再进行告警设置"),M(function(){bt.value=!1}),e.a(2);case 1:if(!t){e.n=3;break}if(_.compData.isNewAlarmVersion){e.n=2;break}return V.warn("当前企业级防篡改插件版本小于5.6，请升级插件"),M(function(){bt.value=!1}),e.a(2);case 2:Vt.value=!0,e.n=7;break;case 3:return e.p=3,e.n=4,X({title:"关闭保护目录告警【".concat(Ze.value.name,"】"),content:"关闭该保护目录告警后，该配置将无法发送告警，是否继续操作？",icon:"warning"});case 4:return e.n=5,Q({loading:"正在关闭告警任务，请稍侯...",request:_.compData.isNewAlarmVersion?ye({project:at.value.pid},"delete"):he({id:at.value.pid,name:"tamper_push",status:0}),message:!0});case 5:e.v.status&&Zt(),e.n=7;break;case 6:e.p=6,e.v,bt.value=!0;case 7:return e.a(2)}},e,null,[[3,6]])}));return function(t){return e.apply(this,arguments)}}(),Jt=function(){var e=f(i().m(function e(){return i().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,z();case 1:V.success("刷新成功");case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),zt=function(){Vt.value=!1,bt.value=!1},Wt=function(){var e=f(i().m(function e(){return i().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,kt.value.validate();case 1:return e.n=2,Q({loading:"正在设置告警任务，请稍侯...",request:_.compData.isNewAlarmVersion?ye({project:at.value.pid,cycle:Number(xt.cycle),count:Number(xt.count),interval:Number(xt.interval),day_num:Number(xt.push_count),status:1,sender:xt.module.join(",")},"add"):be({id:at.value.pid,name:"tamper_push",data:JSON.stringify({cycle:Number(xt.cycle),count:Number(xt.count),interval:Number(xt.interval),push_count:Number(xt.push_count),module:xt.module.join(","),type:"",title:"【".concat(Ze.value.path,"】篡改告警")})}),message:!0});case 2:e.v.status&&(Vt.value=!1,nn());case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Kt=function(){var e=f(i().m(function e(t,n){return i().w(function(e){for(;;)switch(e.n){case 0:if(nt.value=t,rt.value=n,"tamper_proof_refactored"!==_.compData.type){e.n=3;break}return e.n=1,Ft(n);case 1:return e.n=2,Rt(n);case 2:e.n=4;break;case 3:return ut.p=1,e.n=4,tn(n);case 4:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}(),Qt=function(){var e=f(i().m(function e(){var t,n,r;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,tt.value=!0,e.n=1,ge();case 1:t=e.v,n=t.data,ht.value=n,yt.value=n.glabal_status.kernel_module_status,e.n=3;break;case 2:e.p=2,r=e.v,Z(r);case 3:return e.p=3,tt.value=!1,e.f(3);case 4:return e.a(2)}},e,null,[[0,2,3,4]])}));return function(){return e.apply(this,arguments)}}(),Zt=function(){var e=f(i().m(function e(){var t,n,r,a,u,l,o,c,s;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,we({path:Ze.value.path});case 1:if(t=e.v,n=t.data,at.value=n,n.hasOwnProperty("status")){for(o in at.value.open=!!n.status,r=0,a=0,u=[],l=[],n.total.all)r+=n.total.all[o],u.push("".concat(se[o],": ").concat(n.total.all[o]));for(c in n.total.today)a+=n.total.today[c],l.push("".concat(se[c],": ").concat(n.total.today[c]));at.value.totalNum=r,at.value.totalTitle=u.join("\n"),at.value.theNum=a,at.value.theTitle=l.join("\n"),tn(rt.value)}else at.value.open=!1,at.value.totalNum="--",at.value.theNum="--";e.n=3;break;case 2:e.p=2,s=e.v,Z(s);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}(),Xt=function(){var e=f(i().m(function e(){var t,n=arguments;return i().w(function(e){for(;;)switch(e.n){case 0:if(!(t=n.length>0&&void 0!==n[0]&&n[0])){e.n=1;break}return e.n=1,wt.value.validate();case 1:return e.n=2,Q({loading:"正在设置临时关闭防护，请稍侯...",request:t?ke(_t):_e(),message:!0});case 2:e.v.status&&(gt.value=!1,Qt(),Zt());case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),en=function(){var e=f(i().m(function e(){return i().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,X({title:"开启全局开关",content:"开启后，站点目录对应的防篡改配置将生效，是否继续操作？",icon:"warning"});case 1:return e.n=2,Q({loading:"正在开启全局开关，请稍侯...",request:Ve({value:1,key:"status"}),message:!0});case 2:e.v.status&&Qt();case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),tn=function(){var e=f(i().m(function e(t){var n,r,a;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,xe({path_id:at.value.pid,date:t||rt.value,rows:ut.rows,p:ut.p});case 1:n=e.v,Array.isArray(n.data)?(ot.value=n.data,ut.total=n.hasOwnProperty("page")?ee(n.page):n.data.length):Array.isArray(null==n||null===(r=n.data)||void 0===r?void 0:r.data)?(ot.value=n.data.data,ut.total=n.data.hasOwnProperty("page")?ee(n.data.page):(null===(a=n.data)||void 0===a?void 0:a.total)||n.data.data.length):(ot.value=[],ut.total=0),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}(),nn=function(){var e=f(i().m(function e(){var t,n,r,a,u,l,o;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!_.compData.isNewAlarmVersion){e.n=2;break}return e.n=1,je();case 1:n=e.v,r=n.data,bt.value=null===(t=r.task_list.find(function(e){return e.project===at.value.pid}))||void 0===t?void 0:t.status,e.n=4;break;case 2:return e.n=3,Oe();case 3:a=e.v,u=a.data,l=u.tamper_push&&u.tamper_push[at.value.pid]||{},bt.value=!(null==l||!l.status);case 4:e.n=6;break;case 5:e.p=5,o=e.v,Z(o);case 6:return e.a(2)}},e,null,[[0,5]])}));return function(){return e.apply(this,arguments)}}(),rn=function(){At.date="",Pt.value=!0},an=function(){var e=f(i().m(function e(){var t;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Nt.value.validate();case 1:return e.n=2,Ce({path_id:at.value.pid,date:At.date});case 2:t=e.v,V.request(t),t.status&&(Pt.value=!1,tn()),e.n=4;break;case 3:e.p=3,e.v;case 4:return e.a(2)}},e,null,[[0,3]])}));return function(){return e.apply(this,arguments)}}();N([function(){return ht.value.temp_close_time},function(){return et.value}],function(e){var t=n(e,2),r=t[0],a=t[1];!Xe.value&&0!==r&&1e3*r+3e3<a&&(ht.value.temp_close_time=0,Qt(),Zt())});var un=function(){var e=f(i().m(function e(){var t;return i().w(function(e){for(;;)switch(e.n){case 0:if(_.compData.maskLayer){e.n=1;break}return e.a(2);case 1:if(rt.value=J(new Date,"yyyy-MM-dd"),"tamper_proof_refactored"!==_.compData.type){e.n=4;break}return e.n=2,Ft(rt.value);case 2:return e.n=3,Rt(rt.value);case 3:e.n=8;break;case 4:if(_.compData.isVersion){e.n=5;break}return e.a(2);case 5:return e.n=6,Qt();case 6:return e.n=7,Zt();case 7:if(null===(t=at.value)||void 0===t||!t.path){e.n=8;break}return e.n=8,nn();case 8:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();return P(function(){Xe.value=!0}),A(un),u({sitesList:it,init:un}),function(n,r){var u,l,o,i,f,_=I,V=G,j=L,O=K,C=F,D=R,S=$,N=k,P=te,A=ce,M=ne,z=ie,W=oe,Q=re,Z=ae,X=H,ee=Y,le=ue,se=B,fe=x,de=a,pe=T("bt-loading");return U((c(),s("div",null,["tamper_proof_refactored"===e.compData.type?(c(),s("div",Pe,[q("div",Ae,[r[26]||(r[26]=q("span",{class:"mr-1rem"},"防篡改状态",-1)),d(V,{class:"!w-[16rem]",modelValue:y(at).open,"onUpdate:modelValue":r[0]||(r[0]=function(e){return y(at).open=e}),onChange:$t},{default:p(function(){return[(c(),s(m,null,v(qt,function(e){return d(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])}),64))]}),_:1},8,["modelValue"]),d(j,{placement:"top-start",width:"200","popper-class":"green-tips-popover",trigger:"hover",content:""},{reference:p(function(){return t(r[24]||(r[24]=[q("i",{class:"svgtofont-el-question-filled text-warning ml-[12px] text-[16px]"},null,-1)]))}),default:p(function(){return[r[25]||(r[25]=q("ul",{class:"list-disc pl-1.6rem"},[q("li",null,"拦截模式：拦截，并记录"),q("li",null,"观察模式：不拦截，只记录")],-1))]}),_:1})]),d(Ne,{days:y(nt),onCutDay:Kt},null,8,["days"])])):(c(),s(m,{key:1},[null!==(u=y(ht))&&void 0!==u&&u.temp_close_time?(c(),h(C,{key:0,type:"warning",class:"!mb-[1.6rem] !p-[1.2rem]",closable:!1,"show-icon":""},{title:p(function(){return[q("div",Te,[r[28]||(r[28]=b(" 当前已临时关闭全局防篡改，将在 ",-1)),q("span",Ue,g(y(J)(y(ht).temp_close_time)),1),r[29]||(r[29]=b(" 恢复防护 ",-1)),d(O,{class:"bt-link ml-1rem",onClick:r[1]||(r[1]=function(e){return Xt(!1)})},{default:p(function(){return t(r[27]||(r[27]=[b(" 点击立即恢复 ",-1)]))}),_:1})])]}),_:1})):(c(),s("div",qe,[q("div",Ee,[r[32]||(r[32]=q("span",{class:"mr-1rem"},"防篡改开关",-1)),d(D,{modelValue:y(at).open,"onUpdate:modelValue":r[2]||(r[2]=function(e){return y(at).open=e}),width:36,onChange:Yt},null,8,["modelValue"]),d(S,{direction:"vertical",class:"!h-2rem !mx-1.6rem"}),r[33]||(r[33]=q("span",{class:"mr-1rem"},"告警设置",-1)),d(D,{class:"mr-[1.6rem]",modelValue:y(bt),"onUpdate:modelValue":r[3]||(r[3]=function(e){return w(bt)?bt.value=e:null}),width:36,onChange:Bt},null,8,["modelValue"]),null!==(l=y(ht))&&void 0!==l&&null!==(l=l.glabal_status)&&void 0!==l&&l.settings_status?E("",!0):(c(),s("div",Me,[d(C,{type:"warning",class:"h-3.2rem",closable:!1,"show-icon":""},{title:p(function(){return[q("div",Ie,[r[31]||(r[31]=b(" 未启用企业级防篡改，请先开启 ",-1)),d(O,{class:"underline",type:"danger",onClick:en},{default:p(function(){return t(r[30]||(r[30]=[b(" 全局开关 ",-1)]))}),_:1})])]}),_:1})]))]),d(N,{type:"primary",onClick:Ht},{default:p(function(){return t(r[34]||(r[34]=[b(" 全局临时开关 ",-1)]))}),_:1})]))],64)),q("div",Ge,[q("div",Le,[r[35]||(r[35]=q("div",null,"总拦截次数",-1)),q("div",{title:null===(o=y(at))||void 0===o?void 0:o.totalTitle},g(y(at).totalNum),9,Fe)]),q("div",Re,[r[36]||(r[36]=q("div",null,"当日拦截次数",-1)),q("div",{title:null===(i=y(at))||void 0===i?void 0:i.theTitle},g(y(at).theNum),9,$e)])]),"tamper_core"===e.compData.type?(c(),s(m,{key:2},[d(P,{ref:"tamperRef",type:"",class:"mt-1rem",modelValue:y(Ct),"onUpdate:modelValue":r[4]||(r[4]=function(e){return w(Ct)?Ct.value=e:null}),options:y(Dt)},null,8,["modelValue","options"]),null!==(f=y(at))&&void 0!==f&&f.path?(c(),s("div",He,[d(N,{type:"default",onClick:rn},{default:p(function(){return t(r[37]||(r[37]=[b("清理日志",-1)]))}),_:1}),q("div",Ye,[d(Ne,{days:y(nt),onCutDay:Kt},null,8,["days"]),d(A,{onRefresh:tn,class:"ml-1rem"})])])):E("",!0)],64)):E("",!0),d(W,null,{"header-left":p(function(){return t(r[38]||(r[38]=[]))}),"header-right":p(function(){return t(r[39]||(r[39]=[]))}),content:p(function(){return["tamper_core"==e.compData.type?U((c(),h(M,{key:0,column:y(Gt),maxHeight:320,data:y(ot)},null,8,["column","data"])),[[pe,y(lt)]]):U((c(),h(M,{key:1,column:y(It),maxHeight:400,data:y(ot)},null,8,["column","data"])),[[pe,y(lt)]])]}),"footer-left":p(function(){return t(r[40]||(r[40]=[]))}),"footer-right":p(function(){return["tamper_core"===e.compData.type?(c(),h(z,{key:0,class:"mb-1rem",page:y(ut).p,"onUpdate:page":r[5]||(r[5]=function(e){return y(ut).p=e}),row:y(ut).rows,"onUpdate:row":r[6]||(r[6]=function(e){return y(ut).rows=e}),total:y(ut).total,"pager-count":4,onChange:r[7]||(r[7]=function(e){return tn()})},null,8,["page","row","total"])):E("",!0)]}),_:1}),d(Q,{options:y(jt),"list-style":"disc",class:"ml-2rem"},null,8,["options"]),d(le,{title:"临时关闭防篡改",modelValue:y(gt),"onUpdate:modelValue":r[10]||(r[10]=function(e){return w(gt)?gt.value=e:null}),area:58,onConfirm:r[11]||(r[11]=function(e){return Xt(!0)}),"show-footer":""},{default:p(function(){return[d(ee,{class:"p-[2rem]",ref_key:"tempFormRef",ref:wt,model:y(_t),rules:y(St)},{default:p(function(){return[d(X,{label:"临时关闭",prop:"expire"},{default:p(function(){return[q("div",Be,[d(Z,{type:"number",modelValue:y(_t).expire,"onUpdate:modelValue":r[8]||(r[8]=function(e){return y(_t).expire=e}),width:"14rem",class:"!w-14rem",placeholder:"请输入时间"},null,8,["modelValue"]),d(V,{class:"ml-1rem !w-[10rem]",modelValue:y(_t).unit,"onUpdate:modelValue":r[9]||(r[9]=function(e){return y(_t).unit=e})},{default:p(function(){return[d(_,{label:"分钟",value:"minute"}),d(_,{label:"小时",value:"hour"}),d(_,{label:"天",value:"day"})]}),_:1},8,["modelValue"]),r[41]||(r[41]=q("span",{class:"text-secondary ml-[4px]"},"，到期后自动恢复防护",-1))])]}),_:1})]}),_:1},8,["model","rules"])]}),_:1},8,["modelValue"]),d(le,{title:"设置告警任务",modelValue:y(Vt),"onUpdate:modelValue":r[18]||(r[18]=function(e){return w(Vt)?Vt.value=e:null}),area:54,onConfirm:Wt,onCancel:zt,"show-footer":""},{default:p(function(){return[d(ee,{class:"p-[2rem]",ref_key:"alarmFormRef",ref:kt,model:y(xt),rules:y(Ot)},{default:p(function(){return[d(X,{label:"保护列表"},{default:p(function(){return[d(Z,{modelValue:y(xt).name,"onUpdate:modelValue":r[12]||(r[12]=function(e){return y(xt).name=e}),disabled:"",width:"35rem"},null,8,["modelValue"])]}),_:1}),d(X,{label:"触发条件"},{default:p(function(){return[q("div",Je,[d(X,{prop:"cycle"},{default:p(function(){return[d(Z,{modelValue:y(xt).cycle,"onUpdate:modelValue":r[13]||(r[13]=function(e){return y(xt).cycle=e}),type:"number",width:"12rem"},null,8,["modelValue"])]}),_:1}),r[42]||(r[42]=q("span",{class:"text-secondary mx-[.6rem]"},"分钟内，篡改",-1)),d(X,{prop:"count"},{default:p(function(){return[d(Z,{modelValue:y(xt).count,"onUpdate:modelValue":r[14]||(r[14]=function(e){return y(xt).count=e}),type:"number",width:"12rem"},null,8,["modelValue"])]}),_:1}),r[43]||(r[43]=q("span",{class:"text-secondary mx-[.6rem]"},"次",-1))])]}),_:1}),d(X,{label:"间隔时间",prop:"interval"},{default:p(function(){return[q("div",ze,[d(Z,{modelValue:y(xt).interval,"onUpdate:modelValue":r[15]||(r[15]=function(e){return y(xt).interval=e}),type:"number",width:"12rem",class:"!w-12rem"},null,8,["modelValue"]),r[44]||(r[44]=q("span",{class:"text-secondary mx-[.6rem]"},"秒后再次监控触发条件",-1))])]}),_:1}),d(X,{label:"推送次数",prop:"push_count"},{default:p(function(){return[q("div",We,[d(Z,{modelValue:y(xt).push_count,"onUpdate:modelValue":r[16]||(r[16]=function(e){return y(xt).push_count=e}),type:"number",width:"12rem",class:"!w-12rem"},null,8,["modelValue"]),r[45]||(r[45]=q("span",{class:"text-secondary mx-[.6rem]"}," 次后停止推送，次日再次监控 ",-1))])]}),_:1}),d(X,{label:"告警方式",prop:"module"},{default:p(function(){return[d(se,{modelValue:y(xt).module,"onUpdate:modelValue":r[17]||(r[17]=function(e){return y(xt).module=e}),class:"!w-35rem",limit:y(xt).limit},null,8,["modelValue","limit"])]}),_:1}),q("ul",Ke,[q("li",null,[r[47]||(r[47]=b(" 点击配置后状态未更新，尝试点击【 ",-1)),d(O,{class:"!inline-block",onClick:Jt},{default:p(function(){return t(r[46]||(r[46]=[b("手动刷新",-1)]))}),_:1}),r[48]||(r[48]=b(" 】 ",-1))])])]}),_:1},8,["model","rules"])]}),_:1},8,["modelValue"]),d(le,{title:"清理日志",modelValue:y(Pt),"onUpdate:modelValue":r[20]||(r[20]=function(e){return w(Pt)?Pt.value=e:null}),area:38,onConfirm:an,"show-footer":""},{default:p(function(){return[d(ee,{class:"p-[2rem]",ref_key:"clearFormRef",ref:Nt,model:y(At),rules:y(Tt)},{default:p(function(){return[d(X,{label:"需要清理的日期",prop:"date"},{default:p(function(){return[d(fe,{modelValue:y(At).date,"onUpdate:modelValue":r[19]||(r[19]=function(e){return y(At).date=e}),type:"date",class:"date",placeholder:"选择日期","value-format":"YYYY-MM-DD","disabled-date":Ut},null,8,["modelValue"])]}),_:1}),d(Q,{class:"pl-2rem",options:[{content:"当前仅支持按日期清理日志"}]})]}),_:1},8,["model","rules"])]}),_:1},8,["modelValue"]),d(le,{title:"溯源日志[".concat(y(ct).name,"]"),modelValue:y(ct).logDialog,"onUpdate:modelValue":r[21]||(r[21]=function(e){return y(ct).logDialog=e}),area:[60]},{default:p(function(){return[q("div",Qe,[d(de,{class:"h-[40rem] !rounded-none",content:y(ct).logContent},null,8,["content"])])]}),_:1},8,["title","modelValue"]),d(le,{title:"清理日志",modelValue:y(ft),"onUpdate:modelValue":r[23]||(r[23]=function(e){return w(ft)?ft.value=e:null}),area:56,onConfirm:Lt,"show-footer":""},{default:p(function(){return[d(ee,{class:"p-[2rem]",ref_key:"addWhiteListFormRef",ref:dt,model:y(mt),rules:y(vt),disabled:y(pt)},{default:p(function(){return[d(X,{label:"目录/文件",prop:"path"},{default:p(function(){return[d(Z,{modelValue:y(mt).path,"onUpdate:modelValue":r[22]||(r[22]=function(e){return y(mt).path=e}),width:"35rem",placeholder:"请输入目录/文件"},null,8,["modelValue"])]}),_:1}),d(X,null,{default:p(function(){return[d(Q,{options:st,class:"pl-1rem leading-2rem","list-style":"disc"})]}),_:1})]}),_:1},8,["model","rules","disabled"])]}),_:1},8,["modelValue"])])),[[pe,y(tt)],[pe,"正在获取站点防篡改信息，请稍侯","title"]])}}});e("default",z(Ze,[["__scopeId","data-v-28fe5bf0"]]))}}})}();
