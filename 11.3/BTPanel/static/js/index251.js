import{u as e,Q as a,V as s,H as t,n as l,d as c,e as n,f as r,_ as i}from"./utils-lib.js?v=1763689792";import{c as o,s as m,t as u,r as d,W as p,x as v,y as f,A as h,z as b,G as x,e as g,O as y,B as _,C as w,D as S,M as C,L as M,bb as k,F as j,b1 as T,R as D,H as B,b2 as z,bA as H,be as P,bz as L}from"./base-lib.js?v=1763689792";import{B as O}from"./firewall.js?v=1763689792";import{S as E}from"./useController5.js?v=1763689792";import{p as V}from"./validator.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./site.js?v=1763689792";import"./column.js?v=1763689792";import"./index110.js?v=1763689792";import"./useStore4.js?v=1763689792";import"./useController6.js?v=1763689792";import"./useMethod5.js?v=1763689792";import"./index107.js?v=1763689792";const A={class:"p-[2rem]"},I={class:"head mb-[4rem]"},Z={class:"scan-header flex flex-row flex-wrap items-center justify-between"},F={class:"flex flex-row flex-wrap justify-center items-center"},R={key:0,class:"relative scan-header-cont"},W={key:0,class:"animate-spin absolute top-0 border-primary border-b-2 rounded-full h-full w-full bg-#cccccc00"},q={class:"scan-header-cont flex justify-between flex-col px-[2rem]"},N=["innerHTML"],G={class:"scan-subtitle text-medium mt-[1.2rem]"},K={class:"scan-header-cont justify-end relative"},Q={class:"text-[1.5rem]"},U={class:"content"},X={key:0,class:"info"},Y={class:"webedit-con flex items-center justify-center"},J={class:"thumbnail-introduce mt-[0rem]"},$={key:1,class:"scan"},ee={key:0,class:"scan-success border-[0.1rem] p-[2rem] h-[49rem] border-light flex items-center justify-center"},ae={class:"flex flex-column items-center"},se={key:1,class:"scan-dangerous"},te={class:"flex items-center"},le={class:"w-[26rem] flex items-center justify-start"},ce={class:"ml-[1.2rem]"},ne={class:"flex items-center justify-between w-full"},re={class:"flex items-center ml-[1.2rem]"},ie={class:"text-tertiary ml-[1.2rem]"},oe={class:"bg-[#f6f6f6] text-tertiary p-[2rem] ml-[1.2rem]"},me={class:"mt-[1.2rem] ml-[2rem]"},ue={class:"flex items-center"},de=i(o({__name:"index",props:{compData:{default:()=>({isSiteModule:!1})}},setup(i){const o=i,{scanData:de}=m(E()),{payment:pe}=e(),{authType:ve}=u(pe.value),fe=d(!0),he=d(!1),be=d({scanTitle:"立即进行漏洞扫描，确保您的网站安全。",scanTime:"您还未进行漏洞扫描!",scanCheckButton:"立即扫描"}),xe=d(["1"]),ge=p([]),ye={4:["danger","严重"],3:["warning","高危"],2:["info","中危"],1:["success","低危"]},_e=d("success"),we=d(!1),Se=async()=>{if("ltd"!==ve.value)return V({sourceId:19});_e.value="loading",be.value.scanTitle="正在扫描中，请稍后...";try{const{data:e}=await a({request:O(),loading:we});if(be.value.scanTitle="扫描完成",be.value.scanTime="扫描时间：".concat(s(e.time)),be.value.scanCheckButton="重新检测",fe.value=!1,e.info.length?(he.value=!1,ge.value=e.info,_e.value="danger",be.value.scanCheckButton="重新检测",be.value.scanTitle="全部【".concat(e.site_num,"个】网站存在风险项<span class='text-danger'>").concat(e.loophole_num,"</span>个")):(he.value=!0,be.value.scanTitle="当前网站没有风险项"),!1!==(null==e?void 0:e.status)&&!0===o.compData.isSiteModule){const{useSitePhpStore:a}=await t(()=>import("./useController5.js?v=1763689792").then(e=>e.w),__vite__mapDeps([]),import.meta.url),{scanData:s}=a();Object.assign(s.value,e)}}catch(e){_e.value="success"}},Ce=()=>l({title:"设置自动扫描",area:54,component:()=>t(()=>import("./index481.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),showFooter:!0});return(()=>{const{loophole_num:e,site_num:a,time:t}=de.value;o.compData.isSiteModule&&(de.value.loophole_num>0?(_e.value="danger",be.value.scanTitle="<span class='text-danger'>".concat(e,"</span>个高危网站漏洞待处理！ 总扫描网站数量").concat(a,"个"),be.value.scanTime="上一次扫描时间:".concat(s(t)),be.value.scanCheckButton="立即查看"):(be.value.scanTitle="未扫描到网站漏洞，总扫描网站数量".concat(a,"个"),be.value.scanTime="上一次扫描时间:".concat(s(t)),be.value.scanCheckButton="重新检测",_e.value="success"))})(),(e,a)=>{const s=c,t=n,l=B,o=z,m=r,u=P,d=L,p=H;return v(),f("div",A,[h("div",I,[h("div",Z,[h("div",F,["loading"==b(_e)?(v(),f("div",R,[b(we)?(v(),f("div",W)):x("",!0),g(s,{icon:"scanning-scan",size:60,color:"#20a53a"})])):x("",!0),"success"==b(_e)?(v(),y(s,{key:1,icon:"scanning-success",size:80,color:"#20a53a"})):x("",!0),"danger"==b(_e)?(v(),y(s,{key:2,icon:"scanning-danger",size:80,color:"#ef0808"})):x("",!0),h("div",q,[h("div",{class:"scan-title text-extraLarge font-bold",innerHTML:b(be).scanTitle},null,8,N),h("div",G,_(b(be).scanTime),1)])]),h("div",K,[g(t,{class:"btlink setScanAlarm absolute top-[6rem] right-1rem",onClick:Ce},{default:w(()=>[...a[1]||(a[1]=[S(" 自动扫描>> ",-1)])]),_:1}),g(l,{class:"scan-btn h-[4rem] w-[10rem]",type:"loading"==b(_e)?"default":"primary",size:"large",onClick:Se},{default:w(()=>[h("span",Q,_(b(be).scanCheckButton),1)]),_:1},8,["type"])])])]),g(o,{class:"!mt-0"}),h("div",U,[b(fe)?(v(),f("div",X,[h("div",Y,[g(m,{style:C(i.compData.isSiteModule?"width:40rem":""),src:i.compData.isSiteModule?"/preview/site_scanning.png":"/firewall/safe_detect_scanning.png",class:M(i.compData.isSiteModule?"!w-[34rem] mr-[4rem]":"max-w-[90rem] mr-[4rem]")},null,8,["style","src","class"]),h("div",J,[a[3]||(a[3]=h("span",{class:"text-large font-bold"},"漏洞扫描工具介绍：",-1)),h("ul",{class:M(["block leading-[3rem] mx-[2rem] list-square mt-[2rem]",i.compData.isSiteModule?"text-small":"text-medium"])},[...a[2]||(a[2]=[k("<li data-v-63449881> 可识别多款开源CMS程序，支持如下： <br data-v-63449881> 迅睿CMS、pbootcms、苹果CMS、eyoucms、 <br data-v-63449881> 海洋CMS、ThinkCMF、zfaka、dedecms、 <br data-v-63449881> MetInfo、emlog、帝国CMS、discuz、 <br data-v-63449881> Thinkphp、Wordpress、Z-Blog、极致CMS、 <br data-v-63449881> ShopXO、HYBBS、ECShop、SchoolCMS、 <br data-v-63449881> phpcms、likeshop、iCMS、WellCMS、 <br data-v-63449881> chanzhiEPS、PHPOK、LaySNS、骑士CMS、 <br data-v-63449881> openSNS、齐博CMS、ZZZCMS、prestashop、 <br data-v-63449881> ThinkphpSHOP、DouPHP、cmseasy、 <br data-v-63449881> piwigo、phpwind、行云海CMS </li><li data-v-63449881>可扫描网站中存在的漏洞</li><li data-v-63449881>提供修复/提供付费解决方案</li>",3)])],2)])])])):(v(),f("div",$,[b(he)?(v(),f("div",ee,[h("div",ae,[g(m,{src:"/firewall/secure.png",class:"w-[34.0rem] h-[30.1rem]"}),a[4]||(a[4]=h("span",{class:"absolute mt-[10.5rem] text-extraLarge leading-[0.14rem]"}," 当前处于【安全状态】，请继续保持！ ",-1))])])):(v(),f("div",se,[a[7]||(a[7]=h("div",{class:"flex items-center mb-[2rem] text-default"},[h("span",{class:"w-[26rem]"},"网站"),h("span",null,"类型")],-1)),h("div",{class:M(i.compData.isSiteModule?"overflow-auto h-[42rem]":"")},[g(p,{modelValue:b(xe),"onUpdate:modelValue":a[0]||(a[0]=e=>D(xe)?xe.value=e:null),accordion:""},{default:w(()=>[(v(!0),f(j,null,T(b(ge),(e,s)=>(v(),y(d,{key:s},{title:w(()=>[h("div",te,[h("div",le,[g(u,{type:e.cms.length>0?"warning":"success",effect:"dark"},{default:w(()=>[S(_(e.cms.length)+"项 ",1)]),_:2},1032,["type"]),h("span",ce,_(e.name),1)]),h("span",null,_(e.cms_name+"--"+e.version_info),1),a[5]||(a[5]=h("div",{class:"text-secondary text-small ml-[6rem]"},"无法自动修复,请在网站后台更新该软件版本。",-1))])]),default:w(()=>[g(p,{accordion:""},{default:w(()=>[(v(!0),f(j,null,T(e.cms,(e,s)=>(v(),y(d,{key:s},{title:w(()=>[h("div",ne,[h("div",re,[g(u,{type:ye[e.dangerous][0]},{default:w(()=>[S(_(ye[e.dangerous][1]),1)]),_:2},1032,["type"]),h("span",ie,_(e.ps),1)]),g(t,{class:"mb-[.2rem] mr-[1.6rem]"},{default:w(()=>[...a[6]||(a[6]=[S("详情",-1)])]),_:1})])]),default:w(()=>[h("div",oe,"修复建议："+_(e.repair),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"])],2)]))])),h("div",me,[h("div",ue,[a[9]||(a[9]=S(" 如需支持其他cms程序，请发帖反馈： ",-1)),g(t,{href:"https://www.bt.cn/bbs/thread-89149-1-1.html"},{default:w(()=>[...a[8]||(a[8]=[S(" https://www.bt.cn/bbs/thread-89149-1-1.html ",-1)])]),_:1})])])])])}}}),[["__scopeId","data-v-63449881"]]);export{de as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
