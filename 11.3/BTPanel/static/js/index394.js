import{c as e,r as l,g as a,v as t,a8 as s,x as o,O as d,C as n,e as r,A as m,z as i,J as p,K as u,y as c,B as f,G as _,L as y,D as b,b1 as h,F as V,a1 as v,ad as x,am as g,an as w,al as k,aj as j,ak as U,V as C,H as F}from"./base-lib.js?v=1763689792";import{_ as P}from"./index107.js?v=1763689792";import{L as z,cf as T,k as E,e as M,d as A,N as H}from"./utils-lib.js?v=1763689792";import{p as I,s as q,i as B,$ as D,a as J,o as L,g as O,e as $,b as G,c as K,d as N,f as S,h as Q,u as R,j as W,k as X}from"./index78.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index109.js?v=1763689792";import"./index147.js?v=1763689792";import"./index131.js?v=1763689792";import"./validator.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./index.vue_vue_type_style_index_0_scoped_cdc7f4d3_lang.js?v=1763689792";import"./useController6.js?v=1763689792";import"./site.js?v=1763689792";import"./useStore4.js?v=1763689792";const Y={class:"flex items-center"},Z={key:0,class:"absolute top-[26px] text-small text-[red]"},ee={class:"flex items-center"},le={class:"text-small text-tertiary flex items-center justify-center"},ae=["title"],te={key:0,class:"absolute top-[50%] right-[-1rem] translate-y-[-50%] flex items-center"},se={class:"text-small text-tertiary truncate max-w-[6rem]"},oe={class:"text-small text-tertiary"},de={class:"flex items-center"},ne={class:"truncate text-medium max-w-[13rem]"},re={class:"text-small text-tertiary mt-[.5rem]"},me={class:"text-small ml-8px"},ie={class:"mt-[1.6rem]"},pe={class:"mt-[1.6rem]"},ue={class:"flex"},ce={key:2,class:"my-[20px]"},fe={class:"flex items-center"},_e={class:"ml-[1rem] text-primary w-[16rem] select-none"},ye={class:"pt-[0]"},be=e({__name:"index",setup(e,{expose:be}){const he=l(!1),{BtForm:Ve,submit:ve}=z({data:I.value,options:e=>a(()=>[{type:"slots",key:"custom",rules:{pjname:[T({message:"请输入项目名称"})],port:[{validator:(e,l,a)=>{"command"!==I.value.stype&&(!/^\d+$/.test(l)||l<0||l>65535)?I.value.listenMsg?a(new Error(" ")):a(new Error("端口号范围为0-65535")):a()},tirgger:["blur","change"]}],path:[T({message:"请选择路径"})],processes:[T({message:"请输入进程数"})],threads:[T({message:"请输入线程数"})],python_bin:[T({message:"请选择Python环境"})],parm:[{validator:(e,l,a)=>{"command"===I.value.stype&&""===l?a(new Error("请输入启动命令")):a()},tirgger:["blur","change"]}]}}]),submit:async(e,l)=>(await l(),await q(e.value))});return t(()=>{B()}),s(D),be({onConfirm:ve}),(e,l)=>{const a=E,t=x,s=g,z=w,T=M,q=k,B=j,D=A,be=H,xe=P,ge=U,we=C,ke=F;return o(),d(i(Ve),{"label-width":"100px",class:"p-2rem"},{custom:n(()=>[r(t,{label:"项目名称",prop:"pjname"},{default:n(()=>[m("div",Y,[r(a,{disabled:i(J),width:"22rem",modelValue:i(I).pjname,"onUpdate:modelValue":l[0]||(l[0]=e=>i(I).pjname=e),placeholder:"请输入Python项目名称"},null,8,["disabled","modelValue"]),p(r(t,{label:"项目端口",prop:"port","label-width":"7rem"},{default:n(()=>[r(a,{width:"18rem",type:"number",modelValue:i(I).port,"onUpdate:modelValue":l[1]||(l[1]=e=>i(I).port=e),placeholder:"项目的真实端口"},null,8,["modelValue"]),i(I).listenMsg&&"command"!==i(I).stype?(o(),c("div",Z,f(i(I).listenMsg),1)):_("",!0)]),_:1},512),[[u,"command"!==i(I).stype]])])]),_:1}),r(t,{label:"Python环境",prop:"python_bin"},{default:n(()=>[m("div",ee,[m("div",{class:y(["flex items-center",i(J)?"":"custom-refresh-select"])},[r(z,{modelValue:i(I).python_bin,"onUpdate:modelValue":l[3]||(l[3]=e=>i(I).python_bin=e),filterable:"",class:"!w-[24rem]","popper-class":"env-select",disabled:i(J)},{empty:n(()=>[m("div",le,[l[24]||(l[24]=b("暂无Python环境,",-1)),m("span",{class:"bt-link",onClick:l[2]||(l[2]=e=>i(L)(i(O)))},"点击添加")])]),default:n(()=>[(o(!0),c(V,null,h(i($),e=>(o(),d(s,{key:e.bin_path,value:e.bin_path,label:e.name},{default:n(()=>[m("div",{class:"relative pt-[1rem]",title:e.name},[e.project_name.length?(o(),c("div",te,[m("span",se,f(e.project_name[0]),1),m("span",oe,f("等".concat(e.project_name.length,"个项目正在使用")),1)])):_("",!0),m("div",de,[m("div",ne,f(e.name),1),m("span",{class:y(["text-small ml-[8px] px-[.5rem] rounded-base border","tag-".concat(e.type)])},f(i(X)(e.type)),3)]),m("div",re,f(e.version),1)],8,ae)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","disabled"])],2),m("span",me,[l[26]||(l[26]=b(" * 如需添加Python环境，请点击",-1)),r(T,{onClick:l[4]||(l[4]=e=>i(L)(i(O)))},{default:n(()=>[...l[25]||(l[25]=[b("环境管理",-1)])]),_:1})])])]),_:1}),r(t,{label:"启动方式"},{default:n(()=>[r(B,{modelValue:i(I).stype,"onUpdate:modelValue":l[5]||(l[5]=e=>i(I).stype=e)},{default:n(()=>[r(q,{label:"command"},{default:n(()=>[...l[27]||(l[27]=[b("命令行启动",-1)])]),_:1}),r(q,{label:"uwsgi"},{default:n(()=>[...l[28]||(l[28]=[b("uwsgi",-1)])]),_:1}),r(q,{label:"gunicorn"},{default:n(()=>[...l[29]||(l[29]=[b("gunicorn",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),r(t,{label:"项目路径",prop:"path"},{default:n(()=>[r(a,{width:"42rem","icon-type":!i(J)&&"folder",disabled:i(J),placeholder:"项目的根路径",onFolder:i(G),onChange:i(K),modelValue:i(I).path,"onUpdate:modelValue":l[6]||(l[6]=e=>i(I).path=e)},v({_:2},[i(J)?void 0:{name:"append",fn:n(()=>[r(be,{onClick:i(G)},{default:n(()=>[r(D,{icon:"el-folder-opened",class:"cursor-pointer"})]),_:1},8,["onClick"])]),key:"0"}]),1032,["icon-type","disabled","onFolder","onChange","modelValue"])]),_:1}),p(m("div",{class:"mt-[1rem] ml-[12rem]"},"当前框架："+f(i(I).framework),513),[[u,i(I).framework]]),p(m("div",ie,[r(t,{label:"启动命令",prop:"parm"},{default:n(()=>[r(a,{modelValue:i(I).parm,"onUpdate:modelValue":l[7]||(l[7]=e=>i(I).parm=e),placeholder:"请输入启动命令",width:"42rem"},null,8,["modelValue"])]),_:1})],512),[[u,"command"===i(I).stype]]),p(m("div",pe,[r(t,{label:"入口文件"},{default:n(()=>[r(xe,{placeholder:"项目的入口文件",modelValue:i(I).rfile,"onUpdate:modelValue":l[8]||(l[8]=e=>i(I).rfile=e),icon:"el-folder-opened",onIconClick:l[9]||(l[9]=e=>i(N)(i(I))),onChange:l[10]||(l[10]=e=>i(S)(i(I))),width:"42rem"},null,8,["modelValue"])]),_:1}),r(t,{label:"通讯协议"},{default:n(()=>[m("div",ue,[r(z,{modelValue:i(I).xsgi,"onUpdate:modelValue":l[11]||(l[11]=e=>i(I).xsgi=e),class:"!w-[15rem]"},{default:n(()=>[r(s,{label:"wsgi",value:"wsgi"}),r(s,{label:"asgi",value:"asgi"})]),_:1},8,["modelValue"]),r(t,{label:"应用名称"},{default:n(()=>[r(a,{modelValue:i(I).app,"onUpdate:modelValue":l[12]||(l[12]=e=>i(I).app=e),placeholder:"请输入应用名称",width:"22rem"},null,8,["modelValue"])]),_:1})])]),_:1})],512),[[u,"command"!==i(I).stype]]),r(t,{label:"环境变量",class:"mt-[1.6rem]"},{default:n(()=>[r(B,{modelValue:i(I).envType,"onUpdate:modelValue":l[13]||(l[13]=e=>i(I).envType=e)},{default:n(()=>[r(ge,{label:0},{default:n(()=>[...l[30]||(l[30]=[b("无",-1)])]),_:1}),r(ge,{label:1},{default:n(()=>[...l[31]||(l[31]=[b("指定变量",-1)])]),_:1}),r(ge,{label:2},{default:n(()=>[...l[32]||(l[32]=[b("从文件加载",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),p(r(t,{label:" "},{default:n(()=>[p(r(a,{width:"40rem",type:"textarea",rows:4,resize:"none",modelValue:i(I).env,"onUpdate:modelValue":l[14]||(l[14]=e=>i(I).env=e),placeholder:"环境变量，1行1个，例如： JAVA_HOME=/usr/local/btjdk/jdk8"},null,8,["modelValue"]),[[u,1===i(I).envType]]),p(r(xe,{modelValue:i(I).envPath,"onUpdate:modelValue":l[15]||(l[15]=e=>i(I).envPath=e),placeholder:"请选择环境变量文件",icon:"el-folder-opened",onIconClick:i(Q),width:"42rem"},null,8,["modelValue","onIconClick"]),[[u,2===i(I).envType]])]),_:1},512),[[u,0!==i(I).envType]]),r(t,{label:"启动用户"},{default:n(()=>[r(z,{modelValue:i(I).user,"onUpdate:modelValue":l[16]||(l[16]=e=>i(I).user=e),class:"!w-[16rem]"},{default:n(()=>[(o(!0),c(V,null,h(i(R),e=>(o(),d(s,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),i(J)?(o(),d(t,{key:0,label:"开机启动"},{default:n(()=>[r(we,{modelValue:i(I).auto_run,"onUpdate:modelValue":l[17]||(l[17]=e=>i(I).auto_run=e)},{default:n(()=>[...l[33]||(l[33]=[b(" 是否设置开机自动启动（默认自带守护进程每120秒检测一次） ",-1)])]),_:1},8,["modelValue"])]),_:1})):_("",!0),i(J)?_("",!0):(o(),d(t,{key:1,label:"安装依赖包"},{default:n(()=>[r(a,{width:"42rem","icon-type":"folder",placeholder:"安装依赖包路径（非必填）",onFolder:i(W),modelValue:i(I).requirement_path,"onUpdate:modelValue":l[18]||(l[18]=e=>i(I).requirement_path=e)},{append:n(()=>[r(be,{onClick:i(W)},{default:n(()=>[r(D,{icon:"el-folder-opened",class:"cursor-pointer"})]),_:1},8,["onClick"])]),_:1},8,["onFolder","modelValue"])]),_:1})),i(J)?(o(),c("div",ce,["command"!=i(I).stype?(o(),d(t,{key:0,label:"进程数",prop:"processes"},{default:n(()=>[m("div",fe,[r(a,{width:"16rem",modelValue:i(I).processes,"onUpdate:modelValue":l[19]||(l[19]=e=>i(I).processes=e)},null,8,["modelValue"]),r(t,{label:"线程数",prop:"threads"},{default:n(()=>[r(a,{width:"16rem",modelValue:i(I).threads,"onUpdate:modelValue":l[20]||(l[20]=e=>i(I).threads=e)},null,8,["modelValue"])]),_:1})])]),_:1})):_("",!0),i(J)&&"uwsgi"===i(I).stype?(o(),d(t,{key:1,label:"通信方式"},{default:n(()=>[r(z,{modelValue:i(I).is_http,"onUpdate:modelValue":l[21]||(l[21]=e=>i(I).is_http=e),class:"w-[16rem]"},{default:n(()=>[r(s,{label:"http",value:!0}),r(s,{label:"socket",value:!1})]),_:1},8,["modelValue"])]),_:1})):_("",!0)])):_("",!0),i(J)?_("",!0):(o(),c(V,{key:3},[m("div",{class:"more flex items-center cursor-pointer pl-[10rem] my-[2rem] px-[2rem]",onClick:l[22]||(l[22]=e=>he.value=!i(he))},[m("i",{class:y(i(he)?"svgtofont-el-arrow-down":"svgtofont-el-arrow-right")},null,2),m("div",_e,f("更多设置，".concat(i(he)?"点击收回":"点击查看")),1)]),p(m("div",ye,[r(t,{label:"项目初始化命令",prop:"initialize"},{default:n(()=>[r(a,{rows:3,modelValue:i(I).initialize,"onUpdate:modelValue":l[23]||(l[23]=e=>i(I).initialize=e),type:"textarea",name:"initialize",width:"42rem",placeholder:"此处填写用于初始化项目的命令或脚本，常见的有项目数据库初始化操作等。例如：django常使用python manage.py makemigrations 和 python manage.py migrate 初始化数据库"},null,8,["modelValue"])]),_:1})],512),[[u,i(he)]]),l[34]||(l[34]=m("ul",{class:"mt-[20px] leading-8 text-small list-disc ml-48px"},[m("li",null,"执行命令：请输入项目需要携带的参数，默认请输入执行文件名"),m("li",null,[b(" 通讯协议：wsgi：同步通讯，一次处理一个请求， asgi：异步处理，并发处理请求 "),m("br"),b(" 根据项目情况具体选择，例如: 传统Flask就是wsgi, Fastapi框架就是asgi, Django两者都可以支持 ")]),m("li",null,"项目初始化命令：初始化脚本会在创建虚拟环境，安装依赖库之后执行")],-1))],64)),i(J)?(o(),d(t,{key:4,label:" "},{default:n(()=>[r(ke,{type:"primary",onClick:i(ve)},{default:n(()=>[...l[35]||(l[35]=[b("保存配置",-1)])]),_:1},8,["onClick"])]),_:1})):_("",!0)]),_:1})}}});export{be as default};
