!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function n(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",s=a.toStringTag||"@@toStringTag";function o(n,a,c,s){var o=a&&a.prototype instanceof l?a:l,u=Object.create(o.prototype);return r(u,"_invoke",function(n,r,a){var c,s,o,l=0,u=a||[],f=!1,d={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return c=t,s=0,o=e,d.n=n,i}};function m(n,r){for(s=n,o=r,t=0;!f&&l&&!a&&t<u.length;t++){var a,c=u[t],m=d.p,v=c[2];n>3?(a=v===r)&&(o=c[(s=c[4])?5:(s=3,3)],c[4]=c[5]=e):c[0]<=m&&((a=n<2&&m<c[1])?(s=0,d.v=r,d.n=c[1]):m<v&&(a=n<3||c[0]>r||r>v)&&(c[4]=n,c[5]=r,d.n=v,s=0))}if(a||n>1)return i;throw f=!0,r}return function(a,u,v){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&m(u,v),s=u,o=v;(t=s<2?e:o)||!f;){c||(s?s<3?(s>1&&(d.n=-1),m(s,o)):d.n=o:d.v=o);try{if(l=2,c){if(s||(a="next"),t=c[a]){if(!(t=t.call(c,o)))throw TypeError("iterator result is not an object");if(!t.done)return t;o=t.value,s<2&&(s=0)}else 1===s&&(t=c.return)&&t.call(c),s<2&&(o=TypeError("The iterator does not provide a '"+a+"' method"),s=1);c=e}else if((t=(f=d.n<0)?o:n.call(r,d))!==i)break}catch(t){c=e,s=1,o=t}finally{l=1}}return{value:t,done:f}}}(n,c,s),!0),u}var i={};function l(){}function u(){}function f(){}t=Object.getPrototypeOf;var d=[][c]?t(t([][c]())):(r(t={},c,function(){return this}),t),m=f.prototype=l.prototype=Object.create(d);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,r(e,s,"GeneratorFunction")),e.prototype=Object.create(m),e}return u.prototype=f,r(m,"constructor",f),r(f,"constructor",u),u.displayName="GeneratorFunction",r(f,s,"GeneratorFunction"),r(m),r(m,s,"Generator"),r(m,c,function(){return this}),r(m,"toString",function(){return"[object Generator]"}),(n=function(){return{w:o,m:v}})()}function r(e,t,n,a){var c=Object.defineProperty;try{c({},"",{})}catch(e){c=0}r=function(e,t,n,a){function s(t,n){r(e,t,function(e){return this._invoke(t,n,e)})}t?c?c(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(s("next",0),s("throw",1),s("return",2))},r(e,t,n,a)}function a(e,t,n,r,a,c,s){try{var o=e[c](s),i=o.value}catch(e){return void n(e)}o.done?t(i):Promise.resolve(i).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,c){var s=e.apply(t,n);function o(e){a(s,r,c,o,i,"next",e)}function i(e){a(s,r,c,o,i,"throw",e)}o(void 0)})}}System.register(["./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./index-legacy344.js?v=1763689792","./firewall-legacy.js?v=1763689792","./validator-legacy.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./column-legacy.js?v=1763689792","./index-legacy107.js?v=1763689792"],function(t,r){"use strict";var a,s,o,i,l,u,f,d,m,v,p,y,b,h,g,w,x,S,k,_,j,T,C,M,O,P,A,B,H,z,G,E,F,D,I,L,V;return{setters:[function(e){a=e.u,s=e.Q,o=e.V,i=e.H,l=e.n,u=e.d,f=e.e,d=e.f,m=e._},function(e){v=e.c,p=e.s,y=e.t,b=e.r,h=e.W,g=e.w,w=e.x,x=e.y,S=e.A,k=e.z,_=e.G,j=e.e,T=e.O,C=e.B,M=e.C,O=e.D,P=e.bb,A=e.F,B=e.b1,H=e.R,z=e.H,G=e.b2,E=e.be,F=e.bz,D=e.bA},function(e){I=e.H},function(e){L=e.B},function(e){V=e.dg},null,null,null,null],execute:function(){var Z={class:"p-[1rem]"},N={class:"head mb-[2rem]"},W={class:"scan-header flex flex-row flex-wrap items-center justify-between"},q={class:"flex flex-row flex-wrap justify-center items-center"},U={key:0,class:"relative scan-header-cont"},K={key:0,class:"animate-spin absolute top-0 border-primary border-b-2 rounded-full h-full w-full"},Q={class:"scan-header-cont flex justify-between flex-col px-[2rem]"},R=["innerHTML"],X={class:"scan-subtitle text-medium mt-[1.2rem]"},Y={class:"scan-header-cont justify-end relative"},$={class:"text-base"},J={class:"content"},ee={key:0,class:"info"},te={class:"webedit-con flex items-center justify-center"},ne={key:1,class:"scan"},re={key:0,class:"scan-success border-[0.1rem] p-[2rem] h-[38rem] border-light flex items-center justify-center"},ae={class:"flex flex-column items-center"},ce={key:1,class:"scan-dangerous"},se={class:"overflow-auto h-[36rem]"},oe={class:"flex items-center"},ie={class:"w-[26rem] flex items-center justify-start"},le={class:"ml-[1.2rem]"},ue={class:"flex items-center justify-between w-full"},fe={class:"flex items-center ml-[1.2rem]"},de={class:"text-tertiary ml-[1.2rem]"},me={class:"bg-light text-tertiary p-[2rem] ml-[1.2rem]"},ve={class:"mt-[1.2rem] ml-[2rem]"},pe={class:"flex items-center"},ye=v({__name:"web",props:{compData:{default:function(){return{isSiteModule:!1}}}},setup:function(t){var m=t,v=a().payment,ye=I(),be=p(ye).repairTypeActive,he=y(v.value).authType,ge=b(!0),we=b(!1),xe=b({scanTitle:"立即进行漏洞扫描，确保您的网站安全。",scanTime:"您还未进行漏洞扫描!",scanCheckButton:"立即扫描"}),Se=b(["1"]),ke=h([]),_e={4:["danger","严重"],3:["warning","高危"],2:["info","中危"],1:["success","低危"]},je=b("success"),Te=b(!1),Ce=function(){var e=c(n().m(function e(){var t,a,c,l,u,f;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if("ltd"===he.value){e.n=1;break}return e.a(2,ye.openPayView());case 1:return je.value="loading",xe.value.scanTitle="正在扫描中，请稍后...",e.p=2,e.n=3,s({request:L(),loading:Te});case 3:if(t=e.v,a=t.data,xe.value.scanTitle="扫描完成",xe.value.scanTime="扫描时间：".concat(o(a.time)),xe.value.scanCheckButton="重新检测",ge.value=!1,a.info.length?(we.value=!1,ke.value=a.info,je.value="danger",xe.value.scanCheckButton="重新检测",xe.value.scanTitle="全部【".concat(a.site_num,"个】网站存在风险项<span class='text-danger'>").concat(a.loophole_num,"</span>个")):(we.value=!0,xe.value.scanTitle="当前网站没有风险项"),a.loophole_num!==ye.tootipTotal.web&&ye.getScanTotal(),!1===(null==a?void 0:a.status)){e.n=6;break}e.n=true===m.compData.isSiteModule?4:6;break;case 4:return e.n=5,i(function(){return r.import("./useController-legacy5.js?v=1763689792").then(function(e){return e.w})},void 0,r.meta.url);case 5:return c=e.v,l=c.useSitePhpStore,u=l(),f=u.scanData,Object.assign(f.value,a),e.a(3,6);case 6:e.n=8;break;case 7:e.p=7,e.v,je.value="success";case 8:return e.p=8,e.f(8);case 9:return e.a(2)}},e,null,[[2,7,8,9]])}));return function(){return e.apply(this,arguments)}}(),Me=function(){var e=c(n().m(function e(){var t,r,a,c,s,o;return n().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,V();case 1:t=e.v,r=t.data,a=r.data,c=a.loophole_num,s=a.site_num,o=a.time,c>0?(xe.value.scanTitle="<span class='text-danger'>".concat(c,"</span>个高危网站漏洞待处理！ 总扫描网站数量").concat(s,"个"),xe.value.scanTime="上一次扫描时间:".concat(o),je.value="danger",xe.value.scanCheckButton="立即查看"):(xe.value.scanTitle="未扫描到网站漏洞，总扫描网站数量".concat(s,"个"),xe.value.scanTime="上一次扫描时间:".concat(o),xe.value.scanCheckButton="重新检测",je.value="success");case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();g(be,function(e){"web"===e&&Me()});var Oe=function(){return l({title:"设置自动扫描",area:54,component:function(){return i(function(){return r.import("./index-legacy523.js?v=1763689792")},void 0,r.meta.url)},showFooter:!0})};return function(t,n){var r=u,a=f,c=z,s=G,o=d,i=E,l=F,m=D;return w(),x("div",null,[n[9]||(n[9]=S("div",{class:"text-large mb-6"},"网站漏洞检测",-1)),S("div",Z,[S("div",N,[S("div",W,[S("div",q,["loading"==k(je)?(w(),x("div",U,[k(Te)?(w(),x("div",K)):_("",!0),j(r,{icon:"scanning-scan",size:60,color:"var(--el-color-primary)"})])):_("",!0),"success"==k(je)?(w(),T(r,{key:1,icon:"scanning-success",size:60,color:"var(--el-color-primary)"})):_("",!0),"danger"==k(je)?(w(),T(r,{key:2,icon:"scanning-danger",size:60,color:"#ef0808"})):_("",!0),S("div",Q,[S("div",{class:"scan-title text-extraLarge font-bold",innerHTML:k(xe).scanTitle},null,8,R),S("div",X,C(k(xe).scanTime),1)])]),S("div",Y,[j(a,{class:"btlink setScanAlarm absolute top-[5rem] right-1rem",onClick:Oe},{default:M(function(){return e(n[1]||(n[1]=[O(" 自动扫描>> ",-1)]))}),_:1}),j(c,{class:"scan-btn h-[4rem] w-[10rem]",type:"loading"==k(je)?"default":"primary",size:"large",onClick:Ce},{default:M(function(){return[S("span",$,C(k(xe).scanCheckButton),1)]}),_:1},8,["type"])])])]),j(s,{class:"!mt-0"}),S("div",J,[k(ge)?(w(),x("div",ee,[S("div",te,[j(o,{class:"max-w-[90rem] mr-[4rem] w-[36rem]",src:"/preview/site_scanning.png"}),n[2]||(n[2]=P('<div class="thumbnail-introduce mt-[0rem]" data-v-95e8545a><span class="text-large font-bold" data-v-95e8545a>漏洞扫描工具介绍：</span><ul class="block leading-[2.6rem] mx-[2rem] list-square mt-[2rem]" data-v-95e8545a><li data-v-95e8545a> 可识别多款开源CMS程序，支持如下： <br data-v-95e8545a> 迅睿CMS、pbootcms、苹果CMS、eyoucms、海洋CMS、 <br data-v-95e8545a> ThinkCMF、zfaka、dedecms、MetInfo、emlog、 <br data-v-95e8545a>帝国CMS、discuz、Thinkphp、Wordpress、Z-Blog、 <br data-v-95e8545a>极致CMS、ShopXO、HYBBS、ECShop、SchoolCMS、 <br data-v-95e8545a>phpcms、likeshop、iCMS、WellCMS、chanzhiEPS、 <br data-v-95e8545a>PHPOK、LaySNS、骑士CMS、openSNS、齐博CMS、 <br data-v-95e8545a>ZZZCMS、prestashop、ThinkphpSHOP、DouPHP、 <br data-v-95e8545a>cmseasy、piwigo、phpwind、行云海CMS </li><li data-v-95e8545a>可扫描网站中存在的漏洞</li><li data-v-95e8545a>提供修复/提供付费解决方案</li></ul></div>',1))])])):(w(),x("div",ne,[k(we)?(w(),x("div",re,[S("div",ae,[j(o,{src:"/firewall/secure.png",class:"w-[34.0rem] h-[30.1rem]"}),n[3]||(n[3]=S("span",{class:"absolute mt-[10.5rem] text-extraLarge leading-[0.14rem]"}," 当前处于【安全状态】，请继续保持！ ",-1))])])):(w(),x("div",ce,[n[6]||(n[6]=S("div",{class:"flex items-center mb-[2rem] text-default"},[S("span",{class:"w-[26rem]"},"网站"),S("span",null,"类型")],-1)),S("div",se,[j(m,{modelValue:k(Se),"onUpdate:modelValue":n[0]||(n[0]=function(e){return H(Se)?Se.value=e:null}),accordion:""},{default:M(function(){return[(w(!0),x(A,null,B(k(ke),function(t,r){return w(),T(l,{key:r},{title:M(function(){return[S("div",oe,[S("div",ie,[j(i,{type:t.cms.length>0?"warning":"success",effect:"dark"},{default:M(function(){return[O(C(t.cms.length)+"项 ",1)]}),_:2},1032,["type"]),S("span",le,C(t.name),1)]),S("span",null,C(t.cms_name+"--"+t.version_info),1),n[4]||(n[4]=S("div",{class:"text-secondary text-small ml-[6rem]"},"无法自动修复,请在网站后台更新该软件版本。",-1))])]}),default:M(function(){return[j(m,{accordion:""},{default:M(function(){return[(w(!0),x(A,null,B(t.cms,function(t,r){return w(),T(l,{key:r},{title:M(function(){return[S("div",ue,[S("div",fe,[j(i,{type:_e[t.dangerous][0]},{default:M(function(){return[O(C(_e[t.dangerous][1]),1)]}),_:2},1032,["type"]),S("span",de,C(t.ps),1)]),j(a,{class:"mb-[.2rem] mr-[1.6rem]"},{default:M(function(){return e(n[5]||(n[5]=[O("详情",-1)]))}),_:1})])]}),default:M(function(){return[S("div",me,"修复建议："+C(t.repair),1)]}),_:2},1024)}),128))]}),_:2},1024)]}),_:2},1024)}),128))]}),_:1},8,["modelValue"])])]))])),S("div",ve,[S("div",pe,[n[8]||(n[8]=O(" 如需支持其他cms程序，请发帖反馈： ",-1)),j(a,{href:"https://www.bt.cn/bbs/thread-89149-1-1.html"},{default:M(function(){return e(n[7]||(n[7]=[O(" https://www.bt.cn/bbs/thread-89149-1-1.html ",-1)]))}),_:1})])])])])])}}});t("default",m(ye,[["__scopeId","data-v-95e8545a"]]))}}})}();
