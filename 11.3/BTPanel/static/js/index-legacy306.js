!function(){function t(r){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(r)}function r(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(t){if("string"==typeof t)return e(t,r);var o={}.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?e(t,r):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,o=Array(r);e<r;e++)o[e]=t[e];return o}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,r,e="function"==typeof Symbol?Symbol:{},s=e.iterator||"@@iterator",a=e.toStringTag||"@@toStringTag";function i(e,o,s,a){var i=o&&o.prototype instanceof l?o:l,u=Object.create(i.prototype);return n(u,"_invoke",function(e,o,n){var s,a,i,l=0,u=n||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(r,e){return s=r,a=0,i=t,p.n=e,c}};function d(e,o){for(a=e,i=o,r=0;!f&&l&&!n&&r<u.length;r++){var n,s=u[r],d=p.p,y=s[2];e>3?(n=y===o)&&(i=s[(a=s[4])?5:(a=3,3)],s[4]=s[5]=t):s[0]<=d&&((n=e<2&&d<s[1])?(a=0,p.v=o,p.n=s[1]):d<y&&(n=e<3||s[0]>o||o>y)&&(s[4]=e,s[5]=o,p.n=y,a=0))}if(n||e>1)return c;throw f=!0,o}return function(n,u,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&d(u,y),a=u,i=y;(r=a<2?t:i)||!f;){s||(a?a<3?(a>1&&(p.n=-1),d(a,i)):p.n=i:p.v=i);try{if(l=2,s){if(a||(n="next"),r=s[n]){if(!(r=r.call(s,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,a<2&&(a=0)}else 1===a&&(r=s.return)&&r.call(s),a<2&&(i=TypeError("The iterator does not provide a '"+n+"' method"),a=1);s=t}else if((r=(f=p.n<0)?i:e.call(o,p))!==c)break}catch(r){s=t,a=1,i=r}finally{l=1}}return{value:r,done:f}}}(e,s,a),!0),u}var c={};function l(){}function u(){}function f(){}r=Object.getPrototypeOf;var p=[][s]?r(r([][s]())):(n(r={},s,function(){return this}),r),d=f.prototype=l.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,n(t,a,"GeneratorFunction")),t.prototype=Object.create(d),t}return u.prototype=f,n(d,"constructor",f),n(f,"constructor",u),u.displayName="GeneratorFunction",n(f,a,"GeneratorFunction"),n(d),n(d,a,"Generator"),n(d,s,function(){return this}),n(d,"toString",function(){return"[object Generator]"}),(o=function(){return{w:i,m:y}})()}function n(t,r,e,o){var s=Object.defineProperty;try{s({},"",{})}catch(t){s=0}n=function(t,r,e,o){function a(r,e){n(t,r,function(t){return this._invoke(r,e,t)})}r?s?s(t,r,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[r]=e:(a("next",0),a("throw",1),a("return",2))},n(t,r,e,o)}function s(t,r,e,o,n,s,a){try{var i=t[s](a),c=i.value}catch(t){return void e(t)}i.done?r(c):Promise.resolve(c).then(o,n)}function a(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),e.push.apply(e,o)}return e}function i(r,e,o){return(e=function(r){var e=function(r,e){if("object"!=t(r)||!r)return r;var o=r[Symbol.toPrimitive];if(void 0!==o){var n=o.call(r,e||"default");if("object"!=t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(r)}(r,"string");return"symbol"==t(e)?e:e+""}(e))in r?Object.defineProperty(r,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[e]=o,r}System.register(["./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./firewall-legacy.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792"],function(t,e){"use strict";var n,c,l,u,f,p,d,y,v,g,m,b,w,h,_,k,S,O,j,E,x,T,P,C,A,D,G,I,F,M;return{setters:[function(t){n=t.fJ,c=t.V,l=t.aK,u=t.f,f=t.e,p=t.ay,d=t._},function(t){y=t.c,v=t.r,g=t.o,m=t.g,b=t.v,w=t.I,h=t.J,_=t.z,k=t.x,S=t.y,O=t.A,j=t.L,E=t.O,x=t.F,T=t.e,P=t.D,C=t.B,A=t.G,D=t.C,G=t.b1,I=t.b6,F=t.H},function(t){M=t.aa},null],execute:function(){var e={id:"safeDetectList"},H={class:"progress-header"},J={class:"progress-header-cot"},N={key:0,class:"relative"},L={class:"absolute top-[1.6rem] left-[2.6rem] flex flex-col"},z={class:"progress-header-cot"},B={class:"scanning-progress-title"},K={class:"color-org"},U={class:"color-red"},V={class:"scanning-progress-cont"},$={class:"progress-header-cot"},q={class:"progress-cont-list"},Q=["onClick"],R={class:"progress_type"},W={class:"progress_status"},X={key:0,class:"text-danger"},Y={key:1,class:"text-warning"},Z={key:1},tt={key:2,class:"text-secondary"},rt={key:0},et={class:"progress_fold"},ot={class:"progress_item_body"},nt={class:"info_cont"},st={class:"info_cont_desc"},at=y({__name:"index",setup:function(t){var d=v(!1),y=[{color:"var(--el-color-text-tertiary)",text:"未安装"},{color:"var(--el-color-text-secondary)",text:"良好"},{color:"var(--el-color-warning",text:"警告"},{color:"red",text:"危险"}],at={system_account:"系统账户",sshd_service:"SSHD远程服务",file_mode:"重要文件权限及属性",software:"重点软件检测",other:"其他项目检测",backdoor:"后门检测",proc:"恶意进程",history:"历史命令",log:"日志排查",rootkit:"rootkit检测"},it=v({}),ct=g(function(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?a(Object(e),!0).forEach(function(r){i(t,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):a(Object(e)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}return t}({},{scanStatus:!1,isEnd:!1,error:0,warn:0,time:0,progress:0,progressColor:"var(--el-color-primary)",progressConfig:{system_account:[],sshd_service:[],file_mode:[],software:[],other:[],backdoor:[],proc:[],history:[],log:[],rootkit:[]},statusTotal:{},allArr:[],result:{},progressStatus:{},active:{system_account:!1,sshd_service:!1,file_mode:!1,software:!1,other:!1,backdoor:!1,proc:!1,history:!1,log:!1,rootkit:!1}})),lt=function(t){return t+" 分"},ut=null,ft=m(function(){return ct.scanStatus&&!ct.isEnd?"正在扫描":it.value.status?"上次检测时间 "+("刚刚"===n(it.value.msg.time)?"一分钟内":n(it.value.msg.time)):"当前未进行安全检测"}),pt=v(""),dt=v(""),yt=m(function(){return ct.scanStatus&&!ct.isEnd?"正在扫描-".concat(pt.value):ct.isEnd?"检测时间："+c(ct.time/1e3,"yyyy-MM-dd"):it.value.status?"若长时间未检测，服务器可能存在安全风险，建议立即检测":"当前安全风险未知，请立即检测"}),vt=function(t,r){if(r.data){var e,o=JSON.parse(r.data.replace(/'/g,'"'));if(o.hasOwnProperty("callback"))null===(e=ut)||void 0===e||e.close(),ct.scanStatus=!1,ct.isEnd=!0,ct.time=(new Date).getTime();else pt.value=o.name,dt.value=o.topic,ct.progress=parseInt(o.progress),ct.progressConfig[o.topic].push(o),ct.statusTotal[o.topic]=gt(ct.progressConfig[o.topic]),ct.allArr.push(o),3===o.status?ct.error++:2===o.status&&ct.warn++,1!==o.status&&(ct.progressColor="var(--el-color-warning)")}},gt=function(t){var r={};return t.forEach(function(t){r[t.status]?r[t.status]++:r[t.status]=1}),r},mt=function(){var t,r;if(ct.scanStatus&&!ct.isEnd||ct.isEnd,ct.scanStatus&&!ct.isEnd)return null===(r=ut)||void 0===r||r.close(),void bt();ct.isEnd&&bt(),ct.scanStatus=!0,null===(t=ut=p({route:"/ws_project",onMessage:vt}))||void 0===t||t.send({mod_name:"safe_detect",def_name:"get_safe_scan",ws_callback:""})},bt=function(){ct.scanStatus=!1,ct.isEnd=!1,ct.error=0,ct.warn=0,ct.time=0,ct.progress=0,ct.progressColor="var(--el-color-primary)",ct.progressConfig={system_account:[],sshd_service:[],file_mode:[],software:[],other:[],backdoor:[],proc:[],history:[],log:[],rootkit:[]},ct.statusTotal={},ct.allArr=[],ct.result={},ct.progressStatus={},ct.active={system_account:!1,sshd_service:!1,file_mode:!1,software:!1,other:!1,backdoor:!1,proc:!1,history:!1,log:!1,rootkit:!1}},wt=function(){var t,r=(t=o().m(function t(){var r,e;return o().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,M();case 1:r=t.v,it.value=r.data,t.n=3;break;case 2:t.p=2,e=t.v,l(e);case 3:return t.a(2)}},t,null,[[0,2]])}),function(){var r=this,e=arguments;return new Promise(function(o,n){var a=t.apply(r,e);function i(t){s(a,o,n,i,c,"next",t)}function c(t){s(a,o,n,i,c,"throw",t)}i(void 0)})});return function(){return r.apply(this,arguments)}}();return b(function(){wt()}),function(t,o){var n,s,a,i=u,c=I,l=F,p=f,v=w("bt-loading");return h((k(),S("div",e,[O("div",H,[O("div",J,[O("div",{class:j("progresscirclebar "+(_(it).status?"security ":"")+"text-["+(100===(null===(n=_(it).msg)||void 0===n?void 0:n.security_count)?" var(--el-color-primary) ":" var(--el-color-warning)")+"]")},[_(it).status?(k(),S(x,{key:1},[_(ct).scanStatus&&!_(ct).isEnd?(k(),S("div",N,[T(c,{class:"animate-spin",type:"circle",percentage:70,"show-text":!1,"stroke-width":4,"define-back-color":"var(--el-color-white)",color:_(ct).warn||_(ct).error?"var(--el-color-warning)":"var(--el-color-primary)",width:100},null,8,["color"]),O("div",L,[T(i,{class:"w-[full] px-[.4rem]",src:"/firewall/icon-safe-detect".concat(_(ct).warn||_(ct).error?"-org":"",".svg")},null,8,["src"]),o[0]||(o[0]=O("span",{class:"text-small font-bold py-[.4rem] leading-none"}," 安全检测 ",-1))])])):(k(),E(c,{key:1,type:"circle",percentage:null===(s=_(it).msg)||void 0===s?void 0:s.security_count,format:lt,color:100===(null===(a=_(it).msg)||void 0===a?void 0:a.security_count)?"var(--el-color-primary)":"var(--el-color-warning)",width:100},null,8,["percentage","color"]))],64)):(k(),E(i,{key:0,class:"w-[10rem]",src:"/firewall/icon-safe-detect.svg"}))],2)]),O("div",z,[O("div",B,[_(ct).isEnd?(k(),S(x,{key:1},[o[5]||(o[5]=P(" 检测已完成 ",-1)),_(ct).error>0||_(ct).warn>0?(k(),S(x,{key:0},[o[4]||(o[4]=P(" ，一共发现 ",-1)),_(ct).warn>0?(k(),S(x,{key:0},[O("span",K,C(_(ct).warn),1),o[1]||(o[1]=P(" 项风险项 ",-1))],64)):A("",!0),_(ct).error>0?(k(),S(x,{key:1},[o[2]||(o[2]=P(" （包含 ",-1)),O("span",U,C(_(ct).error),1),o[3]||(o[3]=P(" 项危险项，请立即处理） ",-1))],64)):A("",!0)],64)):A("",!0)],64)):(k(),S(x,{key:0},[P(C(_(ft)),1)],64))]),_(ct).scanStatus?(k(),E(c,{key:0,percentage:_(ct).progress,color:_(ct).warn||_(ct).error?"var(--el-color-warning)":"var(--el-color-primary)","stroke-width":10},null,8,["percentage","color"])):A("",!0),O("div",V,C(_(yt)),1)]),O("div",$,[T(l,{type:_(ct).scanStatus&&!_(ct).isEnd?"warning":"primary",onClick:mt,plain:!(!_(ct).scanStatus||_(ct).isEnd)},{default:D(function(){return[P(C(_(ct).scanStatus&&!_(ct).isEnd?"取消扫描":_(ct).isEnd?"重新检测":"立即检测"),1)]}),_:1},8,["type","plain"]),T(p,{class:"!absolute -bottom-[2.5rem] right-[1.4rem]",href:"https://www.bt.cn/bbs/thread-126643-1-1.html"},{default:D(function(){return r(o[6]||(o[6]=[P(" 需求反馈>> ",-1)]))}),_:1})])]),O("div",q,[(k(),S(x,null,G(at,function(t,r){return O("div",{key:r,class:j([r+"_item "+(_(ct).active[r]?"active":""),"progress_item"])},[O("div",{class:"progress_item_header",onClick:function(t){return function(t){ct.active[t]=!ct.active[t]}(r)}},[O("div",R,[T(i,{class:"title-icon",src:"/firewall/icon-"+r+".svg"},null,8,["src"]),O("span",null,C(t),1)]),O("div",W,[_(ct).statusTotal[r]?(k(),S(x,{key:0},[_(ct).statusTotal[r][3]||_(ct).statusTotal[r][2]?(k(),S(x,{key:0},[_(ct).statusTotal[r][3]?(k(),S("span",X," 发现"+C(_(ct).statusTotal[r][3])+"项危险 ",1)):A("",!0),_(ct).statusTotal[r][2]?(k(),S("span",Y,C((_(ct).statusTotal[r][3]?"":"发现")+_(ct).statusTotal[r][2])+"项警告 ",1)):A("",!0)],64)):_(ct).scanStatus&&_(dt)==r?(k(),S("span",Z," 正在扫描... ")):(k(),S("span",tt,"无风险项"))],64)):(k(),S(x,{key:1},[_(ct).scanStatus&&!_(ct).statusTotal[r]?(k(),S("span",rt," 等待扫描 ")):A("",!0)],64))]),O("div",et,[T(i,{src:"/firewall/arrow-down.svg"})])],8,Q),O("div",ot,[_(ct).progressConfig[r]&&_(ct).progressConfig[r].length?(k(!0),S(x,{key:0},G(_(ct).progressConfig[r],function(t,r){return k(),S("div",{key:r,class:j([t.info?"active":"","progress_item_info"])},[O("div",nt,[O("div",null,C(t.name.replace("分析网站","")),1),O("div",{class:j("text-["+y[t.status<0?0:t.status].color+"]")},C(y[t.status<0?0:t.status].text),3)]),O("div",st,C(t.info||""),1)],2)}),128)):A("",!0)])],2)}),64))])])),[[v,_(d)]])}}});t("default",d(at,[["__scopeId","data-v-4feacef1"]]))}}})}();
