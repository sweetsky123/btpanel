!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function n(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t(Object(r),!0).forEach(function(t){a(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function a(t,n,a){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var r=a.call(t,n||"default");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a,t}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,l,u,o=[],i=!0,c=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(a=l.call(n)).done)&&(o.push(a.value),o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{if(!i&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(c)throw r}}return o}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function l(n,a,r,l){var i=a&&a.prototype instanceof o?a:o,s=Object.create(i.prototype);return c(s,"_invoke",function(n,a,r){var l,o,i,c=0,s=r||[],f=!1,d={p:0,n:0,v:e,a:v,f:v.bind(e,4),d:function(t,n){return l=t,o=0,i=e,d.n=n,u}};function v(n,a){for(o=n,i=a,t=0;!f&&c&&!r&&t<s.length;t++){var r,l=s[t],v=d.p,m=l[2];n>3?(r=m===a)&&(i=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=v&&((r=n<2&&v<l[1])?(o=0,d.v=a,d.n=l[1]):v<m&&(r=n<3||l[0]>a||a>m)&&(l[4]=n,l[5]=a,d.n=m,o=0))}if(r||n>1)return u;throw f=!0,a}return function(r,s,m){if(c>1)throw TypeError("Generator is already running");for(f&&1===s&&v(s,m),o=s,i=m;(t=o<2?e:i)||!f;){l||(o?o<3?(o>1&&(d.n=-1),v(o,i)):d.n=i:d.v=i);try{if(c=2,l){if(o||(r="next"),t=l[r]){if(!(t=t.call(l,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,o<2&&(o=0)}else 1===o&&(t=l.return)&&t.call(l),o<2&&(i=TypeError("The iterator does not provide a '"+r+"' method"),o=1);l=e}else if((t=(f=d.n<0)?i:n.call(a,d))!==u)break}catch(t){l=e,o=1,i=t}finally{c=1}}return{value:t,done:f}}}(n,r,l),!0),s}var u={};function o(){}function s(){}function f(){}t=Object.getPrototypeOf;var d=[][a]?t(t([][a]())):(c(t={},a,function(){return this}),t),v=f.prototype=o.prototype=Object.create(d);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,r,"GeneratorFunction")),e.prototype=Object.create(v),e}return s.prototype=f,c(v,"constructor",f),c(f,"constructor",s),s.displayName="GeneratorFunction",c(f,r,"GeneratorFunction"),c(v),c(v,r,"Generator"),c(v,a,function(){return this}),c(v,"toString",function(){return"[object Generator]"}),(i=function(){return{w:l,m:m}})()}function c(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}c=function(e,t,n,a){function l(t,n){c(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(l("next",0),l("throw",1),l("return",2))},c(e,t,n,a)}function s(e,t,n,a,r,l,u){try{var o=e[l](u),i=o.value}catch(e){return void n(e)}o.done?t(i):Promise.resolve(i).then(a,r)}function f(e){return function(){var t=this,n=arguments;return new Promise(function(a,r){var l=e.apply(t,n);function u(e){s(l,a,r,u,o,"next",e)}function o(e){s(l,a,r,u,o,"throw",e)}u(void 0)})}}System.register(["./base-lib-legacy.js?v=1763689792","./validator-legacy.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./useMethod-legacy.js?v=1763689792","./index-legacy422.js?v=1763689792","./config-legacy.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./column-legacy.js?v=1763689792","./index-legacy107.js?v=1763689792","./useStore-legacy.js?v=1763689792"],function(t,a){"use strict";var o,c,s,d,v,m,p,y,b,h,_,g,k,w,x,V,j,O,S,E,T,M,U,D,P,H,C,A,I,L,B,G,N,F,R,z,Y,$,q,J,Z,K,Q,X,W,ee,te,ne,ae,re,le,ue,oe,ie,ce,se,fe;return{setters:[function(e){o=e.c,c=e.r,s=e.t,d=e.g,v=e.v,m=e.w,p=e.I,y=e.x,b=e.y,h=e.z,_=e.e,g=e.C,k=e.F,w=e.b1,x=e.O,V=e.R,j=e.G,O=e.J,S=e.A,E=e.D,T=e.L,M=e.M,U=e.am,D=e.an,P=e.c1,H=e.aB,C=e.a1,A=e.B,I=e.U,L=e.ak,B=e.aj,G=e.H,N=e.ad,F=e.Y,R=e.Z,z=e.c2,Y=e.o,$=e.a0,q=e.K,J=e.n,Z=e.c3,K=e.ab},function(e){Q=e.p,X=e._},function(e){W=e.ak,ee=e.af,te=e.V,ne=e.am,ae=e._,re=e.u,le=e.M,ue=e.Q,oe=e.eE,ie=e.Z},function(e){ce=e.g},function(e){se=e.B},function(e){fe=e.am},null,null,null,null,null],execute:function(){var a={key:0,class:"flex items-center"},de=["innerHTML"],ve={key:3,class:"flex items-center"},me=o({__name:"select",props:{tid:{},value:{},data:{},cycles:{},row:{}},emits:["update:value"],setup:function(e,t){var n=t.emit,r=c([]),o=e,H=n,C=s(o),A=C.tid,I=C.data,L=C.row,B=c(!1),G=c(!1),N=d({get:function(){return o.value},set:function(e){"9"===o.tid&&"cycle"===o.data.attr?H("update:value",Number(e)):H("update:value",e)}}),F=function(){var e=f(i().m(function e(){return i().w(function(e){for(;;)switch(e.n){case 0:return G.value=!0,e.n=1,z(I);case 1:G.value=!1;case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),R={lazy:!0,lazyLoad:function(e,t){return f(i().m(function n(){var a,r,l,u,o,c;return i().w(function(n){for(;;)switch(n.n){case 0:if(r=e.level,null==I||null===(a=I.value)||void 0===a||!a.items[r].url){n.n=2;break}if(l={},r>=1)for(u=0;u<r;u++)l[I.value.items[r].data[u]]=u===r-1?e.value:e.parent.value;return n.n=1,fe(I.value.items[r].url,l);case 1:o=n.v,c=o.data,t(c.map(function(e){return{value:e.value,label:e.title,leaf:r===I.value.items.length-1?I.value.items.length:void 0}}));case 2:return n.a(2)}},n)}))()}},z=function(){var e=f(i().m(function e(t){var n,a;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fe(t.value.items.url);case 1:n=e.v,a=n.data,r.value=a,e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}(),Y=function(e,t){if(!e||!t)return"";var n,a=t,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=u(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,l=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw l}}}}(e.split("."));try{for(r.s();!(n=r.n()).done;){var l,o=n.value;if(void 0===(a=null===(l=a)||void 0===l?void 0:l[o]))break}}catch(i){r.e(i)}finally{r.f()}return null!=a?a:""};return v(f(i().m(function e(){var t;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:if(m(N,function(e){}),"select"!==I.value.type||!W(I.value.items)||!("url"in I.value.items)){e.n=6;break}if(B.value=!0,t=!ee(L.value),e.p=1,0!==r.value.length){e.n=3;break}return G.value=!0,e.n=2,z(I);case 2:G.value=!1,N.value=t?Y(I.value.attr,L.value.task_data):r.value[0].value,e.n=4;break;case 3:""===N.value&&(N.value=t?Y(I.value.attr,L.value.task_data):r.value[0].value);case 4:e.n=6;break;case 5:e.p=5,e.v;case 6:return e.a(2)}},e,null,[[1,5]])}))),function(t,n){var u=U,o=D,i=P,c=p("bt-loading");return y(),b("div",null,[e.cycles.includes(h(A)||"")&&"cycle"===h(I).attr?(y(),b("div",a,[_(o,{modelValue:h(N),"onUpdate:modelValue":n[0]||(n[0]=function(e){return V(N)?N.value=e:null}),class:"!w-[16rem]",disabled:!0},{default:g(function(){return[(y(!0),b(k,null,w(h(I).items,function(e){return y(),x(u,{key:e.value,label:e.title+"分钟",value:e.value},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"]),h(I).suffix?(y(),b("div",{key:0,innerHTML:h(I).suffix,class:"ml-[1rem]"},null,8,de)):j("",!0)])):"cascader"===h(I).type?(y(),x(i,{key:1,modelValue:h(N),"onUpdate:modelValue":n[1]||(n[1]=function(e){return V(N)?N.value=e:null}),props:R},null,8,["modelValue"])):"multiple-select"===h(I).type?(y(),x(o,{key:2,modelValue:h(N),"onUpdate:modelValue":n[2]||(n[2]=function(e){return V(N)?N.value=e:null}),multiple:"",class:"!w-[24.8rem] bt-multiple-select",placeholder:h(I).suffix||"请选择"},{default:g(function(){return[(y(!0),b(k,null,w(h(I).items,function(e){return y(),x(u,{key:e.value,label:e.title,value:e.value},null,8,["label","value"])}),128))]}),_:1},8,["modelValue","placeholder"])):h(B)?(y(),b("div",ve,[O((y(),x(o,{"element-loading-spinner":"svgtofont-el-loading",modelValue:h(N),"onUpdate:modelValue":n[3]||(n[3]=function(e){return V(N)?N.value=e:null}),filterable:"",class:"!w-[24.8rem]"},{default:g(function(){return[(y(!0),b(k,null,w(h(r),function(e){return y(),x(u,{key:e.value,label:e.title,value:e.value},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"])),[[c,h(G)],[c,"small","size"]]),S("span",{class:"bt-link ml-[1rem] flex items-center",onClick:F},l(n[5]||(n[5]=[E("刷新",-1),S("i",{class:"svgtofont-el-refresh-right ml-2px"},null,-1)])))])):(y(),x(o,{key:4,modelValue:h(N),"onUpdate:modelValue":n[4]||(n[4]=function(e){return V(N)?N.value=e:null}),class:T(h(I).width?"":"!w-[24.8rem]"),style:M({width:h(I).width}),disabled:h(I).disabled},{default:g(function(){return[(y(!0),b(k,null,w(h(I).items,function(e){return y(),x(u,{key:e.value,label:e.title,value:e.value},null,8,["label","value"])}),128))]}),_:1},8,["modelValue","class","style","disabled"]))])}}}),pe=["innerHTML"],ye=["innerHTML"],be=["innerHTML"],he={key:0,class:"ml-[1rem]"},_e=o({__name:"common-item",props:{tid:{default:""},value:{default:""},data:{},row:{default:{}},currentTemplate:{default:{}}},emits:["update:value"],setup:function(e,t){var n=t.emit,a=e,l=s(a),u=l.tid,o=l.data,i=l.row,c=l.currentTemplate,f=n,v=d({get:function(){return a.value},set:function(e){f("update:value",{val:e,attr:o.value.attr})}}),m=d(function(){return" "===o.value.name?" ":o.value.name}),p={4:["cycle","count"],21:["cycle","count"],22:["cycle","count"],23:["cycle","count"],123:["hour","minute"]},O=["21","22","23"],S=d(function(){var e;if(null===(e=c.value)||void 0===e||!e.sorted)return!1;var t=c.value.sorted.find(function(e){return e.includes(o.value.attr)});return t&&t.length>1}),U=d(function(){var e=[];S.value&&e.push("inline");for(var t=Object.entries(p),n=0;n<t.length;n++){var a=r(t[n],2),l=a[0],i=a[1];l===u.value&&i.includes(o.value.attr)&&e.push("inline")}return e.join(" ")}),D={1:["interval"],2:["interval"],3:["interval"],4:["interval"]},P=function(e){(!/^[0-9]*$/.test(String(e))||e<=0)&&(v.value=1)},F=function(){""===v.value&&(v.value=1)},R=function(){""===v.value&&(v.value=o.value.default)},z=H("alarm-list-form").fields,Y=function(e){"9"===u.value&&"cycle"===o.value.attr?(ne(e)&&z.value.forEach(function(t){t.forEach(function(t){if(t.all_items){var n=t.all_items[Number(e)-1];n&&(t.items=n,t.value="")}})}),$(e)):$(e)},$=function(e){z.value.forEach(function(t){t.forEach(function(t){t.attr===o.value.attr&&(t.value=e)})})},q=function(e){if("20"===u.value){var t,n=null===(t=z.value[2])||void 0===t?void 0:t[0];if(n)switch(e){case 1:n.unit="GB",n.name="占用超过";break;case 2:n.unit="%",n.name="占用率超过"}}},J=d(function(){for(var e=Object.entries(D),t=0;t<e.length;t++){var n=r(e[t],2),a=n[0],l=n[1];if(a===u.value&&l.includes(o.value.attr))return!1}return!0}),Z=d(function(){return o.value.show_format&&v.value?o.value.show_format.replace("${value}",te(v.value,"yyyy-MM-dd")):""}),K=function(e){if(e){var t=Number(e);isNaN(t)?v.value=0:v.value=t}else v.value=0},Q=function(){v.value=0};return function(e,t){var n=I,a=L,r=B,l=se,c=G,s=N;return h(J)?(y(),x(s,{key:0,label:h(m),class:T(h(U))},{default:g(function(){return["number"===h(o).type?(y(),b(k,{key:0},[_(n,{modelValue:h(v),"onUpdate:modelValue":t[0]||(t[0]=function(e){return V(v)?v.value=e:null}),modelModifiers:{number:!0},type:"number",class:"!w-[15rem]","text-type":h(o).unit,onInput:P,onBlur:F},C({_:2},[h(o).unit?{name:"append",fn:g(function(){return[E(A(h(o).unit),1)]}),key:"0"}:void 0]),1032,["modelValue","text-type"]),h(o).suffix?(y(),b("div",{key:0,innerHTML:h(o).suffix,class:"ml-[1rem]"},null,8,pe)):j("",!0)],64)):j("",!0),"textarea"===h(o).type?(y(),b(k,{key:1},[_(n,{modelValue:h(v),"onUpdate:modelValue":t[1]||(t[1]=function(e){return V(v)?v.value=e:null}),type:"textarea","text-type":h(o).unit,class:"!w-[15rem]",onBlur:R},{append:g(function(){return[E(A(h(o).unit),1)]}),_:1},8,["modelValue","text-type"]),h(o).suffix?(y(),b("div",{key:0,innerHTML:h(o).suffix,class:"ml-[1rem]"},null,8,ye)):j("",!0)],64)):j("",!0),"select"===h(o).type||"cascader"===h(o).type||"multiple-select"===h(o).type?(y(),x(me,{key:2,data:h(o),tid:h(u),value:h(v),cycles:O,row:h(i),"onUpdate:value":Y},null,8,["data","tid","value","row"])):j("",!0),"help"===h(o).type?(y(),b("ul",{key:3,class:"help-info-text c7",style:M(h(o).style)},[(y(!0),b(k,null,w(h(o).list,function(e){return y(),b("li",{key:e},A(e),1)}),128))],4)):j("",!0),"radio"===h(o).type?(y(),x(r,{key:4,modelValue:h(v),"onUpdate:modelValue":t[2]||(t[2]=function(e){return V(v)?v.value=e:null})},{default:g(function(){return[(y(!0),b(k,null,w(h(o).items,function(e,t){return y(),x(a,{value:e.value,key:t,onChange:q},{default:g(function(){return[E(A(e.title),1)]}),_:2},1032,["value"])}),128))]}),_:1},8,["modelValue"])):j("",!0),"link"===h(o).type?(y(),b("span",{key:5,class:"bt-link",innerHTML:h(o).list},null,8,be)):j("",!0),"date"===h(o).type?(y(),b(k,{key:6},[_(l,{modelValue:h(v),"onUpdate:modelValue":t[3]||(t[3]=function(e){return V(v)?v.value=e:null}),"value-format":"X",class:"date",type:"date",onClear:Q,placeholder:0===h(v)?h(o).default_show:"选择日期",onChange:K},null,8,["modelValue","placeholder"]),_(c,{type:"default",class:"!ml-[.4rem]",onClick:Q},{default:g(function(){return[E(" 设为"+A(h(o).default_show),1)]}),_:1}),h(o).show_format&&0!==h(v)?(y(),b("span",he,A(h(Z)),1)):j("",!0)],64)):j("",!0)]}),_:1},8,["label","class"])):j("",!0)}}}),ge=ae(_e,[["__scopeId","data-v-45ab667c"]]),ke={class:"pl-[9px] flex flex-wrap gap-2"},we=["onClick"],xe=["title"],Ve={class:""},je={key:0,class:"svgtofont-icon-ltd !text-extraLarge !font-normal text-ltd ml-[4px]"},Oe=o({__name:"add-select",props:F({options:{},tagOptions:{},isEdit:{type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:F(["change","update:tagOptions"],["update:modelValue"]),setup:function(e,t){var a=t.emit,r=R(e,"modelValue"),u=re().payment,o=e,i=a,c=d(function(){if(!r.value)return"";var e=o.options.find(function(e){return e.value===r.value});return(null==e?void 0:e.label)||""}),s=d(function(){return"ltd"!==u.value.authType}),f=function(e){i("change",e)},v=d(function(){var e=o.tagOptions.filter(function(e){return e.checked}).map(function(e){return e.value});return e.includes("all")||0===e.length?l(o.options):l(o.options).filter(function(t){var n;return null===(n=t.tags)||void 0===n?void 0:n.some(function(t){return e.includes(t)})})});return function(t,a){var l=U,u=z,d=D;return y(),x(d,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=function(e){return r.value=e}),disabled:e.isEdit,filterable:"",clearable:"",class:"!w-[248px]",onChange:f},{label:g(function(){return[E(A(h(c)),1)]}),header:g(function(){return[a[1]||(a[1]=S("div",{class:"pl-[9px] text-small text-tertiary mb-[5px]"},"任务分类",-1)),S("div",ke,[(y(!0),b(k,null,w(e.tagOptions,function(e){return y(),b("span",{class:T(["text-small text-tertiary cursor-pointer border border-darkTertiary rounded-base px-[10px] py-[2px]",{"!text-primary !border-primary":e.checked}]),onClick:function(t){return a=e.value,r=o.tagOptions.map(function(e){return n(n({},e),{},{checked:"all"===a?"all"===e.value:"all"!==e.value&&(e.value===a?!e.checked:e.checked)})}),r.some(function(e){return e.checked})||(r=r.map(function(e){return n(n({},e),{},{checked:"all"===e.value})})),void i("update:tagOptions",r);var a,r}},A(e.label),11,we)}),256))])]}),default:g(function(){return[_(u,{label:"任务类型"},{default:g(function(){return[(y(!0),b(k,null,w(h(v),function(e){return y(),b(k,null,[e.used&&e.can_create?(y(),x(l,{key:e.value,label:e.label,value:e.value,onClick:function(t){return function(e){e.is_pro&&s.value&&Q({disablePro:!0,sourceId:361})}(e)},disabled:h(s)&&e.is_pro},{default:g(function(){return[S("div",{class:"flex items-center",title:e.label},[S("span",Ve,A(e.label),1),e.is_pro?(y(),b("span",je)):j("",!0)],8,xe)]}),_:2},1032,["label","value","onClick","disabled"])):j("",!0)],64)}),256))]}),_:1})]}),_:1},8,["modelValue","disabled"])}}}),Se={key:0,class:"ml-10px text-small text-secondary"},Ee={class:"text-small text-secondary"},Te={class:"mb-[1.6rem]"},Me={class:"w-35rem"},Ue=o({__name:"index",props:{compData:{}},emits:["close"],setup:function(t,a){var u=a.expose,o=a.emit,m=t,p=o,M=s(m).compData,U=c(""),D=c([]),P=c([]),H=c(!1),C=["dingding","mail","sms","wx_account","feishu","weixin"],L=c([]),B=Y({method:[],send_interval:0,time_range:[(new Date).setHours(0,0,0,0),(new Date).setHours(23,59,59,0)],day_num:0,total:0});c();var G=function(e,t){return 0===t&&(U.value=e.tid,ee()),{label:e.title,value:e.tid,used:e.used,tags:e.tags,can_create:e.can_create,is_pro:e.is_pro,description:e.description}},F=function(e){P.value=P.value.map(function(t){return t.map(function(t){return t.attr===e.attr?n(n({},t),{},{value:e.val}):t})})},R=function(t){var a={};for(var r in t)if("object"===e(t[r])&&null!==t[r]){var l=R(t[r]);a=n(n({},a),l)}else a["".concat(r)]=t[r];return a},z=d(function(){var e,t={};return null===(e=D.value)||void 0===e||e.forEach(function(e){t[e.tid]=e}),t}),Q=d(function(){return z.value[U.value]}),W=d(function(){var e,t,n=R((null===(e=Q.value)||void 0===e?void 0:e.advancedShow)||{});m.compData.isEdit||(null===(t=Object.entries(n))||void 0===t||t.forEach(function(e){var t=r(e,2),n=t[0],a=t[1];B[n]=a}));return n}),ee=function(){J(function(){if(Q.value){L.value=C.filter(function(e){if(!Q.value.module.includes(e))return e});var e,t,a,r,l=Q.value.field.map(function(e){var t,a=e.default;"select"!==e.type||void 0!==e.default&&null!==e.default||(a=(null===(t=e.items[0])||void 0===t?void 0:t.value)||"");return n(n({},e),{},{value:a})});P.value=(e=l,t=Q.value.sorted,a=[],r=new Map(e.map(function(e){return[e.attr,e]})),t.forEach(function(e){var t=e.map(function(e){return r.get(e)}).filter(Boolean);a.push(t)}),a)}})},te=function(e){var t=new Date(e),n=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),l=new Date(n,a-1,r).getTime();return Math.floor((e-l)/1e3)},ne=function(e){var t=new Date,n=t.getFullYear(),a=t.getMonth(),r=t.getDate();return new Date(n,a,r).getTime()+1e3*e},ae=c([{label:"全部",value:"all",checked:!0},{label:"常用",value:"common",checked:!1},{label:"网站",value:"site",checked:!1},{label:"SSL",value:"ssl",checked:!1},{label:"系统",value:"system",checked:!1},{label:"软件",value:"soft",checked:!1},{label:"插件",value:"plugin",checked:!1},{label:"面板",value:"panel",checked:!1},{label:"安全",value:"safe",checked:!1}]),re=d(function(){var e,t,n=m.compData,a=n.diyProcessTemplate,r=n.diyProcessTemplateTid;return a&&null!=r&&r.length?null===(e=D.value)||void 0===e?void 0:e.filter(function(e){return r.includes(e.tid)}).map(G):null===(t=D.value)||void 0===t?void 0:t.map(G)}),se=function(){var e={},t=Q.value;return e.tid=t.tid,e.type=t.type,e.title=t.title,e.status=!0,e.count=0,e.interval=600,e.project="",P.value.forEach(function(t){t.forEach(function(t){e[t.attr]=t.value})}),e},fe=function(){var e=f(i().m(function e(){var t;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,t=de(),e.n=1,ue({loading:"正在添加告警任务，请稍候...",request:oe(t),message:!0,success:function(e){var t,n;e.status&&(U.value=re.value[0].value,ee(),B.method=[],B.send_interval=0,B.time_range=[(new Date).setHours(0,0,0,0),(new Date).setHours(23,59,59,0)],B.day_num=0,B.total=0,(null===(t=M.value)||void 0===t?void 0:t.onRefresh)&&(null===(n=M.value)||void 0===n||n.onRefresh()),p("close"))}});case 1:e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}(),de=function(){var e=Q.value,t=M.value,n=t.isEdit,a=t.row,r={template_id:e.tid,task_data:{task_data:se(),sender:B.method,number_rule:{day_num:B.day_num,total:B.total}}};return r.task_data.time_rule={send_interval:B.send_interval,time_range:0!=B.time_range[1]?[te(B.time_range[0]),te(B.time_range[1])]:[]},r.task_data=JSON.stringify(r.task_data),n&&(r.task_id=a.id),r},ve=function(){var e=f(i().m(function e(){var t,n;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,B.method.length){e.n=1;break}return le.error("请选择告警方式"),e.a(2);case 1:if(M.value.isEdit){e.n=2;break}return fe(),e.a(2);case 2:return t=de(),e.n=3,ue({loading:"正在编辑告警任务，请稍候...",request:oe(t),message:!0,success:function(e){var t;e.status&&(M.value.onRefresh&&(null===(t=M.value)||void 0===t||t.onRefresh()))}});case 3:return n=e.v,e.a(2,n.status);case 4:return e.p=4,e.v,e.a(2,!1)}},e,null,[[0,4]])}));return function(){return e.apply(this,arguments)}}(),me=function(e){U.value=e.template_id,ee(),J(function(){P.value.flat().forEach(function(t){if(ie(e.task_data,t.attr)&&(t.value=e.task_data[t.attr]),"9"==U.value&&"cycle"===t.attr&&"number"==typeof t.value){var n,a=null===(n=P.value[1])||void 0===n?void 0:n[0];if(a){var r=a.all_items[t.value-1];a.items=r}}if("20"===U.value&&"count"===t.attr){var l,u,o=null===(l=P.value[1])||void 0===l?void 0:l[0],i=null===(u=P.value[2])||void 0===u?void 0:u[0];if(o&&i){var c=1===o.value;i.name=c?"占用超过":"占用率超过",i.unit=c?"GB":"%"}}})})},pe=function(){var e=f(i().m(function e(){var t,n,a,r,l;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,ce();case 1:if(l=e.v){e.n=2;break}l=[];case 2:D.value=l,t=M.value,n=t.isEdit,a=t.row,n&&(r=a.sender.map(function(e){return e}),B.method=r,B.day_num=a.number_rule.day_num||0,B.total=a.number_rule.total||0,B.send_interval=a.time_rule.send_interval||0,a.time_rule&&a.time_rule.time_range&&a.time_rule.time_range.length>0?B.time_range=[ne(a.time_rule.time_range[0]),ne(a.time_rule.time_range[1])]:B.time_range=[(new Date).setHours(0,0,0,0),(new Date).setHours(23,59,59,0)],J(function(){return me(a)})),e.n=4;break;case 3:e.p=3,e.v;case 4:return e.a(2)}},e,null,[[0,3]])}));return function(){return e.apply(this,arguments)}}();return $("alarm-list-form",{fields:P}),v(function(){return pe()}),u({onConfirm:ve}),function(e,t){var n=N,a=I,r=X,u=Z,o=K;return y(),x(o,{class:"p-[20px]"},{default:g(function(){var e;return[_(n,{label:"任务类型"},{default:g(function(){return[_(Oe,{modelValue:h(U),"onUpdate:modelValue":t[0]||(t[0]=function(e){return V(U)?U.value=e:null}),isEdit:h(M).isEdit,options:h(re),"tag-options":h(ae),"onUpdate:tagOptions":t[1]||(t[1]=function(e){return V(ae)?ae.value=e:null}),onChange:ee},null,8,["modelValue","isEdit","options","tag-options"]),"site_push@8"===h(U)?(y(),b("span",Se," * 当检测到新的版本时发送一次通知 ")):j("",!0)]}),_:1}),null!==(e=h(Q))&&void 0!==e&&e.description?(y(),x(n,{key:0,label:" ",class:"!mt-[-1rem]"},{default:g(function(){var e;return[S("div",Ee,A(null===(e=h(Q))||void 0===e?void 0:e.description),1)]}),_:1})):j("",!0),(y(!0),b(k,null,w(h(P),function(e){return y(),b("div",{key:h(U)+"_"+e.name+"_"+e.attr,class:"block"},[(y(!0),b(k,null,w(e,function(e){return y(),x(ge,{key:h(U)+"_"+e.name+"_"+e.attr,value:e.value,tid:h(U),data:e,row:h(M).row,"current-template":h(Q),"onUpdate:value":F},null,8,["value","tid","data","row","current-template"])}),128))])}),128)),S("div",Te,[h(W).day_num?(y(),x(n,{key:0,label:"每日发送上限"},{default:g(function(){return[_(a,{modelValue:h(B).day_num,"onUpdate:modelValue":t[2]||(t[2]=function(e){return h(B).day_num=e}),modelModifiers:{number:!0},type:"number","text-type":"次",class:"!w-[15rem]"},{append:g(function(){return l(t[11]||(t[11]=[E(" 次 ",-1)]))}),_:1},8,["modelValue"])]}),_:1})):j("",!0),h(W).total?(y(),x(n,{key:1,label:"总发送上限"},{default:g(function(){return[_(a,{modelValue:h(B).total,"onUpdate:modelValue":t[3]||(t[3]=function(e){return h(B).total=e}),modelModifiers:{number:!0},type:"number","text-type":"次",class:"!w-[15rem]"},{append:g(function(){return l(t[12]||(t[12]=[E(" 次 ",-1)]))}),_:1},8,["modelValue"])]}),_:1})):j("",!0),h(W).send_interval?(y(),x(n,{key:2,label:"最小发送间隔"},{default:g(function(){return[_(a,{modelValue:h(B).send_interval,"onUpdate:modelValue":t[4]||(t[4]=function(e){return h(B).send_interval=e}),modelModifiers:{number:!0},"text-type":"秒",type:"number",class:"!w-[15rem]"},{append:g(function(){return l(t[13]||(t[13]=[E(" 秒 ",-1)]))}),_:1},8,["modelValue"])]}),_:1})):j("",!0)]),_(n,{label:"告警方式"},{default:g(function(){return[_(r,{class:"!w-[30rem]",modelValue:h(B).method,"onUpdate:modelValue":t[5]||(t[5]=function(e){return h(B).method=e}),limit:h(L)},null,8,["modelValue","limit"])]}),_:1}),_(n,{class:"!my-[1rem]",label:" "},{default:g(function(){return[S("span",{class:"bt-link",onClick:t[6]||(t[6]=function(e){return H.value=!h(H)})},[t[14]||(t[14]=E("高级设置",-1)),S("span",{class:T(h(H)?"svgtofont-el-arrow-up":"svgtofont-el-arrow-down")},null,2)])]}),_:1}),O(S("div",null,[h(W).day_num?j("",!0):(y(),x(n,{key:0,label:"每日发送上限"},{default:g(function(){return[_(a,{modelValue:h(B).day_num,"onUpdate:modelValue":t[7]||(t[7]=function(e){return h(B).day_num=e}),modelModifiers:{number:!0},"text-type":"次",type:"number",class:"!w-[15rem]"},{append:g(function(){return l(t[15]||(t[15]=[E(" 次 ",-1)]))}),_:1},8,["modelValue"])]}),_:1})),h(W).total?j("",!0):(y(),x(n,{key:1,label:"总发送上限"},{default:g(function(){return[_(a,{modelValue:h(B).total,"onUpdate:modelValue":t[8]||(t[8]=function(e){return h(B).total=e}),modelModifiers:{number:!0},"text-type":"次",type:"number",class:"!w-[15rem]"},{append:g(function(){return l(t[16]||(t[16]=[E(" 次 ",-1)]))}),_:1},8,["modelValue"])]}),_:1})),h(W).send_interval?j("",!0):(y(),x(n,{key:2,label:"最小发送间隔"},{default:g(function(){return[_(a,{modelValue:h(B).send_interval,"onUpdate:modelValue":t[9]||(t[9]=function(e){return h(B).send_interval=e}),modelModifiers:{number:!0},"text-type":"秒",type:"number",class:"!w-[15rem]"},{append:g(function(){return l(t[17]||(t[17]=[E(" 秒 ",-1)]))}),_:1},8,["modelValue"])]}),_:1})),_(n,{label:"可发送时间范围"},{default:g(function(){return[S("div",Me,[_(u,{modelValue:h(B).time_range,"onUpdate:modelValue":t[10]||(t[10]=function(e){return h(B).time_range=e}),"is-range":"","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",placeholder:"选择时间范围"},null,8,["modelValue"])])]}),_:1})],512),[[q,h(H)]])]}),_:1})}}});t("default",ae(Ue,[["__scopeId","data-v-42099376"]]))}}})}();
