!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function n(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",u=r.toStringTag||"@@toStringTag";function s(r,n,o,u){var s=n&&n.prototype instanceof i?n:i,c=Object.create(s.prototype);return a(c,"_invoke",function(r,n,a){var o,u,s,i=0,c=a||[],p=!1,v={p:0,n:0,v:e,a:y,f:y.bind(e,4),d:function(t,r){return o=t,u=0,s=e,v.n=r,l}};function y(r,n){for(u=r,s=n,t=0;!p&&i&&!a&&t<c.length;t++){var a,o=c[t],y=v.p,f=o[2];r>3?(a=f===n)&&(s=o[(u=o[4])?5:(u=3,3)],o[4]=o[5]=e):o[0]<=y&&((a=r<2&&y<o[1])?(u=0,v.v=n,v.n=o[1]):y<f&&(a=r<3||o[0]>n||n>f)&&(o[4]=r,o[5]=n,v.n=f,u=0))}if(a||r>1)return l;throw p=!0,n}return function(a,c,f){if(i>1)throw TypeError("Generator is already running");for(p&&1===c&&y(c,f),u=c,s=f;(t=u<2?e:s)||!p;){o||(u?u<3?(u>1&&(v.n=-1),y(u,s)):v.n=s:v.v=s);try{if(i=2,o){if(u||(a="next"),t=o[a]){if(!(t=t.call(o,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,u<2&&(u=0)}else 1===u&&(t=o.return)&&t.call(o),u<2&&(s=TypeError("The iterator does not provide a '"+a+"' method"),u=1);o=e}else if((t=(p=v.n<0)?s:r.call(n,v))!==l)break}catch(t){o=e,u=1,s=t}finally{i=1}}return{value:t,done:p}}}(r,o,u),!0),c}var l={};function i(){}function c(){}function p(){}t=Object.getPrototypeOf;var v=[][o]?t(t([][o]())):(a(t={},o,function(){return this}),t),y=p.prototype=i.prototype=Object.create(v);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,a(e,u,"GeneratorFunction")),e.prototype=Object.create(y),e}return c.prototype=p,a(y,"constructor",p),a(p,"constructor",c),c.displayName="GeneratorFunction",a(p,u,"GeneratorFunction"),a(y),a(y,u,"Generator"),a(y,o,function(){return this}),a(y,"toString",function(){return"[object Generator]"}),(n=function(){return{w:s,m:f}})()}function a(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}a=function(e,t,r,n){function u(t,r){a(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(u("next",0),u("throw",1),u("return",2))},a(e,t,r,n)}function o(e,t,r,n,a,o,u){try{var s=e[o](u),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,a)}function u(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var u=e.apply(t,r);function s(e){o(u,n,a,s,l,"next",e)}function l(e){o(u,n,a,s,l,"throw",e)}s(void 0)})}}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach(function(t){i(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function i(t,r,n){return(r=function(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,r||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}System.register(["./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./useController-legacy11.js?v=1763689792","./form-item-legacy.js?v=1763689792","./index-legacy66.js?v=1763689792","./useStore-legacy10.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./validator-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./column-legacy.js?v=1763689792","./index-legacy107.js?v=1763689792","./index-legacy109.js?v=1763689792","./index-legacy147.js?v=1763689792","./index-legacy131.js?v=1763689792","./index.vue_vue_type_style_index_0_scoped_cdc7f4d3_lang-legacy.js?v=1763689792"],function(e,r){"use strict";var a,o,s,i,c,p,v,y,f,d,h,_,g,b,m,w,k,P,j,S,O,x,A,I,H,T;return{setters:[function(e){a=e.k_,o=e.L,s=e.k$,i=e.l0},function(e){c=e.r,p=e.c,v=e.aB,y=e.g,f=e.aE,d=e.H,h=e.a8,_=e.x,g=e.y,b=e.e,m=e.z,w=e.aZ},function(e){k=e.h,P=e.i},function(e){j=e.b,S=e.e,O=e.d,x=e.c,A=e.F,I=e.j},function(e){H=e.u},function(e){T=e.u},null,null,null,null,null,null,null,null,null],execute:function(){H();var r=T().rowData,C=function(){try{var e,t,n,a,o,u,s,i,c,p,v,y,f,d,h="api";null!==(e=r.value)&&void 0!==e&&e.app_key?h="app":null!==(t=r.value)&&void 0!==t&&t.api_key?h="api":null!==(n=r.value)&&void 0!==n&&n.ssh_conf&&(h="ssh");var _={ssh_ip:(null===(a=r.value)||void 0===a?void 0:a.ssh_conf.host)||"",ssh_type:null!==(o=r.value)&&void 0!==o&&o.ssh_conf.pkey?"key":"password",ssh_password:(null===(u=r.value)||void 0===u?void 0:u.ssh_conf.password)||"",ssh_key:(null===(s=r.value)||void 0===s?void 0:s.ssh_conf.pkey)||"",ssh_port:(null===(i=r.value)||void 0===i?void 0:i.ssh_conf.port)||"22",ssh_pkey_passwd:(null===(c=r.value)||void 0===c?void 0:c.ssh_conf.pkey_passwd)||""};return l(l({},null!==(p=r.value)&&void 0!==p&&p.id?{id:null===(v=r.value)||void 0===v?void 0:v.id}:{}),{},{address:(null===(y=r.value)||void 0===y?void 0:y.address)||"",verify_type:h,api_key:"",app_key:"",category_id:(null===(f=r.value)||void 0===f||null===(f=f.category_id)||void 0===f?void 0:f.toString())||"0",remarks:(null===(d=r.value)||void 0===d?void 0:d.remarks)||""},_)}catch(g){return{}}},E={class:"p-[2rem]"};e("default",p({__name:"index",setup:function(e,r){var p,q=r.expose,D=H(),G=D.isEdit,L=D.isVerify,F=v("popupLoading",function(e,t){return{close:function(){}}}),N=c(!1),U=T(),B=U.rowData,J=U.nodeCategory,R=y(function(){return J.value.filter(function(e){return"all"!==e.value&&Number(e.value)>=0})}),V=function(){var e=c("测试连接"),t=c("default"),r=c(!1),o=function(){var o=u(n().m(function o(u,s){var i;return n().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,s();case 1:if(n.v){n.n=2;break}return n.a(2);case 2:return r.value=!0,e.value="测试中",t.value="default",n.n=3,a(l({host:u.value.ssh_ip,port:parseInt(u.value.ssh_port),test_case:1},"password"==u.value.ssh_type?{password:u.value.ssh_password}:{pkey:u.value.ssh_key,pkey_passwd:u.value.ssh_pkey_passwd}));case 3:i=n.v,r.value=!1,i.status?(e.value="连接成功",t.value="success"):(e.value="连接失败",t.value="danger");case 4:return n.a(2)}},o)}));return function(e,t){return o.apply(this,arguments)}}();return{buttonText:e,buttonType:t,buttonLoading:r,buttonClick:o,textChange:function(){e.value="测试连接",t.value="default",r.value=!1}}}(),$=V.buttonText,z=V.buttonType,M=V.buttonLoading,Z=V.buttonClick,K=V.textChange,Q=o({data:C,options:function(e){return y(function(){var r;return[j("节点名称","remarks",{attrs:{class:"!w-[32rem]",placeholder:"请输入节点名称"},rules:[{required:!0,message:"节点名称不能为空",trigger:["blur","change"]}]}),S("验证类型","verify_type",[{label:"API密钥",value:"api"},{label:"APP插件",value:"app"},{label:"SSH",value:"ssh"}],{attrs:{onChange:function(){Y()}}})].concat(t("ssh"===e.value.verify_type?[O([j("节点IP","ssh_ip",{attrs:{class:"!w-[150px]",placeholder:"例如:192.168.1.1",onInput:K},rules:[{required:!0,message:"请输入节点IP",trigger:["change","blur"]}]}),j("SSH端口","ssh_port",{attrs:{class:"!w-[70px]",placeholder:"22",onInput:K},rules:[{required:!0,message:"请输入SSH端口",trigger:["change","blur"]}]})]),S("认证方式","ssh_type",[{label:"密码",value:"password"},{label:"密钥",value:"key"}],{attrs:{onChange:function(){Y(),K()}}}),O([].concat(t("password"===e.value.ssh_type?[j("SSH密码","ssh_password",{attrs:{class:"!w-[230px]",type:"password",placeholder:"例如:123456",onInput:K},rules:[{required:!0,message:"请输入SSH密码",trigger:["change","blur"]}]})]:[x("SSH密钥","ssh_key",{attrs:{class:"!w-[230px]",placeholder:"请输入SSH密钥",onInput:K},rules:[{required:!0,message:"请输入SSH密钥",trigger:["change","blur"]}]})]),[A(function(){return f(d,{plain:!0,type:z.value,class:"ml-[1.5rem] self-end mb-[1.8rem]",loading:M.value,disabled:M.value,onClick:function(){return Z(e,ee)}},$.value)})]))].concat(t("key"===e.value.ssh_type?[j("SSH私钥密码","ssh_pkey_passwd",{attrs:{class:"!w-[320px]",type:"password",placeholder:"若没有密码，请留空",onInput:K}})]:[])):[]),t("api"===e.value.verify_type?[j("面板地址","address",{attrs:{class:"!w-[320px]",clearable:!0,placeholder:"例如:http://192.168.1.1:88 或 https://domain.com:88",onInput:function(t){if(e.value.address=e.value.address.trim(),s(e.value.address)){var r=new URL(e.value.address);e.value.address=r.origin}}},rules:[i()]})]:[]),t("api"===e.value.verify_type?[j("API密钥","api_key",{attrs:{class:"!w-[32rem]",placeholder:G.value?"请输入API密钥,留空则沿用之前的密钥":"请输入API密钥"},rules:[{required:!G.value,message:"API密钥不能为空",trigger:["blur","change"]}]})]:[]),t("app"===e.value.verify_type?t(L.value?[A(function(){return f(w,{class:"!w-[32rem] !mb-[1rem] !ml-[10rem]",title:"请回到面板【堡塔APP】插件上点击确认按钮来完成验证",type:"warning",closable:!1})})]:[j("APP密钥","app_key",{attrs:{class:"!w-[32rem]",placeholder:G.value?"请输入APP插件密钥,留空则沿用之前的密钥":"请输入APP插件密钥"},rules:[{required:!G.value,message:"APP插件密钥不能为空",trigger:["blur","change"]}]})]):[]),[I("分类","category_id",R.value||[{label:"默认分类",value:"0"}],{attrs:{class:"!w-[32rem]",placeholder:"请选择分类",defaultId:null===(r=e.value)||void 0===r?void 0:r.category_id}})],t("api"===e.value.verify_type?[{type:"help",options:[{content:"第一步：填写面板URL地址，示例：https://192.168.1.2:8888"},{content:"第二步：打开面板，转到【面板设置】页面，点击【API接口配置】"},{isHtml:!0,content:'<li style="color:red">第三步：配置【IP白名单】，输入您电脑的公网固定IP，如果没有固定IP，请直接填星号(*)</li>'},{content:"第四步：在【API接口配置】窗口中复制【接口密钥】"},{content:"第五步：回到节点管理窗口，粘贴到【API密钥】输入框"}]}]:"ssh"===e.value.verify_type?[{type:"help",options:[{content:"请输入root账户信息"}]}]:[{type:"help",options:[{content:"第一步：在面板【软件商店】安装【堡塔APP】插件1.2以上版本"},{content:"第二步：点击【复制绑定密钥】按钮获取密钥"},{content:"第三步：粘贴到【APP密钥】输入框，并点击【验证】按钮"},{content:"第四步：回到面板【堡塔APP】插件上点击【确认】按钮来完成验证"}]}]))})},submit:(p=u(n().m(function e(t,r,a){var o;return n().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r();case 1:if("app"!==t.value.verify_type||""===t.value.app_key||(null===(o=B.value)||void 0===o?void 0:o.app_key)===t.value.app_key){e.n=2;break}return e.a(2,new Promise(function(){var e=u(n().m(function e(r,a){var o,s;return n().w(function(e){for(;;)switch(e.n){case 0:return o=F(L,"请先完成验证"),s=o.close,e.n=1,k({remarks:t.value.remarks,app_key:t.value.app_key},u(n().m(function e(){var a;return n().w(function(e){for(;;)switch(e.n){case 0:return s(),a=r,e.n=1,te(t);case 1:a(e.v);case 2:return e.a(2)}},e)})));case 1:N.value=e.v,N.value||(s(),L.value=!1,a(!1));case 2:return e.a(2)}},e)}));return function(t,r){return e.apply(this,arguments)}}()));case 2:return e.n=3,te(t);case 3:return e.a(2,e.v)}},e)})),function(e,t,r){return p.apply(this,arguments)})}),W=Q.BtForm,X=Q.submit,Y=Q.clearValidate,ee=Q.validate,te=function(){var e=u(n().m(function e(t){var r,a,o,u,s,i,c,p,v,y,f,d,h;return n().w(function(e){for(;;)switch(e.n){case 0:return r=t.value,a=r.address,o=r.category_id,u=r.api_key,s=r.app_key,i=r.remarks,c=r.ssh_ip,p=r.ssh_port,v=r.ssh_type,y=r.ssh_password,f=r.ssh_key,d=r.ssh_pkey_passwd,h=l(l(l(l({},"api"===t.value.verify_type?{api_key:u}:{}),"app"===t.value.verify_type?{app_key:s}:{}),"ssh"===t.value.verify_type?{ssh_conf:JSON.stringify(l({host:c,port:p},"password"===v?{password:y}:{pkey:f,pkey_passwd:d}))}:{address:a}),{},{category_id:"all"===o?0:o,remarks:i}),G.value&&(""===t.value.api_key&&(h.api_key=B.value.api_key),""===t.value.app_key&&(h.app_key=B.value.app_key),"ssh"!==t.value.verify_type&&(h.ssh_conf=JSON.stringify(B.value.ssh_conf)),h.id=B.value.id),e.n=1,P(h,G.value);case 1:return e.a(2,e.v)}},e)}));return function(t){return e.apply(this,arguments)}}();return h(function(){L.value=!1,N.value&&N.value()}),q({onConfirm:X}),function(e,t){return _(),g("div",E,[b(m(W),{disabled:m(L)},null,8,["disabled"])])}}}))}}})}();
