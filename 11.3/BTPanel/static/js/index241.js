import{c as e,r as a,o as t,v as s,n as o,x as r,y as d,e as l,C as i,A as m,z as u,D as p,G as c,H as n,ad as f,ab as _}from"./base-lib.js?v=1763689792";import{B as j}from"./index422.js?v=1763689792";import{b as y,_ as v}from"./utils-lib.js?v=1763689792";import{h as x,i as b}from"./validator.js?v=1763689792";import{batchPhpEdate as D,setModulesEtimeMultiple as g,setEdate as h}from"./site.js?v=1763689792";import{o as w}from"./useController6.js?v=1763689792";import{u as C}from"./useStore4.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";const q={class:"p-2rem"},Y={class:"flex items-center"},k={key:0,class:"text-[#888] mt-[8px] ml-10rem"},A=v(e({__name:"index",props:{compData:{default:()=>{}}},emits:["close"],setup(e,{expose:v,emit:A}){const H=y(),T=e,{rowData:V,siteType:M}=T.compData,P=!!Array.isArray(V),{isRefreshList:R}=C(),S=A,z=a(),B=t({edate:V.edate||""}),G={edate:[{required:!0,message:"请选择到期时间",trigger:"blur"}]},I=e=>e.getTime()<Date.now()-864e5,L=()=>{B.edate="",U(),F()},U=()=>{const e=document.querySelector(".date .el-input__inner");e&&(e.value="永久")},E=e=>{},F=async e=>{try{if(P){const{enable:e,exclude:a}=T.compData.config,t=x(V,a,e,{params:{edate:B.edate?B.edate:"0000-00-00",project_type:"PHP"}}),s=await D(t),{data:o}=b(s.data);w({title:"批量设置到期时间",resultTitle:"设置到期时间",resultData:o}),R.value=!0,S("close")}else{let e,a=H.load("正在设置到期时间，请稍后...");if(M){const e=await g({sites_id:V.id,edate:B.edate?B.edate:"0000-00-00"});e.data.status?(H.request(e),R.value=!0):H.error(e.data.msg)}else e=await h({id:V.id,edate:B.edate?B.edate:"0000-00-00"}),H.request(e),e.status&&(R.value=!0);a.close(),S("close")}}catch(a){}};return v({onConfirm:F}),s(()=>{"0000-00-00"===V.edate&&(B.edate="",o(()=>{U()}))}),(e,a)=>{const t=j,s=n,o=f,y=_;return r(),d("div",q,[l(y,{ref_key:"formRef",ref:z,model:u(B),rules:G},{default:i(()=>[l(o,{label:"到期时间",prop:"edate"},{default:i(()=>[m("div",Y,[l(t,{modelValue:u(B).edate,"onUpdate:modelValue":a[0]||(a[0]=e=>u(B).edate=e),"value-format":"YYYY-MM-DD","disabled-date":I,class:"date",onChange:E,type:"date",placeholder:"选择日期"},null,8,["modelValue"]),l(s,{type:"default",class:"!ml-[.4rem]",onClick:L},{default:i(()=>[...a[1]||(a[1]=[p(" 设为永久 ",-1)])]),_:1})])]),_:1})]),_:1},8,["model"]),u(B).edate?(r(),d("div",k,"* 到期当天24点后过期")):c("",!0)])}}}),[["__scopeId","data-v-26d5d260"]]);export{A as default};
