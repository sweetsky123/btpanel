import{H as e}from"./utils-lib.js?v=1763689792";import{d as a,a as t,g as s,b as l,c as n,e as c,f as r,u as i,h as o,i as d,s as u}from"./api.js?v=1763689792";import{t as f,a as p}from"./store5.js?v=1763689792";import{c as m,z as g,r as h,o as k,g as v,v as S,I as y,x as P,y as T,J as _,A as b,B as w,e as I,C as x,D as C,G as E,O as q,F as D,R as A}from"./base-lib.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";const V={key:0,class:"tencent min-h-[5.2rem] module-ui !p-0"},R={class:"flex items-center px-[1rem] py-[1.4rem] flex-wrap gap-y-1rem"},j={class:"mx-[1rem]"},N=["innerHTML"],U={class:"mx-[1rem]"},L={class:"mx-[1rem]"},B={key:0,class:"mx-[1rem]"},H={key:2},z={class:"p-[2rem]"},K={class:"p-[2rem]"},M={class:"alert alert-danger leading-2rem mb-1rem"},O={class:"flex items-center justify-between"},F={class:"p-[1rem]"},G={style:{"text-align":"right",margin:"0"}},J={key:1,shadow:"always","body-style":{padding:"0",display:"flex",minHeight:"5.2rem"},class:"module-ui min-h-[5.2rem] !text-danger !bg-[var(--el-color-warning-light-8)] px-1.6rem"},Q={class:"flex items-center"},Y=m({__name:"statusbar",props:{dependencies:{default:()=>({})}},setup(m,{expose:Y}){const W=m,{BtDialog:X,BtLink:Z,ElCard:$,ElIcon:ee,ElPopover:ae,ElTable:te,ElTableColumn:se,ElInput:le,ElButton:ne}=g(W.dependencies.components),{getByteUnit:ce}=g(W.dependencies.utils),{useAxios:re,useMessage:ie,useConfirm:oe,useDialog:de}=g(W.dependencies.hooks),ue=ie(),fe=h(!1),pe=h(!1),me=h(!1),ge=h(!1),he=k({InstanceId:"",appId:"",secretId:"",secretKey:"",show:!0,PrivateAddresses:[],PublicAddresses:[],Region:"",Region_title:"",ExpiredTime:"",requestPack:{InstanceTrafficPackageSet:[],RequestId:"",TotalCount:0},requestInfoShow:!1,firstPhotoShow:!1,snapshotsList:[],SnapshotName:"",createSnapshotDisable:!1}),ke=v(()=>{const e=(e,a)=>"<span>".concat(e.join("、"),"(").concat(a,")</span>");if(he.PrivateAddresses.length>0&&he.PublicAddresses.length>0){const a=e(he.PrivateAddresses,"内"),t=e(he.PublicAddresses,"外");return"".concat(a," / ").concat(t)}return"----"}),ve=v(()=>""!==he.Region&&""!==he.Region_title?"".concat(he.Region_title,"-").concat(he.Region):"----"),Se=v(()=>""!==he.ExpiredTime?Te(he.ExpiredTime):"----"),ye=v(()=>{const e=[];for(let a=0;a<he.requestPack.InstanceTrafficPackageSet.length;a++){const t=he.requestPack.InstanceTrafficPackageSet[a];for(let a=0;a<t.TrafficPackageSet.length;a++){const s=t.TrafficPackageSet[a];e.push({TrafficPackageId:s.TrafficPackageId,TrafficPackageTotal:ce(s.TrafficPackageTotal),TrafficUsed:ce(s.TrafficUsed),TrafficPackageRemaining:ce(s.TrafficPackageRemaining),TrafficPackageStart:Te(s.StartTime),TrafficPackageEnd:Te(s.EndTime)})}}return e}),Pe=v(()=>{if(he.requestPack.InstanceTrafficPackageSet.length>0){const e=he.requestPack.InstanceTrafficPackageSet[0];let a=0,t=0;for(let s=0;s<e.TrafficPackageSet.length;s++){const l=e.TrafficPackageSet[s];a+=l.TrafficPackageTotal,t+=l.TrafficUsed}return e.TrafficPackageSet.length?"".concat(ce(t),"/").concat(ce(a)):"不限制流量/无法获取流量包信息"}return"----"}),Te=e=>{if(!e)return"--";const a=new Date(e),t=a.getFullYear(),s=String(a.getMonth()+1).padStart(2,"0"),l=String(a.getDate()).padStart(2,"0"),n=String(a.getHours()).padStart(2,"0"),c=String(a.getMinutes()).padStart(2,"0"),r=String(a.getSeconds()).padStart(2,"0");return"".concat(t,"-").concat(s,"-").concat(l," ").concat(n,":").concat(c,":").concat(r)},_e=()=>{window.open("https://console.cloud.tencent.com/lighthouse/instance/detail?id=".concat(he.InstanceId),"_blank","noopener,noreferrer")},be=a=>{(a=a||{}).alert=me.value?"当前密钥错误，请重新关联API密钥":"",de({isAsync:!0,component:()=>e(()=>import("./config5.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),title:!1,area:[48],compData:{...a,dependencies:W.dependencies}})},we=e=>{e?be({appId:he.appId,secretId:he.secretId,secretKey:he.secretKey,isEdit:e||!1}):be()},Ie=async(e=!1)=>{try{me.value=!1,fe.value=!0,pe.value=!0;const{data:a}=await s();if(!1===(null==a?void 0:a.status)&&(null==a?void 0:a.msg))return;if(a){he.show=!1,he.secretKey=a.secretKey,he.appId=a.appid,he.secretId=a.secretId;const{data:t}=await l(e?{force:1}:{});p.value=t,Object.assign(he,t),"cvm"!==(null==t?void 0:t.server_type)?(f.value=!1,xe()):f.value=!0,pe.value=!1}else pe.value=!1}catch(a){}finally{pe.value=!1}},xe=async()=>{try{const{data:e}=await n();e&&e.msg&&(e.msg.indexOf("密钥连接错误")>-1||e.msg.indexOf("获取失败")>-1)?be({tips:"当前密钥错误，请重新绑定或取消当前密钥关联"}):he.requestPack=e}catch(e){fe.value=!1,me.value=!0}},Ce=async(e=!1)=>{try{he.firstPhotoShow=!0;const{data:a}=f.value?await c():await r();he.snapshotsList=a.SnapshotSet,e&&ue.success("刷新成功")}catch(a){}},Ee=async()=>{await oe({title:"更新腾讯云专版数据",content:"更新当前腾讯专版功能 (面板功能除外，面板更新请使用自带更新功能) ，是否继续操作?"});const e=await i();ue.request(e)},qe=async()=>{if(he.SnapshotName)try{const e=ue.load("正在创建快照，请稍后...");he.createSnapshotDisable=!0;const a=f.value?o:d,{data:t}=await a({SnapshotName:he.SnapshotName});e.close(),he.createSnapshotDisable=!1,ge.value=!1,ue.request(t),he.SnapshotName="",t.status&&await Ce()}catch(e){}else ue.error("请输入快照名称")};return S(()=>{u(re),Ie()}),Y({tencentCloudDialog:be}),(e,s)=>{const l=y("bt-loading");return P(),T("div",null,[g(fe)?_((P(),T("div",V,[b("div",R,[s[26]||(s[26]=b("div",{class:"tencent_division flex items-center"},[b("i",{class:"tencent_ico"}),b("span",{class:"text-base text-secondary font-semibold ml-[5px]"},"腾讯云专享版")],-1)),b("div",j,[s[13]||(s[13]=b("span",null,"主机IPv4：",-1)),b("span",{innerHTML:g(ke)},null,8,N)]),b("div",U,[s[14]||(s[14]=b("span",null,"区域：",-1)),b("span",null,w(g(ve)),1)]),b("div",L,[s[15]||(s[15]=b("span",null,"到期时间：",-1)),b("span",null,w(g(Se)),1)]),g(he).requestPack.InstanceTrafficPackageSet.length>0?(P(),T("div",B,[s[17]||(s[17]=b("span",null,"流量包：",-1)),b("span",null,w(g(Pe)),1),I(g(Z),{class:"ml-[0.5rem]",onClick:s[0]||(s[0]=e=>g(he).requestInfoShow=!0)},{default:x(()=>[...s[16]||(s[16]=[C("详情",-1)])]),_:1})])):E("",!0),g(he).show?(P(),q(g(ne),{key:1,class:"ml-[1rem]",onClick:s[1]||(s[1]=e=>we(!1))},{default:x(()=>[...s[18]||(s[18]=[C("关联腾讯云API密钥",-1)])]),_:1})):(P(),T("div",H,[I(g(ne),{class:"ml-[1rem]",onClick:_e},{default:x(()=>[...s[19]||(s[19]=[C("续费",-1)])]),_:1}),I(g(ne),{class:"ml-[1rem]",onClick:_e},{default:x(()=>[...s[20]||(s[20]=[C("升级套餐",-1)])]),_:1}),I(g(ne),{type:"default",class:"ml-[1rem]",onClick:s[2]||(s[2]=e=>we(!0))},{default:x(()=>[...s[21]||(s[21]=[C("密钥管理",-1)])]),_:1}),I(g(ne),{type:"default",class:"ml-[1rem]",onClick:s[3]||(s[3]=e=>Ce())},{default:x(()=>[...s[22]||(s[22]=[C("快照",-1)])]),_:1}),I(g(ne),{type:"default",class:"ml-[1rem]",onClick:Ee},{default:x(()=>[...s[23]||(s[23]=[C("更新",-1)])]),_:1}),I(g(ne),{type:"default",class:"ml-[1rem]",onClick:s[4]||(s[4]=e=>Ie(!0))},{default:x(()=>[...s[24]||(s[24]=[C("刷新",-1),b("i",{class:"svgtofont-el-refresh-right el-icon--right size-[1.3rem]"},null,-1)])]),_:1}),I(g(Z),{class:"ml-[1rem]",onClick:s[5]||(s[5]=e=>{return a="https://www.bt.cn/bbs/thread-66887-1-1.html",void window.open(a,"_blank","noopener,noreferrer");var a})},{default:x(()=>[...s[25]||(s[25]=[C("查看教程",-1)])]),_:1})]))]),I(g(X),{modelValue:g(he).requestInfoShow,"onUpdate:modelValue":s[6]||(s[6]=e=>g(he).requestInfoShow=e),title:"流量包管理",area:[80,30]},{default:x(()=>[b("div",z,[I(g(te),{data:g(ye),border:"","max-height":250},{default:x(()=>[I(g(se),{prop:"TrafficPackageId",label:"流量包ID",width:"120"}),I(g(se),{prop:"TrafficPackageTotal",label:"总量"}),I(g(se),{prop:"TrafficUsed",label:"已用"}),I(g(se),{prop:"TrafficPackageRemaining",label:"剩余"}),I(g(se),{prop:"TrafficPackageStart",label:"开始时间",width:"150"}),I(g(se),{prop:"TrafficPackageEnd",label:"结束时间",width:"150"})]),_:1},8,["data"])])]),_:1},8,["modelValue"]),I(g(X),{modelValue:g(he).firstPhotoShow,"onUpdate:modelValue":s[11]||(s[11]=e=>g(he).firstPhotoShow=e),title:"腾讯云硬盘快照",area:[62]},{default:x(()=>[b("div",K,[b("div",M,[s[35]||(s[35]=C(" 温馨提示： ",-1)),g(f)?(P(),T(D,{key:1},[s[34]||(s[34]=b("div",null,[C(" 1、快照仅能捕获该时刻已经在云硬盘上的数据，而无法将在内存中的数据记录下来。因此，为了保证快照能尽可能回复完整的数据，建议您在制作快照前进行以下操作： "),b("ul",{class:"pl-1.6rem list-disc"},[b("li",null,"数据库业务：进行 flush and lock 表操作，加锁并下刷表数据"),b("li",null,"文件系统：进行 sync 操作，下刷内存数据")])],-1)),b("div",null,[s[32]||(s[32]=C(" 2、快照已正式商业化，请您关注因此产生的费用。有关快照的更多信号可参考",-1)),I(g(Z),{href:"https://cloud.tencent.com/document/product/362/5754",class:"BtLink",target:"_blank"},{default:x(()=>[...s[30]||(s[30]=[C("快照概述",-1)])]),_:1}),s[33]||(s[33]=C("以及",-1)),I(g(Z),{href:"https://cloud.tencent.com/document/product/362/17935",class:"BtLink",target:"_blank"},{default:x(()=>[...s[31]||(s[31]=[C("快照商业化FAQ",-1)])]),_:1})])],64)):(P(),T(D,{key:0},[s[27]||(s[27]=b("div",null,[C("1、每个地域的免费快照配额为已创建实例数"),b("span",{style:{"font-weight":"600"}},"(待回收实例和存储型套餐实例除外)乘以2"),C("，且最多不超过4个。")],-1)),s[28]||(s[28]=b("div",null,"2、使用存储型套餐的实例不支持创建快照。",-1)),s[29]||(s[29]=b("div",null,"3、创建快照通常可以在5分钟内完成，请耐心等待，创建过程中无需关机。",-1))],64))]),b("div",O,[I(g(ae),{modelValue:g(ge),"onUpdate:modelValue":s[9]||(s[9]=e=>A(ge)?ge.value=e:null),placement:"right","popper-class":"myPopover",width:"200"},{reference:x(()=>[I(g(ne),{type:"primary"},{default:x(()=>[...s[38]||(s[38]=[C("创建快照",-1)])]),_:1})]),default:x(()=>[b("div",F,[I(g(le),{modelValue:g(he).SnapshotName,"onUpdate:modelValue":s[7]||(s[7]=e=>g(he).SnapshotName=e),disabled:g(he).createSnapshotDisable,size:"small",class:"mb-[1rem]",placeholder:"请输入快照名称"},null,8,["modelValue","disabled"]),b("div",G,[I(g(ne),{size:"small",type:"default",onClick:s[8]||(s[8]=e=>ge.value=!1)},{default:x(()=>[...s[36]||(s[36]=[C("取消",-1)])]),_:1}),I(g(ne),{type:"primary",size:"small",loading:g(he).createSnapshotDisable,onClick:qe},{default:x(()=>[...s[37]||(s[37]=[C("确定",-1)])]),_:1},8,["loading"])])])]),_:1},8,["modelValue"]),I(g(ne),{type:"default",onClick:s[10]||(s[10]=e=>Ce(!0))},{default:x(()=>[...s[39]||(s[39]=[b("span",{class:"svgtofont-el-refresh"},null,-1)])]),_:1})]),I(g(te),{data:g(he).snapshotsList,border:"","max-height":250,class:"mt-[1rem]"},{default:x(()=>[I(g(se),{prop:"SnapshotName",label:"快照名称",width:"120"}),I(g(se),{prop:"CreatedTime",label:"创建时间",formatter:e=>Te(e.CreatedTime)},null,8,["formatter"]),I(g(se),{prop:"TrafficUsed",label:"操作",align:"right"},{default:x(e=>[I(g(Z),{onClick:_e},{default:x(()=>[...s[40]||(s[40]=[C("回滚",-1)])]),_:1}),s[42]||(s[42]=b("div",{class:"el-divider el-divider--vertical"},null,-1)),I(g(Z),{onClick:s=>(async e=>{try{await oe({title:"删除[".concat(e.SnapshotName,"]快照"),content:"是否删除当前【".concat(e.SnapshotName,"】快照，删除后将无法恢复，是否继续？")});const s=ue.load("正在删除快照，请稍后..."),l=f.value?a:t,n=await l({SnapshotId:e.SnapshotId});s.close(),ue.request(n),await Ce()}catch(s){}})(e.row)},{default:x(()=>[...s[41]||(s[41]=[C("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1},8,["modelValue"])])),[[l,g(pe)]]):E("",!0),g(me)?(P(),T("div",J,[I(g(ee),{name:"svgtofont-el-warning",class:"text-danger"}),b("div",Q,[s[44]||(s[44]=C(" 密钥连接错误，请重新绑定或取消当前密钥关联! ",-1)),I(g(Z),{class:"ml-1rem",onClick:s[12]||(s[12]=e=>be())},{default:x(()=>[...s[43]||(s[43]=[C("[ 密钥管理 ]",-1)])]),_:1})])])):E("",!0)])}}});export{Y as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
