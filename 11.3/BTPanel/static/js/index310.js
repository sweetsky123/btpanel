import{R as a,fJ as t,Q as e,n as o,H as r,p as n,l as s}from"./utils-lib.js?v=1763689792";import{_ as i}from"./index109.js?v=1763689792";import{c as l,r as m,e as p,D as c,v as _,I as d,x as u,y as b,C as f,J as h,z as j,H as w}from"./base-lib.js?v=1763689792";import{am as g,an as y,ao as k}from"./firewall.js?v=1763689792";import{u as v}from"./column.js?v=1763689792";import{m as E,o as C}from"./useMethod8.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./useStore6.js?v=1763689792";import"./validator.js?v=1763689792";import"./index107.js?v=1763689792";const D=l({__name:"index",setup(l){const D=m(!1),x=m(),A=async()=>{await e({loading:D,request:g(),data:[Array,x]})},R=()=>{o({title:"自定义词库",area:44,component:()=>r(()=>import("./own-thesaurus.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},I=a=>{o({title:"添加监控",area:68,showFooter:!0,compData:{...a,refreshEvent:A},component:()=>r(()=>import("./add-monitor.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},L=[{label:"监控名",prop:"name"},{label:"网站/URL",prop:"url"},{label:"监控方式",prop:"method",render:a=>E[a.method]},{label:"上一次检测时间",minWidth:110,render:e=>a(e.last_scan_time)&&!e.last_scan_time.length?"未检测":e.last_scan_time?t(e.last_scan_time):"未检测"},{label:"上一次风险",minWidth:90,render:a=>[a.last_risk_count>0?p("span",{class:"bt-link !text-danger",onClick:()=>C(a)},[a.last_risk_count]):p("span",null,[c("无风险")])]},{label:"计划任务状态",prop:"crontab_status",minWidth:100,render:a=>[1===a.crontab_status?p("span",null,[c("正常")]):p("span",{style:"color:var(--el-color-warning);cursor:pointer",onClick:()=>(a=>o({isAsync:!0,title:"修复计划任务【".concat(a.name,"】"),area:64,component:()=>r(()=>import("./repair-crontab.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:{...a,refreshEvent:A},showFooter:!0}))(a)},[c("未设置")])]},{label:"发送告警",prop:"send_msg",render:a=>p("span",{style:"color:".concat(1===a.send_msg?"var(--el-color-primary)":"var(--el-color-warning)",";cursor:pointer"),onClick:()=>I(a)},[1===a.send_msg?"已开启":"未开启"])},{label:"检测频率",prop:"crontab_info",render:a=>a.crontab_info?a.crontab_info.cycle:a.crontab_info},v([{onClick:async a=>{var t;const n=await e({request:k({id:a.id})});o({title:"检测详情",area:[64,50],btn:["停止检测"],component:()=>r(()=>import("./scan-details.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:{name:a.name,id:a.id,path_info:null==(t=n.data)?void 0:t.path_info}})},title:"立即检测",width:70},{onClick:I,title:"编辑"},{onClick:async a=>{await n({icon:"warning-filled",title:"删除监控【"+a.name+"】",width:"34rem",content:"删除后无法继续监控该网站，是否继续？"}),await e({loading:"正在删除监控，请稍后...",request:y({id:a.id}),message:!0}),A()},title:"删除"}])];return _(()=>A()),(a,t)=>{const e=w,o=s,r=i,n=d("bt-loading");return u(),b("div",null,[p(r,null,{"header-left":f(()=>[p(e,{type:"primary",onClick:t[0]||(t[0]=a=>I())},{default:f(()=>[...t[1]||(t[1]=[c("添加监控",-1)])]),_:1}),p(e,{onClick:R},{default:f(()=>[...t[2]||(t[2]=[c("自定义词库",-1)])]),_:1})]),content:f(()=>[h(p(o,{ref:"portTable",column:L,data:j(x),description:"监控列表为空"},null,8,["data"]),[[n,j(D)],[n,"正在加载监控列表，请稍后...","title"]])]),popup:f(()=>[...t[3]||(t[3]=[])]),_:1})])}}});export{D as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
