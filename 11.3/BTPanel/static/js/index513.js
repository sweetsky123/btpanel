import{b3 as t,n as e,H as a,an as s,p as n,Q as o,ao as l,ap as r,M as i,aK as m,$ as c,aj as u}from"./utils-lib.js?v=1763689792";import{_ as p}from"./index109.js?v=1763689792";import{j as d,r as _,s as f,c as y,x as h,y as v,e as b,C as w,z as j,A as B}from"./base-lib.js?v=1763689792";import{getDirAuth as R,getFileDeny as L,deleteDirAuth as x,delFileDeny as E}from"./site.js?v=1763689792";import{u as C}from"./useController5.js?v=1763689792";import{a as g,u as D}from"./column.js?v=1763689792";import{o as T}from"./useController6.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./useStore4.js?v=1763689792";import"./validator.js?v=1763689792";import"./index110.js?v=1763689792";import"./index107.js?v=1763689792";import"./useMethod5.js?v=1763689792";const k=d("wp-wordpress-security",()=>({isRefreshLimitList:_(!1),isRefreshDenyList:_(!1)})),{localRow:P}=f(C()),I={class:"flex flex-col"},O=y({__name:"limit",setup(u){const{localRow:d}=f(C()),{isRefreshLimitList:_}=f(k()),{BtOperation:y}=t({options:[{onClick:()=>{e({title:"添加限制访问",area:48,component:()=>a(()=>import("./limit-form.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:{isEdit:!1,siteId:d.value.id,getList:()=>{_.value=!0}},btn:!0})},type:"button",active:!0,label:"添加限制访问"}]}),L=r([{label:"批量删除",value:"delete",event:async(t,e,a,s)=>{await n({title:"批量删除限制访问规则",content:"批量删除选中的限制访问规则，该操作可能会存在风险，是否继续？"});let o=i.load("正在删除,请稍后...");try{const t=await Promise.all(a.value.map(async t=>{try{const{data:e}=await x({id:d.value.id,name:t.name});return e.status?{name:t.name,status:!0}:{name:t.name,status:!1}}catch(e){return{name:t.name,status:!1}}}));T({resultData:t,resultTitle:"删除限制访问规则"}),_.value=!0}catch(l){m(l)}finally{o.close()}}}]),{BtTable:E,BtPage:O,BtRecommendSearch:A,BtRefresh:V,BtColumn:q,BtBatch:M,BtTableCategory:S,BtErrorMask:H,tableRef:N,classList:z,refresh:K}=s({request:t=>(async()=>{try{const{data:t}=await R({id:P.value.id});return{data:t[P.value.name],total:0,other:{search_history:[]}}}catch(t){return{data:[],total:0,other:{search_history:[]}}}})(),columns:[g(),{label:"名称",prop:"name"},{label:"路径",prop:"site_dir"},D([{onClick:t=>{e({title:"添加限制访问",area:48,component:()=>a(()=>import("./limit-form.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:{isEdit:!0,siteId:d.value.id,row:t,getList:()=>{_.value=!0}},btn:!0})},title:"编辑"},{onClick:t=>{n({title:"删除限制访问规则【".concat(t.name,"】"),content:"删除选中的规则后，访问".concat(t.site_dir,"将不再需要安全验证，是否继续操作？"),icon:"warning-filled",type:"calc",onConfirm:async()=>{await o({loading:"正在删除，请稍后...",request:x({id:d.value.id,name:t.name}),message:!0,success:()=>{_.value=!0}})}})},title:"删除"}])],extension:[l(_),L]});return(t,e)=>{const a=c,s=p;return h(),v("div",null,[b(s,null,{"header-left":w(()=>[b(j(y))]),content:w(()=>[b(j(E))]),"footer-left":w(()=>[B("div",I,[b(j(M)),b(a,{options:[{content:"目录设置加密访问后，访问时需要输入账号密码才能访问"},{content:"例如我设置了加密访问 /test/ ,那我访问 http://aaa.com/test/ 时就要输入账号密码才能访问"}],class:"ml-[20px] mt-[20px]"})])]),_:1})])}}}),A={class:"flex flex-col"},V=y({__name:"deny",setup(u){const{localRow:d}=f(C()),{isRefreshDenyList:_}=f(k()),{BtOperation:y}=t({options:[{onClick:()=>{e({title:"添加拒绝访问",area:48,component:()=>a(()=>import("./deny-form.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:{isEdit:!1,siteName:d.value.name,getList:()=>{_.value=!0}},btn:!0})},type:"button",active:!0,label:"添加拒绝访问"}]}),R=r([{label:"删除",value:"delete",event:async(t,e,a,s)=>{await n({title:"批量删除拒绝访问规则",content:"批量删除选中的拒绝访问规则，该操作可能会存在风险，是否继续？"});let o=i.load("正在删除,请稍后...");try{const t=await Promise.all(a.value.map(async t=>{try{const{data:e}=await E({website:d.value.name,deny_name:t.name});return e.status?{name:t.name,status:!0}:{name:t.name,status:!1}}catch(e){return{name:t.name,status:!1}}}));T({resultData:t,resultTitle:"删除拒绝访问规则"}),_.value=!0}catch(l){m(l)}finally{o.close()}}}]),{BtTable:x,BtPage:I,BtRecommendSearch:O,BtRefresh:V,BtColumn:q,BtBatch:M,BtTableCategory:S,BtErrorMask:H,tableRef:N,classList:z,refresh:K}=s({request:t=>(async()=>{try{const{data:t}=await L({website:P.value.name});return{data:t,total:0,other:{search_history:[]}}}catch(t){return{data:[],total:0,other:{search_history:[]}}}})(),columns:[g(),{label:"名称",prop:"name"},{label:"路径",prop:"dir"},D([{onClick:t=>{e({title:"添加拒绝访问",area:48,component:()=>a(()=>import("./deny-form.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:{isEdit:!0,siteName:d.value.name,row:t,getList:()=>{_.value=!0}},btn:!0})},title:"编辑"},{onClick:t=>{n({title:"删除拒绝访问规则【".concat(t.name,"】"),content:"删除选中的规则后，访问".concat(t.dir,"该保护目录将失去防护，是否继续操作？"),icon:"warning-filled",type:"calc",onConfirm:async()=>{await o({loading:"正在删除，请稍后...",request:E({website:d.value.name,deny_name:t.name}),message:!0,success:()=>{_.value=!0}})}})},title:"删除"}])],extension:[l(_),R]});return(t,e)=>{const a=c,s=p;return h(),v("div",null,[b(s,null,{"header-left":w(()=>[b(j(y))]),content:w(()=>[b(j(x))]),"footer-left":w(()=>[B("div",A,[b(j(M)),b(a,{options:[{content:"后缀：禁止访问的文件后缀"},{content:"目录：规则会在这个目录内生效"}],class:"mt-4px"})])]),_:1})])}}}),q=y({__name:"index",setup(t){const e=_("access"),s=[{name:"access",label:"访问限制",render:()=>O},{name:"deny",label:"拒绝访问",render:()=>V},{name:"hotlink",label:"防盗链",render:()=>a(()=>import("./index243.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)}],{BtTabs:n}=u({type:"card",options:s,value:e});return(t,e)=>(h(),v("div",null,[b(j(n))]))}});export{q as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
