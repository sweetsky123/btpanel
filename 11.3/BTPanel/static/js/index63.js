import{fd as e,R as a,ax as t,H as l,V as n,g0 as o,ak as r,aA as s,n as i,p as u,g1 as c,g2 as d,b as m,l as p,_,g3 as v,g4 as h,g5 as f,g6 as b,$ as w,aC as g}from"./utils-lib.js?v=1763689792";import{_ as y}from"./index109.js?v=1763689792";import{c as x,Y as j,Z as V,r as O,x as k,O as C,z as E,j as P,o as R,e as T,s as D,v as L,a8 as I,I as S,C as A,A as U,D as z,J as M,H as W,aw as q,y as B,aG as H,ad as N,U as J,ab as X,R as G}from"./base-lib.js?v=1763689792";import{u as Y}from"./column.js?v=1763689792";import{b as Z,c as $,s as F,r as K,d as Q}from"./useMethod9.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./validator.js?v=1763689792";import"./index107.js?v=1763689792";const ee=x({__name:"sender-select",props:j({isInit:{type:Boolean,default:!1}},{value:{},valueModifiers:{}}),emits:["update:value"],setup(l,{expose:n}){const o=l,r=V(l,"value"),s=O([]),i=async()=>{const{data:t}=await e();a(t.data)&&t.data.length>0&&(s.value=t.data.map(e=>({label:e.username,value:e.username})),r.value=t.data[0].username)};return o.isInit&&i(),n({getList:i}),(e,a)=>{const l=t;return k(),C(l,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=e=>r.value=e),filterable:!0,options:E(s),placeholder:"请选择发件人"},null,8,["modelValue","options"])}}}),ae=P("MAIL_INBOX",()=>{const e=O(),a=R({p:1,username:null}),{table:t,columns:o}=Z([{prop:"from",label:"发件人",width:250,showOverflowTooltip:!0},{prop:"to",label:"收件人",width:250,showOverflowTooltip:!0},{prop:"theme",label:"主题",minWidth:160,showOverflowTooltip:!0,render:e=>{const a=e.html;return(a||e.body||"").slice(0,2e3),(a||e.body||"").length,T("span",{class:"cursor-pointer",onClick:async()=>{const{onShowView:a}=await l(()=>Promise.resolve().then(()=>se),void 0,import.meta.url);a(e)}},[T("a",{class:"bt-link"},[e.subject])])}},{prop:"time",label:"时间",width:150,minWidth:150,render:e=>n(e.time)},Y([{title:"查看",onClick:async e=>{const{onShowView:a}=await l(()=>Promise.resolve().then(()=>se),void 0,import.meta.url);a(e)}},{title:"垃圾邮件",onClick:async e=>{const{onSpam:a}=await l(()=>Promise.resolve().then(()=>se),void 0,import.meta.url);a(e)}},{title:"删除",onClick:async e=>{const{onDel:a}=await l(()=>Promise.resolve().then(()=>se),void 0,import.meta.url);a(e)}}],{fixed:"right",width:200,label:"操作"})]);return{senderRef:e,search:a,table:t,columns:o,reset:()=>{a.p=1,a.username=null,t.data=[],t.total=0,e.value=null}}}),{search:te,table:le}=D(ae()),ne=m(),oe=async()=>{try{le.value.loading=!0;const{data:e}=await o({p:te.value.p,username:te.value.username||""});r(e)&&(le.value.data=a(e.data)?e.data:[],le.value.total=s(e.page))}finally{le.value.loading=!1}},re=()=>{te.value.p=1,oe()},se=Object.freeze(Object.defineProperty({__proto__:null,getList:oe,onDel:async e=>{const{data:a}=await d({path:e.path});ne.request(a),oe()},onShowView:e=>{i({title:"检查邮件【".concat(e.subject,"】"),area:[85,68],compData:{row:e},component:()=>l(()=>import("./mail-view.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},onSpam:async e=>{try{await u({title:"标记为垃圾邮件",content:"您确定要将此消息标记为垃圾邮件吗？"});const{data:a}=await c({path:e.path,username:te.value.username||""});ne.request(a),oe()}catch(a){}},refresh:re},Symbol.toStringTag,{value:"Module"})),ie={class:"w-460px flex items-center"},ue={class:"flex items-center"},ce=_(x({__name:"index",setup(e){const{search:a,table:t,senderRef:l}=D(ae()),{columns:n,reset:o}=ae();return L(async()=>{await l.value.getList()}),I(()=>{o()}),(e,o)=>{const r=W,s=p,i=q,u=y,c=S("bt-loading");return k(),C(u,null,{"header-left":A(()=>[U("div",ie,[o[2]||(o[2]=U("span",{class:"mr-[1rem] w-[7rem] text-base"},"邮箱地址",-1)),T(ee,{ref_key:"senderRef",ref:l,value:E(a).username,"onUpdate:value":[o[0]||(o[0]=e=>E(a).username=e),E(re)]},null,8,["value","onUpdate:value"])])]),"header-right":A(()=>[U("div",ue,[T(r,{onClick:E(re)},{default:A(()=>[...o[3]||(o[3]=[z("刷新",-1)])]),_:1},8,["onClick"])])]),content:A(()=>[M(T(s,{data:E(t).data,column:E(n)},null,8,["data","column"]),[[c,E(t).loading]])]),"footer-right":A(()=>[T(i,{size:"small","current-page":E(a).p,"onUpdate:currentPage":o[1]||(o[1]=e=>E(a).p=e),"page-size":10,layout:"prev, pager, next, total",total:E(t).total,background:"",onCurrentChange:E(oe)},null,8,["current-page","total","onCurrentChange"])]),_:1})}}}),[["__scopeId","data-v-6b3befa4"]]),de=P("MAIL_OUTBOX",()=>{const e=O(),a=R({p:1,username:null}),{table:t,columns:o}=Z([{prop:"from",label:"发件人",width:250,showOverflowTooltip:!0},{prop:"to",label:"收件人",width:250,showOverflowTooltip:!0},{prop:"theme",label:"主题",minWidth:160,showOverflowTooltip:!0,render:e=>{const a=e.html;return(a||e.body||"").slice(0,2e3),(a||e.body||"").length,T("span",{class:"cursor-pointer",onClick:async()=>{const{onShowView:a}=await l(()=>Promise.resolve().then(()=>fe),void 0,import.meta.url);a(e)}},[T("a",{class:"bt-link"},[e.subject])])}},{prop:"time",label:"时间",width:150,minWidth:150,render:e=>n(e.time)},Y([{title:"查看",onClick:async e=>{const{onShowView:a}=await l(()=>Promise.resolve().then(()=>fe),void 0,import.meta.url);a(e)}},{title:"删除",onClick:async e=>{const{onDel:a}=await l(()=>Promise.resolve().then(()=>fe),void 0,import.meta.url);a(e)}}],{width:200,fixed:"right",label:"操作"})]);return{search:a,table:t,columns:o,senderRef:e,reset:()=>{a.username=null,t.data=[],t.total=0,a.p=1}}}),{search:me,table:pe}=D(de()),_e=m(),ve=async()=>{try{pe.value.loading=!0;const{data:e}=await v({p:me.value.p,username:me.value.username||""});r(e)&&(pe.value.data=a(e.data)?e.data:[],pe.value.total=s(e.page))}finally{pe.value.loading=!1}},he=()=>{me.value.p=1,ve()},fe=Object.freeze(Object.defineProperty({__proto__:null,getList:ve,onDel:async e=>{const{data:a}=await d({path:e.path});_e.request(a),ve()},onShowView:e=>{i({title:"检查邮件【".concat(e.subject,"】"),area:[85,68],compData:{row:e},component:()=>l(()=>import("./mail-view.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},refresh:he},Symbol.toStringTag,{value:"Module"})),be={class:"w-460px flex items-center"},we={class:"flex items-center"},ge=_(x({__name:"index",setup(e){const{search:a,table:t,senderRef:l}=D(de()),{columns:n,reset:o}=de();return L(async()=>{await l.value.getList()}),I(()=>{o()}),(e,o)=>{const r=W,s=p,i=q,u=y,c=S("bt-loading");return k(),B("div",null,[T(u,null,{"header-left":A(()=>[U("div",be,[o[2]||(o[2]=U("span",{class:"mr-[1rem] w-[7rem] text-base"},"邮箱地址",-1)),T(ee,{ref_key:"senderRef",ref:l,value:E(a).username,"onUpdate:value":[o[0]||(o[0]=e=>E(a).username=e),E(he)]},null,8,["value","onUpdate:value"])])]),"header-right":A(()=>[U("div",we,[T(r,{onClick:E(he)},{default:A(()=>[...o[3]||(o[3]=[z("刷新",-1)])]),_:1},8,["onClick"])])]),content:A(()=>[M(T(s,{data:E(t).data,column:E(n)},null,8,["data","column"]),[[c,E(t).loading]])]),"footer-right":A(()=>[T(i,{size:"small","current-page":E(a).p,"onUpdate:currentPage":o[1]||(o[1]=e=>E(a).p=e),"page-size":10,layout:"prev, pager, next, total",total:E(t).total,background:"",onCurrentChange:E(ve)},null,8,["current-page","total","onCurrentChange"])]),_:1})])}}}),[["__scopeId","data-v-6ec76377"]]),ye=P("MAIL_SPAM",()=>{const e=O(),a=R({p:1,username:null}),{table:t,columns:o}=Z([{prop:"from",label:"发件人",width:250,minWidth:250,showOverflowTooltip:!0},{prop:"to",label:"收件人",width:250,minWidth:250,showOverflowTooltip:!0},{prop:"theme",label:"主题",minWidth:160,showOverflowTooltip:!0,render:e=>{const a=e.html;return(a||e.body||"").slice(0,2e3),(a||e.body||"").length,T("span",{class:"cursor-pointer",onClick:async()=>{const{onShowView:a}=await l(()=>Promise.resolve().then(()=>Ce),void 0,import.meta.url);a(e)}},[T("a",{class:"bt-link"},[e.subject])])}},{prop:"time",label:"时间",width:150,minWidth:150,render:e=>n(e.time)},Y([{title:"查看",onClick:async e=>{const{onShowView:a}=await l(()=>Promise.resolve().then(()=>Ce),void 0,import.meta.url);a(e)}},{title:"取消标记",onClick:async e=>{const{onSpam:a}=await l(()=>Promise.resolve().then(()=>Ce),void 0,import.meta.url);a(e)}},{title:"删除",onClick:async e=>{const{onDel:a}=await l(()=>Promise.resolve().then(()=>Ce),void 0,import.meta.url);a(e)}}],{fixed:"right",width:200,label:"操作"})]);return{search:a,table:t,columns:o,senderRef:e,reset:()=>{a.username=null,t.data=[],t.total=0,a.p=1}}}),{search:xe,table:je}=D(ye()),Ve=m(),Oe=async()=>{try{je.value.loading=!0;const{data:e}=await h({p:xe.value.p,username:xe.value.username||""});r(e)&&(je.value.data=a(e.data)?e.data:[],je.value.total=s(e.page))}finally{je.value.loading=!1}},ke=()=>{xe.value.p=1,Oe()},Ce=Object.freeze(Object.defineProperty({__proto__:null,getList:Oe,onDel:async e=>{const{data:a}=await d({path:e.path});Ve.request(a),Oe()},onShowView:e=>{i({title:"检查邮件【".concat(e.subject,"】"),area:[85,68],compData:{row:e},component:()=>l(()=>import("./mail-view.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},onSpam:async e=>{const{data:a}=await f({path:e.path,username:xe.value.username||""});Ve.request(a),Oe()},refresh:ke},Symbol.toStringTag,{value:"Module"})),Ee={class:"w-460px flex items-center"},Pe={class:"flex items-center"},Re=_(x({__name:"index",setup(e){const{search:a,table:t,senderRef:l}=D(ye()),{columns:n,reset:o}=ye();return L(async()=>{await l.value.getList()}),I(()=>{o()}),(e,o)=>{const r=W,s=p,i=q,u=y,c=S("bt-loading");return k(),C(u,null,{"header-left":A(()=>[U("div",Ee,[o[2]||(o[2]=U("span",{class:"mr-[1rem] w-[7rem] text-base"},"邮箱地址",-1)),T(ee,{ref_key:"senderRef",ref:l,value:E(a).username,"onUpdate:value":[o[0]||(o[0]=e=>E(a).username=e),E(ke)]},null,8,["value","onUpdate:value"])])]),"header-right":A(()=>[U("div",Pe,[T(r,{onClick:E(ke)},{default:A(()=>[...o[3]||(o[3]=[z("刷新",-1)])]),_:1},8,["onClick"])])]),content:A(()=>[M(T(s,{data:E(t).data,column:E(n)},null,8,["data","column"]),[[c,E(t).loading]])]),"footer-right":A(()=>[T(i,{size:"small","current-page":E(a).p,"onUpdate:currentPage":o[1]||(o[1]=e=>E(a).p=e),"page-size":10,layout:"prev, pager, next, total",total:E(t).total,background:"",onCurrentChange:E(Oe)},null,8,["current-page","total","onCurrentChange"])]),_:1})}}}),[["__scopeId","data-v-569a468f"]]),Te=P("MAIL_SEND",()=>{const e=O(),a=O(null),t=R({sender:null,mail_to:"",subject:"",content:""}),l={mail_to:{trigger:["blur","input"],validator:()=>""!==t.mail_to.trim()||new Error("请输入收件人")},subject:{trigger:["blur","input"],validator:()=>""!==t.subject.trim()||new Error("请输入邮件主题")},content:{validator:()=>""!==$()||new Error("请输入邮件内容")}};return{formRef:a,senderRef:e,form:t,rules:l,reset:()=>{t.sender=null,t.mail_to="",t.subject="",t.content="",e.value=null}}}),{form:De,formRef:Le}=D(Te()),Ie=m(),Se=async()=>{var e;await(null==(e=Le.value)?void 0:e.validate());const a={mail_from:De.value.sender||"",mail_to:JSON.stringify(De.value.mail_to.split(",")),subject:De.value.subject,content:$(),subtype:"html",smtp_server:"localhost"},{data:t}=await b(a);Ie.request(t),De.value.mail_to="",De.value.subject="",F("")},Ae={class:"p-[16px]"},Ue={class:"w-350px"},ze={class:"w-760px"},Me={class:"w-760px"},We=x({__name:"index",setup(e){const{form:a,formRef:t,senderRef:l}=D(Te()),{rules:n,reset:o}=Te();return L(()=>{K("editor"),l.value.getList()}),H(()=>{Q(),o()}),(e,o)=>{const r=N,s=J,i=W,u=X,c=w;return k(),B("div",Ae,[T(u,{ref_key:"formRef",ref:t,class:"pt-8px",model:E(a),rules:E(n)},{default:A(()=>[T(r,{label:"发件人",prop:"sender"},{default:A(()=>[U("div",Ue,[T(ee,{ref_key:"senderRef",ref:l,value:E(a).sender,"onUpdate:value":o[0]||(o[0]=e=>E(a).sender=e),placeholder:"请输入或选择用户邮箱"},null,8,["value"])])]),_:1}),T(r,{label:"收件人",prop:"mail_to"},{default:A(()=>[U("div",ze,[T(s,{modelValue:E(a).mail_to,"onUpdate:modelValue":o[1]||(o[1]=e=>E(a).mail_to=e),placeholder:'多个收件人使用 "," 来分隔收件人邮箱'},null,8,["modelValue"])])]),_:1}),T(r,{label:"主题",prop:"subject"},{default:A(()=>[U("div",Me,[T(s,{modelValue:E(a).subject,"onUpdate:modelValue":o[2]||(o[2]=e=>E(a).subject=e),placeholder:""},null,8,["modelValue"])])]),_:1}),T(r,{label:"内容",prop:"content"},{default:A(()=>[...o[3]||(o[3]=[U("div",{class:"w-[760px]"},[U("textarea",{class:"hidden",name:"editor",id:"editor",rows:"10"})],-1)])]),_:1}),T(r,{label:" ","show-feedback":!1},{default:A(()=>[T(i,{type:"primary",size:"large",onClick:E(Se)},{default:A(()=>[...o[4]||(o[4]=[z("发送",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"]),T(c,{class:"ml-24px mt-24px"},{default:A(()=>[...o[5]||(o[5]=[U("li",{class:"text-dangerDark"},"提示：此功能只建议测试发件功能用，真正使用请使用客户端软件（比如foxmail）或者api接口",-1)])]),_:1})])}}}),qe=x({__name:"index",setup(e){const a=O("inbox"),t=[{label:"收件箱",name:"inbox",lazy:!0,render:()=>T(ce,null,null)},{name:"outbox",label:"发件箱",lazy:!0,render:()=>T(ge,null,null)},{name:"spam",label:"垃圾邮件",lazy:!0,render:()=>T(Re,null,null)},{name:"sender",label:"发送邮件",lazy:!0,render:()=>T(We,null,null)}];return(e,l)=>{const n=g;return k(),B("div",null,[T(n,{type:"card",options:t,modelValue:E(a),"onUpdate:modelValue":l[0]||(l[0]=e=>G(a)?a.value=e:null)},null,8,["modelValue"])])}}});export{qe as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
