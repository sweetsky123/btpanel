import{u as e,ar as a,Q as t,iO as l,b8 as s,p as o,n,H as i,aK as r,ho as p,b3 as u,an as c,V as m,ao as d,B as _,ap as v,k as f,$ as b,aC as g}from"./utils-lib.js?v=1763689792";import{r as y,o as x,c as h,s as P,e as w,w as C,v as T,I as j,x as F,O as D,C as k,A as V,z as E,B as I,D as B,J as L,y as O,R,aD as S,ad as z,H as A,ab as q,ap as H}from"./base-lib.js?v=1763689792";import{B as U}from"./index119.js?v=1763689792";import{_ as M}from"./index109.js?v=1763689792";import{_ as W}from"./index110.js?v=1763689792";import{S as Z,_ as G}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1763689792";import{S as J,_ as K}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1763689792";import{u as N,a as Q,c as $,d as X,e as Y,f as ee,g as ae,h as te,b as le,i as se,j as oe,k as ne,s as ie}from"./useStore9.js?v=1763689792";import{a as re,i as pe,b as ue,j as ce,d as me,k as de,g as _e,u as ve}from"./column.js?v=1763689792";import{u as fe}from"./index147.js?v=1763689792";import{aL as be,p as ge}from"./validator.js?v=1763689792";import"./index.vue_vue_type_style_index_0_scoped_cdc7f4d3_lang.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./ace.js?v=1763689792";import"./index131.js?v=1763689792";import"./index107.js?v=1763689792";const{payment:ye,getGlobalInfo:xe}=e(),{ftpPort:he,rowData:Pe}=N(),{isEdit:we}=Q(),Ce=Z(),Te=J(),je=y("service"),Fe=y({}),De=y(!1),ke=y(),Ve=x({port:he.value}),Ee=x({port:[a()]}),Ie=async()=>{await ke.value.validate(),await t({loading:"正在修改FTP端口，请稍后...",request:l({port:Ve.port}),data:{status:Boolean},message:!0})},Be=y(!1),Le=y(""),Oe=[{content:"此处为pure-ftpd主配置文件，若您不了解配置规则，请勿随意修改"}],Re=async()=>{await t({loading:"正在保存配置，请稍后...",request:s({path:"/www/server/pure-ftpd/etc/pure-ftpd.conf",data:Le.value,encoding:"utf-8"}),message:!0})},Se=y(""),ze=y([]),Ae=y(!1),qe=async e=>{await o({title:"".concat(e?"开启":"关闭","pure-ftpd日志管理"),content:"".concat(e?"开启":"关闭","pure-ftpd日志管理后，将").concat(e?"":"无法","记录所有FTP用户的登录、操作记录，是否继续操作？")}),await t({loading:"正在".concat(e?"开启":"关闭","，请稍后..."),request:be({exec_name:e?"start":"stop"}),message:!0,success:He})},He=async()=>{await t({loading:"正在获取日志状态，请稍后...",request:be({exec_name:"getlog"}),success:e=>{Ae.value="start"===e.msg}})},Ue=async e=>{switch(je.value=e,e){case"manger":De.value=!0;break;case"service":case"portConfig":Me();break;case"config":(async()=>{await t({loading:Be,request:p({path:"/www/server/pure-ftpd/etc/pure-ftpd.conf"}),data:{data:[String,Le]}})})();break;case"logs":He()}},Me=e=>{e.id&&(Fe.value=e);const a={...Fe.value,name:"pure-ftpd"};Ce.init(a),Te.init(a),Se.value=Fe.value.version,ze.value=Fe.value.versions,(async()=>{try{await xe()}catch(e){r(e)}})()},We=e=>(Pe.value=e,we.value=!!e,n({title:"".concat(e?"修改FTP用户【".concat(e.name,"】"):"添加FTP用户"),area:50,btn:"保存",compData:e||{},component:()=>i(()=>import("./index329.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})),Ze=e=>{Pe.value=e,n({title:"快速连接",area:48,compData:e,component:()=>i(()=>import("./index335.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},Ge=e=>{"ltd"===ye.value.authType?Je(e):ge({sourceId:52})},Je=e=>{Pe.value=e,n({title:"【".concat(e.name,"】FTP配额容量"),area:50,btn:!0,compData:e,component:()=>i(()=>import("./index331.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},Ke=e=>{Pe.value=e,n({title:"修改FTP权限配置-[".concat(e.name,"]"),area:72,btn:"保存",compData:e,component:()=>i(()=>import("./index334.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},Ne=async e=>{Pe.value=e,n({title:"查看FTP日志【"+e.name+"】",area:[70,58],compData:e,component:()=>i(()=>import("./index337.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},Qe={class:"my-[10px]"},$e={class:"flex items-center mb-[20px]"},Xe=h({__name:"index",props:{compData:{default:{}}},setup(a){const t=a,{serverIp:l}=e(),{rowData:s,ftpPort:o,isRefreshFtpList:r,pluginInfo:p}=N(),{compData:x}=P(Z()),h=y([]),J=fe({key:"type_id",name:"FTP分类",options:()=>[{label:"全部分类",value:"all"}],event:{get:async()=>{const e=await $();return h.value=e,e},add:X,update:Y,delete:ee}}),{BtOperation:Q}=u({options:[{type:"button",label:"添加FTP",active:!0,onClick:()=>We()}]}),be=v([{label:"启用FTP",value:"start",event:ne},{label:"停用FTP",value:"stop",event:ne},{label:"改密FTP",value:"exitPaw",event:async(e,a,t,l,o)=>{s.value={selectedList:t,clearSelection:o},await n({title:"批量修改FTP密码",area:"auto",btn:!0,compData:{selectedList:t,clearSelection:o},component:()=>i(()=>import("./index336.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})}},{label:"设置分类",value:"setClass",event:async(e,a,t,l,s,o)=>{ie(t,s,h,o)}},{label:"删除FTP",value:"delete",event:ne}]),{BtTable:ge,BtPage:ye,BtSearch:xe,BtRefresh:he,BtColumn:Pe,BtBatch:we,BtTableCategory:Ce,refresh:Te}=c({request:e=>"manger"!==je.value?Promise.resolve({data:[],total:0}):("all"===e.type_id&&(e.type_id=""),ae(e)),columns:[re(),{label:"用户名",prop:"name",minWidth:100},pe(),ue({event:te,data:["已停用","已启用"],width:80}),ce({label:"快速连接",width:80,isCustom:!1,title:"复制快速连接信息",text:"点击查看",event:Ze}),me(),{label:"密码有效期",minWidth:100,isCustom:!1,title:"设置密码有效期",prop:"end_time",render:e=>{let{isOrange:a,isEnd:t}=le(e);return w("span",{onClick:()=>{s.value=e,(e=>{n({title:"设置密码有效期",area:46,btn:!0,compData:e,component:()=>i(()=>import("./index330.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})})(e)},title:"设置密码有效期",style:"color:#".concat(t?"ef0808":a?"f0ad4e":"20a53a",";cursor:pointer")},["0"!==e.end_time?m(Number(e.end_time),"yyyy-MM-dd"):"永久"])}},de({isCustom:!1,event:Ge}),_e({table:"ftps",width:100}),ve([{onClick:Ke,title:"配置"},{onClick:We,title:"修改"},{onClick:Ne,title:"日志"},{onClick:se,title:"删除"}])],extension:[J,be,d(r)]});return C(()=>De.value,e=>{e&&Te()}),C(()=>r.value,e=>{Te()},{immediate:!0,deep:!0}),T(()=>{t.compData&&(p.value=t.compData),Me(p.value),je.value="service",x.value.refreshEvent=oe}),(e,a)=>{const t=W,s=S,n=M,i=f,r=z,p=A,u=q,c=U,m=b,d=H,v=g,y=j("bt-loading");return F(),D(v,{modelValue:E(je),"onUpdate:modelValue":a[4]||(a[4]=e=>R(je)?je.value=e:null),type:"left-bg-card",position:"left",class:"h-full",onChange:E(Ue)},{default:k(()=>[w(s,{label:"服务",name:"service",lazy:!0},{default:k(()=>[V("div",null,[w(G),w(t,{direction:"horizontal"}),a[5]||(a[5]=V("span",null," 当前FTP地址为： ",-1)),V("span",{class:"cursor-pointer",title:"点击复制FTP路径",onClick:a[0]||(a[0]=e=>E(_)({value:"ftp://".concat(E(l)||"IP地址",":").concat(E(o)||"端口")}))}," ftp://"+I(E(l)||"IP地址")+":"+I(E(o)||"端口"),1),w(t),a[6]||(a[6]=V("span",{class:"bt-link"},[V("a",{target:"_self",href:"https://download.bt.cn/win/filezilla/FileZilla-setup.exe"}," 下载FTP连接工具(FileZilla, 免费开源) ")],-1)),w(K)])]),_:1}),w(s,{label:"用户管理",name:"manger",lazy:!0},{default:k(()=>[w(n,null,{"header-left":k(()=>[w(E(Q))]),"header-right":k(()=>[w(E(Ce),{class:"!w-[140px] mr-[10px]"}),w(E(xe),{class:"!w-[20rem] mr-[10px]",placeholder:"请输入用户名"}),w(E(he),{class:"mr-[10px]"}),w(E(Pe))]),content:k(()=>[w(E(ge),{"max-height":420})]),"footer-left":k(()=>[w(E(we))]),"footer-right":k(()=>[w(E(ye))]),_:1})]),_:1}),w(s,{label:"端口配置",name:"portConfig",lazy:!0},{default:k(()=>[w(u,{ref_key:"portFormRef",ref:ke,model:E(Ve),rules:E(Ee),"label-width":"80px",class:"-ml-2rem"},{default:k(()=>[w(r,{label:"默认端口"},{default:k(()=>[w(i,{type:"number",modelValue:E(Ve).port,"onUpdate:modelValue":a[1]||(a[1]=e=>E(Ve).port=e),placeholder:"请输入端口",width:"14rem"},null,8,["modelValue"])]),_:1}),w(r,{label:" "},{default:k(()=>[w(p,{type:"primary",onClick:E(Ie)},{default:k(()=>[...a[7]||(a[7]=[B("保存",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1}),w(s,{label:"配置文件",name:"config",lazy:!0},{default:k(()=>[L((F(),O("div",null,[a[9]||(a[9]=V("span",{class:"my-[4px] text-secondary"}," 提示：Ctrl+F 搜索关键字，Ctrl+S 保存，Ctrl+H 查找替换 ",-1)),V("div",Qe,[w(c,{class:"!h-[40rem] !w-full",modelValue:E(Le),"onUpdate:modelValue":a[2]||(a[2]=e=>R(Le)?Le.value=e:null),id:"configContent",onSave:E(Re)},null,8,["modelValue","onSave"])]),w(p,{type:"primary",onClick:E(Re)},{default:k(()=>[...a[8]||(a[8]=[B("保存",-1)])]),_:1},8,["onClick"]),w(m,{options:E(Oe),class:"mt-1rem"},null,8,["options"])])),[[y,E(Be)]])]),_:1}),w(s,{label:"日志管理",name:"logs",lazy:!0},{default:k(()=>[V("div",null,[V("div",$e,[a[10]||(a[10]=V("span",{class:"mr-[8px]"},"日志管理开关",-1)),w(d,{modelValue:E(Ae),"onUpdate:modelValue":a[3]||(a[3]=e=>R(Ae)?Ae.value=e:null),onChange:E(qe)},null,8,["modelValue","onChange"])]),a[11]||(a[11]=V("ul",{class:"leading-8 text-small list-disc ml-[20px]"},[V("li",null,"开启后，将记录所有FTP用户的登录、操作记录")],-1))])]),_:1})]),_:1},8,["modelValue","onChange"])}}});export{Xe as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
