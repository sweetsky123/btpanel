import{c as e,r as a,o as t,v as s,n as r,x as o,y as l,e as d,C as i,A as m,z as u,D as c,G as p,H as n,ad as f,ab as j}from"./base-lib.js?v=1763689792";import{B as _}from"./index422.js?v=1763689792";import{aQ as y,jp as b,b as h,_ as x}from"./utils-lib.js?v=1763689792";import{k as v}from"./useController4.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./validator.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";import"./useController5.js?v=1763689792";import"./site.js?v=1763689792";import"./useStore4.js?v=1763689792";import"./useController6.js?v=1763689792";import"./useMethod5.js?v=1763689792";const D={class:"p-2rem"},C={class:"flex items-center"},k={key:0,class:"text-tertiary mt-[8px] ml-10rem"},w=x(e({__name:"index",props:{compData:{default:()=>{}}},emits:["close"],setup(e,{expose:x,emit:w}){const T=h(),Y=e,{rowData:g,siteType:A}=Y.compData,E=!!Array.isArray(g),{refreshSiteTable:M}=y(),S=w,V=a(),q=t({edate:g.edate||""}),H={},z=e=>e.getTime()<Date.now()-864e5,B=()=>{q.edate="",G(),O()},G=()=>{const e=document.querySelector(".date .el-input__inner");e&&(e.value="永久"),null==e||e.blur()},I=e=>{e||G()},O=async e=>{try{if(E){let e=[],a=[];g.forEach(a=>{e.push(a.id)});const t=await b({edate:q.edate?q.edate:"0000-00-00",sites_id:e});Object.keys(t.error).forEach(e=>{a.push({name:e,status:!1})}),await t.success.forEach(e=>{a.push({name:e,status:!0})}),v({title:"批量设置到期时间",resultTitle:"设置到期时间",resultData:a}),M(),S("close")}else{let e=T.load("正在设置到期时间，请稍后...");const a=await b({id:g.id,edate:q.edate?q.edate:"0000-00-00"});a.data.status?(T.request(a),M()):T.error(a.data.msg),e.close(),S("close")}}catch(a){}};return x({onConfirm:O}),s(()=>{"0000-00-00"===g.edate&&(q.edate="",r(()=>{G()}))}),(e,a)=>{const t=_,s=n,r=f,y=j;return o(),l("div",D,[d(y,{ref_key:"formRef",ref:V,model:u(q),rules:H},{default:i(()=>[d(r,{label:"到期时间",prop:"edate"},{default:i(()=>[m("div",C,[d(t,{modelValue:u(q).edate,"onUpdate:modelValue":a[0]||(a[0]=e=>u(q).edate=e),"value-format":"YYYY-MM-DD","disabled-date":z,class:"date",onChange:I,type:"date",placeholder:"选择日期"},null,8,["modelValue"]),d(s,{type:"default",class:"!ml-[.4rem]",onClick:B},{default:i(()=>[...a[1]||(a[1]=[c(" 设为永久 ",-1)])]),_:1})])]),_:1})]),_:1},8,["model"]),u(q).edate?(o(),l("div",k,"* 到期当天24点后过期")):p("",!0)])}}}),[["__scopeId","data-v-0cf3bc99"]]);export{w as default};
