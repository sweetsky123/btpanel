import{_ as e}from"./index109.js?v=1763689792";import{L as a,hT as t,hU as l,b as i,k as m,hE as s,ak as d,n as r,p as n,hV as _,u,f0 as o,x as p,V as c,hx as h,N as b}from"./utils-lib.js?v=1763689792";import{_ as x}from"./version-compare.vue_vue_type_script_setup_true_lang.js?v=1763689792";import{s as k,j as v,r as g,c as y,g as w,x as f,y as q,e as V,C as P,z as j,V as B,ad as C,w as H,aP as U,D,A as E}from"./base-lib.js?v=1763689792";import{u as T}from"./column.js?v=1763689792";import{e as W}from"./validator.js?v=1763689792";import{b as F,f as L}from"./form-item.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./index107.js?v=1763689792";const A=v("VHOST-PACKAGE-STORE",()=>{const e=g(!1),a=g({package_name:"",remark:"",disk_space_quota:{value:0,unlimited:!0},monthly_bandwidth_limit:{value:0,unlimited:!0},max_site_limit:{value:0,unlimited:!0},php_start_children:1,php_max_children:3,max_database:{value:0,unlimited:!0}}),t=g(0);return{isEdit:e,formData:a,refreshInfo:t,refreshList:()=>{t.value=(new Date).getTime()},resetFormData:()=>{a.value={package_name:"",remark:"",disk_space_quota:{value:0,unlimited:!0},monthly_bandwidth_limit:{value:0,unlimited:!0},max_site_limit:{value:0,unlimited:!0},php_start_children:1,php_max_children:3,max_database:{value:0,unlimited:!0}},e.value=!1}}}),O=()=>{const e=A(),a=k(e);return{...e,...a}},S={class:"p-[2rem]"},I=y({__name:"index",setup(e,{expose:s}){const{isEdit:d,formData:r,refreshList:n,resetFormData:_}=O(),{request:u,load:o}=i(),{BtForm:p,submit:c}=a({data:r.value,options:e=>w(()=>[F("资源包名称","package_name",{attrs:{class:"!w-[22rem]",clearable:!0,placeholder:"请输入资源包名称"},rules:[{required:!0,message:"资源包名称不能为空！",trigger:"blur"},{min:2,max:20,message:"资源包名称在 2 到 20 个字符",trigger:"blur"}]}),{type:"slots",key:"disk_space_quota",rules:{"disk_space_quota.value":[{required:!0,message:"磁盘配额空间不能为空！",trigger:"blur"}]}},{type:"slots",key:"monthly_bandwidth_limit",rules:{"monthly_bandwidth_limit.value":[{required:!0,message:"每月带宽限制不能为空！",trigger:"blur"}]}},{type:"slots",key:"max_site_limit",rules:{"max_site_limit.value":[{required:!0,message:"最大网站数不能为空！",trigger:"blur"}]}},{type:"slots",key:"max_database",rules:{"max_database.value":[{required:!0,message:"最大数据库数不能为空！",trigger:"blur"}]}},F("PHP起始子进程","php_start_children",{attrs:{class:"!w-[22rem]",type:"number",clearable:!0,placeholder:"请输入最大子进程数"},rules:[{required:!0,message:"PHP起始子进程不能为空！",trigger:"blur"}]}),F("PHP最大子进程","php_max_children",{attrs:{class:"!w-[22rem]",type:"number",clearable:!0,placeholder:"请输入最大子进程数"},rules:[{required:!0,message:"PHP最大子进程不能为空！",trigger:"blur"}]}),F("备注","remark",{attrs:{class:"!w-[22rem]",clearable:!0,placeholder:"请输入备注内容，可为空"}}),L("备注",[{content:"PHP起始子进程数量：此值越大网站响应性能越好，同时内存占用越高"},{content:"PHP最大子进程数量：此值越大网站并发性能越好，同时峰值内存占用越高"}])]),submit:async(e,a,i)=>{await a();let m=Q(e.value,!0),s={};const r=o("正在提交表单，请稍候...");d.value||delete m.package_id;try{if(s=d.value?await t(m):await l(m),_(),u(s),n(),!s.status)return!1}catch(p){}finally{r.close()}return s}});return s({onConfirm:c,onCancel:_}),(e,a)=>{const t=m,l=B,i=C;return f(),q("div",S,[V(j(p),{"label-width":"120px"},{disk_space_quota:P(()=>[V(i,{prop:"disk_space_quota.value",label:"磁盘配额空间(MB)"},{default:P(()=>[V(t,{type:"number",modelValue:j(r).disk_space_quota.value,"onUpdate:modelValue":a[0]||(a[0]=e=>j(r).disk_space_quota.value=e),width:"22rem",disabled:j(r).disk_space_quota.unlimited,clearable:"",class:"mr-[10px]"},null,8,["modelValue","disabled"]),V(l,{modelValue:j(r).disk_space_quota.unlimited,"onUpdate:modelValue":a[1]||(a[1]=e=>j(r).disk_space_quota.unlimited=e),label:"无限制"},null,8,["modelValue"])]),_:1})]),monthly_bandwidth_limit:P(()=>[V(i,{prop:"monthly_bandwidth_limit.value",label:"每月带宽限制(MB)"},{default:P(()=>[V(t,{type:"number",modelValue:j(r).monthly_bandwidth_limit.value,"onUpdate:modelValue":a[2]||(a[2]=e=>j(r).monthly_bandwidth_limit.value=e),disabled:j(r).monthly_bandwidth_limit.unlimited,width:"22rem",class:"mr-[10px]"},null,8,["modelValue","disabled"]),V(l,{modelValue:j(r).monthly_bandwidth_limit.unlimited,"onUpdate:modelValue":a[3]||(a[3]=e=>j(r).monthly_bandwidth_limit.unlimited=e),label:"无限制"},null,8,["modelValue"])]),_:1})]),max_site_limit:P(()=>[V(i,{prop:"max_site_limit.value",label:"最大网站数"},{default:P(()=>[V(t,{type:"number",modelValue:j(r).max_site_limit.value,"onUpdate:modelValue":a[4]||(a[4]=e=>j(r).max_site_limit.value=e),disabled:j(r).max_site_limit.unlimited,width:"22rem",class:"mr-[10px]"},null,8,["modelValue","disabled"]),V(l,{modelValue:j(r).max_site_limit.unlimited,"onUpdate:modelValue":a[5]||(a[5]=e=>j(r).max_site_limit.unlimited=e),label:"无限制"},null,8,["modelValue"])]),_:1})]),max_database:P(()=>[V(i,{prop:"max_database.value",label:"最大数据库数"},{default:P(()=>[V(t,{type:"number",modelValue:j(r).max_database.value,"onUpdate:modelValue":a[6]||(a[6]=e=>j(r).max_database.value=e),disabled:j(r).max_database.unlimited,width:"22rem",class:"mr-[10px]"},null,8,["modelValue","disabled"]),V(l,{modelValue:j(r).max_database.unlimited,"onUpdate:modelValue":a[7]||(a[7]=e=>j(r).max_database.unlimited=e),label:"无限制"},null,8,["modelValue"])]),_:1})]),_:1})])}}}),{error:M,request:R}=i(),{isEdit:z,refreshList:G,formData:K}=O(),N=async e=>{n({title:"删除资源包".concat(e.package_name),content:"删除".concat(e.package_name,"资源包，是否继续？"),onConfirm:async()=>{if(1===e.status)return M("资源包正在使用中，无法删除");const a=await _({package_id:e.package_id});await R(a),G()}})},J=async(e=!1)=>{e&&(z.value=!0,K.value=Q(e,!1)),r({title:"".concat(e?"编辑":"添加","资源包"),area:50,showFooter:!0,component:I})},Q=(e,a)=>a?{package_id:null==e?void 0:e.package_id,package_name:e.package_name,remark:e.remark,disk_space_quota:e.disk_space_quota.unlimited?0:1024*e.disk_space_quota.value*1024,monthly_bandwidth_limit:e.monthly_bandwidth_limit.unlimited?0:1024*e.monthly_bandwidth_limit.value*1024,max_site_limit:e.max_site_limit.unlimited?0:e.max_site_limit.value,php_start_children:e.php_start_children,php_max_children:e.php_max_children,max_email_account:0,max_database:e.max_database.unlimited?0:e.max_database.value}:{package_id:null==e?void 0:e.package_id,package_name:e.package_name,remark:e.remark,disk_space_quota:{value:e.disk_space_quota?e.disk_space_quota/1024/1024:0,unlimited:0===e.disk_space_quota},monthly_bandwidth_limit:{value:e.monthly_bandwidth_limit?e.monthly_bandwidth_limit/1024/1024:0,unlimited:0===e.monthly_bandwidth_limit},max_site_limit:{value:e.max_site_limit,unlimited:0===e.max_site_limit},php_start_children:e.php_start_children,php_max_children:e.php_max_children,max_email_account:0,max_database:{value:e.max_database,unlimited:0===e.max_database}},X=y({__name:"index",setup(a){const{mainHeight:t}=u(),{refreshInfo:l}=O(),{BtTable:i,BtSearch:m,BtRefresh:r,BtPage:n,refresh:_}=o({request:e=>(async e=>{const{data:a}=await s({p:e.p,search_value:e.search,rows:e.limit});return d(a)?{data:a.list,total:a.page.count}:{data:[],total:0}})(e),columns:[{label:"资源包名称",prop:"package_name",minWidth:84},{label:"网站",prop:"php_start_children",minWidth:80,render:e=>V("div",null,[0===e.max_site_limit?"无限制":e.max_site_limit])},{label:"磁盘配额",prop:"disk_space_quota",minWidth:100,render:e=>V("div",null,[0===e.disk_space_quota?"无限制":p(e.disk_space_quota,!0,0)])},{label:"月带宽限制",prop:"monthly_bandwidth_limit",minWidth:100,render:e=>V("div",null,[0===e.monthly_bandwidth_limit?"无限制":p(e.monthly_bandwidth_limit,!0,0)])},{label:"备注",prop:"remark",minWidth:80,render:e=>e.remark?e.remark:"--"},{label:"创建时间",prop:"create_time",minWidth:140,render:e=>c(e.create_time)},T([{onClick:J,title:"编辑"},{onClick:N,title:"删除"}])],extension:[h()]});return H(()=>l.value,_),(a,l)=>{const s=U("BtOperation"),d=b,_=U("BtTableCategory"),u=U("BtBatch"),o=e;return f(),q("div",null,[V(x),V(o,null,{"header-left":P(()=>[V(s),V(d,{type:"primary",onClick:l[0]||(l[0]=e=>j(J)())},{default:P(()=>[...l[2]||(l[2]=[D("添加资源包",-1)])]),_:1}),E("div",{class:"flex items-center ml-1rem",onClick:l[1]||(l[1]=e=>j(W)({name:"用户管理",type:35,id:62}))},[...l[3]||(l[3]=[E("i",{class:"svgtofont-desired text-medium mr-[4px]"},null,-1),E("span",{class:"bt-link"},"需求反馈",-1)])])]),"header-right":P(()=>[V(_,{class:"!w-[140px] mr-[10px]"}),V(j(m),{placeholder:"请输入资源包名称",class:"!w-[270px] mr-[10px]"}),V(j(r))]),content:P(()=>[V(j(i),{"min-height":j(t)},null,8,["min-height"])]),"footer-left":P(()=>[V(u)]),"footer-right":P(()=>[V(j(n))]),_:1})])}}});export{X as default};
