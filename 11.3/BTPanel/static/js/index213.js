import{Q as e,b8 as a,M as l,aK as s,bK as t,$ as o,aC as n,_ as r}from"./utils-lib.js?v=1763689792";import{_ as u}from"./index123.js?v=1763689792";import{r as i,c,v as m,I as p,x as d,O as v,C as f,e as _,A as b,z as y,R as h,J as w,D as g,y as x,F as k,b1 as V,B as C,G as j,aD as U,H as A,am as q,an as T,ax as S,az as B,U as R,ad as D,ab as H}from"./base-lib.js?v=1763689792";import{B as K}from"./index119.js?v=1763689792";import{_ as z}from"./index110.js?v=1763689792";import{S as I,_ as O}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1763689792";import{S as P,_ as W}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1763689792";import{bx as E,by as F,b0 as $,a_ as G,m as J,bz as M,bA as N,bB as Q,a$ as L}from"./validator.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./ace.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";const X=P(),Y=I(),Z=i({}),ee={UpTime:"启动时间(Uptime)",IdleWorkers:"空闲进程(IdleWorkers)",TotalAccesses:"总连接数(TotalAccesses)",TotalKBytes:"传送总字节(TotalkBytes)",workermem:"Apache使用内存",workercpu:"Apache使用CPU",ReqPerSec:"每秒请求数(ReqPerSec)",RestartTime:"重启时间(RestartTime)",BusyWorkers:"繁忙进程(BusyWorkers)"},ae=i([]),le=i("service"),se=i(""),te=i(!1),oe=i(!1),ne=i([]),re=i(""),ue=i(""),ie=i([]),ce=[{content:"此处为apache主配置文件,若您不了解配置规则,请勿随意修改"}],me=i(!1),pe=a=>{e({loading:"正在设置守护进程，请稍后...",request:E({status:a?1:0}),message:!0,success:e=>{e.status||(me.value=!a)}})},de=async()=>{let a={};ae.value.forEach(e=>{a[e.name]=e.value}),await e({loading:"正在保存中，请稍后...",request:F(a),message:!0})},ve=async()=>{await e({loading:"正在保存中，请稍后...",request:a({path:"/www/server/apache/conf/httpd.conf",data:se.value,encoding:"utf-8"}),message:!0})},fe=async()=>{await e({loading:te,request:$({path:"/www/wwwlogs/error_log"}),data:{msg:[String,re]}})},_e=async e=>{let[a,t]=e.version.split("."),o=[a,t].join(".");if(ue.value!==o)try{await G({sName:"apache",version:ue.value,min_version:""}),J()}catch(n){s(n)}else l.error("当前版本与选择版本一致")},be=({props:{name:a}})=>{switch(a){case"service":ye();break;case"performance":(async()=>{await e({loading:te,request:N(),data:[Array,ae]})})();break;case"config":(async()=>{await e({loading:te,request:L({path:"/www/server/apache/conf/httpd.conf"}),data:{data:[String,se]}})})();break;case"load":(async()=>{await e({loading:te,request:Q(),success:e=>{ne.value=[],Object.keys(e.data).forEach(a=>{ne.value.push({name:a,ps:ee[a],value:e.data[a]})})}})})();break;case"logs":fe()}},ye=e=>{le.value="service",e&&(Z.value=e),Y.init(Z.value),X.init({name:"apache"}),ue.value=Z.value.version.split(".")[0]+"."+Z.value.version.split(".")[1],ie.value=Z.value.versions,(async()=>{try{const e=await M();me.value=1===e.data.status}catch(e){}})()},he={class:"my-[12px]"},we={class:"flex text-secondary items-center"},ge={class:"flex flex-col text-secondary performance"},xe={key:0,class:"flex items-center"},ke={key:1,class:"flex items-center"},Ve=r(c({__name:"index",props:{compData:{default:{}}},emits:["close"],setup(e,{emit:a}){const l=e;return m(()=>{ye(l.compData)}),(a,l)=>{const s=z,r=t,i=o,c=U,m=K,I=A,P=q,E=T,F=S,$=B,G=R,J=D,M=H,N=u,Q=n,L=p("bt-loading");return d(),v(Q,{modelValue:y(le),"onUpdate:modelValue":l[4]||(l[4]=e=>h(le)?le.value=e:null),type:"left-bg-card",onTabClick:y(be)},{default:f(()=>[_(c,{label:"服务",name:"service"},{default:f(()=>[_(O),_(W),_(s,{direction:"horizontal"}),b("div",null,[b("div",null,[l[5]||(l[5]=b("span",null,"守护进程：",-1)),_(r,{class:"mr-[2rem]",modelValue:y(me),"onUpdate:modelValue":l[0]||(l[0]=e=>h(me)?me.value=e:null),onChange:y(pe)},null,8,["modelValue","onChange"])]),_(i,{class:"mt-1rem",options:[{content:"守护进程可以在Apache服务停止后自动启动，保证Apache服务一直运行。"}]})])]),_:1}),_(c,{label:"配置文件",name:"config"},{default:f(()=>[l[7]||(l[7]=b("span",{class:"my-[4px] text-secondary"},"提示：Ctrl+F 搜索关键字，Ctrl+S 保存，Ctrl+H 查找替换",-1)),b("div",he,[w(_(m,{class:"!h-[40rem] !w-[54rem] my-[12px]",modelValue:y(se),"onUpdate:modelValue":l[1]||(l[1]=e=>h(se)?se.value=e:null),id:"configContent",filePath:"/www/server/apache/conf/httpd.conf"},null,8,["modelValue"]),[[L,y(te)]])]),_(I,{type:"primary",onClick:y(ve)},{default:f(()=>[...l[6]||(l[6]=[g("保存",-1)])]),_:1},8,["onClick"]),_(i,{options:y(ce),class:"ml-[20px] mt-[20px]"},null,8,["options"])]),_:1}),_(c,{label:"版本切换",name:"version"},{default:f(()=>[b("div",we,[l[9]||(l[9]=b("span",null,"选择版本",-1)),_(E,{class:"mx-[12px] !w-[18rem]",modelValue:y(ue),"onUpdate:modelValue":l[2]||(l[2]=e=>h(ue)?ue.value=e:null)},{default:f(()=>[(d(!0),x(k,null,V(y(ie),(e,a)=>(d(),v(P,{key:a,label:"apache "+e.m_version,value:e.m_version},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),_(I,{type:"primary",onClick:l[3]||(l[3]=a=>y(_e)(e.compData))},{default:f(()=>[...l[8]||(l[8]=[g("切换",-1)])]),_:1})])]),_:1}),_(c,{label:"负载状态",name:"load"},{default:f(()=>[w((d(),v($,{maxHeight:"500",data:y(ne),border:"",style:{width:"100%"}},{default:f(()=>[_(F,{prop:"ps",label:"字段"}),_(F,{prop:"value",label:"当前值"})]),_:1},8,["data"])),[[L,y(te)]])]),_:1}),w((d(),v(c,{label:"性能调整",name:"performance"},{default:f(()=>[b("div",ge,[_(M,{"label-position":"right","label-width":"186px"},{default:f(()=>[(d(!0),x(k,null,V(y(ae),(e,a)=>(d(),v(J,{label:e.name,key:a},{default:f(()=>["KeepAlive"!=e.name?(d(),x("div",xe,[_(G,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,type:"worker_processes"!==e.name?"number":""},null,8,["modelValue","onUpdate:modelValue","type"]),b("span",null,C(e.ps),1)])):j("",!0),"KeepAlive"==e.name?(d(),x("div",ke,[_(E,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,class:"!w-[8rem] mr-8px"},{default:f(()=>[_(P,{label:"开启",value:"On"}),_(P,{label:"关闭",value:"Off"})]),_:1},8,["modelValue","onUpdate:modelValue"]),b("span",null,C(e.ps),1)])):j("",!0)]),_:2},1032,["label"]))),128)),_(J,{label:" "},{default:f(()=>[_(I,{onClick:y(de),type:"primary"},{default:f(()=>[...l[10]||(l[10]=[g("保存",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1})])]),_:1})),[[L,y(oe)]]),_(c,{label:"运行日志",name:"logs"},{default:f(()=>[w(_(N,{content:y(re),autoScroll:!0,isHtml:!0,"full-screen":{title:"全屏查看日志",onRefresh:y(fe)},style:"height:540px"},null,8,["content","full-screen"]),[[L,y(te)]])]),_:1})]),_:1},8,["modelValue","onTabClick"])}}}),[["__scopeId","data-v-62e09e71"]]);export{Ve as default};
