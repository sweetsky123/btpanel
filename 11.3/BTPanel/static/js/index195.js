import{c as e,o as a,r as s,bW as l,v as o,x as t,y as n,A as r,D as i,F as u,b1 as c,L as p,B as d,J as v,K as m,z as y,e as f,C as x,O as b,G as _,R as h,U as k,aA as g,ad as w,ab as M,H as j,bp as C}from"./base-lib.js?v=1763689792";import{u as U,aD as V,ia as q,bz as H,b as I,_ as z}from"./utils-lib.js?v=1763689792";import{aw as B}from"./validator.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";const E={class:"nps-survey-box"},F={class:"py-[40px] px-[30px]"},A={class:"nps-survey-score h-[130px]"},D={id:"survey-score",class:"flex items-center justify-around"},G={class:"survey-score-num small"},J=["data-content","onMouseover","onMouseleave","onClick"],N={class:"survey-score-num medium"},O=["data-content","onMouseover","onMouseleave","onClick"],K={class:"survey-score-num large"},L=["data-content","onMouseover","onMouseleave","onClick"],R={class:"flex flex-col items-center"},S={class:"nps-survey-title"},W={key:0,class:"text-danger"},$={class:"text-base"},P={key:0,class:"nps-surver-tips"},Q=z(e({__name:"index",emits:["close"],setup(e,{emit:z}){const Q=z,{proxy:T}=C(),{load:X,error:Y}=I(),{panel:Z}=U(),ee=a({}),ae=s([]),se=s(!1),le=s(0),oe=s(0),te=e=>le.value===e||oe.value===e,ne=(e,a)=>{if(oe.value===a)return!1;le.value=a},re=(e,a,s)=>{ae.value[s].error=""==e?"问题答案不可为空":"",ee[a]=e,T.$forceUpdate()},ie=(e,a)=>{if(oe.value===a)return!1;le.value=-1},ue=(e,a)=>{if(!ae.value.length)return Y("暂时无法进行评分哦~请刷新页面重试"),!1;oe.value=a},ce=async()=>{try{await ae.value.forEach(e=>{if(""!=e.error)throw Y("还有必填项没有填写哦~"),new Error("还有必填项没有填写哦~")});let e=X("正在提交问卷，请稍后...");(await H({questions:JSON.stringify(ee),product_type:0,rate:oe.value,software_name:"panel"})).status&&(e.close(),Q("close"),B())}catch(e){}};return l(async()=>{try{const{data:e}=await V({version:-1,product_type:0});ae.value=e.msg,ae.value=[{id:4,hint:"您在使用产品过程中有什么需求没有被满足，或遇到什么BUG没被解决，请将您的问题或需求详细描述给我们，我们尽力为您解决及开发对应的功能",product_type:0,question:"您的哪些需求在宝塔面板上还没有被满足的?",required:1,version:0,textarea:!0,isHint:!0}],ae.value.forEach(e=>{ee[e.id]=""})}catch(e){}}),o(async()=>{Z.value.panelNps=!0,q({software_name:"panel"})}),(e,a)=>{const s=k,l=g,o=w,C=M,U=j;return t(),n("div",E,[a[5]||(a[5]=r("div",{class:"nps-survey-banner"},[r("span",null,[r("i"),i(),r("span",{style:{"vertical-align":"4px"}},"宝塔面板产品体验调查")])],-1)),r("div",F,[r("div",A,[a[2]||(a[2]=r("div",{class:"text-round font-bold text-center text-black"},"您向朋友或同事推荐宝塔面板的可能性有多大?",-1)),r("div",D,[r("ul",G,[(t(),n(u,null,c([1,2,3,4,5,6],e=>r("li",{key:e,"data-content":e,class:p({act:te(e)}),onMouseover:a=>ne(0,e),onMouseleave:a=>ie(0,e),onClick:a=>ue(0,e)},d(te(e)?"".concat(e,"分"):e),43,J)),64))]),r("ul",N,[(t(),n(u,null,c([7,8],e=>r("li",{key:e,"data-content":e,class:p({act:te(e)}),onMouseover:a=>ne(0,e),onMouseleave:a=>ie(0,e),onClick:a=>ue(0,e)},d(e+(te(e)?"分":"")),43,O)),64))]),r("ul",K,[(t(),n(u,null,c([9,10],e=>r("li",{key:e,"data-content":e,class:p({act:te(e)}),onMouseover:a=>ne(0,e),onMouseleave:a=>ie(0,e),onClick:a=>ue(0,e)},d(te(e)?"".concat(e,"分"):e),43,L)),64))])])]),v(r("div",R,[f(C,{ref:"npsForm","label-position":"top",model:y(ee),size:"default"},{default:x(()=>[(t(!0),n(u,null,c(y(ae),(e,i)=>(t(),b(o,{key:i,label:"",error:e.error},{label:x(()=>[r("span",S,[e.required?(t(),n("span",W,"*")):_("",!0),r("span",$,d(e.question),1)]),e.textarea?_("",!0):(t(),n("span",P,d(e.hint),1))]),default:x(()=>[e.textarea?(t(),b(l,{key:0,ref_for:!0,ref:"popover",visible:y(se),"onUpdate:visible":a[1]||(a[1]=e=>h(se)?se.value=e:null),placement:"top-start","popper-class":"green-tips-popover p-20px !border-none",title:"",width:"51.2rem",trigger:"focus",content:e.hint},{reference:x(()=>[f(s,{modelValue:y(ee)[e.id],"onUpdate:modelValue":a=>y(ee)[e.id]=a,type:"textarea",class:"!w-[51.2rem]",rows:6,maxlength:500,placeholder:e.isHint?e.hint:"",onFocus:a[0]||(a[0]=e=>se.value=!0),onInput:a=>re(a,e.id,i),onBlur:a=>e.isHint=!0},null,8,["modelValue","onUpdate:modelValue","placeholder","onInput","onBlur"])]),_:2},1032,["visible","content"])):(t(),b(s,{key:1,modelValue:y(ee)[e.id],"onUpdate:modelValue":a=>y(ee)[e.id]=a,class:"w-[51.2rem]",maxlength:500,placeholder:"请填写问题答案",onInput:a=>re(a,e.id,i)},null,8,["modelValue","onUpdate:modelValue","onInput"]))]),_:2},1032,["error"]))),128))]),_:1},8,["model"]),a[4]||(a[4]=r("div",{class:"text-primary leading-[3.5rem] mb-[1rem]"},"我们特别重视您的需求反馈，我们会每周进行需求评审。希望能更好的帮到您",-1)),f(U,{class:"w-[12.5rem]",size:"large",type:"primary",onClick:ce},{default:x(()=>[...a[3]||(a[3]=[i("提交",-1)])]),_:1})],512),[[m,0!==y(oe)]])])])}}}),[["__scopeId","data-v-31c39cbb"]]);export{Q as default};
