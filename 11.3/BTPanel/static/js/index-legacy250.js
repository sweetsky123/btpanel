!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",i=a.toStringTag||"@@toStringTag";function o(t,a,s,i){var o=a&&a.prototype instanceof l?a:l,u=Object.create(o.prototype);return r(u,"_invoke",function(t,r,a){var s,i,o,l=0,u=a||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return s=n,i=0,o=e,d.n=t,c}};function p(t,r){for(i=t,o=r,n=0;!f&&l&&!a&&n<u.length;n++){var a,s=u[n],p=d.p,m=s[2];t>3?(a=m===r)&&(o=s[(i=s[4])?5:(i=3,3)],s[4]=s[5]=e):s[0]<=p&&((a=t<2&&p<s[1])?(i=0,d.v=r,d.n=s[1]):p<m&&(a=t<3||s[0]>r||r>m)&&(s[4]=t,s[5]=r,d.n=m,i=0))}if(a||t>1)return c;throw f=!0,r}return function(a,u,m){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&p(u,m),i=u,o=m;(n=i<2?e:o)||!f;){s||(i?i<3?(i>1&&(d.n=-1),p(i,o)):d.n=o:d.v=o);try{if(l=2,s){if(i||(a="next"),n=s[a]){if(!(n=n.call(s,o)))throw TypeError("iterator result is not an object");if(!n.done)return n;o=n.value,i<2&&(i=0)}else 1===i&&(n=s.return)&&n.call(s),i<2&&(o=TypeError("The iterator does not provide a '"+a+"' method"),i=1);s=e}else if((n=(f=d.n<0)?o:t.call(r,d))!==c)break}catch(n){s=e,i=1,o=n}finally{l=1}}return{value:n,done:f}}}(t,s,i),!0),u}var c={};function l(){}function u(){}function f(){}n=Object.getPrototypeOf;var d=[][s]?n(n([][s]())):(r(n={},s,function(){return this}),n),p=f.prototype=l.prototype=Object.create(d);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,r(e,i,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=f,r(p,"constructor",f),r(f,"constructor",u),u.displayName="GeneratorFunction",r(f,i,"GeneratorFunction"),r(p),r(p,i,"Generator"),r(p,s,function(){return this}),r(p,"toString",function(){return"[object Generator]"}),(t=function(){return{w:o,m:m}})()}function r(e,n,t,a){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}r=function(e,n,t,a){function i(n,t){r(e,n,function(e){return this._invoke(n,t,e)})}n?s?s(e,n,{value:t,enumerable:!a,configurable:!a,writable:!a}):e[n]=t:(i("next",0),i("throw",1),i("return",2))},r(e,n,t,a)}function a(e,n,t,r,a,s,i){try{var o=e[s](i),c=o.value}catch(e){return void t(e)}o.done?n(c):Promise.resolve(c).then(r,a)}function s(e){return function(){var n=this,t=arguments;return new Promise(function(r,s){var i=e.apply(n,t);function o(e){a(i,r,s,o,c,"next",e)}function c(e){a(i,r,s,o,c,"throw",e)}o(void 0)})}}System.register(["./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./column-legacy.js?v=1763689792","./validator-legacy.js?v=1763689792","./site-legacy.js?v=1763689792","./useController-legacy5.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./index-legacy107.js?v=1763689792","./useStore-legacy4.js?v=1763689792","./useController-legacy6.js?v=1763689792","./useMethod-legacy5.js?v=1763689792"],function(n,r){"use strict";var a,i,o,c,l,u,f,d,p,m,b,g,v,y,h,x,k,w,_,S,j,T,O,C,L,E,F,M,A,H,P,G,I,z,D,B,R,V,J,K,N,U;return{setters:[function(e){a=e.u,i=e.ay,o=e.p,c=e.aK,l=e.d,u=e.l,f=e.j,d=e.b,p=e.f,m=e.e,b=e._},function(e){g=e.c,v=e.r,y=e.o,h=e.v,x=e.I,k=e.J,w=e.z,_=e.x,S=e.y,j=e.A,T=e.e,O=e.O,C=e.B,L=e.C,E=e.D,F=e.L,M=e.K,A=e.F,H=e.b1,P=e.G,G=e.R,I=e.H,z=e.b6,D=e.b2,B=e.M,R=e.bz,V=e.bA},function(e){J=e.a},function(e){K=e.p},function(e){N=e.getRiskCount},function(e){U=e.i},null,null,null,null,null,null],execute:function(){var r={id:"safeDetectList",class:"p-[2rem]"},$={class:"progress-header"},q={class:"progress-header-cot"},Q={class:"flex items-center"},W={key:0,class:"scan-icon relative h-[8rem] w-[8rem] flex"},X={key:1},Y={class:"progress-header-cot h-[8rem]"},Z=["innerHTML"],ee={class:"scanning-progress-cont"},ne={class:"progress-header-cot"},te={class:"progress-cont-list"},re={key:0},ae={class:"inline-grid grid-cols-4 w-full mt-20px"},se=["onClick"],ie={class:"progress_type"},oe={class:"flex-1"},ce={key:0},le={key:1},ue={key:2,class:"text-danger mr-[4px]"},fe={key:3,class:"text-primary"},de={class:"progress_fold text-small flex items-center"},pe={class:"mr-4px"},me={class:"progress_item_body"},be={class:"flex items-center justify-between w-full"},ge={class:"flex items-center ml-12px"},ve=["innerHTML"],ye={class:"flex flex-col py-[1rem] px-[1.6rem] text-small progress_item_info"},he={class:"flex items-center"},xe=["innerHTML"],ke={class:"flex"},we=["innerHTML"],_e={class:"p-[2rem]"},Se=g({__name:"index",setup:function(n){var b=d(),g=a().payment,Se=v(),je=v(!1),Te=v([{name:"webscan",title:"网站配置安全性"},{name:"filescan",title:"文件泄露"},{name:"backup",title:"备份文件"},{name:"index",title:"首页内容风险"},{name:"webhorse",title:"挂马排查"},{name:"deadchain",title:"坏链扫描"},{name:"database",title:"数据库安全"},{name:"ftps",title:"网站FTP风险"},{name:"backend",title:"网站后台安全"}]),Oe=v(""),Ce=y({title:"定期扫描网站，提升网站安全性",msg:"当前安全风险未知，请立即扫描",isFirst:!0,error:0,scanStatus:!1,isEnd:!1,siteList:[],time:0,scanTypeStatus:{vulscan:!0,webscan:!0,filescan:!0,backup:!0,index:!0,webhorse:!0,deadchain:!0,database:!0,ftps:!0,backend:!0},btnObj:{text:"立即扫描",type:"primary"},progress:0,progressColor:"var(--el-color-primary)",progressConfig:{},statusTotal:{},active:{vulscan:!1,webscan:!1,filescan:!1,backup:!1,index:!1,webhorse:!1,deadchain:!1,database:!1,ftps:!1,backend:!1}}),Le=y({0:{text:"警告",bg:"rgba(252, 109, 38, 0.1)",color:"#fc6d26"},1:{text:"低危",bg:"rgba(232, 213, 68, 0.1)",color:"#D4BB00"},2:{text:"中危",bg:"rgba(240, 173, 78, 0.14)",color:"#f0ad4e"},3:{text:"高危",bg:"rgba(239, 8, 8, 0.1)",color:"#EF0808"}}),Ee=null,Fe=v(),Me=v(!1),Ae=v(!1),He=v([]),Pe=v([J({key:"name",type:"page"}),{label:"网站名",prop:"name"}]),Ge=function(){Ee=i({route:"/ws_project",onMessage:De})},Ie=function(e){Ae.value=!0,Ce.siteList=e},ze=function(){if(0==Ce.siteList.length)return b.error("请选择扫描站点"),!1;Me.value=!1,Be()},De=function(e,n){var t=JSON.parse(n.data);if(t.hasOwnProperty("site_list"))return He.value=t.site_list,void(Ce.siteList=t.site_list);if(t.hasOwnProperty("end")){var r;if(Ce.progress=t.bar,Ce.msg=t.info,t.dangerous&&(Ce.progressConfig[t.type]||(Ce.progressConfig[t.type]=[]),Ce.progressConfig[t.type].push(t),Ce.statusTotal[t.type]?Ce.statusTotal[t.type]++:Ce.statusTotal[t.type]=1,Ce.error++),t.end)return Ce.isEnd=!0,Ce.scanStatus=!1,null===(r=Ee)||void 0===r||r.close(),U(),void Ve("end");t.type!=Oe.value&&(Oe.value&&!Ce.statusTotal[Oe.value]&&(Ce.scanTypeStatus[Oe.value]=!1),Oe.value=t.type)}},Be=function(){var e=s(t().m(function e(){var n;return t().w(function(e){for(;;)switch(e.n){case 0:if(Ce.time=0,Ce.error=0,setInterval(function(){Ce.time++},1e3),"ltd"===g.value.authType){e.n=1;break}return e.a(2,K({sourceId:20}));case 1:if(Ce.siteList=He.value,!Ce.isFirst){e.n=2;break}Re(),Ce.scanStatus=!0,Ce.isFirst=!1,Ve("scan"),e.n=5;break;case 2:if(!Ce.scanStatus){e.n=4;break}return e.n=3,o({title:"取消扫描",content:"确定取消扫描吗?"});case 3:null===(n=Ee)||void 0===n||n.close(),Ce.isFirst=!0,Ve("scan"),Ke(),e.n=5;break;case 4:Ke(),Re(),Ce.scanStatus=!0,Ve("scan");case 5:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Re=function(){var e=s(t().m(function e(){var n;return t().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Ge();case 1:return e.n=2,null===(n=Ee)||void 0===n?void 0:n.send({mod_name:"webscanning",def_name:"ScanAllSite",site_list:Ce.siteList.map(function(e){return e.name}),ws_callback:"123"});case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Ve=function(e){switch(e){case"scan":Ce.title="正在扫描",Ce.isEnd=!1,Ce.btnObj.text="取消扫描",Ce.btnObj.type="warning";break;case"end":Ne(),Ce.btnObj.text="重新扫描",Ce.btnObj.type="primary"}},Je=function(e){"free"==g.value.authType&&K({sourceId:65})},Ke=function(){Oe.value="",Ce.scanStatus=!1,Ce.isEnd=!1,Ce.error=0,Ce.time=0,Ce.progress=0,Ce.progressConfig={vulscan:[],webscan:[],filescan:[],backup:[],index:[],webhorse:[],deadchain:[],database:[],ftps:[],backend:[]},Ce.statusTotal={},Ce.active={vulscan:!1,webscan:!1,filescan:!1,backup:!1,index:!1,webhorse:!1,deadchain:!1,database:!1,ftps:!1,backend:!1},Ce.scanTypeStatus={vulscan:!0,webscan:!0,filescan:!0,backup:!0,index:!0,webhorse:!0,deadchain:!0,database:!0,ftps:!0,backend:!0},Ce.btnObj.text="立即扫描",Ce.btnObj.type="primary",Ce.title="定期扫描网站，提升网站安全性",Ce.msg="当前安全风险未知，请立即扫描"},Ne=function(){var e=s(t().m(function e(){var n,r,a;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,N();case 1:n=e.v,r=n.data,r.risk_count.high+r.risk_count.middle>0?(Ce.error=r.risk_count.high+r.risk_count.middle,Ce.title="".concat(r.web_count,"个网站检测出，高危").concat(r.risk_count.high>0?'<span class="text-danger">'.concat(r.risk_count.high,"</span>"):0,"个/中危").concat(r.risk_count.middle,"个！"),Ce.msg="上次扫描时间：".concat(r.scan_time)):(Ce.title="已完成对".concat(r.web_count,"个网站的全面检测，暂未发现风险。"),Ce.msg="最后扫描时间：".concat(r.scan_time)),r.risk_count.high>0&&(Ce.isEnd=!0),e.n=3;break;case 2:e.p=2,a=e.v,c(a);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}();return Ne(),h(function(){var e;Ge(),null===(e=Ee)||void 0===e||e.send({mod_name:"webscanning",def_name:"GetAllSite",ws_callback:""})}),function(n,t){var a=l,s=I,i=z,o=D,c=p,d=m,b=R,v=V,y=u,h=f,J=x("bt-loading");return k((_(),S("div",r,[j("div",$,[j("div",q,[j("div",Q,[w(Ce).scanStatus?(_(),S("div",W,[t[1]||(t[1]=j("div",{class:"animate-spin absolute top-0 border-primary border-b-2 rounded-full h-full w-full"},null,-1)),T(a,{icon:"scanning-danger",size:60,color:"#F39C12",class:"m-auto"})])):(_(),S("div",X,[w(Ce).warn||w(Ce).error?(_(),O(a,{key:0,icon:"scanning-danger",size:70,color:"#ef0808"})):(_(),O(a,{key:1,icon:"scanning-"+(w(Ce).isEnd?"success":"danger"),size:72,color:w(Ce).isEnd?"var(--el-color-primary)":"#F39C12"},null,8,["icon","color"]))]))])]),j("div",Y,[j("div",{class:"scanning-progress-title",innerHTML:w(Ce).title},null,8,Z),j("div",ee,C(w(Ce).msg.length>35?w(Ce).msg.substring(0,35)+"...":w(Ce).msg),1)]),j("div",ne,[T(s,{class:F({"warning-hover":w(Ce).scanStatus}),plain:!!w(Ce).scanStatus,type:w(Ce).btnObj.type,onClick:Be},{default:L(function(){return[E(C(w(Ce).btnObj.text),1)]}),_:1},8,["class","plain","type"])])]),k(T(i,{class:"!w-full",color:w(Ce).progressColor,"show-text":!1,"stroke-width":2,percentage:w(Ce).progress},null,8,["color","percentage"]),[[M,w(Ce).scanStatus]]),k(T(o,{class:"!mt-0 !mb-20px !bg-base"},null,512),[[M,!w(Ce).scanStatus]]),j("div",te,[w(Ce).scanStatus||w(Ce).isEnd?P("",!0):(_(),S("div",re,[t[2]||(t[2]=j("div",{class:"font-bold text-medium text-secondary my-[4rem]"},"支持网站以下安全扫描项:",-1)),j("div",ae,[(_(!0),S(A,null,H(w(Te),function(e,n){return _(),S("div",{key:n,class:"flex flex-col inline-block items-center mb-20px"},[T(c,{class:"w-[4rem] inline-block mb-8px opacity-90",src:"/scan/scanning-"+e.name+"-ico.svg"},null,8,["src"]),E(" "+C(e.title),1)])}),128))])])),w(Ce).scanStatus||w(Ce).isEnd?(_(!0),S(A,{key:1},H(w(Te),function(n,r){return _(),S("div",{key:r,class:F([n.name+"_item "+(w(Ce).active[n.name]?"active":""),"progress_item"])},[j("div",{class:"progress_item_header",onClick:function(e){return function(e){Ce.active[e]||(Ce.active[e]=!1),Ce.active[e]=!Ce.active[e]}(n.name)}},[j("div",ie,[T(c,{class:"mr-12px w-[2rem]",src:"/scan/scanning-"+n.name+"-ico.svg"},null,8,["src"]),j("span",null,C(n.title),1)]),j("div",oe,[w(Ce).scanStatus&&w(Oe)==n.name?(_(),S("span",ce," 正在扫描... ")):w(Ce).scanStatus&&w(Oe)!=n.name&&!w(Ce).statusTotal[n.name]&&w(Ce).scanTypeStatus[n.name]?(_(),S("span",le," 等待扫描 ")):w(Ce).statusTotal[n.name]?(_(),S("span",ue," 发现"+C(w(Ce).statusTotal[n.name])+"项危险 ",1)):(_(),S("span",fe,"无风险项"))]),j("div",de,[j("span",pe,C(w(Ce).active[n.name]?"收起":"展开"),1),j("i",{class:F(w(Ce).active[n.name]?"svgtofont-el-arrow-up":"svgtofont-el-arrow-down")},null,2)])],8,se),k(j("div",me,[T(v,{accordion:""},{default:L(function(){return[(_(!0),S(A,null,H(w(Ce).progressConfig[n.name],function(n,r){return _(),O(b,{key:r,disabled:"free"==w(g).authType},{title:L(function(){return[j("div",be,[j("div",ge,[j("span",{class:"text-small h-[2.2rem] flex items-center px-[8px] rounded-small mr-[1rem]",style:B({color:w(Le)[n.dangerous||0].color,backgroundColor:w(Le)[n.dangerous||0].bg})},C(w(Le)[n.dangerous||0].text),5),j("span",{innerHTML:n.info,class:"w-[46rem] truncate"},null,8,ve)]),T(d,{class:"mb-2px mr-4px",onClick:Je},{default:L(function(){return e(t[3]||(t[3]=[E(" 详情 ",-1)]))}),_:1})])]}),default:L(function(){return[j("div",ye,[j("div",he,[t[4]||(t[4]=j("span",{class:"w-[6rem] flex-shrink-0 inline-block"}," 详情： ",-1)),j("span",{class:"leading-[1.6rem]",innerHTML:n.detail},null,8,xe)]),T(o,{class:"!my-8px"}),j("div",ke,[t[5]||(t[5]=j("span",{class:"w-[6rem] flex-shrink-0 inline-block"}," 修复方案： ",-1)),j("span",{innerHTML:n.repair},null,8,we)])])]}),_:2},1032,["disabled"])}),128))]}),_:2},1024)],512),[[M,w(Ce).active[n.name]]])],2)}),128)):P("",!0)]),T(h,{title:"选择扫描网站",modelValue:w(Me),"onUpdate:modelValue":t[0]||(t[0]=function(e){return G(Me)?Me.value=e:null}),ref_key:"scanSiteListDialog",ref:Fe,area:45,onConfirm:ze,showFooter:""},{default:L(function(){return[j("div",_e,[T(y,{ref_key:"scanSiteTableRef",ref:Se,data:w(He),column:w(Pe),"max-height":296,onSelectionChange:Ie,description:"网站列表为空"},null,8,["data","column"])])]}),_:1},8,["modelValue"])])),[[J,w(je)]])}}});n("default",b(Se,[["__scopeId","data-v-bea56db3"]]))}}})}();
