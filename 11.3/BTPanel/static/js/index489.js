import{Q as a,p as e,l as t,ah as s,$ as l,b as r}from"./utils-lib.js?v=1763689792";import{_ as i}from"./index109.js?v=1763689792";import{c as o,r as n,W as p,o as c,e as m,D as d,v as h,I as f,x as u,y,C as b,z as g,J as w,H as _}from"./base-lib.js?v=1763689792";import{_ as v}from"./index107.js?v=1763689792";import{bg as j,bh as x,bi as C}from"./firewall.js?v=1763689792";import{a as k,c as T}from"./column.js?v=1763689792";import{f as q}from"./validator.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";const V={class:"p-[2rem]"},A=o({__name:"index",setup(o){const A=r(),H=n(),I=p([]),W=[{content:'注意：添加白名单目录要以"/"结尾'}],z=[{label:"删除",value:"delete",event:async(a,e,t,s)=>{const{label:l,value:r}=s,i=async(a,e)=>{const{path:t,type:s}=a;if("delete"===r)return await x({path:t,type:s})};await a({title:"批量".concat(l,"白名单目录"),content:"批量".concat(l,"已选的白名单目录，是否继续操作！"),column:[{label:"路径",prop:"path"},T()],onConfirm:async()=>(await e(i),J(),!1)})}}],D=c({path:"",type:"dir"}),J=async()=>{a({request:j(),success:a=>{Array.isArray(a.data)||(I.value=[...a.data.dir.map(a=>({path:a,type:"dir",typeTitle:"目录"})),...a.data.file.map(a=>({path:a,type:"file",typeTitle:"文件"}))])}})},L=async()=>{try{if(!D.path)return void A.error("请输入白名单目录");await a({request:C({path:D.path}),message:!0,loading:"正在添加白名单目录，请稍后...",success:J}),D.path=""}catch(e){}},O=[k(),{label:"路径",prop:"path",showOverflowTooltip:!0},{label:"类型",prop:"typeTitle"},{label:"操作",align:"right",fixed:"right",render:t=>m("span",{class:"bt-link",onClick:()=>(async t=>{await e({icon:"warning-filled",title:"删除白名单目录",width:"34rem",content:"删除白名单目录【"+t.path+"】，是否继续操作？"}),a({request:x({path:t.path,type:t.type}),message:!0,loading:"正在删除白名单目录，请稍后...",success:J})})(t)},[d("删除")])}];return h(()=>{J()}),(a,e)=>{const r=v,o=_,n=t,p=s,c=i,h=l,j=f("bt-loading");return u(),y("div",V,[m(c,null,{"header-left":b(()=>[m(r,{modelValue:g(D).path,"onUpdate:modelValue":e[0]||(e[0]=a=>g(D).path=a),name:"path",placeholder:"选择目录/文件全路径",icon:"icon-file_mode",onIconClick:e[1]||(e[1]=a=>{q({type:"all",change(a,e){D.path=a,D.type=e,"dir"!==e||a.endsWith("/")||(D.path+="/")}})}),onChangePassive:e[2]||(e[2]=a=>{var e;D[e="path"]=D[e].replace(/\s+/g,"")}),width:"32rem"},null,8,["modelValue"]),m(o,{class:"!ml-[.8rem]",type:"primary",onClick:L},{default:b(()=>[...e[3]||(e[3]=[d(" 添加 ",-1)])]),_:1})]),content:b(()=>[w(m(n,{ref_key:"whiteList",ref:H,column:O,data:g(I),description:"白名单列表为空"},null,8,["data"]),[[j,"正在加载白名单列表，请稍后...","title"]])]),"footer-left":b(()=>[m(p,{"table-ref":g(H),options:z},null,8,["table-ref"])]),_:1}),m(h,{options:W,class:"mx-[1.6rem] my-[0.6rem]"})])}}});export{A as default};
