import{Q as a,p as s,b as t}from"./utils-lib.js?v=1763689792";import{r as e}from"./base-lib.js?v=1763689792";import{g as r,b as i,r as o,c as n}from"./useStore7.js?v=1763689792";import{a as d}from"./useController8.js?v=1763689792";import{g as u}from"./useStore6.js?v=1763689792";const l=t(),c=e(!1),{refs:{sshTabActive:m}}=u(),f=async(s,t)=>{try{s.limit=5,t&&(s.historyType="ALL");const e=await a({request:t?r({data:JSON.stringify(s)}):i(s),data:{data:Array,total:Number}});return{data:e.data,total:e.total,other:{}}}catch(e){return{data:[],total:0,other:{}}}},p=a=>{if(!a||"string"!=typeof a)return"-";const s=a.toLowerCase();return s.includes("edg/")?"Edge":s.includes("opr/")||s.includes("opera")?"Opera":!s.includes("chrome")||s.includes("edg/")||s.includes("opr/")?s.includes("firefox")?"Firefox":s.includes("safari")&&!s.includes("chrome")?"Safari":s.includes("msie")||s.includes("trident/")?"IE":"Unknown":"Chrome"},g=async a=>{const t=a.deny_status;await s({title:"提示",content:t?"解封该IP后，将恢复此IP对服务器的访问，是否继续操作？":"封禁该IP后，将不再允许此IP访问服务器，是否继续操作？",icon:"warning-filled"});let e={address:a.address};t||(e={address:a.address,types:"drop",brief:"SSH登录日志页面点击IP手动封禁",domain:"",choose:"address"}),e={data:JSON.stringify(e)};const r=await y(e,t);return l.request(r),c.value=!0,r},y=async(s,t)=>{try{const e=await a({loading:"正在处理中，请稍后...",request:t?o(s):n(s)});return{msg:e.data[0].msg,status:e.data[0].status,data:{ip:e.data[0].ip}}}catch(e){return{msg:"操作失败",status:!1,data:{}}}},h=a=>{d.value="ALL",m.value="login",a.push("/firewall/ssh-manger")};export{g as a,p as b,f as g,c as i,h as o};
