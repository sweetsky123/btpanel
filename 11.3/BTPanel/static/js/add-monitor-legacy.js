!function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,t="function"==typeof Symbol?Symbol:{},l=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function u(t,r,l,o){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return a(s,"_invoke",function(t,r,a){var l,o,u,c=0,s=a||[],m=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(n,t){return l=n,o=0,u=e,d.n=t,i}};function f(t,r){for(o=t,u=r,n=0;!m&&c&&!a&&n<s.length;n++){var a,l=s[n],f=d.p,p=l[2];t>3?(a=p===r)&&(u=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=e):l[0]<=f&&((a=t<2&&f<l[1])?(o=0,d.v=r,d.n=l[1]):f<p&&(a=t<3||l[0]>r||r>p)&&(l[4]=t,l[5]=r,d.n=p,o=0))}if(a||t>1)return i;throw m=!0,r}return function(a,s,p){if(c>1)throw TypeError("Generator is already running");for(m&&1===s&&f(s,p),o=s,u=p;(n=o<2?e:u)||!m;){l||(o?o<3?(o>1&&(d.n=-1),f(o,u)):d.n=u:d.v=u);try{if(c=2,l){if(o||(a="next"),n=l[a]){if(!(n=n.call(l,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,o<2&&(o=0)}else 1===o&&(n=l.return)&&n.call(l),o<2&&(u=TypeError("The iterator does not provide a '"+a+"' method"),o=1);l=e}else if((n=(m=d.n<0)?u:t.call(r,d))!==i)break}catch(n){l=e,o=1,u=n}finally{c=1}}return{value:n,done:m}}}(t,l,o),!0),s}var i={};function c(){}function s(){}function m(){}n=Object.getPrototypeOf;var d=[][l]?n(n([][l]())):(a(n={},l,function(){return this}),n),f=m.prototype=c.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,a(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return s.prototype=m,a(f,"constructor",m),a(m,"constructor",s),s.displayName="GeneratorFunction",a(m,o,"GeneratorFunction"),a(f),a(f,o,"Generator"),a(f,l,function(){return this}),a(f,"toString",function(){return"[object Generator]"}),(r=function(){return{w:u,m:p}})()}function a(e,n,t,r){var l=Object.defineProperty;try{l({},"",{})}catch(e){l=0}a=function(e,n,t,r){function o(n,t){a(e,n,function(e){return this._invoke(n,t,e)})}n?l?l(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(o("next",0),o("throw",1),o("return",2))},a(e,n,t,r)}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach(function(n){u(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function u(n,t,r){return(t=function(n){var t=function(n,t){if("object"!=e(n)||!n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var a=r.call(n,t||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"==e(t)?t:t+""}(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function i(e,n,t,r,a,l,o){try{var u=e[l](o),i=u.value}catch(e){return void t(e)}u.done?n(i):Promise.resolve(i).then(r,a)}function c(e){return function(){var n=this,t=arguments;return new Promise(function(r,a){var l=e.apply(n,t);function o(e){i(l,r,a,o,u,"next",e)}function u(e){i(l,r,a,o,u,"throw",e)}o(void 0)})}}System.register(["./base-lib-legacy.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./validator-legacy.js?v=1763689792","./firewall-legacy.js?v=1763689792","./index.vue_vue_type_script_setup_true_lang-legacy13.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./column-legacy.js?v=1763689792","./index-legacy107.js?v=1763689792"],function(e,t){"use strict";var a,l,u,i,s,m,d,f,p,v,_,y,b,h,g,w,V,j,O,U,k,S,x,P,D,E,T,A,G,C,F,I,R,q;return{setters:[function(e){a=e.c,l=e.r,u=e.W,i=e.w,s=e.v,m=e.x,d=e.O,f=e.C,p=e.e,v=e.z,_=e.A,y=e.y,b=e.b1,h=e.F,g=e.G,w=e.D,V=e.B,j=e.ad,O=e.am,U=e.an,k=e.ap,S=e.ak,x=e.aj,P=e.ab},function(e){D=e.a_,E=e.Q,T=e.k,A=e.ax,G=e.ag,C=e.$},function(e){F=e._},function(e){I=e.bx,R=e.by},function(e){q=e._},null,null,null,null],execute:function(){var t={class:"flex"},L={class:"flex"},N={class:"flex min-h-[3.2rem] items-start"},H={class:"items-center h-[3.2rem]"};e("default",a({__name:"add-monitor",props:{compData:{default:function(){}}},setup:function(e,a){var z=a.expose,B=l(null),J=e,M=l({name:"",method:2,site_name:"",site_url:"",access:"http",send_msg:!1,send_type:[],type:"day",week:1,where1:1,hour:1,minute:19,switch_config:!1,scan_config:{thesaurus:1,scan_args:!1,title_hash:!1,tail_hash:!1,keywords:!1,descriptions:!1,title:!1,search_monitor:!1,scan_ua:"Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)"},id:""}),$=u([]),Q=["周一","周二","周三","周四","周五","周六","周日"],W=l(!!J.compData.id),K=[{content:"如果是本机端口转发，目标IP为：127.0.0.1"},{content:"如果目标IP不填写，默认则为本机端口转发!"}],X=[{label:"全站扫描",value:1},{label:"快速扫描",value:2},{label:"单URL",value:3}],Y=[{label:"HTTPS",value:"https"},{label:"HTTP",value:"http"}],Z=[{label:"每天",value:"day"},{label:"N天",value:"day-n"},{label:"每星期",value:"week"},{label:"每月",value:"month"}],ee={name:[{required:!0,trigger:["blur","change"],message:"请输入监控名"}],site_name:[{validator:function(e,n,t){if("auto"!==n)t();else{if(M.value.site_url||t(new Error("请输入网站域名")),3!==M.value.method&&!D(M.value.site_url))return t(new Error("检测网站域名格式不正确"));t()}},trigger:["blur","change"]}],send_type:[{required:!0,message:"请选择通知方式",trigger:["blur","change"]}],type:[{validator:function(e,n,t){return"day-n"!==n&&"month"!==n||!(M.value.where1<0||M.value.where1>31)?M.value.hour<0||M.value.hour>23?t(new Error("请输入正确小时范围[0-23]")):M.value.minute<0||M.value.minute>59?t(new Error("请输入正确分钟范围[0-59]")):void t():t(new Error("请输入正确天数范围[0-31]"))},trigger:["blur","change"]}]},ne=function(){var e=c(r().m(function e(n){var t,a,l;return r().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,B.value.validate();case 1:return t="auto"===M.value.site_name?M.value.site_url:M.value.site_name,a=o(o({},M.value),{},{site_name:t,url:M.value.access+"://"+t,send_msg:Number(M.value.send_msg)}),"week"===(l=M.value).type&&(a.week=l.week),W.value&&(a.id=l.id),e.n=2,E({loading:"正在提交，请稍后...",request:I(W.value,a),message:!0});case 2:J.compData.refreshEvent&&J.compData.refreshEvent(),n();case 3:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),te=function(){var e=c(r().m(function e(){return r().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,E({loading:"正在获取网站列表，请稍后...",request:R({type:"sites"}),data:{data:[Array,$]}});case 1:M.value.site_name=W.value?J.compData.site_name:$.value[0].name,J.compData.isSite&&(M.value.site_name=J.compData.name);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),re=function(e){},ae=function(e){var n;(M.value.method=e,3===e)?M.value.site_name="auto":J.compData.isSite&&(M.value.site_name=(null===(n=J.compData)||void 0===n?void 0:n.site_name)||J.compData.name||"")};return i(function(){return M.value.site_name},function(){var e=X.find(function(e){return e.value===M.value.method}).label;M.value.name=(("auto"===M.value.site_name?M.value.site_url:M.value.site_name)||"")+e}),z({onConfirm:ne}),s(function(){te(),W.value&&function(){var e,n,t,r,a,l=J.compData;M.value=o(o(o(o({},l),l.crontab_info),l.scan_config),{},{access:null===(e=l.url)||void 0===e?void 0:e.split("://")[0],where1:(null===(n=l.crontab_info)||void 0===n?void 0:n.where1)||1,hour:(null===(t=l.crontab_info)||void 0===t?void 0:t.where_hour)||1,minute:(null===(r=l.crontab_info)||void 0===r?void 0:r.where_minute)||30,send_msg:!!l.send_msg,id:l.id});var u=null===(a=J.compData.crontab_info)||void 0===a?void 0:a.type;M.value.type="每星期"===u?"week":"每月"===u?"month":"每天"===u?"day":"day-n"}()}),function(r,a){var l=T,o=j,u=A,i=O,c=U,s=G,D=k,E=F,I=S,R=x,z=C,J=P;return m(),d(J,{ref_key:"monitorFormRef",ref:B,rules:ee,model:v(M),class:"p-[2rem] addfrom overflow-auto max-h-[60rem]","label-width":"10rem"},{default:f(function(){return[p(o,{label:"监控名",prop:"name"},{default:f(function(){return[p(l,{modelValue:v(M).name,"onUpdate:modelValue":a[0]||(a[0]=function(e){return v(M).name=e}),width:"26rem",placeholder:"请输入监控名",clearable:""},null,8,["modelValue"])]}),_:1}),p(o,{label:"检测方式"},{default:f(function(){return[p(u,{modelValue:v(M).method,"onUpdate:modelValue":a[1]||(a[1]=function(e){return v(M).method=e}),options:X,onChange:ae,class:"!w-[26rem]"},null,8,["modelValue"])]}),_:1}),p(o,{label:"检测网站",prop:"site_name"},{default:f(function(){return[_("div",t,[p(c,{modelValue:v(M).site_name,"onUpdate:modelValue":a[2]||(a[2]=function(e){return v(M).site_name=e}),class:"!w-[20rem] mr-4",disabled:!(3!==v(M).method&&!e.compData.isSite)},{default:f(function(){return[(m(!0),y(h,null,b(v($),function(e,n){return m(),d(i,{key:n,value:e.name,label:"".concat(e.name,"[").concat(e.ps,"]")},null,8,["value","label"])}),128)),p(i,{label:"自定义网站",value:"auto"})]}),_:1},8,["modelValue","disabled"]),"auto"===v(M).site_name?(m(),d(l,{key:0,modelValue:v(M).site_url,"onUpdate:modelValue":a[3]||(a[3]=function(e){return v(M).site_url=e}),width:"20rem",placeholder:"请输入网站域名",clearable:""},null,8,["modelValue"])):g("",!0)])]}),_:1}),p(o,{label:"访问网站方式"},{default:f(function(){return[p(s,{modelValue:v(M).access,"onUpdate:modelValue":a[4]||(a[4]=function(e){return v(M).access=e}),options:Y},null,8,["modelValue"])]}),_:1}),p(o,{label:"发送告警"},{default:f(function(){return[p(D,{modelValue:v(M).send_msg,"onUpdate:modelValue":a[5]||(a[5]=function(e){return v(M).send_msg=e})},null,8,["modelValue"])]}),_:1}),!v(M).send_msg?g("",!0):(m(),d(o,{key:0,label:"通知方式",prop:"send_type"},{default:f(function(){return[p(E,{modelValue:v(M).send_type,"onUpdate:modelValue":a[6]||(a[6]=function(e){return v(M).send_type=e}),limit:["sms","wx_account"],onChange:re,multiple:!1,class:"!w-[26rem]"},null,8,["modelValue"])]}),_:1})),p(o,{label:"检测频率",prop:"type"},{default:f(function(){return[_("div",L,[p(u,{class:"!w-[8rem] mr-4",modelValue:v(M).type,"onUpdate:modelValue":a[7]||(a[7]=function(e){return v(M).type=e}),options:Z},null,8,["modelValue"]),"week"===v(M).type?(m(),d(c,{key:0,class:"!w-[8rem] mr-4",modelValue:v(M).week,"onUpdate:modelValue":a[8]||(a[8]=function(e){return v(M).week=e})},{default:f(function(){return[(m(),y(h,null,b(Q,function(e,n){return p(i,{key:n,label:e,value:n+1},null,8,["label","value"])}),64))]}),_:1},8,["modelValue"])):g("",!0),"day-n"===v(M).type||"month"===v(M).type?(m(),d(l,{key:1,type:"number",class:"!w-[13rem] mr-4",min:"0",max:"31",modelValue:v(M).where1,"onUpdate:modelValue":a[9]||(a[9]=function(e){return v(M).where1=e})},{append:f(function(){return[w(V("day-n"===v(M).type?"天":"日"),1)]}),_:1},8,["modelValue"])):g("",!0),p(l,{type:"number",class:"!w-[13rem] mr-4",min:"0",max:"23",modelValue:v(M).hour,"onUpdate:modelValue":a[10]||(a[10]=function(e){return v(M).hour=e})},{append:f(function(){return n(a[21]||(a[21]=[w("时",-1)]))}),_:1},8,["modelValue"]),p(l,{type:"number",class:"!w-[13rem]",min:"0",max:"59",modelValue:v(M).minute,"onUpdate:modelValue":a[11]||(a[11]=function(e){return v(M).minute=e})},{append:f(function(){return n(a[22]||(a[22]=[w("分",-1)]))}),_:1},8,["modelValue"])])]}),_:1}),p(q,{"is-show-divider":!0},{config:f(function(){return[p(o,{label:"敏感词库"},{default:f(function(){return[p(R,{modelValue:v(M).scan_config.thesaurus,"onUpdate:modelValue":a[12]||(a[12]=function(e){return v(M).scan_config.thesaurus=e}),class:"border-darker border-1 !w-[26rem] rounded-small px-[1rem] py-[.5rem] flex flex-col !items-start"},{default:f(function(){return[p(I,{value:1},{default:f(function(){return n(a[23]||(a[23]=[w("全选",-1)]))}),_:1}),p(I,{value:2},{default:f(function(){return n(a[24]||(a[24]=[w("自定义词库",-1)]))}),_:1}),p(I,{value:3},{default:f(function(){return n(a[25]||(a[25]=[w("默认词库",-1)]))}),_:1})]}),_:1},8,["modelValue"])]}),_:1}),p(o,{label:"检测带参数的URL"},{default:f(function(){return[_("div",N,[_("div",H,[p(D,{modelValue:v(M).scan_config.scan_args,"onUpdate:modelValue":a[13]||(a[13]=function(e){return v(M).scan_config.scan_args=e})},null,8,["modelValue"])]),a[26]||(a[26]=_("div",{class:"unit"},[_("p",null,"扫描时检测带参数的URL，如URL: https://bt.cn?a=b"),_("p",null,[w(" 开启前 "),_("span",{class:"ml-[2rem]"},"不检测")]),_("p",null,[w(" 开启后 "),_("span",{class:"ml-[2rem]"},"检测")]),_("p",null,"注意，开启后检测页面将成倍增长，可能会导致检测时间大量增加")],-1))])]}),_:1}),p(o,{label:"头部JS检测"},{default:f(function(){return[p(D,{modelValue:v(M).scan_config.title_hash,"onUpdate:modelValue":a[14]||(a[14]=function(e){return v(M).scan_config.title_hash=e})},null,8,["modelValue"]),a[27]||(a[27]=_("span",{class:"unit"},"监控页面源码中的title_hash标签是否有修改",-1))]}),_:1}),p(o,{label:"尾部JS检测"},{default:f(function(){return[p(D,{modelValue:v(M).scan_config.tail_hash,"onUpdate:modelValue":a[15]||(a[15]=function(e){return v(M).scan_config.tail_hash=e})},null,8,["modelValue"]),a[28]||(a[28]=_("span",{class:"unit"},"监控页面源码中的tail_hash标签是否有修改",-1))]}),_:1}),p(o,{label:"关键词检测"},{default:f(function(){return[p(D,{modelValue:v(M).scan_config.keywords,"onUpdate:modelValue":a[16]||(a[16]=function(e){return v(M).scan_config.keywords=e})},null,8,["modelValue"]),a[29]||(a[29]=_("span",{class:"unit"},"监控页面源码中的keywords标签是否有修改",-1))]}),_:1}),p(o,{label:"描述检测"},{default:f(function(){return[p(D,{modelValue:v(M).scan_config.descriptions,"onUpdate:modelValue":a[17]||(a[17]=function(e){return v(M).scan_config.descriptions=e})},null,8,["modelValue"]),a[30]||(a[30]=_("span",{class:"unit"},"监控页面源码中的descriptions标签是否有修改",-1))]}),_:1}),p(o,{label:"标题检测"},{default:f(function(){return[p(D,{modelValue:v(M).scan_config.title,"onUpdate:modelValue":a[18]||(a[18]=function(e){return v(M).scan_config.title=e})},null,8,["modelValue"]),a[31]||(a[31]=_("span",{class:"unit"},"监控页面源码中的title标签是否有修改",-1))]}),_:1}),p(o,{label:"搜索引擎收录监控"},{default:f(function(){return[p(D,{modelValue:v(M).scan_config.search_monitor,"onUpdate:modelValue":a[19]||(a[19]=function(e){return v(M).scan_config.search_monitor=e})},null,8,["modelValue"]),a[32]||(a[32]=_("span",{class:"unit"},"监控搜索引擎是否存在风险关键词",-1))]}),_:1}),p(o,{label:"自定义访问UA"},{default:f(function(){return[p(l,{type:"textarea",modelValue:v(M).scan_config.scan_ua,"onUpdate:modelValue":a[20]||(a[20]=function(e){return v(M).scan_config.scan_ua=e}),width:"36rem",height:"10rem",placeholder:"请输入自定义访问UA",clearable:""},null,8,["modelValue"])]}),_:1})]}),_:1}),p(z,{options:K,class:"pl-[3.6rem] mt-[2rem]"})]}),_:1},8,["model"])}}}))}}})}();
