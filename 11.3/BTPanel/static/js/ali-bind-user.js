import{c as e,r as a,o as l,v as t,aG as s,x as r,O as i,C as o,J as c,K as n,z as d,A as m,e as u,B as p,L as v,Q as f,y as h,D as w,G as g,F as b,M as y,aA as x,ad as _,U as k,H as D,b2 as C,ab as V}from"./base-lib.js?v=1763689792";import{_ as j}from"./index110.js?v=1763689792";import{u as z,M as U,io as q,bL as B,t as E,r as H,e as I,_ as M}from"./utils-lib.js?v=1763689792";import{_ as L}from"./bt_logo_new.js?v=1763689792";import{u as K,b as T,f as A}from"./useController.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";const G={class:"flex !justify-center !w-full items-center"},O={class:"text-default inline-block mr-2 font-bold mt-12x"},W={key:0,class:"absolute el-form-item__error"},$={class:"flex justify-end items-center text-small mt-[1rem]"},F={key:0,class:"view-con bg-white"},J={key:1,class:"w-[100%] mt-[1.2rem] flex items-center justify-center text-primary",size:"default"},Q={key:2,class:"flex justify-end items-center text-small mt-[1rem] h-[1.68rem]"},N={key:0},P={class:"more-bind"},R=M(e({__name:"ali-bind-user",props:{compData:{default:null}},emits:["close"],setup(e,{expose:M,emit:R}){var S;const X=e,{aliyunEcsLtd:Y,payment:Z}=z(),ee=a(!1),ae=a("获取验证码"),le=l({username:"",password:"",code:""}),te=l({username:!1,password:!1,code:!1}),se=a(""),re=a(0),ie=a(),oe=a(!1),ce=a(1),ne=a(X.compData.authData),de=a({username:[{validator:(e,a,l)=>{var t,s;if((null==(t=X.compData)?void 0:t.title)&&(oe.value=!1),/^1[3456789]\d{9}$/.test(a))l();else if(""===a)l(new Error("请输入宝塔官网账号"));else{if(null==(s=X.compData)?void 0:s.title)return oe.value=!0,void l(new Error(" "));l(new Error(" 请输入正确的手机号 "))}},trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:["blur","change"]},{validator:(e,a,l)=>{a.length>=8?l():l(new Error("请输入至少8位密码"))},trigger:["blur","change"]}],token:[{required:!1,message:"请输入验证码",trigger:["blur","change"]},{validator:(e,a,l)=>{ee.value||l(),6===a.length?l():l(new Error("请输入6位验证码，不可为空"))},trigger:["blur","change"]}]}),me=async()=>{await ie.value.validate(),await T({isCheck:ee,userInfo:le,userToken:se})},ue=async()=>{const e=U.load("正在绑定中......");try{const{data:a}=await q({client:2});a.status||a.success?A(X.compData.redirect):(e.close(),U.error(a.msg||a.res))}catch(a){null==e||e.close()}},pe=async()=>{if(!le.username||!le.password)return U.error("请先输入手机号和密码");te.username=!0,te.password=!0,(e=>{re.value&&clearInterval(re.value);const a=()=>{if(--e<=0)return clearInterval(re.value),ae.value="获取验证码",void(te.code=!1);ae.value="重新获取验证码(".concat(e,"s)")};a(),re.value=setInterval(a,1e3),te.code=!0})(60);const e=await B({username:le.username,token:se.value});U.request(e)},ve=()=>{ie.value.clearValidate(),be()},fe=a(!1),he=e=>{var a;ce.value=e,(null==(a=X.compData)?void 0:a.onChangeType)&&X.compData.onChangeType(1===e?"bind":"other")},{qrcodeLoading:we,openWechatLogin:ge,onCancelWechat:be}=K(null==(S=X.compData)?void 0:S.redirect),ye=()=>{H.push("/"),ve()};return M({onOpen:()=>{E(ie.value.$el,"username")},onCancel:ve}),t(()=>{var e;(async()=>{try{fe.value=2===ne.value.client&&1===ne.value.login,2===ne.value.client&&1===ne.value.login?he(2):he(1)}catch(e){he(1)}})(),null==(e=ie.value)||e.clearValidate()}),s(()=>{be()}),(a,l)=>{var t;const s=x,z=_,U=k,q=I,B=D,E=I,H=j,M=C,K=V;return r(),i(K,{ref_key:"bindUserInfo",ref:ie,size:"large",rules:d(de),model:d(le),autocomplete:"off",class:v(["bind-user-info",{"bind-form":!!(null==(t=e.compData)?void 0:t.title)}])},{default:o(()=>{var a,t,x,_,k,D,C,V,j,I,K,T,A;return[c(m("div",null,[u(z,{class:"text-center !mb-5 flex justify-center"},{default:o(()=>{var a;return[m("div",G,[m("h3",O,p((null==(a=e.compData)?void 0:a.title)||"切换宝塔官网账号"),1),u(s,{placement:"top-start",width:"200",trigger:"hover",content:"宝塔面板许多功能都依赖于官网，绑定仅限于为您提供更好的面板服务体验，不涉及您服务器任何敏感信息，请放心使用。",class:"inline-block relative -top-1.5"},{reference:o(()=>[...l[10]||(l[10]=[m("a",{class:"bt-ico-ask align-middle",href:"javascript:;"},"?",-1)])]),_:1})])]}),_:1}),(r(),i(z,{key:1,prop:"username",class:v({"!mb-[3rem]":!!(null==(a=e.compData)?void 0:a.title)})},{default:o(()=>{var a;return[u(U,{modelValue:d(le).username,"onUpdate:modelValue":l[0]||(l[0]=e=>d(le).username=e),clearable:"",required:"",name:"username",autocomplete:"off",class:"!leading-[4rem] !h-[4rem]",placeholder:"宝塔官网账号",disabled:d(te).username,onKeyup:l[1]||(l[1]=f(e=>me(),["enter"]))},null,8,["modelValue","disabled"]),(null==(a=e.compData)?void 0:a.title)&&d(oe)?(r(),h("span",W,[l[12]||(l[12]=m("span",null,"请使用宝塔官网登录账号进行登录，若未有账号，可进行",-1)),u(q,{class:"!text-small",href:"https://www.bt.cn/register"},{default:o(()=>[...l[11]||(l[11]=[w(" 免费注册 ",-1)])]),_:1})])):g("",!0)]}),_:1},8,["class"])),(r(),i(z,{key:2,prop:"password"},{default:o(()=>[u(U,{modelValue:d(le).password,"onUpdate:modelValue":l[2]||(l[2]=e=>d(le).password=e),clearable:"",required:"",type:"password",name:"password",class:"!leading-[4rem] !h-[4rem]",autocomplete:"off",placeholder:"密码","show-password":!0,disabled:d(te).password,onKeyup:l[3]||(l[3]=f(e=>me(),["enter","native"]))},null,8,["modelValue","disabled"])]),_:1})),c(u(z,{prop:"code"},{default:o(()=>[u(U,{modelValue:d(le).code,"onUpdate:modelValue":l[4]||(l[4]=e=>d(le).code=e),type:"text",clearable:"",autocomplete:"off",placeholder:"验证码",onKeyup:l[5]||(l[5]=f(e=>me(),["enter","native"]))},{append:o(()=>[u(B,{class:"relative top-0 rounded-r-base",type:"primary",size:"default",disabled:d(te).code,plain:"",onClick:pe},{default:o(()=>[w(p(d(ae)),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1},512),[[n,d(ee)]]),u(B,{type:"primary",class:"w-[100%] mt-[1.2rem]",size:"default",onClick:l[6]||(l[6]=e=>me())},{default:o(()=>{var a,l;return[w(p((null==(a=e.compData)?void 0:a.btn)||((null==(l=e.compData)?void 0:l.title)?"绑定账号":"切换账号")),1)]}),_:1}),m("div",$,[d(Z).bindUser?g("",!0):(r(),h(b,{key:0},[u(E,{onClick:ye},{default:o(()=>[...l[13]||(l[13]=[w("暂不绑定",-1)])]),_:1}),u(H)],64)),u(E,{href:"https://www.bt.cn/register"},{default:o(()=>[...l[14]||(l[14]=[w("注册账号",-1)])]),_:1}),u(H),u(E,{href:"https://www.bt.cn/login.html?page=reset"},{default:o(()=>[...l[15]||(l[15]=[w("忘记密码",-1)])]),_:1}),u(H),u(E,{href:"https://www.bt.cn/bbs"},{default:o(()=>[...l[16]||(l[16]=[w("问题反馈",-1)])]),_:1})])],512),[[n,1===d(ce)]]),c(m("div",null,[(null==(t=e.compData)?void 0:t.title)?g("",!0):(r(),h("div",{key:0,class:v({"view-con":!0,"bg-white":!(null==(x=e.compData)?void 0:x.title)})},[m("div",{class:v({"app-box":!0,"bg-white":!(null==(_=e.compData)?void 0:_.title)})},[...l[17]||(l[17]=[m("img",{alt:"",src:L},null,-1)])],2),l[19]||(l[19]=m("div",{class:"change-icon"},[m("svg",{t:"1729493717851",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"19919",width:"200",height:"200"},[m("path",{d:"M914.618182 477.090909H546.909091V109.381818c0-18.618182-16.290909-34.909091-34.909091-34.909091s-34.909091 16.290909-34.909091 34.909091v367.709091H109.381818c-18.618182 0-34.909091 16.290909-34.909091 34.909091s16.290909 34.909091 34.909091 34.909091h367.709091v367.709091c0 18.618182 16.290909 34.909091 34.909091 34.909091s34.909091-16.290909 34.909091-34.909091V546.909091h367.709091c18.618182 0 34.909091-16.290909 34.909091-34.909091s-16.290909-34.909091-34.909091-34.909091z",fill:"var(--el-color-text-tertiary)","p-id":"19920"})])],-1)),m("div",{class:v({"app-box":!0,"bg-white":!(null==(k=e.compData)?void 0:k.title)})},[...l[18]||(l[18]=[m("div",{class:"ali-icon"},null,-1)])],2)],2)),m("div",{class:v({"bg-light":null==(D=e.compData)?void 0:D.title,"rounded-base":null==(C=e.compData)?void 0:C.title}),style:y({border:(null==(V=e.compData)?void 0:V.title)?"1px solid var(--el-border-color)":"none","padding-top":(null==(j=e.compData)?void 0:j.title)?"2rem":"0"})},[(null==(I=e.compData)?void 0:I.title)?(r(),h("div",F,[...l[20]||(l[20]=[m("div",{class:"app-box bg-white"},[m("img",{alt:"",src:L})],-1),m("div",{class:"change-icon"},[m("svg",{t:"1729493717851",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"19919",width:"200",height:"200"},[m("path",{d:"M914.618182 477.090909H546.909091V109.381818c0-18.618182-16.290909-34.909091-34.909091-34.909091s-34.909091 16.290909-34.909091 34.909091v367.709091H109.381818c-18.618182 0-34.909091 16.290909-34.909091 34.909091s16.290909 34.909091 34.909091 34.909091h367.709091v367.709091c0 18.618182 16.290909 34.909091 34.909091 34.909091s34.909091-16.290909 34.909091-34.909091V546.909091h367.709091c18.618182 0 34.909091-16.290909 34.909091-34.909091s-16.290909-34.909091-34.909091-34.909091z",fill:"var(--el-color-text-tertiary)","p-id":"19920"})])],-1),m("div",{class:"app-box bg-white"},[m("div",{class:"ali-icon"})],-1)])])):g("",!0),u(z,{class:v(["!mb-5 flex justify-center",{"p-[2.5rem]":null==(K=e.compData)?void 0:K.title,"!pt-0":null==(T=e.compData)?void 0:T.title}])},{default:o(()=>[u(M),l[21]||(l[21]=m("h3",{class:"text-base w-full text-secondary inline-block font-bold"},"阿里云用户专享特权：",-1)),l[22]||(l[22]=m("h3",{class:"text-small leading-[1] w-full text-tertiary inline-block mt-[1rem] flex items-center"},[m("span",{class:"svgtofont-el-check text-primaryDark font-bold mr-[.5rem]"}),w(" 免费使用原本需要付费的功能： ")],-1)),l[23]||(l[23]=m("h3",{class:"text-small leading-[1] w-full text-tertiary inline-block mt-[1rem] ml-[1.9rem] flex items-center"},[m("img",{src:"/static/img/soft_ico/ico-msg_push.png",class:"w-[2rem] mr-[1rem]"}),w(" 异常监控推送 ")],-1)),l[24]||(l[24]=m("h3",{class:"text-small leading-[1] w-full text-tertiary inline-block mt-[1.5rem] flex items-center"},[m("span",{class:"svgtofont-el-check text-primaryDark font-bold mr-[.5rem]"}),w(" 宝塔官方付费软件均享额外折扣 ")],-1))]),_:1},8,["class"]),u(B,{type:"primary",class:"w-[85%] mt-[4rem] relative left-[7.5%]",style:{margin:"1rem auto 0"},size:"default",onClick:ue},{default:o(()=>[...l[25]||(l[25]=[w("一键激活专享特权",-1)])]),_:1}),d(Y)?g("",!0):(r(),h("div",J,[d(Z).bindUser?g("",!0):(r(),h(b,{key:0},[u(E,{onClick:ye},{default:o(()=>[...l[26]||(l[26]=[w("暂不绑定",-1)])]),_:1}),u(H)],64)),m("span",{class:"cursor-pointer hover:text-primaryDark",onClick:l[7]||(l[7]=e=>he(1))},"已有宝塔账号登录")])),(null==(A=e.compData)?void 0:A.title)?(r(),h("div",Q)):g("",!0)],6)],512),[[n,2===d(ce)]]),1===d(ce)?(r(),h("div",N,[l[29]||(l[29]=m("div",{class:"more-title"},[m("span",null,"更多绑定方式")],-1)),m("div",P,[c(m("div",{class:"wechat-login-container",onClick:l[8]||(l[8]=e=>he(2))},[...l[27]||(l[27]=[m("div",{class:"wechat-icon-circle"},[m("i",{class:"wechat-icon tencent_ico"})],-1),m("div",{class:"wechat-text"},"阿里云",-1)])],512),[[n,1===d(ce)&&d(fe)]]),c(m("div",{class:v(["wechat-login-container",{"ml-[1.4rem]":d(fe)}]),onClick:l[9]||(l[9]=(...e)=>d(ge)&&d(ge)(...e))},[...l[28]||(l[28]=[m("div",{class:"wechat-icon-circle"},[m("i",{class:"wechat-icon"},[m("svg",{t:"1749545795651",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"9096",width:"20",height:"20"},[m("path",{d:"M391.95 175.27c-159.03 0-289.29 108.4-289.29 246.04 0 79.45 43.35 144.67 115.74 195.2l-28.93 87.05 101.12-50.74c36.19 7.19 65.22 14.54 101.33 14.54 9.08 0 18.09-0.45 27.01-1.16-5.64-19.37-8.92-39.61-8.92-60.62 0-126.32 108.54-228.89 245.97-228.89 9.37 0 18.64 0.69 27.86 1.71C658.8 261.87 534.2 175.27 391.95 175.27z m-93.97 195.31c-21.67 0-43.56-14.52-43.56-36.21 0-21.77 21.89-36.09 43.56-36.09s36.12 14.33 36.12 36.09c-0.02 21.69-14.45 36.21-36.12 36.21z m202.46 0c-21.69 0-43.45-14.52-43.45-36.21 0-21.77 21.76-36.09 43.45-36.09 21.79 0 36.21 14.33 36.21 36.09 0 21.69-14.43 36.21-36.21 36.21z m0 0",fill:"#3CB034","p-id":"9097"}),m("path",{d:"M920.01 602.12c0-115.59-115.74-209.86-245.72-209.86-137.64 0-246.05 94.27-246.05 209.86 0 115.84 108.41 209.92 246.05 209.92 28.81 0 57.85-7.25 86.79-14.51l79.36 43.44-21.76-72.3c58.06-43.53 101.33-101.3 101.33-166.55z m-325.5-36.14c-14.41 0-28.95-14.31-28.95-28.92 0-14.44 14.54-28.96 28.95-28.96 21.89 0 36.21 14.52 36.21 28.96 0 14.61-14.33 28.92-36.21 28.92z m159.13 0c-14.31 0-28.74-14.31-28.74-28.92 0-14.44 14.43-28.96 28.74-28.96 21.67 0 36.21 14.52 36.21 28.96 0 14.61-14.54 28.92-36.21 28.92z m0 0",fill:"#3CB034","p-id":"9098"})])])],-1),m("div",{class:"wechat-text"},"微信",-1)])],2),[[n,1===d(ce)]])])])):g("",!0)]}),_:1},8,["rules","model","class"])}}}),[["__scopeId","data-v-b632fca8"]]);export{R as default};
