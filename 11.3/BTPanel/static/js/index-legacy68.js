!function(){function e(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,u,l=[],i=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);i=!0);}catch(e){c=!0,a=e}finally{try{if(!i&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(c)throw a}}return l}}(e,n)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function o(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return l(s,"_invoke",function(n,r,a){var o,u,l,c=0,s=a||[],f=!1,p={p:0,n:0,v:e,a:v,f:v.bind(e,4),d:function(t,n){return o=t,u=0,l=e,p.n=n,i}};function v(n,r){for(u=n,l=r,t=0;!f&&c&&!a&&t<s.length;t++){var a,o=s[t],v=p.p,d=o[2];n>3?(a=d===r)&&(l=o[(u=o[4])?5:(u=3,3)],o[4]=o[5]=e):o[0]<=v&&((a=n<2&&v<o[1])?(u=0,p.v=r,p.n=o[1]):v<d&&(a=n<3||o[0]>r||r>d)&&(o[4]=n,o[5]=r,p.n=d,u=0))}if(a||n>1)return i;throw f=!0,r}return function(a,s,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===s&&v(s,d),u=s,l=d;(t=u<2?e:l)||!f;){o||(u?u<3?(u>1&&(p.n=-1),v(u,l)):p.n=l:p.v=l);try{if(c=2,o){if(u||(a="next"),t=o[a]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,u<2&&(u=0)}else 1===u&&(t=o.return)&&t.call(o),u<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),u=1);o=e}else if((t=(f=p.n<0)?l:n.call(r,p))!==i)break}catch(t){o=e,u=1,l=t}finally{c=1}}return{value:t,done:f}}}(n,a,o),!0),s}var i={};function c(){}function s(){}function f(){}t=Object.getPrototypeOf;var p=[][r]?t(t([][r]())):(l(t={},r,function(){return this}),t),v=f.prototype=c.prototype=Object.create(p);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=Object.create(v),e}return s.prototype=f,l(v,"constructor",f),l(f,"constructor",s),s.displayName="GeneratorFunction",l(f,a,"GeneratorFunction"),l(v),l(v,a,"Generator"),l(v,r,function(){return this}),l(v,"toString",function(){return"[object Generator]"}),(u=function(){return{w:o,m:d}})()}function l(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}l=function(e,t,n,r){function o(t,n){l(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},l(e,t,n,r)}function i(e,t,n,r,a,o,u){try{var l=e[o](u),i=l.value}catch(e){return void n(e)}l.done?t(i):Promise.resolve(i).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function u(e){i(o,r,a,u,l,"next",e)}function l(e){i(o,r,a,u,l,"throw",e)}u(void 0)})}}System.register(["./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./index-legacy109.js?v=1763689792","./column-legacy.js?v=1763689792","./useController-legacy6.js?v=1763689792"],function(t,r){"use strict";var o,l,i,s,f,p,v,d,m,b,y,_,h,g,w,S,j,k,O,x,q,R,C,P,E,M,D,T,B,L,A,G,W,H,N,I,z,Q,F,Y,$,V,U,K,J,X,Z,ee,te,ne,re;return{setters:[function(e){o=e.Q,l=e.h1,i=e.h2,s=e.aK,f=e.h3,p=e.h4,v=e.u,d=e.gR,m=e.M,b=e.n,y=e.H,_=e.p,h=e.an,g=e.x,w=e.V,S=e.h5,j=e.h6,k=e.b3,O=e.h7,x=e.ao,q=e.ap,R=e.$,C=e._,P=e.h8,E=e.h9,M=e.ha,D=e.hb,T=e.aC},function(e){B=e.j,L=e.k,A=e.s,G=e.r,W=e.e,H=e.D,N=e.bO,I=e.bP,z=e.i,Q=e.c,F=e.v,Y=e.n,$=e.x,V=e.y,U=e.C,K=e.z,J=e.L,X=e.O,Z=e.R},function(e){ee=e._},function(e){te=e.c,ne=e.u,re=e.a},null],execute:function(){t("g",function(e){var t,n,r,a,o,u,l,i,c,s,f,p,v,d,m,b,y,_,h,w,S,j,k,O,x,q,R,C,P,E,M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"master";var D="master"==M?(null===(t=e.value)||void 0===t?void 0:t.master_detail.data)||{}:e.data||{},T=D.memory||{},B=D.performance||{},L=D.connections||{},A=D.replication||{},G=[{name:"base",label:"基础信息",items:[{label:"节点状态",value:"online"===D.status?"在线":"离线"},{label:"Redis版本",value:D.redis_version||"--"},{label:"运行天数",value:(null!==(n=D.uptime_days)&&void 0!==n?n:"--")+"天"},{label:"监听端口",value:null!==(r=D.port)&&void 0!==r?r:"--"},{label:"连接数",value:null!==(a=D.connected_slaves)&&void 0!==a?a:"--"},{label:"角色",value:null!==(o=D.role)&&void 0!==o?o:"--"}]},{name:"memory",label:"内存信息",items:[{label:"已使用内存",value:null!==(u=T.used_memory_human)&&void 0!==u?u:"--"},{label:"系统内存",value:T.max_memory?g(T.max_memory):"--"},{label:"内存使用率",value:null!=T.usage_percent?qe(T.usage_percent):"--",tooltip:"计算方式：已使用内存/系统内存"}]},{name:"connection",label:"连接信息",items:[{label:"当前连接数",value:null!==(l=L.connected_clients)&&void 0!==l?l:"--"},{label:"总连接数",value:null!==(i=L.total_connections)&&void 0!==i?i:"--",tooltip:"仅记录TCP连接数"},{label:"最大连接数限制",value:null!==(c=L.max_clients)&&void 0!==c?c:"--"},{label:"拒绝连接数",value:null!==(s=L.rejected_connections)&&void 0!==s?s:"--"}]},{name:"performance",label:"性能统计",items:[{label:"当前QPS",value:null!==(f=B.qps)&&void 0!==f?f:"--"},{label:"总执行命令数",value:null!==(p=B.total_commands)&&void 0!==p?p:"--"},{label:"键命中次数",value:null!==(v=B.keyspace_hits)&&void 0!==v?v:"--"},{label:"键未命中次数",value:null!==(d=B.keyspace_misses)&&void 0!==d?d:"--"},{label:"命中率",value:null!=B.hit_rate?qe(B.hit_rate):"--"}]}],W=[{name:"base",label:"基础信息",items:[{label:"Redis版本",value:D.redis_version||"--"},{label:"运行天数",value:(null!==(m=D.uptime_days)&&void 0!==m?m:"--")+"天"},{label:"监听端口",value:null!==(b=D.tcp_port)&&void 0!==b?b:"--"},{label:"角色",value:null!==(y=A.role)&&void 0!==y?y:"--"},{label:"主节点地址",value:null!==(_=A.master_host)&&void 0!==_?_:"--"},{label:"主节点端口",value:null!==(h=A.master_port)&&void 0!==h?h:"--"}]},{name:"memory",label:"内存信息",items:[{label:"已使用内存",value:null!==(w=T.used_memory_human)&&void 0!==w?w:"--"},{label:"系统内存",value:T.max_memory?g(T.max_memory):"--"},{label:"内存使用率",value:null!=T.usage_percent?qe(T.usage_percent):"--"}]},{name:"connection",label:"连接信息",items:[{label:"当前连接数",value:null!==(S=L.connected_clients)&&void 0!==S?S:"--"},{label:"总连接数",value:null!==(j=L.total_connections)&&void 0!==j?j:"--"},{label:"阻塞连接数",value:null!==(k=L.rejected_connections)&&void 0!==k?k:"--"}]},{name:"replication",label:"复制信息",items:[{label:"主从连接状态",value:null!==(O=A.master_link_status)&&void 0!==O?O:"--"},{label:"最后IO时间",value:A.last_io_seconds?A.last_io_seconds+"秒前":"--"},{label:"同步进度",value:A.sync_in_progress?"是":"否"},{label:"复制偏移量",value:null!==(x=A.repl_offset)&&void 0!==x?x:"--"},{label:"复制延迟（秒）",value:null!==(q=A.lag)&&void 0!==q?q:"--"},{label:"是否在线",value:A.is_online?"是":"否"}]},{name:"performance",label:"性能统计",items:[{label:"当前QPS",value:null!==(R=B.qps)&&void 0!==R?R:"--"},{label:"总执行命令数",value:null!==(C=B.total_commands)&&void 0!==C?C:"--"},{label:"键命中次数",value:null!==(P=B.keyspace_hits)&&void 0!==P?P:"--"},{label:"键未命中次数",value:null!==(E=B.keyspace_misses)&&void 0!==E?E:"--"},{label:"命中率",value:null!=B.hit_rate?qe(B.hit_rate):"--"}]}];return"master"==M?G:W});var ae=B("MASTER-STORE",function(){return{tabActive:L("nodeRedisTabActive","mysqlMaster")}}),oe=B("MASTER-MYSQL-STORE",function(){var e=G(!1),t=G([]),n=function(){var e=c(u().m(function e(t){var n,r;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,n={slave_ip:t.slave_ip},e.n=1,o({loading:"正在删除从库，请稍候...",request:l(n),message:!0});case 1:return r=e.v,e.a(2,{status:r.status,msg:r.msg});case 2:return e.p=2,e.v,e.a(2,{status:!1,msg:"删除从库失败"})}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}(),r=function(){var t=c(u().m(function t(n,r,a,o){var i,s,f;return u().w(function(t){for(;;)switch(t.n){case 0:return i=o.label,s=o.value,f=function(){var e=c(u().m(function e(t,n){var r;return u().w(function(e){for(;;)switch(e.n){case 0:r=s,e.n="delete"===r?1:3;break;case 1:return e.n=2,l({slave_ip:t.slave_ip});case 2:return e.a(2,e.v);case 3:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}(),t.n=1,n({title:"批量".concat(i,"从库"),content:"批量".concat(i,"已选的从库，是否继续操作！"),column:[{label:"从库地址",prop:"slave_ip"},te()],onConfirm:function(){var t=c(u().m(function t(){return u().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,r(f);case 1:return e.value=!0,t.a(2,!1)}},t)}));return function(){return t.apply(this,arguments)}}()});case 1:return t.a(2)}},t)}));return function(e,n,r,a){return t.apply(this,arguments)}}(),a=function(){var e=c(u().m(function e(){var t,n;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,i();case 1:return t=e.v,e.a(2,t);case 2:e.p=2,n=e.v,s(n);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}(),v=function(){var e=c(u().m(function e(t){var n,r;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,f(t);case 1:return n=e.v,e.a(2,n);case 2:e.p=2,r=e.v,s(r);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=c(u().m(function e(t,n){var r,a;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,p({slave_ip:t.slave_ip,status:n});case 1:return r=e.v,e.a(2,r);case 2:e.p=2,a=e.v,s(a);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t,n){return e.apply(this,arguments)}}();return{deleteMysqlSlaveEvent:n,multDeleteMysqlSlaveEvent:r,setMysqlSlaveEvent:d,getMysqlSlaveHistoryEvent:a,deleteMysqlSlaveHistoryEvent:v,isRefreshList:e,mysqlRowData:t}}),ue=t("a",function(){return a(a({},oe()),A(oe()))});function le(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!z(e)}var ie=ue().mysqlRowData,ce=v(),se=(ce.plugin,ce.getGlobalInfo),fe=function(){var e=c(u().m(function e(){var t,a;return u().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,se();case 1:return a=e.v,e.n=2,o({request:d(),loading:"正在获取节点数据，请稍等...",success:function(e){e.msg&&!1===e.status&&m.error(e.msg),ie.value=e.data.data.filter(function(e){return!e.is_local&&!e.lpver}).map(function(e){return{label:"".concat(e.remarks," - ").concat(e.server_ip),value:e.id,remarks:e.server_ip}})}});case 2:b({title:"添加主从",area:62,compData:{panel_address:"object"===n(a)&&(null==a||null===(t=a.panel)||void 0===t?void 0:t.address)},btn:["添加","取消"],component:function(){return y(function(){return r.import("./add-form-legacy.js?v=1763689792")},void 0,r.meta.url)},showFooter:!0});case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),pe=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,me().openMasterSlaveLog)(e,t)},ve=function(){var e=c(u().m(function e(t){var n,r,a,o,l,i;return u().w(function(e){for(;;)switch(e.n){case 0:return n=ue(),r=n.deleteMysqlSlaveEvent,a=n.isRefreshList,e.n=1,_({title:"".concat("删除mysql从库【".concat(t.slave_ip,"】")),content:"".concat("风险操作，此操作不可逆，删除【".concat(t.slave_ip,"】后您将无法管理该从库，是否继续操作？"))});case 1:return e.n=2,r(t);case 2:o=e.v,l=o.status,i=o.msg,l?(m.success(i),a.value=!0):m.error(i);case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=c(u().m(function e(t){var n,r,a;return u().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,_({title:"".concat("start"===t.run_status?"停止":"启动","从库同步【").concat(t.slave_ip,"】"),content:"是否确认".concat("start"===t.run_status?"停止":"启动","从库同步【").concat(t.slave_ip,"】？")});case 1:return n=ue(),r=n.setMysqlSlaveEvent,a=n.isRefreshList,e.n=2,r(t,"start"===t.run_status?"stop":"start");case 2:a.value=!0;case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),me=function(){var t=function(){var t=c(u().m(function t(n){var r,a,o,l,i,c=arguments;return u().w(function(t){for(;;)switch(t.n){case 0:if(r=c.length>1&&void 0!==c[1]&&c[1],a=G(),!r||"done"!==n.config_status){t.n=2;break}return t.n=1,S({slave_ip:n.slave_ip});case 1:o=t.v,l=o.data,a.value=l,t.n=4;break;case 2:if(j(n.error_msg)){t.n=3;break}a.value=n.error_msg,t.n=4;break;case 3:return"done"!==n.config_status&&m.error("主从配置未完成，请先完成主从配置：操作 - 同步中"),t.a(2);case 4:i=m.load("正在获取日志信息，请稍后..."),b({title:"从库状态日志",area:60,component:function(){var t;return W("div",{class:"p-[1.6rem] max-h-[60rem] overflow-y-auto"},[W("div",{class:"mb-[1.6rem]"},[H("从库地址: "),n.slave_ip]),W(N,{column:1,border:!0},le(t=Object.entries(a.value).map(function(t){var n,r=e(t,2),a=r[0],o=r[1];return W(I,{label:a},le(n=String(o))?n:{default:function(){return[n]}})}))?t:{default:function(){return[t]}})])}}),null==i||i.close();case 5:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}();return{openMasterSlaveLog:t}},be=t("b",function(e){b({title:"同步进度",area:[60,"auto"],component:function(){return y(function(){return r.import("./index-legacy375.js?v=1763689792")},void 0,r.meta.url)},compData:{slave_ip:e}})}),ye=Q({__name:"index",setup:function(e){v();var t,n=ue(),a=n.isRefreshList,o=n.multDeleteMysqlSlaveEvent,l=k({options:[{type:"button",label:"添加主从",active:!0,onClick:fe},{type:"button",label:"历史备份",active:!1,onClick:function(){var e,t,n,r=(e=ue(),t=e.getMysqlSlaveHistoryEvent,n=e.deleteMysqlSlaveHistoryEvent,{openHistoryBackup:function(){var e,r,a=h({request:(r=c(u().m(function e(){var n,r;return u().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,t();case 1:return n=e.v,(r=n.data).msg&&!1===r.status&&m.error(r.msg),e.a(2,{data:r.data,total:r.data.length})}},e)})),function(){return r.apply(this,arguments)}),columns:[{label:"文件名",prop:"name"},{label:"大小",prop:"size",render:function(e){return g(e.size)}},{label:"创建时间",prop:"mtime",width:160,render:function(e){return w(e.mtime)}},ne([{title:"下载",onClick:function(e){window.open("/download?filename="+e.path)}},{title:"删除",onClick:(e=c(u().m(function e(t){var r,a,o;return u().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,_({title:"删除备份文件",content:"是否确认删除该备份文件？"});case 1:return e.n=2,n({path:t.path});case 2:r=e.v,a=r.status,o=r.msg,a?(m.success(o),l()):m.error(o);case 3:return e.a(2)}},e)})),function(t){return e.apply(this,arguments)})}])]}),o=a.BtTable,l=a.refresh;b({title:"主库历史备份文件",area:62,component:function(){return W("div",{class:"p-[1.6rem]"},[W(o,{maxHeight:"40rem"},null)])}})}});(0,r.openHistoryBackup)()}}]}),i=l.BtOperation,s=q([{label:"删除",value:"delete",event:o}]),f=function(e){return{label:e.label,prop:e.prop,render:function(t){var n="function"==typeof e.status?e.status(t):t[e.prop];return e.render?e.render(t):W("span",{class:"bt-link ".concat(e.onClick?"cursor-pointer":""," ").concat(e.class?e.class(t):""),style:{color:"success"===n.type?"var(--el-color-primary)":"#ef0808"},onClick:function(){var n;null===(n=e.onClick)||void 0===n||n.call(e,t)}},[n.text])}}},p=h({request:(t=c(u().m(function e(t){var n,r;return u().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,O(t);case 1:return n=e.v,(r=n.data).msg&&!1===r.status&&m.error(r.msg),e.a(2,{data:r.data,total:0,search:{}})}},e)})),function(e){return t.apply(this,arguments)}),columns:[re({key:"slave_ip"}),{label:"从库地址",prop:"slave_ip",minWidth:220},{label:"同步中的数据库",prop:"db_name",render:function(e){return e.db_name}},f({label:"读写状态",prop:"io_status",status:function(e){return{type:"Yes"===e.io_status&&"done"===e.config_status?"success":"danger",text:"done"!==e.config_status?"未开始":"Yes"===e.io_status?"正常":"api_error"===e.sql_status?"从库面板api连接异常":"异常"}},onClick:pe}),f({label:"同步状态",prop:"sql_status",status:function(e){return{type:"Yes"===e.sql_status&&"done"===e.config_status?"success":"danger",text:"done"!==e.config_status?"未开始":"Yes"===e.sql_status?"正常":"api_error"===e.sql_status?"从库面板api连接异常":"异常"}},onClick:pe}),f({label:"是否启用",prop:"run_status",status:function(e){return{type:"start"===e.run_status?"success":"danger",text:"start"===e.run_status?"已启用":"已停用"}},onClick:de}),ne([{render:function(e){var t="done"===e.config_status?"状态":"同步中";return W("span",null,[W("span",{onClick:function(){return"done"===e.config_status?pe(e,!0):be(e.slave_ip)},title:t,class:"bt-link"},[t]),W("div",{class:"el-divider el-divider--vertical",role:"separator",style:"--el-border-style: solid;"},null)])}},{title:"删除",onClick:function(e){return ve(e)}}])],extension:[s,x(a)],empty:function(){return W("span",null,[H("您的列表为空，您可以"),W("span",{class:"bt-link",onClick:fe},[H("添加一个主从")])])}}),d=p.BtTable,S=p.BtSearch,j=p.BtRefresh,C=p.BtPage,P=(p.BtColumn,p.BtBatch);p.refresh;return F(function(){Y(function(){y(function(){return r.import("./index-legacy376.js?v=1763689792")},void 0,r.meta.url),y(function(){return r.import("./index-legacy377.js?v=1763689792")},void 0,r.meta.url)})}),function(e,t){var n=ee,r=R;return $(),V("div",null,[W(n,null,{"header-left":U(function(){return[W(K(i))]}),"header-right":U(function(){return[W(K(S),{class:J(["mr-[10px]","!w-[210px]"]),placeholder:"请输入地址"}),W(K(j))]}),content:U(function(){return[W(K(d))]}),"footer-left":U(function(){return[W(K(P))]}),"footer-right":U(function(){return[W(K(C))]}),_:1}),W(r,{class:"mt-[1rem]",options:[{content:"如从库面板连接异常(从库面板停止，密钥变更)，将无法正常获取读写/同步状态"}]})])}}}),_e=C(ye,[["__scopeId","data-v-1779f5de"]]),he=B("MASTER-REDIS-STORE",function(){return{isRedisRefreshList:G(!1),redisRowData:G([]),redisAvailableNodes:G({row:[],nodes:[]}),redisGroupDetail:G({}),openNodesLoading:G(!0),slaveListLoad:G(!0)}}),ge=t("u",function(){return a(a({},he()),A(he()))}),we=ge(),Se=we.isRedisRefreshList,je=we.redisAvailableNodes,ke=we.redisGroupDetail,Oe=we.openNodesLoading,xe=we.slaveListLoad,qe=t("f",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if("number"!=typeof e||isNaN(e))return"-";var n=(+(100*e).toFixed(t)).toString();return n.indexOf(".")>-1&&(n=(n=n.replace(/\.0+$/,"")).replace(/(\.[1-9]*)0+$/,"$1")),n+"%"}),Re=function(){var e=c(u().m(function e(){var t,n;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return b({title:"新建主从复制组",area:60,btn:["创建","取消"],component:function(){return y(function(){return r.import("./index-legacy378.js?v=1763689792")},void 0,r.meta.url)}}),e.p=1,e.n=2,P();case 2:t=e.v,(n=t.data).status||m.error(n.msg||"获取可用节点失败！"),je.value={row:n.data,nodes:n.data.map(function(e){var t;return{label:"".concat(e.name," - ").concat(e.server_ip," ").concat(null===e.group_info?"":"（主从组 - ".concat(null===(t=e.group_info)||void 0===t?void 0:t.group_name,"）")),value:e.id,server_ip:e.server_ip,disabled:null!==e.group_info}})},e.n=4;break;case 3:e.p=3,e.v;case 4:return e.p=4,Oe.value=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),Ce=function(){var e=c(u().m(function e(t,n,r,a){var o,l,i;return u().w(function(e){for(;;)switch(e.n){case 0:return o=a.label,l=a.value,i=function(){var e=c(u().m(function e(t,n){var r;return u().w(function(e){for(;;)switch(e.n){case 0:r=l,e.n="delete"===r?1:3;break;case 1:return e.n=2,M({group_id:t.group_id});case 2:return e.a(2,e.v);case 3:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}(),e.n=1,t({title:"批量".concat(o),content:"批量删除选中的项目后，项目将无法恢复，是否继续操作？",column:[{label:"主从组名称",prop:"group_name"},te()],onConfirm:function(){var e=c(u().m(function e(){return u().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,n(i);case 1:return Se.value=!0,e.a(2,!1)}},e)}));return function(){return e.apply(this,arguments)}}()});case 1:return e.a(2)}},e)}));return function(t,n,r,a){return e.apply(this,arguments)}}(),Pe=function(){var e=c(u().m(function e(t){var n,a;return u().w(function(e){for(;;)switch(e.n){case 0:return b({title:"管理主从复制组【".concat(t.group_name,"】"),area:80,component:function(){return y(function(){return r.import("./index-legacy379.js?v=1763689792")},void 0,r.meta.url)},compData:{rowData:t}}),e.n=1,E({group_id:t.group_id});case 1:n=e.v,(a=n.data).status||m.error(a.msg||"获取主从复制组失败！"),ke.value=a.data,xe.value=!1;case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),Ee=(t("h",function(e,t){var n;b({title:"".concat("slave"===t?"从节点详情【".concat(e.data.server_ip,"】"):"主节点详情【".concat(null===(n=e.value)||void 0===n||null===(n=n.master_detail)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.address,"】")),area:70,component:function(){return y(function(){return r.import("./index-legacy380.js?v=1763689792")},void 0,r.meta.url)},compData:{rowData:e,type:t||"master"}})}),function(){var e=c(u().m(function e(t){return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=1,e.n=2,_({icon:"warning-filled",title:"删除主从复制组【".concat(t.group_name,"】"),content:"即将删除主从复制组，是否继续操作？"});case 2:return e.n=3,o({loading:"正在删除主从复制组，因需重新还原所有redis相关配置进行重启操作，过程可能较长请稍等...",request:M({group_id:t.group_id}),message:!0,success:function(e){Se.value=!0}});case 3:e.n=5;break;case 4:e.p=4,e.v;case 5:return e.a(2)}},e,null,[[1,4]])}));return function(t){return e.apply(this,arguments)}}());t("o",function(){var e=c(u().m(function e(t){return u().w(function(e){for(;;)switch(e.n){case 0:b({title:"创建主从复制组",area:60,component:function(){return y(function(){return r.import("./redis-create-log-legacy.js?v=1763689792")},void 0,r.meta.url)},compData:{task_id:t}});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());var Me={class:"node-master-redis"},De=Q({__name:"index",setup:function(e){var t,n=ge().isRedisRefreshList,r=q([{label:"删除主从组",value:"delete",event:Ce}]),a=k({options:G([{type:"button",label:"新建主从复制组",active:!0,onClick:function(){return Re()}}])}).BtOperation,o=[re({key:"group_id"}),{label:"主从组名称",prop:"group_name",minWidth:120},{label:"主库地址",prop:"master_server_ip",minWidth:160},{label:"内存占用",prop:"memory_usage",minWidth:100,render:function(e){return W("span",{style:{color:e.memory_usage>=.95?"var(--el-color-danger)":e.memory_usage>.8?"var(--el-color-warning)":"var(--el-color-primary)"}},[qe(e.memory_usage,0)])}},{label:"QPS",prop:"qps",minWidth:80},{label:"连接数",prop:"connections",minWidth:80},{label:"从库数量",prop:"slave_count",minWidth:80},{label:"从库正常数",prop:"normal_slaves",minWidth:100,render:function(e){return W("span",{style:{color:e.normal_slaves<e.slave_count?"var(--el-color-danger)":"var(--el-color-text-primary)"}},[e.normal_slaves])}},{label:"平均延迟（秒）",prop:"avg_lag",minWidth:100},ne([{title:"管理",onClick:Pe},{title:"删除",onClick:Ee}])],l=h({request:(t=c(u().m(function e(t){var n,r;return u().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,D(t);case 1:return n=e.v,(r=n.data).status||m.error(r.msg),e.a(2,{data:r.data,total:r.page.total_count,search:{}})}},e)})),function(e){return t.apply(this,arguments)}),columns:o,extension:[r,x(n)],empty:function(){return W("span",null,[H("您的列表为空，您可以"),W("span",{class:"bt-link",onClick:function(){return Re()}},[H("新建主从复制组")])])}}),i=l.BtTable,s=l.BtBatch,f=l.BtSearch,p=l.BtRefresh,v=l.BtPage;return function(e,t){var n=ee;return $(),V("div",Me,[W(n,null,{"header-left":U(function(){return[W(K(a))]}),"header-right":U(function(){return[W(K(f),{class:J(["mr-[10px]","!w-[210px]"]),placeholder:"请输入名称或地址"}),W(K(p))]}),content:U(function(){return[W(K(i))]}),"footer-left":U(function(){return[W(K(s))]}),"footer-right":U(function(){return[W(K(v))]}),_:1})])}}}),Te=[{label:"MySQL",name:"mysqlMaster",lazy:!0,render:function(){return W(_e,null,null)}},{label:"Redis",name:"redisMaster",lazy:!0,render:function(){return W(De,null,null)}}],Be=Q({__name:"index",setup:function(e){var t=A(ae()).tabActive;return function(e,n){var r=T;return $(),X(r,{class:"module-ui",type:"card",modelValue:K(t),"onUpdate:modelValue":n[0]||(n[0]=function(e){return Z(t)?t.value=e:null}),options:K(Te)},null,8,["modelValue","options"])}}}),Le=Object.freeze(Object.defineProperty({__proto__:null,default:Be},Symbol.toStringTag,{value:"Module"}));t("i",Le)}}})}();
