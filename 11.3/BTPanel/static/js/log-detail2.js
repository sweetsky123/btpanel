import{c as a,r as s,w as t,v as e,a8 as r,x as l,y as o,e as i,C as n,D as c,A as p,z as m,n as u,H as d}from"./base-lib.js?v=1763689792";import{p as f,Q as y,aK as v,b as g}from"./utils-lib.js?v=1763689792";import{clearCrontabLog as x,getCrontabLog as _}from"./site.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";const b={class:"p-[20px]"},w={class:"pre-box bg-darkPrimary mt-[12px] text-white h-[48rem] overflow-auto p-[20px]"},j=["innerHTML"],H=a({__name:"log-detail",props:{compData:{default:{}}},setup(a){const H=g(),h=a,{id:D}=h.compData,k=s("正在获取中...."),q=s(null),C=async()=>{await f({title:"提示",content:"确定清空日志吗？",icon:"warning-filled"}),y({loading:"正在清空日志，请稍后...",request:x({id:D}),message:!0,success:T})},T=async a=>{try{const s=await _({id:D});k.value=s.msg,I(),a&&H.request({status:s.status,msg:s.status?"刷新成功":"刷新失败"})}catch(s){v(s)}},I=()=>{u(()=>{const a=document.querySelector(".pre-box");a.scrollTop=a.scrollHeight})};return t(()=>h.compData,()=>{T()},{immediate:!0}),e(()=>{q.value=setInterval(async()=>{await T()},2e3)}),r(()=>{clearInterval(q.value)}),(a,s)=>{const t=d;return l(),o("div",b,[i(t,{type:"primary",onClick:s[0]||(s[0]=a=>T(!0))},{default:n(()=>[...s[1]||(s[1]=[c("刷新日志",-1)])]),_:1}),i(t,{onClick:C,type:"default"},{default:n(()=>[...s[2]||(s[2]=[c("清空日志",-1)])]),_:1}),p("div",w,[p("pre",{innerHTML:m(k)},null,8,j)])])}}});export{H as default};
