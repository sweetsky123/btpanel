import{B as e,e as a,b as t,aK as s}from"./utils-lib.js?v=1763689792";import{c as l,r,w as i,v as n,a8 as o,I as u,J as c,z as p,x as d,y as v,A as m,G as y,D as f,e as x,R as _,C as g,H as h}from"./base-lib.js?v=1763689792";import{B as b}from"./index119.js?v=1763689792";import{_ as j}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1763689792";import{saveFileBody as k,getJavaProjectConfigList as w,getFileBody as C}from"./site.js?v=1763689792";import{u as S,S as T}from"./useStore4.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./ace.js?v=1763689792";const H={class:"h-full relative"},V={key:0,class:"bg-darkTertiary flex items-center justify-center h-[72rem]"},B={key:1},D={class:"inline-block text-secondary items-center flex"},I={class:"max-w-[55rem] truncate leading-[1.3] inline-block"},L={class:"my-12px"},O={key:0,class:"flex"},U={key:2,class:"bg-darkTertiary flex items-center justify-center h-[72rem]"},q={class:"bg-white px-48px py-16px text-default flex items-center"},z=l({__name:"index",props:{compData:{default:()=>({})}},setup(l,{expose:z}){const{siteInfo:A}=S(),{jumpTabEvent:E}=T(),G=t(),J=r(!1),K=r(""),M=r(!1),R=r({}),F=r(""),N=r(!1),P=r(""),Q=async e=>{if(M.value)try{if(e.data)return F.value=e.data;N.value=!0;const{data:a}=await C({path:e.path});F.value=a.data,N.value=!1}catch(a){s(a),F.value=""}finally{N.value=!1}},W=async()=>{let e=G.load("正在保存内容，请稍候...");try{const e=await k({data:F.value,encoding:"utf-8",path:R.value.path});G.msg({dangerouslyUseHTMLString:!0,message:"<div>".concat(e.msg,"</div>"),type:e.status?"success":"error",duration:e.status?2e3:0,showClose:!e.status,customClass:"!max-w-[70rem]"})}catch(a){}finally{e.close()}};i(()=>A.value,e=>{var a;(null==(a=A.value.project_config)?void 0:a.bind_extranet)&&(M.value=!!A.value.project_config.bind_extranet)},{immediate:!0});const X=async()=>{let e=A.value.project_type.toLowerCase();P.value=e,M.value=!0,(async()=>{try{J.value=!0;const{data:e}=await w({project_name:A.value.name});if(!e.status)return void G.error(e.msg);R.value=e.data.find(e=>"伪静态配置文件"===e.name),R.value&&(K.value=R.value.path,Q(R.value))}catch(e){s(e)}finally{J.value=!1}})()};return n(X),z({init:X}),o(()=>{R.value={}}),(t,s)=>{var l,r;const i=b,n=h,o=a,k=u("bt-loading");return c((d(),v("div",H,[(null==(l=p(R))?void 0:l.path)?y("",!0):(d(),v("div",V,[...s[3]||(s[3]=[m("div",{class:"bg-white px-48px py-16px text-default"},"暂无配置文件",-1)])])),p(M)&&(null==(r=p(R))?void 0:r.path)?(d(),v("div",B,[m("span",D,[s[4]||(s[4]=f(" 文件位置： ",-1)),m("div",I,[x(j,{text:p(R).path},null,8,["text"])]),m("span",{class:"ml-[2rem] svgtofont-el-document-copy cursor-pointer",onClick:s[0]||(s[0]=a=>p(e)({value:p(R).path}))})]),m("div",L,[c(x(i,{class:"!h-[54rem] !w-[64rem] border border-dark rounded-base",modelValue:p(F),"onUpdate:modelValue":s[1]||(s[1]=e=>_(F)?F.value=e:null),request:!1,onSave:W,editorOption:{readonly:"spring"===p(R).type}},null,8,["modelValue","editorOption"]),[[k,p(N)]])]),"spring"!==p(R).type?(d(),v("div",O,[x(n,{type:"primary",onClick:W},{default:g(()=>[...s[5]||(s[5]=[f("保存",-1)])]),_:1})])):y("",!0)])):(d(),v("div",U,[m("div",q,[s[7]||(s[7]=f("请开启 ",-1)),x(o,{onClick:s[2]||(s[2]=e=>p(E)("mapping"))},{default:g(()=>[...s[6]||(s[6]=[f("外网映射",-1)])]),_:1}),s[8]||(s[8]=f(" 后查看配置信息",-1))])]))])),[[k,p(J)],[k,"正在加载配置文件，请稍后...","title"]])}}});export{z as default};
