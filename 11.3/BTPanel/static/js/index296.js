import{n as e,H as a,Q as r,W as t,P as o,l as s,ah as l,p as i}from"./utils-lib.js?v=1763689792";import{_ as n}from"./index109.js?v=1763689792";import{_ as d}from"./index118.js?v=1763689792";import{c as p,r as _,o as m,v as u,I as f,x as c,y as w,z as v,O as j,C as y,e as b,G as g,D as h,R as P,J as x,H as T}from"./base-lib.js?v=1763689792";import{_ as A}from"./index137.js?v=1763689792";import{N as S,O as E}from"./firewall.js?v=1763689792";import{a as I}from"./column.js?v=1763689792";import{r as C,e as H,f as V}from"./useMethod8.js?v=1763689792";import{_ as k}from"./index.vue_vue_type_script_setup_true_lang11.js?v=1763689792";import{g as q}from"./useStore6.js?v=1763689792";import{_ as D}from"./index.vue_vue_type_script_setup_true_lang12.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./validator.js?v=1763689792";import"./index107.js?v=1763689792";import"./index.vue_vue_type_style_index_0_scoped_cdc7f4d3_lang.js?v=1763689792";const F={class:"min-h-[30rem]"},O=p({__name:"index",setup(p){const{refs:{systemTabActive:O,firewallInfo:R}}=q(),U=_(),L=_([]),z=_(""),G=_(0),J=_(!1),M=m({p:1,row:20}),N=(r,t)=>{e({title:r?"修改端口转发规则":"添加端口转发规则",area:44,component:()=>a(()=>import("./add-port-transmit.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),showFooter:!0,compData:{...t,isEdit:r,refreshFn:Q}})},Q=async()=>{"forward"===O.value&&await r({loading:J,request:S({query:z.value}),data:{data:[Array,L],page:t(G)}})},W=(e,a)=>({operation:a,protocol:e.Protocol.toLowerCase(),S_Address:e.S_Address,S_Port:e.S_Port,T_Address:e.T_Address,T_Port:e.T_Port}),B=[I(),{label:"协议",prop:"Protocol"},{label:"源端口",prop:"S_Port"},{label:"目标IP",render:e=>e.T_Address?e.T_Address:"127.0.0.1"},{label:"目标端口",prop:"T_Port"},{label:"时间",prop:"addtime",renderHeader:()=>C("时间","-- : 表示面板数据库中未记录创建时间，规则从系统中直接读取，忽略即可")},{label:"备注",prop:"brief"},H({editEvent:e=>{N(!0,e)},deleteEvent:async e=>{await i({icon:"warning-filled",title:"删除端口转发规则【源端口："+e.S_Port+" -> 目标端口："+e.T_Port+"】",content:"删除选中规则后，该源端口将停止转发至目标端口，是否继续操作？"}),await r({loading:"正在删除IP规则，请稍后...",request:E(W(e,"remove")),message:!0,success:Q})}})],K=[{label:"删除",value:"delete",event:async(e,a)=>{await V(e,a,async(e,a)=>await E(W(e,"remove")),{label:"端口",prop:"T_Address"},Q)}}];return u(()=>Q()),(e,a)=>{const r=A,t=T,i=o,p=s,_=l,m=d,u=n,S=f("bt-loading");return c(),w("div",F,[v(R).init_status?g("",!0):(c(),j(r,{key:0,width:"38rem"},{content:y(()=>[b(D)]),_:1})),b(u,null,{"header-left":y(()=>[b(t,{type:"primary",onClick:a[0]||(a[0]=e=>N())},{default:y(()=>[...a[6]||(a[6]=[h(" 添加端口转发 ",-1)])]),_:1}),b(k,{type:"forward",refreshFn:Q})]),"header-right":y(()=>[b(i,{class:"!w-[32rem]",modelValue:v(z),"onUpdate:modelValue":a[1]||(a[1]=e=>P(z)?z.value=e:null),onSearch:a[2]||(a[2]=e=>Q()),placeholder:"请输入端口/来源"},null,8,["modelValue"])]),content:y(()=>[x(b(p,{ref_key:"portTransmitRef",ref:U,column:B,data:v(L),description:"端口转发列表为空"},null,8,["data"]),[[S,v(J)],[S,"正在加载端口转发列表，请稍后...","title"]])]),"footer-left":y(()=>[b(_,{"table-ref":v(U),options:K},null,8,["table-ref"])]),"footer-right":y(()=>[b(m,{total:v(G),page:v(M).p,"onUpdate:page":a[3]||(a[3]=e=>v(M).p=e),row:v(M).row,"onUpdate:row":a[4]||(a[4]=e=>v(M).row=e),onChange:a[5]||(a[5]=e=>Q()),name:"forward"},null,8,["total","page","row"])]),_:1})])}}});export{O as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
