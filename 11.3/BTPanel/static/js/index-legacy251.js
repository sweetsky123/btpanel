!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function n(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",s=a.toStringTag||"@@toStringTag";function l(n,a,c,s){var l=a&&a.prototype instanceof i?a:i,u=Object.create(l.prototype);return r(u,"_invoke",function(n,r,a){var c,s,l,i=0,u=a||[],f=!1,m={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return c=t,s=0,l=e,m.n=n,o}};function d(n,r){for(s=n,l=r,t=0;!f&&i&&!a&&t<u.length;t++){var a,c=u[t],d=m.p,p=c[2];n>3?(a=p===r)&&(l=c[(s=c[4])?5:(s=3,3)],c[4]=c[5]=e):c[0]<=d&&((a=n<2&&d<c[1])?(s=0,m.v=r,m.n=c[1]):d<p&&(a=n<3||c[0]>r||r>p)&&(c[4]=n,c[5]=r,m.n=p,s=0))}if(a||n>1)return o;throw f=!0,r}return function(a,u,p){if(i>1)throw TypeError("Generator is already running");for(f&&1===u&&d(u,p),s=u,l=p;(t=s<2?e:l)||!f;){c||(s?s<3?(s>1&&(m.n=-1),d(s,l)):m.n=l:m.v=l);try{if(i=2,c){if(s||(a="next"),t=c[a]){if(!(t=t.call(c,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=c.return)&&t.call(c),s<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),s=1);c=e}else if((t=(f=m.n<0)?l:n.call(r,m))!==o)break}catch(t){c=e,s=1,l=t}finally{i=1}}return{value:t,done:f}}}(n,c,s),!0),u}var o={};function i(){}function u(){}function f(){}t=Object.getPrototypeOf;var m=[][c]?t(t([][c]())):(r(t={},c,function(){return this}),t),d=f.prototype=i.prototype=Object.create(m);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,r(e,s,"GeneratorFunction")),e.prototype=Object.create(d),e}return u.prototype=f,r(d,"constructor",f),r(f,"constructor",u),u.displayName="GeneratorFunction",r(f,s,"GeneratorFunction"),r(d),r(d,s,"Generator"),r(d,c,function(){return this}),r(d,"toString",function(){return"[object Generator]"}),(n=function(){return{w:l,m:p}})()}function r(e,t,n,a){var c=Object.defineProperty;try{c({},"",{})}catch(e){c=0}r=function(e,t,n,a){function s(t,n){r(e,t,function(e){return this._invoke(t,n,e)})}t?c?c(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(s("next",0),s("throw",1),s("return",2))},r(e,t,n,a)}function a(e,t,n,r,a,c,s){try{var l=e[c](s),o=l.value}catch(e){return void n(e)}l.done?t(o):Promise.resolve(o).then(r,a)}System.register(["./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./firewall-legacy.js?v=1763689792","./useController-legacy5.js?v=1763689792","./validator-legacy.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./site-legacy.js?v=1763689792","./column-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./useStore-legacy4.js?v=1763689792","./useController-legacy6.js?v=1763689792","./useMethod-legacy5.js?v=1763689792","./index-legacy107.js?v=1763689792"],function(t,r){"use strict";var c,s,l,o,i,u,f,m,d,p,v,y,b,h,g,S,w,x,j,_,k,C,M,T,O,P,D,B,A,z,H,G,E,F,I,L,V,Z;return{setters:[function(e){c=e.u,s=e.Q,l=e.V,o=e.H,i=e.n,u=e.d,f=e.e,m=e.f,d=e._},function(e){p=e.c,v=e.s,y=e.t,b=e.r,h=e.W,g=e.x,S=e.y,w=e.A,x=e.z,j=e.G,_=e.e,k=e.O,C=e.B,M=e.C,T=e.D,O=e.M,P=e.L,D=e.bb,B=e.F,A=e.b1,z=e.R,H=e.H,G=e.b2,E=e.bA,F=e.be,I=e.bz},function(e){L=e.B},function(e){V=e.S},function(e){Z=e.p},null,null,null,null,null,null,null,null],execute:function(){var N={class:"p-[2rem]"},W={class:"head mb-[4rem]"},q={class:"scan-header flex flex-row flex-wrap items-center justify-between"},U={class:"flex flex-row flex-wrap justify-center items-center"},K={key:0,class:"relative scan-header-cont"},Q={key:0,class:"animate-spin absolute top-0 border-primary border-b-2 rounded-full h-full w-full bg-#cccccc00"},R={class:"scan-header-cont flex justify-between flex-col px-[2rem]"},X=["innerHTML"],Y={class:"scan-subtitle text-medium mt-[1.2rem]"},$={class:"scan-header-cont justify-end relative"},J={class:"text-[1.5rem]"},ee={class:"content"},te={key:0,class:"info"},ne={class:"webedit-con flex items-center justify-center"},re={class:"thumbnail-introduce mt-[0rem]"},ae={key:1,class:"scan"},ce={key:0,class:"scan-success border-[0.1rem] p-[2rem] h-[49rem] border-light flex items-center justify-center"},se={class:"flex flex-column items-center"},le={key:1,class:"scan-dangerous"},oe={class:"flex items-center"},ie={class:"w-[26rem] flex items-center justify-start"},ue={class:"ml-[1.2rem]"},fe={class:"flex items-center justify-between w-full"},me={class:"flex items-center ml-[1.2rem]"},de={class:"text-tertiary ml-[1.2rem]"},pe={class:"bg-[#f6f6f6] text-tertiary p-[2rem] ml-[1.2rem]"},ve={class:"mt-[1.2rem] ml-[2rem]"},ye={class:"flex items-center"},be=p({__name:"index",props:{compData:{default:function(){return{isSiteModule:!1}}}},setup:function(t){var d,p,be,he,ge=t,Se=v(V()).scanData,we=c().payment,xe=y(we.value).authType,je=b(!0),_e=b(!1),ke=b({scanTitle:"立即进行漏洞扫描，确保您的网站安全。",scanTime:"您还未进行漏洞扫描!",scanCheckButton:"立即扫描"}),Ce=b(["1"]),Me=h([]),Te={4:["danger","严重"],3:["warning","高危"],2:["info","中危"],1:["success","低危"]},Oe=b("success"),Pe=b(!1),De=function(){var e,t=(e=n().m(function e(){var t,a,c,i,u,f;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if("ltd"===xe.value){e.n=1;break}return e.a(2,Z({sourceId:19}));case 1:return Oe.value="loading",ke.value.scanTitle="正在扫描中，请稍后...",e.p=2,e.n=3,s({request:L(),loading:Pe});case 3:if(t=e.v,a=t.data,ke.value.scanTitle="扫描完成",ke.value.scanTime="扫描时间：".concat(l(a.time)),ke.value.scanCheckButton="重新检测",je.value=!1,a.info.length?(_e.value=!1,Me.value=a.info,Oe.value="danger",ke.value.scanCheckButton="重新检测",ke.value.scanTitle="全部【".concat(a.site_num,"个】网站存在风险项<span class='text-danger'>").concat(a.loophole_num,"</span>个")):(_e.value=!0,ke.value.scanTitle="当前网站没有风险项"),!1===(null==a?void 0:a.status)){e.n=6;break}e.n=!0===ge.compData.isSiteModule?4:6;break;case 4:return e.n=5,o(function(){return r.import("./useController-legacy5.js?v=1763689792").then(function(e){return e.w})},void 0,r.meta.url);case 5:return c=e.v,i=c.useSitePhpStore,u=i(),f=u.scanData,Object.assign(f.value,a),e.a(3,6);case 6:e.n=8;break;case 7:e.p=7,e.v,Oe.value="success";case 8:return e.p=8,e.f(8);case 9:return e.a(2)}},e,null,[[2,7,8,9]])}),function(){var t=this,n=arguments;return new Promise(function(r,c){var s=e.apply(t,n);function l(e){a(s,r,c,l,o,"next",e)}function o(e){a(s,r,c,l,o,"throw",e)}l(void 0)})});return function(){return t.apply(this,arguments)}}(),Be=function(){return i({title:"设置自动扫描",area:54,component:function(){return o(function(){return r.import("./index-legacy481.js?v=1763689792")},void 0,r.meta.url)},showFooter:!0})};return d=Se.value,p=d.loophole_num,be=d.site_num,he=d.time,ge.compData.isSiteModule&&(Se.value.loophole_num>0?(Oe.value="danger",ke.value.scanTitle="<span class='text-danger'>".concat(p,"</span>个高危网站漏洞待处理！ 总扫描网站数量").concat(be,"个"),ke.value.scanTime="上一次扫描时间:".concat(l(he)),ke.value.scanCheckButton="立即查看"):(ke.value.scanTitle="未扫描到网站漏洞，总扫描网站数量".concat(be,"个"),ke.value.scanTime="上一次扫描时间:".concat(l(he)),ke.value.scanCheckButton="重新检测",Oe.value="success")),function(n,r){var a=u,c=f,s=H,l=G,o=m,i=F,d=I,p=E;return g(),S("div",N,[w("div",W,[w("div",q,[w("div",U,["loading"==x(Oe)?(g(),S("div",K,[x(Pe)?(g(),S("div",Q)):j("",!0),_(a,{icon:"scanning-scan",size:60,color:"#20a53a"})])):j("",!0),"success"==x(Oe)?(g(),k(a,{key:1,icon:"scanning-success",size:80,color:"#20a53a"})):j("",!0),"danger"==x(Oe)?(g(),k(a,{key:2,icon:"scanning-danger",size:80,color:"#ef0808"})):j("",!0),w("div",R,[w("div",{class:"scan-title text-extraLarge font-bold",innerHTML:x(ke).scanTitle},null,8,X),w("div",Y,C(x(ke).scanTime),1)])]),w("div",$,[_(c,{class:"btlink setScanAlarm absolute top-[6rem] right-1rem",onClick:Be},{default:M(function(){return e(r[1]||(r[1]=[T(" 自动扫描>> ",-1)]))}),_:1}),_(s,{class:"scan-btn h-[4rem] w-[10rem]",type:"loading"==x(Oe)?"default":"primary",size:"large",onClick:De},{default:M(function(){return[w("span",J,C(x(ke).scanCheckButton),1)]}),_:1},8,["type"])])])]),_(l,{class:"!mt-0"}),w("div",ee,[x(je)?(g(),S("div",te,[w("div",ne,[_(o,{style:O(t.compData.isSiteModule?"width:40rem":""),src:t.compData.isSiteModule?"/preview/site_scanning.png":"/firewall/safe_detect_scanning.png",class:P(t.compData.isSiteModule?"!w-[34rem] mr-[4rem]":"max-w-[90rem] mr-[4rem]")},null,8,["style","src","class"]),w("div",re,[r[3]||(r[3]=w("span",{class:"text-large font-bold"},"漏洞扫描工具介绍：",-1)),w("ul",{class:P(["block leading-[3rem] mx-[2rem] list-square mt-[2rem]",t.compData.isSiteModule?"text-small":"text-medium"])},e(r[2]||(r[2]=[D("<li data-v-63449881> 可识别多款开源CMS程序，支持如下： <br data-v-63449881> 迅睿CMS、pbootcms、苹果CMS、eyoucms、 <br data-v-63449881> 海洋CMS、ThinkCMF、zfaka、dedecms、 <br data-v-63449881> MetInfo、emlog、帝国CMS、discuz、 <br data-v-63449881> Thinkphp、Wordpress、Z-Blog、极致CMS、 <br data-v-63449881> ShopXO、HYBBS、ECShop、SchoolCMS、 <br data-v-63449881> phpcms、likeshop、iCMS、WellCMS、 <br data-v-63449881> chanzhiEPS、PHPOK、LaySNS、骑士CMS、 <br data-v-63449881> openSNS、齐博CMS、ZZZCMS、prestashop、 <br data-v-63449881> ThinkphpSHOP、DouPHP、cmseasy、 <br data-v-63449881> piwigo、phpwind、行云海CMS </li><li data-v-63449881>可扫描网站中存在的漏洞</li><li data-v-63449881>提供修复/提供付费解决方案</li>",3)])),2)])])])):(g(),S("div",ae,[x(_e)?(g(),S("div",ce,[w("div",se,[_(o,{src:"/firewall/secure.png",class:"w-[34.0rem] h-[30.1rem]"}),r[4]||(r[4]=w("span",{class:"absolute mt-[10.5rem] text-extraLarge leading-[0.14rem]"}," 当前处于【安全状态】，请继续保持！ ",-1))])])):(g(),S("div",le,[r[7]||(r[7]=w("div",{class:"flex items-center mb-[2rem] text-default"},[w("span",{class:"w-[26rem]"},"网站"),w("span",null,"类型")],-1)),w("div",{class:P(t.compData.isSiteModule?"overflow-auto h-[42rem]":"")},[_(p,{modelValue:x(Ce),"onUpdate:modelValue":r[0]||(r[0]=function(e){return z(Ce)?Ce.value=e:null}),accordion:""},{default:M(function(){return[(g(!0),S(B,null,A(x(Me),function(t,n){return g(),k(d,{key:n},{title:M(function(){return[w("div",oe,[w("div",ie,[_(i,{type:t.cms.length>0?"warning":"success",effect:"dark"},{default:M(function(){return[T(C(t.cms.length)+"项 ",1)]}),_:2},1032,["type"]),w("span",ue,C(t.name),1)]),w("span",null,C(t.cms_name+"--"+t.version_info),1),r[5]||(r[5]=w("div",{class:"text-secondary text-small ml-[6rem]"},"无法自动修复,请在网站后台更新该软件版本。",-1))])]}),default:M(function(){return[_(p,{accordion:""},{default:M(function(){return[(g(!0),S(B,null,A(t.cms,function(t,n){return g(),k(d,{key:n},{title:M(function(){return[w("div",fe,[w("div",me,[_(i,{type:Te[t.dangerous][0]},{default:M(function(){return[T(C(Te[t.dangerous][1]),1)]}),_:2},1032,["type"]),w("span",de,C(t.ps),1)]),_(c,{class:"mb-[.2rem] mr-[1.6rem]"},{default:M(function(){return e(r[6]||(r[6]=[T("详情",-1)]))}),_:1})])]}),default:M(function(){return[w("div",pe,"修复建议："+C(t.repair),1)]}),_:2},1024)}),128))]}),_:2},1024)]}),_:2},1024)}),128))]}),_:1},8,["modelValue"])],2)]))])),w("div",ve,[w("div",ye,[r[9]||(r[9]=T(" 如需支持其他cms程序，请发帖反馈： ",-1)),_(c,{href:"https://www.bt.cn/bbs/thread-89149-1-1.html"},{default:M(function(){return e(r[8]||(r[8]=[T(" https://www.bt.cn/bbs/thread-89149-1-1.html ",-1)]))}),_:1})])])])])}}});t("default",d(be,[["__scopeId","data-v-63449881"]]))}}})}();
