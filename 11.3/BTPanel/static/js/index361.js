import{r as a,c as e,t as s,g as t,e as l,U as i,am as r,D as o,be as n,an as u,v as p,a8 as c,J as m,z as d,x as v,y as g,C as y,aZ as f,bu as b}from"./base-lib.js?v=1763689792";import{Q as x,kV as _,L as j,$ as w}from"./utils-lib.js?v=1763689792";import{c as h,i as I,g as P}from"./index61.js?v=1763689792";import{h as k,o as D}from"./form-item.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index109.js?v=1763689792";import"./index118.js?v=1763689792";import"./useMethod9.js?v=1763689792";import"./validator.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";import"./useMethod11.js?v=1763689792";import"./header-nav-tools.vue_vue_type_script_setup_true_lang.js?v=1763689792";const V=a({bind:"",status:!0,tags:[],cycle:10}),q=a(!1),z={class:"pt-[1.6rem] px-[3rem]"},C=e({__name:"index",props:{compData:{type:Object,default:()=>({})}},setup(a,{expose:e}){const C=a,{row:H}=s(C.compData),U=[{isHtml:!0,content:'<span class="text-warningDark">开启IP轮换后会定时在选择的多个IP中依次轮换，需要多IP的机器</span>'},{isHtml:!0,content:'<span class="text-warningDark">此功能为附加功能，不影响使用，普通用户可以忽略</span>'}],{BtForm:M,submit:O}=j({data:()=>V.value,options:a=>t(()=>[k("轮换周期",()=>l(i,{modelValue:a.value.cycle,"onUpdate:modelValue":e=>a.value.cycle=e,placeholder:"请输入轮换周期"},{append:()=>"分钟"}),"cycle",{rules:[{required:!0,message:"请输入轮换周期",trigger:"blur"}]}),k("IP池",()=>l(u,{class:"bt-multiple-select",modelValue:a.value.tags,"onUpdate:modelValue":e=>a.value.tags=e,placeholder:"请选择IP",multiple:!0},{default:()=>[I.value.map(a=>l(r,{key:a.value,label:a.label,value:a.value},{default:()=>[l("span",{style:"float: left; max-width: 10ch; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"},[a.label]),l("span",{class:"ml-[.8rem]",style:"float: right; color: var(--el-base-tertiary); font-size: var(--el-font-size-small)"},[o("IP: "),a.ip])]}))],tag:()=>{var e;return(null==(e=a.value.tags)?void 0:e.length)?l("div",{class:"flex flex-wrap gap-[5px]"},[a.value.tags.map(a=>l(n,{key:a,type:"info",closable:!0,class:"!w-auto inline-flex items-center",onClose:()=>B(a)},{default:()=>[a,o(" "),l("span",{class:"text-tertiary ml-1"},[o("IP: "),F(a)])]}))]):null}}),"tags",{rules:[{required:!0,message:"请选择IP",trigger:"blur"}]}),D("状态","status")]),submit:async(a,e)=>(await e(),await(async a=>{const e=await x({request:_({bind:a.bind,tags:a.tags.join(","),cycle:a.cycle,status:a.status?1:0}),loading:"设置中...",message:!0});return e.status&&h(),e.status})(a.value))}),B=a=>{const e=V.value.tags.indexOf(a);e>-1&&V.value.tags.splice(e,1)},F=a=>{const e=I.value.find(e=>e.value===a);return(null==e?void 0:e.ip)||""};return p(async()=>{(a=>{a.domain&&(V.value.bind=a.domain),a.ip_tag&&(V.value.tags=a.ip_tag.map(a=>a.tag)),a.ip_rotate&&(V.value.cycle=a.ip_rotate.cycle,V.value.status=a.ip_rotate.status)})(H.value),q.value=!0,await P(),q.value=!1}),c(()=>{V.value.tags=[],V.value.cycle=10,V.value.status=!0,V.value.bind=""}),e({onConfirm:async()=>{try{return await O()}catch(a){return!1}}}),(a,e)=>{const s=w,t=f,i=b;return m((v(),g("div",z,[l(t,{class:"!mb-[1.6rem]",type:"warning",closable:!1},{default:y(()=>[l(s,{options:U,listStyle:"disc",class:"!text-warningDark"})]),_:1}),l(d(M))])),[[i,d(q)]])}}});export{C as default};
