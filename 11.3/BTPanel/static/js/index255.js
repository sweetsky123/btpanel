import{_ as a}from"./index109.js?v=1763689792";import{p as s,Q as e,jo as l,l as t,j as o}from"./utils-lib.js?v=1763689792";import{_ as i}from"./index130.js?v=1763689792";import{c as r,r as n,aE as p,aB as u,v as c,I as d,x as m,y as f,e as h,C as j,D as v,J as b,z as x,R as _,A as w,B as g,F as y,b1 as C,H as k}from"./base-lib.js?v=1763689792";import{u as D}from"./column.js?v=1763689792";import{uploadCertToCloud as q,removeCloudCert as H}from"./site.js?v=1763689792";import{u as V}from"./useStore4.js?v=1763689792";import{s as A}from"./useController15.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./useStore12.js?v=1763689792";import"./useController6.js?v=1763689792";import"./validator.js?v=1763689792";import"./index107.js?v=1763689792";import"./useController5.js?v=1763689792";import"./useMethod5.js?v=1763689792";import"./useController4.js?v=1763689792";import"./ssl.js?v=1763689792";const B={class:"p-[20px]"},I={class:"relative h-full"},R={class:"p-[20px]"},S={class:"flex flex-col p-[12px] bg-light"},z={class:"mb-[4px]"},E={class:"mb-[4px]"},F={class:"mb-[4px]"},J={class:"overflow-auto h-[12rem] border border-lighter p-[12px]"},L={class:"absolute bottom-0 w-full bg-light flex items-center justify-end p-[12px]"},M=r({__name:"index",props:{compData:{default:()=>({})}},setup(r){var M,O;const{siteInfo:Q}=V(),T=r,U=n(null==(O=null==(M=Q.value)?void 0:M.project_type)?void 0:O.toLowerCase()),G=n(!1),K=n({}),N=n([{label:"域名",prop:"subject"},{label:"到期时间",prop:"not_after"},{label:"品牌",prop:"info.issuer",showOverflowTooltip:!0},{label:"位置",render:a=>p("span",[a.cloud_id>0?"云端":"本地"])},D([{width:70,onClick:async a=>{await s({title:"上传云端证书",content:"将会上传证书信息至云端进行替换，是否继续操作？",icon:"warning-filled",type:"calc"});(await e({loading:"正在上传证书...",request:q({ssl_hash:a.hash}),message:!0})).status&&await X()},isHide:a=>a.cloud_id>0,title:"上传云端"},{onClick:a=>{K.value=a,G.value=!0},title:"部署"},{width:70,onClick:async a=>{await s({title:"删除证书",content:"删除后该证书将不会显示在证书夹，是否继续操作？",icon:"warning-filled"});(await e({loading:"正在删除证书...",request:H({local:a.cloud_id>0?0:1,ssl_hash:a.hash}),message:!0})).status&&await X()},title:"删除"}])]),P=n([]),W=n(!1),X=async()=>{await e({loading:W,request:l(),data:[Array,P]})},Y=u("popupClose");return c(X),(s,e)=>{const l=k,n=i,p=t,u=o,c=a,D=d("bt-loading");return m(),f("div",B,[h(c,null,{"header-left":j(()=>[h(l,{type:"default",onClick:X},{default:j(()=>[...e[3]||(e[3]=[v("从云端同步",-1)])]),_:1})]),"header-right":j(()=>[h(n,{onRefresh:X})]),content:j(()=>[b(h(p,{column:x(N),data:x(P),"max-height":500},null,8,["column","data"]),[[D,x(W)],[D,"正在加载中，请稍后...","title"]])]),popup:j(()=>[h(u,{title:"部署当前证书",modelValue:x(G),"onUpdate:modelValue":e[2]||(e[2]=a=>_(G)?G.value=a:null),area:[52,36]},{default:j(()=>{var a;return[w("div",I,[w("div",R,[w("div",S,[w("span",z,"认证域名："+g(x(K).subject),1),w("span",E,"证书类型："+g(null==(a=x(K).info)?void 0:a.issuer),1),w("span",F,"到期时间："+g(x(K).not_after),1)]),e[4]||(e[4]=w("span",{class:"!mt-[24px] !mb-[4px] inline-block"},"如下是需要批量部署证书的站点：",-1)),w("div",J,[(m(!0),f(y,null,C(r.compData,(a,s)=>(m(),f("div",{key:s,class:"p-[4px] w-full"},g(a.name),1))),128))])]),w("div",L,[h(l,{type:"warning",onClick:e[0]||(e[0]=a=>G.value=!1)},{default:j(()=>[...e[5]||(e[5]=[v("取消",-1)])]),_:1}),h(l,{type:"primary",onClick:e[1]||(e[1]=a=>(async(a=U.value)=>{const{hash:s,subject:e}=K.value;await A({hash:s,subject:e,list:T.compData,type:a}),G.value=!1,Y()})())},{default:j(()=>[v("部署("+g(r.compData.length)+"项目)",1)]),_:1})])])]}),_:1},8,["modelValue"])]),_:1})])}}});export{M as default};
