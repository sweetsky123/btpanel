import{b as a,L as t,$ as e,M as s,_ as r}from"./utils-lib.js?v=1763689792";import{c as o,r as n,g as l,e as i,an as d,am as c,H as m,D as u,v as p,x as v,y as _,z as f,i as b}from"./base-lib.js?v=1763689792";import{h as y,F as j}from"./form-item.js?v=1763689792";import{q as w}from"./useController7.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./validator.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";const g=a(),I={class:"p-[2rem]"};const h=r(o({__name:"index",props:{compData:{default:()=>({})}},setup(a,{expose:r}){const o=a,h=n([]),x=l(()=>h.value.map(a=>{const t=1===a.type?"个人":"企业";return{label:"".concat(a.template_name," (").concat(t,")"),value:a.id,description:"".concat(a.template_name," - ").concat(a.phone)}})),k=[{content:'需要帮助？请查看 <a href="https://docs.bt.cn/domain/user-guide/info-template" target="_blank" class="bt-link">域名实名认证文档</a>',isHtml:!0}],{BtForm:C,submit:D}=t({data:{templateId:void 0},options:a=>l(()=>[y("",()=>{let t;return i("div",{class:"flex items-center gap-4"},[i(d,{modelValue:a.value.templateId,"onUpdate:modelValue":t=>a.value.templateId=t,placeholder:"请选择实名模板",class:"!w-[36rem]"},(e=t=x.value.map(a=>i(c,{key:a.value,label:a.label,value:a.value},null)),"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!b(e)?t:{default:()=>[t]})),i(m,{type:"default",onClick:()=>window.open("https://www.bt.cn/domain/real-name","_blank"),class:"!w-auto"},{default:()=>[u("添加新模板")]})]);var e},"templateId"),j(()=>i("div",null,[i(e,{options:k},null)]))]),submit:async(a,t,e)=>{var r;try{if(await t(),!a.value.templateId)return s.error("请选择实名模板"),!1;const e=h.value.find(t=>t.id===a.value.templateId);return e?(async a=>{const t=g.load("正在提交...");try{const t=await w({url:"/api/v1/domain/manage/update_real_name_tpl",domain_id:a.domainId,new_registrant_id:a.registrantId});return g[t.data.status?"success":"error"](t.data.msg),t.data.status}catch(e){return!1}finally{t.close()}})({domainId:(null==(r=o.compData)?void 0:r.domainId)||0,registrantId:e.registrant_id}):(s.error("未找到选中的模板"),!1)}catch(n){return s.error("提交失败，请重试"),!1}}});return r({onConfirm:D}),p(async()=>{h.value=await(async()=>{try{const a=await w({url:"/api/v1/contact/get_user_detail",p:1,rows:50,status:2});return a.data.status?a.data.data.data:[]}catch(a){return[]}})()}),(a,t)=>(v(),_("div",I,[i(f(C))]))}}),[["__scopeId","data-v-1edd27cc"]]);export{h as default};
