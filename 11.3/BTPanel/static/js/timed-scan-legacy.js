!function(){function e(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return l(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?l(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,l){(null==l||l>e.length)&&(l=e.length);for(var n=0,t=Array(l);n<l;n++)t[n]=e[n];return t}System.register(["./base-lib-legacy.js?v=1763689792","./validator-legacy.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./index-legacy333.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./column-legacy.js?v=1763689792","./index-legacy107.js?v=1763689792","./useStore-legacy9.js?v=1763689792"],function(l,n){"use strict";var t,o,u,r,a,i,d,s,c,f,m,p,y,_,v,g,V,b,h,k,U,j,x,S,A,w,C,I,F,D,L,O,z,M,T,B,E,G;return{setters:[function(e){t=e.c,o=e.v,u=e.I,r=e.x,a=e.y,i=e.J,d=e.z,s=e.O,c=e.C,f=e.e,m=e.G,p=e.A,y=e.V,_=e.be,v=e.D,g=e.B,V=e.F,b=e.K,h=e.S,k=e.ap,U=e.ad,j=e.bc,x=e.bd,S=e.U,A=e.ab},function(e){w=e._},function(e){C=e.ag,I=e.k,F=e.ax,D=e._},function(e){L=e.u,O=e.b,z=e.c,M=e.d,T=e.f,B=e.h,E=e.j,G=e.t},null,null,null,null,null],execute:function(){var n={class:"px-[2rem] py-[2.4rem]"},H={class:"condition-risk"},J={class:"flex items-center"},K={class:"tip"},P={key:0},$=t({__name:"timed-scan",setup:function(l,t){var D=t.expose,$=L(),q=$.isAutoScan,N=$.ruleForm,Q=$.userOptions,R=$.isLoading,W=$.addFtpInfo;return o(O),D({onConfirm:z}),function(l,t){var o=k,D=U,L=C,O=I,z=F,$=j,X=x,Y=S,Z=w,ee=A,le=u("bt-loading");return r(),a("div",n,[i((r(),s(ee,{ref_key:"addFtpInfo",ref:W,model:d(N),class:"btCustomForm p-0","label-width":"4rem",rules:d(G),onSubmit:t[13]||(t[13]=h(function(){},["prevent"]))},{default:c(function(){return[d(q)?(r(),s(D,{key:0,label:"告警状态"},{default:c(function(){return[f(o,{modelValue:d(N).status,"onUpdate:modelValue":t[0]||(t[0]=function(e){return d(N).status=e}),"active-color":"var(--el-color-primary)","inactive-color":"#cdcdcd"},null,8,["modelValue"])]}),_:1})):m("",!0),f(D,{label:"安全风险项",prop:"risk"},{default:c(function(){return[p("div",H,[f(d(y),{modelValue:d(N).login_error,"onUpdate:modelValue":t[1]||(t[1]=function(e){return d(N).login_error=e})},{default:c(function(){return[t[14]||(t[14]=p("span",null,"多次登录失败",-1)),f(d(_),{type:"info",class:"risk-tag",title:d(N).config.login_error_des},{default:c(function(){return[v(g(d(N).config.login_error_des),1)]}),_:1},8,["title"])]}),_:1},8,["modelValue"]),f(d(y),{modelValue:d(N).time,"onUpdate:modelValue":t[2]||(t[2]=function(e){return d(N).time=e})},{default:c(function(){var e;return[t[15]||(t[15]=p("span",null,"登录时间异常",-1)),f(d(_),{type:"info",class:"risk-tag",title:null===(e=d(N).config)||void 0===e?void 0:e.time_des},{default:c(function(){var e;return[v(g(null===(e=d(N).config)||void 0===e?void 0:e.time_des),1)]}),_:1},8,["title"])]}),_:1},8,["modelValue"]),f(d(y),{modelValue:d(N).area,"onUpdate:modelValue":t[3]||(t[3]=function(e){return d(N).area=e})},{default:c(function(){var e;return[t[16]||(t[16]=p("span",null,"登录地区异常",-1)),f(d(_),{type:"info",class:"risk-tag",title:null===(e=d(N).config)||void 0===e?void 0:e.area_des},{default:c(function(){var e,l;return[v(g(null!==(e=d(N).config)&&void 0!==e&&null!==(e=e.area)&&void 0!==e&&e.country.length?null===(l=d(N).config)||void 0===l?void 0:l.area_des:"未配置"),1)]}),_:1},8,["title"])]}),_:1},8,["modelValue"]),f(d(y),{modelValue:d(N).anonymous,"onUpdate:modelValue":t[4]||(t[4]=function(e){return d(N).anonymous=e}),disabled:"other"===d(N).user&&!d(q)},{default:c(function(){return e(t[17]||(t[17]=[p("span",null,"匿名用户登录",-1)]))}),_:1},8,["modelValue","disabled"]),f(d(y),{modelValue:d(N).upload_shell,"onUpdate:modelValue":t[5]||(t[5]=function(e){return d(N).upload_shell=e})},{default:c(function(){var e;return[t[18]||(t[18]=p("span",null,"上传脚本文件",-1)),f(d(_),{type:"info",class:"risk-tag",title:null===(e=d(N).config)||void 0===e?void 0:e.upload_shell_des},{default:c(function(){var e,l;return[v(g(null!==(e=d(N).config)&&void 0!==e&&null!==(e=e.upload_shell)&&void 0!==e&&e.length?null===(l=d(N).config)||void 0===l?void 0:l.upload_shell_des:"未配置"),1)]}),_:1},8,["title"])]}),_:1},8,["modelValue"]),p("span",{class:"bt-link",onClick:t[6]||(t[6]=function(){return d(M)&&d(M).apply(void 0,arguments)})}," 【设置扫描触发条件】 ")])]}),_:1}),d(q)?(r(),a(V,{key:2},[i(f(D,{label:"周期",prop:"cycle"},{default:c(function(){return[f(Y,{class:"max-w-[16rem]",modelValue:d(N).cycle,"onUpdate:modelValue":t[11]||(t[11]=function(e){return d(N).cycle=e}),min:1,type:"number"},{append:c(function(){return[f(X,{type:"flex"},{default:c(function(){return[f($,null,{default:c(function(){return e(t[19]||(t[19]=[p("span",null,"天",-1)]))}),_:1})]}),_:1})]}),_:1},8,["modelValue"])]}),_:1},512),[[b,!1]]),f(D,{label:"告警方式",prop:"channel"},{default:c(function(){return[f(Z,{modelValue:d(N).channel,"onUpdate:modelValue":t[12]||(t[12]=function(e){return d(N).channel=e}),multiple:!0,class:"!w-30rem",limit:["wx_account","sms"]},null,8,["modelValue"])]}),_:1})],64)):(r(),a(V,{key:1},[f(D,{label:"扫描日志天数",prop:"otherDay"},{default:c(function(){return[f(L,{type:"button",size:"small",modelValue:d(N).day,"onUpdate:modelValue":t[7]||(t[7]=function(e){return d(N).day=e}),options:d(T)},null,8,["modelValue","options"]),"other"===d(N).day?(r(),s(O,{key:0,type:"number",modelValue:d(N).otherDay,"onUpdate:modelValue":t[8]||(t[8]=function(e){return d(N).otherDay=e}),modelModifiers:{number:!0},class:"!inline-block ml-[1rem]"},null,8,["modelValue"])):m("",!0)]}),_:1}),f(D,{label:"FTP用户",prop:"userList"},{default:c(function(){return[p("div",J,[f(z,{class:"!w-[16rem]",modelValue:d(N).user,"onUpdate:modelValue":t[9]||(t[9]=function(e){return d(N).user=e}),options:d(B),onChange:d(E)},null,8,["modelValue","options","onChange"]),"other"===d(N).user?(r(),s(z,{key:0,class:"ml-[1rem]",multiple:"","collapse-tags":"",filterable:"",modelValue:d(N).userList,"onUpdate:modelValue":t[10]||(t[10]=function(e){return d(N).userList=e}),options:d(Q)},null,8,["modelValue","options"])):m("",!0)])]}),_:1})],64))]}),_:1},8,["model","rules"])),[[le,d(R)]]),p("div",K,[p("ul",null,[d(q)?(r(),a("li",P,"默认扫描全部用户30天的日志")):m("",!0),t[20]||(t[20]=p("li",null,"【多次登录失败】检测时间为：5分钟",-1))])])])}}});l("default",D($,[["__scopeId","data-v-87d76c83"]]))}}})}();
