import{_ as a}from"./index109.js?v=1763689792";import{Q as e,p as s,l as t,b as i}from"./utils-lib.js?v=1763689792";import{c as r,W as l,o,v as n,I as p,x as m,y as d,e as c,C as u,z as h,D as f,J as b,H as _}from"./base-lib.js?v=1763689792";import{_ as g}from"./index107.js?v=1763689792";import{bl as y,bm as j,bn as v}from"./firewall.js?v=1763689792";import{u as w}from"./column.js?v=1763689792";import{f as x}from"./validator.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";const C={class:"p-[2rem]"},q=r({__name:"index",setup(r){const q=i(),k=l([]),H=o({path:"",type:"dir"}),V=async()=>{e({request:y(),data:{"msg.scan_dir":[Array,a=>{k.value=a.map(a=>({path:a}))}]}})},I=async()=>{H.path?(await e({request:v({dir:H.path}),loading:"正在添加检测目录，请稍后...",message:!0}),V(),H.path=""):q.error("请填写检测目录")},J=[{label:"所在目录",prop:"path"},w([{onClick:async a=>{await s({icon:"question-filled",title:"删除检测目录",width:"34rem",content:"删除检测目录【"+a.path+"】，是否继续操作？"}),await e({request:j({path:JSON.stringify([a.path])}),loading:"正在删除检测目录，请稍后...",message:!0}),V()},title:"删除",isHide:a=>["/bin/","/sbin/","/usr/bin/","/usr/sbin/"].includes(a.path)}])];return n(()=>{V()}),(e,s)=>{const i=g,r=_,l=t,o=a,n=p("bt-loading");return m(),d("div",C,[c(o,null,{"header-left":u(()=>[c(i,{modelValue:h(H).path,"onUpdate:modelValue":s[0]||(s[0]=a=>h(H).path=a),name:"path",placeholder:"选择目录",icon:"icon-file_mode",onIconClick:s[1]||(s[1]=a=>{x({type:"dir",path:"/",change(a,e){a=a.replace(/\/\//g,"/"),H.path=a,H.type=e}})}),onChangePassive:s[2]||(s[2]=a=>{var e;H[e="path"]=H[e].replace(/\s+/g,"")}),width:"32rem"},null,8,["modelValue"]),c(r,{type:"primary",class:"!ml-[.8rem]",onClick:I},{default:u(()=>[...s[3]||(s[3]=[f(" 添加 ",-1)])]),_:1})]),content:u(()=>[b(c(l,{ref:"detecList",column:J,data:h(k),description:"检测列表为空"},null,8,["data"]),[[n,"正在加载检测列表，请稍后...","title"]])]),_:1})])}}});export{q as default};
