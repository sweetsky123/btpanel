import{E as a,V as e,p as t,Q as s,n as l,H as o,W as i,l as n,j as r}from"./utils-lib.js?v=1763689792";import{B as m}from"./index119.js?v=1763689792";import{_ as d}from"./index109.js?v=1763689792";import{_ as p}from"./index118.js?v=1763689792";import{u}from"./column.js?v=1763689792";import{c,b8 as _,r as g,aE as w,e as f,v as h,I as b,x as j,y as v,C as x,J as U,z as I,A as P,R}from"./base-lib.js?v=1763689792";import{aD as V,aC as y,bA as C}from"./firewall.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./ace.js?v=1763689792";import"./index110.js?v=1763689792";const L={class:"p-[2rem] min-h-[40rem]"},D={class:"p-[2rem]"},T=c({__name:"index",props:{compData:{default:{}}},setup(c){const T=c,k=_({p:1,limit:10}),E=g(),q=g(!1),A=g(!1),H=g(0),S=g(),z={mode:"ace/mode/nginx",theme:a.value?"ace/theme/clouds_midnight":"ace/theme/chrome",wrap:!0,showInvisibles:!1,showFoldWidgets:!1,useSoftTabs:!0,tabSize:2,showPrintMargin:!1,readOnly:!0,fontSize:"12px"},O=async a=>{await t({title:"加入IP白名单",content:"是否将".concat(a.address,"添加到IP白名单？"),icon:"warning-filled"}),await s({loading:"正在添加IP白名单，请稍后...",request:y({start_ip:a.address,end_ip:a.address}),message:!0})},W=async()=>{await s({loading:A,request:C({...k,siteName:T.compData.row.site_name}),data:{data:[Array,E],page:i(H)}})},J=[{label:"时间",render:a=>w("span",e(a.addtime))},{label:"用户IP",render:a=>f("span",{class:"bt-link",onClick:()=>O(a)},[a.address])},{label:"恶意类型",prop:"intercept"},{label:"URL地址",prop:"url"},u([{onClick:async a=>{await t({title:"加入URL白名单",content:"加入URL白名单后此URL将不再进行防御，是否继续操作？",icon:"question-filled"}),await s({loading:"正在加入URL白名单，请稍后...",request:V({url_rule:a.url}),message:!0})},title:"URL加白",width:70},{onClick:a=>{l({title:a.address+"-详情",area:56,component:()=>o(()=>import("./log-detail3.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:{row:a,addIpWhiteEvent:O}})},title:"详情"},{onClick:a=>{q.value=!0,S.value=JSON.stringify(a,null,4)},title:"HTTP"}])];return h(()=>W()),(a,e)=>{const t=n,s=p,l=d,o=m,i=r,u=b("bt-loading");return j(),v("div",L,[f(l,null,{content:x(()=>[U(f(t,{height:"380",column:J,data:I(E)},null,8,["data"]),[[u,I(A)],[u,"正在加载中，请稍后...","title"]])]),"footer-right":x(()=>[f(s,{total:I(H),page:I(k).p,"onUpdate:page":e[0]||(e[0]=a=>I(k).p=a),row:I(k).limit,"onUpdate:row":e[1]||(e[1]=a=>I(k).limit=a),onChange:W},null,8,["total","page","row"])]),_:1}),f(i,{title:c.compData.row.site_name+"HTTP详情",modelValue:I(q),"onUpdate:modelValue":e[3]||(e[3]=a=>R(q)?q.value=a:null),area:60},{default:x(()=>[P("div",D,[f(o,{modelValue:I(S),"onUpdate:modelValue":e[2]||(e[2]=a=>R(S)?S.value=a:null),class:"min-h-[48rem] max-h-[60rem] overflow-auto","editor-option":z},null,8,["modelValue"])])]),_:1},8,["title","modelValue"])])}}});export{T as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
