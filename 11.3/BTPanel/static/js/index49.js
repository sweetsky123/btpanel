import{Q as e,u as a,H as s,aC as t}from"./utils-lib.js?v=1763689792";import{_ as n}from"./index124.js?v=1763689792";import{w as i,x as l}from"./firewall.js?v=1763689792";import{c as r,W as o,b8 as u,w as d,I as m,J as p,z as c,x as w,y as _,A as v,e as b,D as g,L as x,B as f,ap as h,r as j,a0 as I,v as y,R as V,O as E}from"./base-lib.js?v=1763689792";import{d as P}from"./useMethod8.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./validator.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";import"./useStore6.js?v=1763689792";const D={class:"tab-header-operate"},L=r({__name:"index",props:{data:{default:{isIntrusion:!1,num:0,days:0}}},emits:["refresh"],setup(a,{emit:s}){const t=a,n=s,l=o(!1),r=u({isIntrusion:!1,num:0,days:0}),j=async a=>{await e({loading:"正在"+(a?"开启":"关闭")+"入侵防御，请稍后...",request:i(a),message:!0}),n("refresh")};return d(()=>t.data,e=>{r.isIntrusion=e.open,r.num=e.totla_times,r.days=e.totla_days},{immediate:!0}),(e,a)=>{const s=h,t=m("bt-loading");return p((w(),_("div",D,[a[2]||(a[2]=v("div",{class:"mr-4"},"入侵防御开关",-1)),v("div",null,[b(s,{modelValue:c(r).isIntrusion,"onUpdate:modelValue":a[0]||(a[0]=e=>c(r).isIntrusion=e),width:36,onChange:j},null,8,["modelValue"])]),a[3]||(a[3]=v("div",{class:"bg-darker w-[1px] h-2rem mx-16px"},null,-1)),v("div",null,[a[1]||(a[1]=g(" 总拦截次数: ",-1)),v("span",{class:x(c(r).num>0?"text-danger":"")},f(c(r).num),3)]),a[4]||(a[4]=v("div",{class:"bg-darker w-[1px] h-2rem mx-16px"},null,-1)),v("div",null,"保护天数: "+f(c(r).days),1)])),[[t,c(l)]])}}}),R={key:0,class:"flex flex-col"},S=r({__name:"index",setup(i){a();const r=o("overview"),d=j(),m=o({}),p=u({title:"入侵防御-功能介绍",ps:"原防提权, 防御大多数的入侵提权攻击造成的挂马和被挖矿,有效拦截webshell执行提权,并及时告警通知",source:105,desc:["违规词内容检测","网页内容修改检测","输出检测报告"],tabImgs:[{title:"概览",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/intrusion_1.png"},{title:"进程白名单",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/intrusion_2.png"},{title:"操作日志",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/intrusion_3.png"}],isInstall:!1,productSrc:"https://www.bt.cn/bbs/thread-50998-1-1.html",pluginInfo:{}}),v=[{label:"概览",name:"overview",render:()=>s(()=>import("./index319.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)},{label:"进程白名单",name:"white",render:()=>s(()=>import("./index320.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)},{label:"操作日志",name:"operationLog",render:()=>s(()=>import("./index321.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)}],g=e=>{"overview"===e&&x()},x=async()=>{const{data:a}=await e({loading:"正在获取入侵防御配置信息，请稍后...",request:l()});d.value=a};return I("infoData",d),I("getIntrusionInfo",x),y(async()=>{m.value=await P("bt_security"),p.pluginInfo=m.value,m.value.setup&&m.value.endtime>-1&&x()}),(e,a)=>{var s;const i=t,l=n;return w(),_("div",null,[(null==(s=c(m))?void 0:s.setup)&&c(m).endtime>-1?(w(),_("div",R,[b(L,{data:c(d),onRefresh:x},null,8,["data"]),b(i,{type:"card",modelValue:c(r),"onUpdate:modelValue":a[0]||(a[0]=e=>V(r)?r.value=e:null),options:v,onChange:g},null,8,["modelValue"])])):(w(),E(l,{key:1,data:c(p),class:"px-[20%] my-[8rem]"},null,8,["data"]))])}}});export{S as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
