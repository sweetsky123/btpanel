!function(){function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var n,r,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function l(e,o,i,a){var l=o&&o.prototype instanceof c?o:c,s=Object.create(l.prototype);return t(s,"_invoke",function(e,t,o){var i,a,l,c=0,s=o||[],d=!1,f={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(e,t){return i=e,a=0,l=n,f.n=t,u}};function p(e,t){for(a=e,l=t,r=0;!d&&c&&!o&&r<s.length;r++){var o,i=s[r],p=f.p,v=i[2];e>3?(o=v===t)&&(l=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=n):i[0]<=p&&((o=e<2&&p<i[1])?(a=0,f.v=t,f.n=i[1]):p<v&&(o=e<3||i[0]>t||t>v)&&(i[4]=e,i[5]=t,f.n=v,a=0))}if(o||e>1)return u;throw d=!0,t}return function(o,s,v){if(c>1)throw TypeError("Generator is already running");for(d&&1===s&&p(s,v),a=s,l=v;(r=a<2?n:l)||!d;){i||(a?a<3?(a>1&&(f.n=-1),p(a,l)):f.n=l:f.v=l);try{if(c=2,i){if(a||(o="next"),r=i[o]){if(!(r=r.call(i,l)))throw TypeError("iterator result is not an object");if(!r.done)return r;l=r.value,a<2&&(a=0)}else 1===a&&(r=i.return)&&r.call(i),a<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=n}else if((r=(d=f.n<0)?l:e.call(t,f))!==u)break}catch(r){i=n,a=1,l=r}finally{c=1}}return{value:r,done:d}}}(e,i,a),!0),s}var u={};function c(){}function s(){}function d(){}r=Object.getPrototypeOf;var f=[][i]?r(r([][i]())):(t(r={},i,function(){return this}),r),p=d.prototype=c.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,a,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=d,t(p,"constructor",d),t(d,"constructor",s),s.displayName="GeneratorFunction",t(d,a,"GeneratorFunction"),t(p),t(p,a,"Generator"),t(p,i,function(){return this}),t(p,"toString",function(){return"[object Generator]"}),(e=function(){return{w:l,m:v}})()}function t(e,n,r,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}t=function(e,n,r,o){function a(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?i?i(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r:(a("next",0),a("throw",1),a("return",2))},t(e,n,r,o)}function n(e,t,n,r,o,i,a){try{var l=e[i](a),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(r,o)}function r(e){return function(){var t=this,r=arguments;return new Promise(function(o,i){var a=e.apply(t,r);function l(e){n(a,o,i,l,u,"next",e)}function u(e){n(a,o,i,l,u,"throw",e)}l(void 0)})}}System.register(["./utils-lib-legacy.js?v=1763689792","./index-legacy109.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./useStore-legacy10.js?v=1763689792","./index-legacy147.js?v=1763689792","./validator-legacy.js?v=1763689792","./index.vue_vue_type_style_index_0_scoped_cdc7f4d3_lang-legacy.js?v=1763689792","./column-legacy.js?v=1763689792","./useController-legacy11.js?v=1763689792"],function(t,n){"use strict";var o,i,a,l,u,c,s,d,f,p,v,y,m,_,g,b,k,h,w,x,j,C,O,T,B,H,S,N,E,M,P,G,D,F,R,I,z,L,q,A,W,$,J,K,Q,U,V,X,Y,Z,ee,te,ne,re,oe,ie;return{setters:[function(e){o=e.u,i=e._,a=e.b3,l=e.an,u=e.ao,c=e.cM,s=e.e$,d=e.H,f=e.n,p=e.gS,v=e.Q,y=e.gT,m=e.ap},function(e){_=e._},function(e){g=e.s,b=e.j,k=e.r,h=e.c,w=e.I,x=e.J,j=e.x,C=e.y,O=e.N,T=e.F,B=e.b1,H=e.A,S=e.B,N=e.L,E=e.O,M=e.e,P=e.C,G=e.D,D=e.G,F=e.ay,R=e.b6,I=e.at,z=e.as,L=e.ar,q=e.g,A=e.v,W=e.n,$=e.z,J=e.K},function(e){K=e.u},function(e){Q=e.u},null,null,function(e){U=e.a,V=e.u},function(e){X=e.g,Y=e.a,Z=e.b,ee=e.c,te=e.d,ne=e.r,re=e.e,oe=e.s,ie=e.f}],execute:function(){var ae=b("NODE-ADD-STORE",function(){var e=o();g(e);var t=k(),n=k({address:"",api_key:"",category_id:"0",remarks:""});return{isEdit:k(!1),addNodeRef:t,nodeForm:n,isVerify:k(!1)}}),le=t("u",function(){return g(ae())}),ue={class:"probe-grid"},ce={key:0,class:"probe-grid__empty"},se={key:1,class:"probe-grid__wrapper"},de={class:"probe-card__header"},fe=["title"],pe={class:"probe-card__info"},ve={class:"probe-card__info-row"},ye=["title"],me={class:"probe-card__info-row"},_e={class:"text-secondary"},ge={key:1,class:"flex flex-col justify-around h-full"},be={class:"probe-card__metric-label"},ke={class:"text-secondary"},he={class:"probe-card__actions"},we=h({__name:"probe-grid",props:{nodes:{},operateOptions:{},categoryMap:{},loading:{type:Boolean},loadingTitle:{}},setup:function(e){var t=e,n=function(e){var t,n;return["在线","","离线","异常","重启中"][null!==(t=null==e||null===(n=e.data)||void 0===n?void 0:n.status)&&void 0!==t?t:0]||"未知"},r=function(e){return e.remarks||e.address||"未命名节点"},o=function(e){if(null==e)return"默认分类";var n=String(e);return t.categoryMap[n]||"默认分类"},i=function(e){var t=Number(e);return Number.isNaN(t)?0:Math.min(Math.max(t,0),100)},a=function(e){var t,n;return 2===(null!==(t=null==e||null===(n=e.data)||void 0===n?void 0:n.status)&&void 0!==t?t:e.status)},l=function(e){var t,n,r,o,a,l,u=i(null==e||null===(t=e.data)||void 0===t?void 0:t.cpu),c=i(null==e||null===(n=e.data)||void 0===n?void 0:n.memory);return"number"==typeof(l=(null==e?void 0:e.data)||{}).disk||"string"==typeof l.disk?i(l.disk):l.disk&&void 0!==l.disk.percent?i(l.disk.percent):void 0!==l.disk_usage?i(l.disk_usage):void 0!==l.disk_used_percent&&i(l.disk_used_percent),(null==e||null===(r=e.data)||void 0===r?void 0:r.disk_txt)||(null==e||null===(o=e.data)||void 0===o?void 0:o.disk)&&e.data.disk.text,[{label:"CPU",value:"".concat(u,"%"),percent:u,color:"var(--el-color-primary)"},{label:"内存",value:null!=e&&null!==(a=e.data)&&void 0!==a&&a.memNewTotal?"".concat(e.data.memNewTotal," (").concat(c,"%)"):"".concat(c,"%"),percent:c,color:"var(--el-color-warning)"}]},u=function(e,t){return"function"==typeof e.isHide?e.isHide(t):Boolean(e.isHide)},c=function(e){var n=[];t.operateOptions.filter(function(t){return!t.isMore&&t.title&&!u(t,e)}).forEach(function(e){n.push({key:"action_".concat(e.title),title:e.title||"",type:"action",data:e})});var r=t.operateOptions.find(function(t){return t.isMore&&!u(t,e)});null!=r&&r.menu&&r.menu.filter(function(t){return"function"==typeof t.isHide?!t.isHide(e):!t.isHide}).forEach(function(e){n.push({key:e.key,title:e.title,type:"more",data:r})});return n};return function(t,i){var u=F,s=R,d=I,f=z,p=L,v=w("bt-loading");return x((j(),C("div",ue,[e.nodes.length||e.loading?(j(),C("div",se,[(j(!0),C(T,null,B(e.nodes,function(e){return j(),C("div",{key:e.id||e.address,class:"probe-card"},[H("div",de,[H("div",{class:"probe-card__title",title:r(e)},S(r(e)),9,fe),H("span",{class:N(["probe-card__status",(t=e,{0:"is-online",2:"is-offline",3:"is-warning",4:"is-warning"}[null!==(v=null==t||null===(y=t.data)||void 0===y?void 0:y.status)&&void 0!==v?v:0]||"")])},S(n(e)),3)]),H("div",pe,[H("div",ve,[i[1]||(i[1]=H("span",null,"地址",-1)),H("span",{class:"text-secondary",title:e.address||"--"},S(e.address||"--"),9,ye)]),H("div",me,[i[2]||(i[2]=H("span",null,"分类",-1)),H("span",_e,S(o(e.category_id)),1)])]),H("div",{class:N(["probe-card__metrics",{"is-empty":a(e),"min-h-[10rem]":!0}])},[a(e)?(j(),E(u,{key:0,description:"节点离线，暂无指标","image-size":60})):(j(),C("div",ge,[(j(!0),C(T,null,B(l(e),function(e){return j(),C("div",{key:e.label,class:"probe-card__metric"},[H("div",be,[H("span",null,S(e.label),1),H("span",ke,S(e.value),1)]),M(s,{percentage:e.percent,"show-text":!1,"stroke-width":6,color:(t=e.percent,t>=90?"var(--el-color-danger)":t>=70?"var(--el-color-warning)":"var(--el-color-primary)")},null,8,["percentage","color"])]);var t}),128))]))],2),H("div",he,[c(e).length?(j(),E(p,{key:0,class:"probe-card__more",onCommand:function(t){return function(e,t){var n=c(t).find(function(t){return t.key===e});if(n)if("action"===n.type){var r=n.data;"function"==typeof r.onClick&&r.onClick(t)}else if("more"===n.type){var o=n.data;"function"==typeof o.onClick&&o.onClick(e,t)}}(t,e)}},{dropdown:P(function(){return[M(f,null,{default:P(function(){return[(j(!0),C(T,null,B(c(e),function(e){return j(),E(d,{key:e.key,command:e.key},{default:P(function(){return[G(S(e.title),1)]}),_:2},1032,["command"])}),128))]}),_:2},1024)]}),default:P(function(){return[i[3]||(i[3]=H("span",{class:"text-secondary hover:!text-primary cursor-pointer flex items-center"},[G(" 操作 "),H("span",{class:"svgtofont-el-arrow-down ml-[2px]"})],-1))]}),_:2},1032,["onCommand"])):D("",!0)])]);var t,v,y}),128))])):(j(),C("div",ce,[O(t.$slots,"empty",{},function(){return[i[0]||(i[0]=H("span",{class:"text-placeholder"},"暂无数据",-1))]},!0)]))])),[[v,e.loading],[v,e.loadingTitle,"title"]])}}}),xe=i(we,[["__scopeId","data-v-27115d9c"]]),je={class:"module-ui"},Ce=h({__name:"index",setup:function(t){var i,g,b=o().mainHeight,k=K(),h=k.rowData,w=k.isRefreshNodeList,O=k.searchWidth,T=k.nodeStatus,B=k.nodeCategory,S=k.forcedFlushes,F=k.setNodeInfo,R=le().isEdit,I=function(e){return"local"===e.api_key&&"local"===e.app_key},z=function(e){return function(t){return!(""!==t.api_key||""!==t.app_key||!t.ssh_conf||!Object.keys(t.ssh_conf).length)||e(t)}},L=function(){return S.value=1},ae=function(e){return h.value=e,R.value=!!e,f({title:"".concat(e?"编辑节点【".concat(e.address,"】"):"添加节点"),area:50,btn:"".concat(e?"保存":"确认"),compData:e||{},component:function(){return d(function(){return n.import("./index-legacy366.js?v=1763689792")},void 0,n.meta.url)}})},ue=[{onClick:ee,title:"访问",isHide:z(function(e){return"local"===e.api_key&&"local"===e.app_key||""!==e.lpver}),type:"success"},{onClick:function(e){return F.value=e,f({title:"".concat(e?"管理节点【".concat(e.address,"】"):"节点管理"),area:90,component:function(){return d(function(){return n.import("./index-legacy367.js?v=1763689792")},void 0,n.meta.url)}})},title:"管理",isHide:I,type:"primary"},{onClick:te,title:"删除",isHide:I,type:"danger"},{isMore:!0,menu:[{key:"edit",title:"编辑",isHide:I},{key:"panel",title:"重启面板",isHide:z(I)},{key:"server",title:"重启服务",isHide:z(I)}],isHide:I,onClick:function(e,t){if("edit"===e)ae(t);else ne(t,e)}}],ce=Q({key:"category_id",name:"节点分类",field:"name",options:function(){return[{label:"全部分类",value:"all"}]},event:{get:re,add:p,delete:function(e){return v({request:y(e),success:function(){T.value=[],w.value=!0}})}},ignore:["0"],showEdit:!1}),se=a({options:[{type:"button",label:"添加节点",active:!0,onClick:function(){return ae()}}]}).BtOperation,de=m([{label:"设置分类",value:"setClass",event:(i=r(e().m(function t(n,r,o,i,a,l){return e().w(function(e){for(;;)switch(e.n){case 0:oe(o,a,we,l);case 1:return e.a(2)}},t)})),function(e,t,n,r,o,a){return i.apply(this,arguments)})},{label:"重启面板",value:"panel",event:ie},{label:"重启服务器",value:"server",event:ie},{label:"删除节点",value:"delete",event:ie}]),fe=q(function(){var e={};return B.value.forEach(function(t){e[String(t.value)]=t.label}),e}),pe=l({request:(g=r(e().m(function t(n){var r;return e().w(function(e){for(;;)switch(e.n){case 0:return"all"===n.category_id&&(n.category_id=""),1===S.value&&(n.refresh=1),e.n=1,X(n);case 1:return r=e.v,Ce.value.show_mode=r.show_mode||"list",e.a(2,r)}},t)})),function(e){return g.apply(this,arguments)}),columns:[U({type:"page",key:"id"}),{label:"节点名称",width:"auto",prop:"remarks",isCustom:!0},{label:"地址",prop:"address",minWidth:120},Y(),Z(),{label:"分类",isCustom:!0,prop:"category_id",render:function(e){var t;return(null===(t=B.value.find(function(t){return Number(t.value)===Number(e.category_id)}))||void 0===t?void 0:t.label)||"默认分类"}},V(ue)],extension:[ce,de,u(w),c(),s({options:[{label:"列表模式",value:"list"},{label:"探针模式",value:"block"}],value:"none",key:"show_mode"})],empty:function(){return M("span",null,[G("您的列表为空，您可以"),M("span",{class:"bt-link",onClick:function(){return ae()}},[G("创建一个节点")])])}}),ve=pe.BtTable,ye=pe.BtPage,me=pe.BtSearch,_e=pe.BtRefresh,ge=pe.BtColumn,be=pe.BtBatch,ke=pe.BtTableCategory,he=pe.BtErrorMask,we=pe.classList,Ce=pe.param,Oe=pe.BtRadioButton,Te=pe.config;return A(function(){W(function(){d(function(){return n.import("./index-legacy367.js?v=1763689792")},void 0,n.meta.url),d(function(){return n.import("./index-legacy368.js?v=1763689792")},void 0,n.meta.url)})}),function(e,t){var n=_;return j(),C("div",je,[M($(he)),M(n,null,{"header-left":P(function(){return[M($(se))]}),"header-right":P(function(){return[M($(Oe),{class:"mr-[10px]"}),M($(ke),{class:"!w-[140px] mr-[10px]"}),M($(me),{class:N(["mr-[10px]","!w-[".concat($(O),"px]")]),placeholder:"请输入节点名称"},null,8,["class"]),M($(_e),{class:"mr-[10px]",onclick:L}),M($(ge))]}),content:P(function(){return["block"===$(Ce).show_mode?(j(),E(xe,{key:0,nodes:$(Te).data,loading:$(Te).loading,"loading-title":$(Te).loadingTitle,"operate-options":ue,"category-map":$(fe)},{empty:P(function(){return[H("span",null,[t[0]||(t[0]=G(" 您的列表为空，您可以 ",-1)),H("span",{class:"bt-link",onClick:ae}," 创建一个节点 ")])]}),_:1},8,["nodes","loading","loading-title","category-map"])):(j(),E($(ve),{key:1,"min-height":$(b)},null,8,["min-height"]))]}),"footer-left":P(function(){return[x(M($(be),null,null,512),[[J,"block"!==$(Ce).show_mode]])]}),"footer-right":P(function(){return["block"!==$(Ce).show_mode?(j(),E($(ye),{key:0})):D("",!0)]}),_:1})])}}}),Oe=i(Ce,[["__scopeId","data-v-0741276f"]]),Te=Object.freeze(Object.defineProperty({__proto__:null,default:Oe},Symbol.toStringTag,{value:"Module"}));t("i",Te)}}})}();
