import{r as e,b8 as t,o as a,c as l,x as s,y as i,A as n,B as o,J as r,K as d,e as c,C as u,F as m,b1 as p,z as y,R as v,n as h,an as f,O as x,am as b,b9 as g,ba as w,D as k,H as D,aC as T,g as A,w as _,v as V,a8 as I,I as S,m as C,G as L,M as z,bb as O,aT as B,ay as M,$ as R,ap as P,bc as E,bd as q}from"./base-lib.js?v=1763689792";import{_ as N}from"./index110.js?v=1763689792";import{as as U,Q as F,p as G,b as j,at as W,au as Z,V as Y,am as J,x as H,_ as Q,n as K,H as X,av as $,aw as ee,k as te}from"./utils-lib.js?v=1763689792";import{S as ae,G as le,a as se,b as ie,c as ne,d as oe}from"./control.js?v=1763689792";const re=j(),de=e("KB/s"),ce=e("KB/s"),ue=e("all"),me=e(7),pe=e(!1),ye=e(0),ve=e(0),he=t({day:0,echartsId:"",echartsParams:{},echartsOption:{},topData:{}}),fe=a({title:"CPU",active:!1,unitVisible:!1,...U(he)}),xe=a({title:"内存",active:!1,unitVisible:!1,...U(he)}),be=a({title:"磁盘IO",active:!1,unitVisible:!0,...U(he)}),ge=a({title:"网络IO：",active:!0,unitVisible:!0,selectVal:"",selectList:[{label:"全部",value:"all"}],...U(he)}),we=a({title:"平均负载",active:!1,unitVisible:!1,...U(he)}),ke=e([]),De={axisLine:{lineStyle:{color:"#666"}},splitLine:{lineStyle:{color:"#ddd"}},axisLabel:{formatter:e=>Te(e/1e3)},nameTextStyle:{color:"#666",fontSize:12,align:"left"},series:{type:"line",smooth:!0,symbol:"circle",showSymbol:!1},table:[{title:"PID",width:"50px",index:1},{title:"进程名",index:2},{title:"CPU占用",index:0,unit:"%"},{title:"启动用户",index:4},{title:"cmd",index:3,width:"160px",custom:!0}]},Te=e=>{const t=new Date(1e3*e),a=t.getMonth()+1,l=t.getDate(),s=t.getHours(),i=t.getMinutes();return"".concat(a.toString().padStart(2,"0"),"-").concat(l.toString().padStart(2,"0"),"\n").concat(s.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"))},Ae=async e=>{let t=ye.value,a=pe.value?"1":"0";return t<1?(!0===e&&(pe.value=!pe.value),re.error("保存天数不合法")):/^-?\d+$/.test(t+"")?void(await F({loading:"正在设置监控状态，请稍后...",request:ae({type:a,day:t}),message:!0,success:async e=>{await je(),e.status&&(me.value=t)}})):re.error("保存天数必须为整数")},_e=({startTime:e,endTime:t})=>({tooltip:{trigger:"axis",axisPointer:{type:"line"},enterable:!0,position:function(e,t,a,l,s){var i,n;let o=0,r=0,d=(null==(i=window.__LAST_VIEWPORT_MOUSE__)?void 0:i.x)||0,c=(null==(n=window.__LAST_VIEWPORT_MOUSE__)?void 0:n.y)||0;const u=d-e[0],m=c-e[1],p=s.contentSize[0]||0,y=s.contentSize[1]||0;return o=e[0]-p-20,r=e[1]-y-30,u<p&&(o=e[0]+20),m<y&&m<300&&(r=e[1]+20),d+p+20>window.innerWidth&&(o=e[0]-p-20),[o,r]}},grid:{bottom:80},xAxis:{type:"time",boundaryGap:["1%","0%"],minInterval:(t-e)/3*1e3,axisLine:De.axisLine,axisLabel:De.axisLabel},yAxis:{type:"value",boundaryGap:[0,"100%"],axisLine:De.axisLine,splitLine:De.splitLine},brush:{xAxisIndex:[0,1],brushType:"lineX",brushMode:"single",throttleType:"debounce",throttleDelay:1e3,toolbox:[]},dataZoom:[{type:"inside",start:0,end:100,zoomLock:!0},{bottom:10,start:0,end:100,handleIcon:"path://M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4v1.3h1.3v-1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z",handleSize:"80%",handleStyle:{color:"#fff",shadowBlur:3,shadowColor:"rgba(var(--el-color-black-rgb), 0.6)",shadowOffsetX:2,shadowOffsetY:2}}],series:[{}]}),Ve=(e,t)=>{e.tooltip.padding=0,e.tooltip.backgroundColor="rgba(255,255,255,0.95)",e.tooltip.borderColor="var(--el-color-border-dark-tertiaryer)",t&&(e.tooltip.position=function(e,a,l,s,i){return((e,t)=>{var a;let l=t.size.contentSize[0],s=t.size.contentSize[1],i=window.innerWidth,n=window.innerHeight,o=null==(a=document.getElementById(e))?void 0:a.getBoundingClientRect(),r=t.pos[0]+(null==o?void 0:o.left),d=t.pos[1]+(null==o?void 0:o.top),c=0,u=0;return u=r+l+80<i?t.pos[0]+20:t.pos[0]-l-20,c=d+s+80<n?t.pos[1]+20:t.pos[1]-s-20,d-s<0&&(c=0-((null==o?void 0:o.top)||0)+10),[u,c]})(t,{pos:e,size:i})})},Ie=e=>{const t=e.time,a=e.legend;let l="",s="",i="";void 0===e.data&&(e.data=[]),void 0===e.table&&(e.table=De.table);for(var n=0;n<e.data.length;n++){const t=e.data[n];0===n&&(l+="<tr>"),s+="<tr>";for(var o=0;o<e.table.length;o++){const a=e.table[o];0===n&&(l+='<th style="width:'.concat(a.width||"auto",'">').concat(a.title,"</th>"),i+="<col ".concat(a.width?'style="width:'.concat(a.width,'"'):"",">"));let r="",d=t[a.index];r="function"==typeof a.unit?a.unit(d):d+(a.unit||""),s+='<td title="'+r+'" '+(a.custom?'style="width:'+a.width+'"':"")+">"+r+"</td>"}0===n&&(l+="</tr>"),s+="</tr>"}return'<div class="echarts-tooltip" style="width:'.concat(e.width||"40rem",'">\n\t\t\t<div class="formatter-header">\n\t\t\t\t<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAABHNCSVQICAgIfAhkiAAAAgBJREFUWIXtWN1xgzAMlkQ3YoCaYaJji8AWPjJM3AEYCasPNT3XZ2xBk17b43uCiy190b8AOHHixN8GPkpQ3/cmfrfWukfIPUyw73vjvTci8oqIJndGRBwivk3TNPwoQWYeAOC689p4hOgugsFq971KYhBRt8f9pD3IzEOOnIg4ABiJqCOibpomBIARAMbw2xd47+/BAyqoLJiznIi4pmnGmjW2rK615IuGYEbBeLvdBs3dQALTuA0yqwZqageCYBOTOxLs8zy7tm0xltW2Lc7z7Er3qv+AmSV+DzF2GJfL5R6XpZqri0mSBjMRdd8hBwDQNM0Yv3vvTel8kaCIvEbPTpMQaUdJYa11cXbHOnIoJknsCkR8KxFbluW6WoOZi64LskyqI4dNC9YsEcN7f08VLcuy2WmIyGl1qQv1VuZuCUfEqrs1UBN8hLIVT2l1JWW5llYisqfVbRJMhZfKQVo6RMTtKUklixazOMxzJjxvloO1na1hUHNhmCE/dZTOFl0clxZN0FtrVbVSW76qBNNyUCodWqSDR62vFwkGa3zGFyKaPQGeInN3zJ2LoWr86cAAByaa3JqgGTxU8yARdYlrrsx81QydaxuEryObevBQj05bi9K6uQF8xNOaSJWNT+2BX780/a+1MwUzD5rFnYiq9fEpBGM869PHiRMn/jreAZxNPtSJHlfLAAAAAElFTkSuQmCC" alt="path" />\n\t\t\t\t<span>日期：').concat(t,'</span>\n\t\t\t</div>\n\t\t\t<div class="formatter-body">\n\t\t\t\t').concat(a,'\n\t\t\t\t<div class="process-top5 ').concat(e.data.length?"":"hide",'">\n\t\t\t\t<div class="process-header"></div>\n\t\t\t\t<table>\n\t\t\t\t\t<colgroup>\n\t\t\t\t\t\t').concat(i,"\n\t\t\t\t\t</colgroup>\n\t\t\t\t\t<thead>\n\t\t\t\t\t<tr>").concat(l,"</tr>\n\t\t\t\t\t</thead>\n\t\t\t\t\t<tbody>").concat(s,"</tbody>\n\t\t\t\t</table>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t</div>")},Se=(e,t)=>({cpu:e=>(({startTime:e,endTime:t,yData:l,topData:s})=>{let i=a(_e({startTime:e,endTime:t}));return i.tooltip.formatter=function(e){let t="";for(var a=0;a<e.length;a++){const l=e[a];t+='\n\t\t\t\t<div class="select-data">\n\t\t\t\t\t<span class="status" style="background-color: '.concat(l.color,'"></span>\n\t\t\t\t\t<span>').concat(l.seriesName,"：").concat(J(l.data[1])?l.data[1].toFixed(2):0,"%</span>\n\t\t\t\t</div>")}return Ie({time:e[0].axisValueLabel,data:s[e[0].axisValue],width:"51rem",legend:t})},Ve(i),i.yAxis.name="百分比",i.yAxis.min=0,i.yAxis.max=100,i.series=[{name:"CPU",...De.series,itemStyle:{color:"rgb(0, 153, 238)"},data:l}],i})(e),mem:e=>(({startTime:e,endTime:t,zData:l,topData:s,echartsId:i})=>{let n=a(_e({startTime:e,endTime:t}));return n.tooltip.formatter=function(e){let t="";for(var a=0;a<e.length;a++){var l=e[a];t+='\n\t\t\t\t<div class="select-data">\n\t\t\t\t\t<span class="status" style="background-color: '.concat(l.color,'"></span>\n\t\t\t\t\t<span>').concat(l.seriesName,"：").concat(J(l.data[1])?l.data[1].toFixed(2):0,"%</span>\n\t\t\t\t</div>")}return Ie({time:e[0].axisValueLabel,data:s[e[0].axisValue],width:"55rem",table:[{title:"PID",width:"50px",index:1},{title:"进程名",width:"100px",index:2},{title:"内存占用",index:0},{title:"启动用户",index:4},{title:"cmd",index:3,width:"200px"}],legend:t})},n.tooltip.className="mem-tooltip",Ve(n,i),n.yAxis.name="百分比",n.yAxis.min=0,n.yAxis.max=100,n.series=[{name:"内存",...De.series,itemStyle:{color:"rgb(0, 153, 238)"},data:l}],n})(e),disk:e=>(({unit:e,startTime:t,endTime:l,rData:s,wData:i,zData:n,yData:o,topData:r,echartsId:d})=>{let c=a(_e({startTime:t,endTime:l}));const u=e||"";return c.tooltip.formatter=function(e){for(var t="",a=0;a<e.length;a++){var l=e[a],s="";"读写次数"===l.seriesName&&(s="次/s"),"读写延迟"===l.seriesName&&(s="ms"),"读取"!==l.seriesName&&"写入"!==l.seriesName||(s=u),t+='<div class="select-data"><span class="status" style="background-color: '+l.color+'"></span><span>'+l.seriesName+"："+(J(l.data[1])?l.data[1].toFixed(2):0)+" "+s+"</span></div>"}const i=e=>"number"!=typeof e?"--":H(e);return Ie({time:e[0].axisValueLabel,data:r[e[0].axisValue],width:"650px",table:[{title:"PID",width:"50px",index:3},{title:"进程名",width:"100px",index:4},{title:"磁盘占用",width:"70px",index:0,unit:i},{title:"读取",width:"70px",index:1,unit:i},{title:"写入",width:"70px",index:2,unit:i},{title:"启动用户",index:6},{title:"cmd",index:5,width:"200px"}],legend:t})},Ve(c,d),c.legend={top:"18px",data:["读取","写入","读写次数","读写延迟"]},c.series=[{name:"读取",...De.series,itemStyle:{color:"rgb(255, 70, 131)"},data:s},{name:"写入",...De.series,itemStyle:{color:"rgba(46, 165, 186, .7)"},data:i},{name:"读写次数",...De.series,itemStyle:{color:"rgba(30, 144, 255)"},data:o},{name:"读写延迟",...De.series,itemStyle:{color:"rgba(255, 140, 0)"},data:n}],c})(e),network:e=>(({unit:e,startTime:t,endTime:l,yData:s,zData:i,echartsId:n})=>{var o=a(_e({startTime:t,endTime:l}));return o.tooltip.formatter=function(t){var a=t[0].data[0];Y(a/1e3);for(var l="",s=0;s<t.length;s++){var i=t[s];l+='\n\t\t\t\t<div class="select-data">\n\t\t\t\t\t<span class="status" style="background-color: '.concat(i.color,'"></span>\n\t\t\t\t\t<span>').concat(i.seriesName,"：").concat(J(i.data[1])?i.data[1].toFixed(3):0," ").concat(e,"</span>\n\t\t\t\t</div>")}return Ie({width:"280px",time:t[0].axisValueLabel,legend:l})},Ve(o,n),o.legend={top:"18px",data:["上行","下行"]},o.series=[{name:"上行",...De.series,itemStyle:{color:"rgb(255, 70, 131)"},data:s},{name:"下行",...De.series,itemStyle:{color:"rgba(46, 165, 186, .7)"},data:i}],o})(e),load:e=>(({startTime:e,endTime:t,yData:l,zData:s,aData:i,bData:n,topData:o,echartsId:r})=>{var d=a(_e({startTime:e,endTime:t})),c=(t-e)/3*1e3;return d.tooltip.formatter=function(e){for(var t="",a="",l=0;l<e.length;l++){var s=e[l];switch(s.seriesName){case"1分钟":case"5分钟":case"15分钟":t+='\n\t\t\t\t\t\t<div class="select-data">\n\t\t\t\t\t\t\t<span class="status" style="background-color: '.concat(s.color,'"></span>\n\t\t\t\t\t\t\t<span>').concat(s.seriesName,"：").concat(J(s.data[1])?s.data[1].toFixed(2):0,"</span>\n\t\t\t\t\t\t</div>");break;case"资源使用率":a=J(s.data[1])?s.data[1].toFixed(2):"0"}}return Ie({time:e[0].axisValueLabel,data:o[e[0].axisValue],width:"50rem",legend:'\n\t\t\t\t<div class="select-data">\n\t\t\t\t\t<span class="status"></span>\n\t\t\t\t\t<span>资源使用率：'.concat(a,'%</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="').concat("资源使用率"===e[0].seriesName?"hide":"",'">\n\t\t\t\t\t').concat(t,"\n\t\t\t\t</div>\n\t\t\t")})},Ve(d,r),d.legend={data:["1分钟","5分钟","15分钟"],right:"16%",top:"10px"},d.axisPointer={link:{xAxisIndex:"all"},lineStyle:{color:"#aaaa",width:1}},d.grid=[{left:"5%",bottom:80,right:"55%",width:"40%",height:"auto"},{bottom:80,left:"55%",width:"40%",height:"auto"}],d.xAxis=[{type:"time",boundaryGap:["1%","0%"],minInterval:c,axisLine:De.axisLine,axisLabel:De.axisLabel},{type:"time",gridIndex:1,boundaryGap:["1%","0%"],minInterval:c,axisLine:De.axisLine,axisLabel:De.axisLabel}],d.yAxis=[{scale:!0,name:"资源使用率",min:0,max:function(e){return e.max>=100?Math.ceil(e.max):e.max>=80?100:parseInt((e.max+10).toString().slice(0,1)+"0")},splitLine:{...De.splitLine,show:!0},nameTextStyle:De.nameTextStyle,axisLine:De.axisLine},{scale:!0,name:"负载详情",gridIndex:1,splitLine:{...De.splitLine,show:!0},nameTextStyle:De.nameTextStyle,axisLine:De.axisLine}],d.dataZoom[0].xAxisIndex=[0,1],d.dataZoom[1].type="slider",d.dataZoom[1].left="5%",d.dataZoom[1].right="5%",d.dataZoom[1].xAxisIndex=[0,1],d.series=[{name:"资源使用率",...De.series,lineStyle:{itemStyle:{width:2,color:"rgb(255, 140, 0)"}},itemStyle:{color:"rgb(255, 140, 0)"},data:l},{xAxisIndex:1,yAxisIndex:1,name:"1分钟",...De.series,lineStyle:{itemStyle:{width:2,color:"rgb(30, 144, 255)"}},itemStyle:{color:"rgb(30, 144, 255)"},data:s},{xAxisIndex:1,yAxisIndex:1,name:"5分钟",...De.series,lineStyle:{itemStyle:{width:2,color:"rgb(0, 178, 45)"}},itemStyle:{color:"rgb(0, 178, 45)"},data:i},{xAxisIndex:1,yAxisIndex:1,name:"15分钟",type:"line",smooth:!0,symbol:"circle",showSymbol:!1,lineStyle:{itemStyle:{width:2,color:"rgb(147, 38, 255)"}},itemStyle:{color:"rgb(147, 38, 255)"},data:n}],d.textStyle={color:"#666",fontSize:12},d})(e)}[t](e)),Ce=(e,t)=>{const a={cpu:fe,mem:xe,disk:be,network:ge,load:we}[t];a.echartsOption=Se({...e,topData:a.topData,echartsId:a.echartsId},t)},Le=()=>Y((new Date).getTime()/1e3,"yyyy/MM/dd"),ze=e=>{const t=new Date(Le()).getTime();return Y((t-24*e*3600*1e3)/1e3,"yyyy/MM/dd")},Oe=async(e,t,a)=>{const{b:l,e:s}=(e=>{let t=0,a=Math.floor((new Date).getTime()/1e3);return 0==e?t=new Date(Le()+" 00:00:00").getTime()/1e3:1==e?(t=new Date(ze(e)+" 00:00:00").getTime()/1e3,a=new Date(ze(e)+" 23:59:59").getTime()/1e3):t=new Date(ze(e-1)+" 00:00:00").getTime()/1e3,t=Math.floor(t),a=Math.floor(a),{b:t,e:a}})(e),i={cpu:fe,mem:xe,disk:be,network:ge,load:we}[a];await t(l,s),Ce(i.echartsParams,a)},Be=(e,t)=>{const a=t.split(" ")[0].split("/");parseInt(a[0],10),parseInt(a[1],10);const l=new Date,s=e.split(" "),i=s[0].split("/"),n=s[1].split(":"),o=parseInt(i[0],10),r=parseInt(i[1],10),d=parseInt(n[0],10),c=parseInt(n[1],10);let u=l.getFullYear();const m=l.getMonth()+1,p=l.getDate();(o>m||o===m&&r>p)&&(u-=1);return new Date(u,o-1,r,d,c).getTime()},Me=e=>{if(void 0!==e&&e.length>0){let t;for(let a=0;a<e.length;a++)"number"!=typeof e[a].addtime&&(t=Be(e[a].addtime,e[e.length-1].addtime),e[a].addtime=t)}},Re=(e,t)=>Te(e).slice(0,5)!==Te(t).slice(0,5),Pe=async(e,t,a,l)=>{try{let i=[];if(l||await(async(e,t)=>{await F({request:ne({start:e,end:t}),data:[Array,ke]})})(e,t),i=ke.value,0===i.length)return void("CPU"===a?fe.echartsParams={startTime:0,endTime:0,yData:[]}:xe.echartsParams={startTime:0,endTime:0,zData:[]});if(Me(i),Re(i[i.length-1].addtime/1e3,e),"CPU"===a){let e=[];if(i.length>0){for(var s=0;s<i.length;s++){let t=i[s];e.push([t.addtime,t.pro]),void 0===fe.topData&&(fe.topData={}),fe.topData[t.addtime]=t.cpu_top}let t=i[0].addtime,a=i[i.length-1].addtime;fe.echartsParams={startTime:t,endTime:a,yData:e}}}else{let e=[];if(i.length>0){for(s=0;s<i.length;s++){let t=i[s];e.push([t.addtime,t.mem]),void 0===xe.topData&&(xe.topData={}),xe.topData[t.addtime]=t.memory_top.map(e=>(J(e[0])&&(e[0]=H(e[0])),e))}let t=i[0].addtime,a=i[i.length-1].addtime;xe.echartsParams={startTime:t,endTime:a,zData:e}}}}catch(i){}},Ee=async()=>{try{await G({type:"calc",title:"清空记录",width:"35rem",content:"您真的要清空所有监控记录吗？"}),F({request:ae({type:"del"}),message:!0,success:()=>{window.location.reload()}})}catch(e){}},qe=async(e,t,a)=>{const l=async(t,a)=>{const l={cpu:fe,mem:xe,disk:be,network:ge,load:we}[a];l.day=e,Array.isArray(e)?(await t(e[0],e[1]),Ce(l.echartsParams,a)):await Oe(l.day,t,a)};await W([[Z("cpu"),async()=>await l((e,t)=>Pe(e,t,"CPU",a),"cpu")],[Z("mem"),async()=>await l((e,t)=>Pe(e,t,"内存",a),"mem")],[Z("disk"),async()=>await l(Ne,"disk")],[Z("network"),async()=>await l(Ue,"network")],[Z("load"),async()=>await l(Fe,"load")]])(t)},Ne=async(e,t)=>{await F({request:le({start:e,end:t}),data:Array,success:t=>{if(0===t.length)return void(be.echartsParams={unit:de.value,startTime:0,endTime:0,rData:[],wData:[],zData:[],yData:[]});Me(t),Re(t[t.length-1].addtime/1e3,e);let a=[],l=[],s=[],i=[],n=1,o=de.value;switch(o){case"MB/s":n=1024;break;case"GB/s":n=1048576;break;default:n=1}if(null==t||t.forEach(e=>{let t=(e.read_bytes/1024).toFixed(3),o=(e.write_bytes/1024).toFixed(3);a.push([e.addtime,t/n]),l.push([e.addtime,o/n]),i.push([e.addtime,e.read_count+e.write_count]),s.push([e.addtime,e.read_time+e.write_time]),void 0===be.topData&&(be.topData={}),be.topData[e.addtime]=e.disk_top}),t.length>0){let e=t[0].addtime/1e3,n=t[t.length-1].addtime/1e3;be.echartsParams={unit:o,startTime:e,endTime:n,rData:a,wData:l,zData:s,yData:i}}}})},Ue=async(e,t)=>{await F({request:se({start:e,end:t}),data:Array,success:t=>{if(0===t.length)return void(ge.echartsParams={unit:ce.value,startTime:0,endTime:0,yData:[],zData:[]});1===ge.selectList.length&&Object.keys(t[0].down_packets).forEach(e=>{ge.selectList.push({title:e,value:e})}),Me(t),Re(t[t.length-1].addtime/1e3,e);let a=[],l=[],s=1,i=ce.value,n=ue.value||"";switch("all"===n&&(n=""),i){case"MB/s":s=1024;break;case"GB/s":s=1048576;break;default:s=1}if(null==t||t.forEach(e=>{"object"==typeof e.down_packets&&(void 0!==n&&""!=n?"object"==typeof e.down_packets?l.push([e.addtime,e.down_packets[n]/s]):l.push([e.addtime,0]):l.push([e.addtime,e.down/s]),void 0!==n&&""!=n?"object"==typeof e.up_packets?a.push([e.addtime,e.up_packets[n]/s]):a.push([e.addtime,0]):a.push([e.addtime,e.up/s]),e.up,e.down)}),t.length>0){let e=t[0].addtime/1e3,s=t[t.length-1].addtime/1e3;ge.echartsParams={unit:i,startTime:e,endTime:s,yData:a,zData:l}}}})},Fe=async(e,t)=>{await F({request:ie({start:e,end:t}),data:Array,success:t=>{if(0===t.length)return void(we.echartsParams={startTime:0,endTime:0,yData:[],zData:[],aData:[],bData:[]});Me(t),Re(t[t.length-1].addtime/1e3,e);let a=[],l=[],s=[],i=[];if(void 0!==t&&(null==t||t.forEach(e=>{i.push([e.addtime,e.one]),s.push([e.addtime,e.pro]),a.push([e.addtime,e.five]),l.push([e.addtime,e.fifteen]),void 0===we.topData&&(we.topData={}),we.topData[e.addtime]=e.cpu_top}),t.length>0)){let e=t[0].addtime/1e3,n=t[t.length-1].addtime/1e3;we.echartsParams={startTime:e,endTime:n,yData:s,zData:i,aData:a,bData:l}}}})},Ge=e=>{ue.value="all"===e?"":e,Oe(ge.day,Ue,"network")},je=async e=>{try{e&&"cpu"!==e||await qe(fe.day,"cpu");const t=[{condition:!e||"load"===e,day:we.day,key:"load"},{condition:!e||"mem"===e,day:xe.day,key:"mem",notRequest:!e},{condition:!e||"network"===e,day:ge.day,key:"network"},{condition:!e||"disk"===e,day:be.day,key:"disk"}].filter(e=>e.condition).map(e=>qe(e.day,e.key,null==e?void 0:e.notRequest));await Promise.allSettled(t)}catch(t){}},We={class:"flex items-center"},Ze={class:"whitespace-nowrap"},Ye=Q(l({__name:"card-title",props:{type:{default:"network"},title:{default:"网络IO"},active:{type:Boolean,default:!1},selectList:{}},emits:["cut-day-click"],setup(t,{emit:a}){const l=a,g=e(ue.value||"all"),w=e(),k=()=>{var e;null==(e=w.value)||e.focus(),l("cut-day-click"),h(()=>{document.querySelectorAll(".custom-day-picker").forEach(e=>{e.style.display="none"})})};return(e,a)=>{const l=b,h=f;return s(),i("div",We,[n("span",Ze,o(t.title),1),r(c(h,{onClick:k,modelValue:y(g),"onUpdate:modelValue":a[0]||(a[0]=e=>v(g)?g.value=e:null),teleported:!1,ref_key:"selectRef",ref:w,style:{width:"8rem"},size:"small",class:"2xl:w-[10rem] <2xl:w-[6rem] lt-lg:w-[10rem] text-left",onChange:a[1]||(a[1]=e=>y(Ge)(y(g))),placeholder:"请选择"},{default:u(()=>[(s(!0),i(m,null,p(t.selectList,e=>(s(),x(l,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),[[d,t.active]])])}}}),[["__scopeId","data-v-ce2a758b"]]),Je={class:"time-control flex relative"},He=Q(l({__name:"card-day",props:{type:{default:"network"}},emits:["cut-day-click"],setup(t,{emit:l}){const n=l,r=e(""),d=e(1),h=e(),f=e([]),b=a({disabledDate:e=>{const t=new Date;t.setHours(23,59,59,999);const a=t.getTime(),l=new Date(t.getTime()-24*me.value*3600*1e3);return e.getTime()<l.getTime()||e.getTime()>a},defaultTime:[new Date,new Date]}),T=e=>{if(!e){document.querySelectorAll(".custom-day-picker").forEach(e=>{e.style.display="none"})}};return(e,a)=>{const l=D,A=g,_=w;return s(),i("div",Je,[c(A,{class:"control-btn"},{default:u(()=>{return[(s(!0),i(m,null,p((e=t.type,[{content:"昨天",active:!1,event:()=>{d.value=0,qe(1,e)}},{content:"今天",active:!0,event:()=>{d.value=1,qe(0,e)}},{content:"最近七天",active:!1,event:()=>{d.value=2,r.value="最近七天",qe(7,e)}},{content:"自定义时间",active:!1,event:()=>{d.value=3,h.value.focus(),n("cut-day-click");const e=document.querySelectorAll(".custom-day-picker"),t=[];e.forEach(e=>{t.push(e.style.zIndex)});const a=t.reduce((e,t,a,l)=>t>l[e]?a:e,0);e.forEach((e,t)=>{t!==a&&(e.style.display="none")})}}]),(e,t)=>(s(),x(l,{key:t,type:y(d)===t?"primary":"",onClick:e.event},{default:u(()=>[k(o(e.content),1)]),_:2},1032,["type","onClick"]))),128))];var e}),_:1}),c(_,{type:"daterange",modelValue:y(f),"onUpdate:modelValue":a[0]||(a[0]=e=>v(f)?f.value=e:null),"range-separator":"","start-placeholder":"开始日期","end-placeholder":"结束日期",teleported:!1,"show-after":100,ref_key:"player",ref:h,class:"!absolute -z-1 !w-[92px] !h-[30px] right-0","popper-class":"custom-day-picker","default-time":y(b).defaultTime,"disabled-date":y(b).disabledDate,format:"YYYY/MM/DD","value-format":"x",onChange:a[1]||(a[1]=e=>{return a=y(f),l=t.type,r.value="自定义时间",a[0]=new Date(a[0]).setHours(0,0,0,0),a[1]=new Date(a[1]).setHours(23,59,59,0),a=[Math.floor(a[0]/1e3),Math.floor(a[1]/1e3)],void qe(a,l);var a,l}),onVisibleChange:T},null,8,["modelValue","default-time","disabled-date"])])}}}),[["__scopeId","data-v-d5b4d512"]]),Qe=()=>{pe.value=!0},Ke=async()=>{await K({isAsync:!0,title:"网络IO总流量统计",area:[70,50],component:()=>X(()=>import("./network-day-dialog.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},Xe=e=>{document.fullscreenElement?h(async()=>{await Ke(),document.querySelector(".el-overlay")&&e.$el.appendChild(document.querySelector(".el-overlay"))}):Ke()},$e=e([{label:"时间",prop:"time"},{label:"上行",prop:"total_up",render:e=>H(e.total_up)},{label:"下行",prop:"total_down",render:e=>H(e.total_down)}]),et=e(!1),tt=new $,at=e(30),lt=e([]),st=T(e=>{const t=Number(e);!Number.isInteger(t)||t<=0?at.value=1:(at.value=t,it(e))},500),it=async e=>{tt.removePending({method:"post",url:"/ajax?action=GetNetWorkIoByDay"}),F({request:oe({day:e}),data:[Array,lt],loading:et})},nt={class:"module-ui-header"},ot={class:"flex items-center"},rt={key:0,class:"flex items-center"},dt={class:"flex items-center ml-[1rem]"},ct={class:"module-ui-body"},ut={key:0,class:"show"},mt=l({__name:"index",props:{title:{default:"默认"},active:{type:Boolean,default:!1},compData:{default:()=>{}},controlValue:{type:Boolean,default:!1},type:{default:""},unitVisible:{type:Boolean,default:!1}},emits:["accept-echarts-id","reset"],setup(t,{expose:a,emit:l}){var o,p;const v=l,f=null!=(p=null==(o=null==crypto?void 0:crypto.randomUUID)?void 0:o.call(crypto))?p:Math.random().toString(36).slice(2),b=t,g=A(()=>Object.keys(b.compData).includes("series")&&void 0===b.compData.series[0].data),w=e(),T=e(),R=e(!1),P=e(),E=e("34rem"),{BtECharts:q,getEChart:N,setOption:U,setQuickOption:F}=ee({options:{xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{boundaryGap:[0,"50%"],type:"value"},tooltip:{extraCssText:"background-color: transparent!important;"},series:[{name:"成交",type:"line",smooth:!0,symbol:"none",stack:"a",data:[]}]}}),G=async e=>{var t;U(e),T.value=await N(),null==(t=T.value)||t.resize()},j=e(!1);let W={x:0,y:0};const Z=e(!1),Y=e(!1),J=e=>{if(!Z.value)return;const t=T.value.getDom().querySelector(".echarts-tooltip");t&&t.contains(e.target)||(ie(),document.removeEventListener("click",J))},H=e=>{Y.value||W&&(Z.value?ie():(T.value.setOption({backgroundColor:"transparent",tooltip:{alwaysShowContent:!0,extraCssText:"background-color: transparent!important;"}}),Z.value=!0,document.removeEventListener("click",J),setTimeout(()=>{document.addEventListener("click",J)},100)))},Q=e=>{var t;const a=e.areas&&e.areas[0];if(!a)return;const l=a.coordRange||a.range;if(!l||l.length<2)return;const s=a.coordRange?a.coordRange[0]:T.value.convertFromPixel({xAxisIndex:0},l[0]),i=a.coordRange?a.coordRange[1]:T.value.convertFromPixel({xAxisIndex:0},l[1]);setTimeout(()=>{var e;null==(e=T.value)||e.dispatchAction({type:"brush",areas:[]}),T.value.resize()},50),null==(t=T.value)||t.dispatchAction({type:"dataZoom",xAxisIndex:[0,1],startValue:s,endValue:i}),v("reset",f)},K=()=>{T.value&&(setTimeout(()=>{var e;null==(e=T.value)||e.dispatchAction({type:"takeGlobalCursor",key:"brush",brushOption:{brushType:"lineX",brushMode:"single"}}),T.value.resize(),j.value=!0},500),T.value.off("brushEnd",Q),T.value.on("brushEnd",Q),T.value.getZr().off("click"),T.value.getZr().on("click",H),T.value.off("legendselectchanged"),T.value.on("legendselectchanged",()=>{Y.value=!0,Promise.resolve().then(()=>{Y.value=!1})}))};_(R,e=>{e?E.value=X():(E.value="34rem",h(()=>{var e;null==(e=T.value)||e.resize()}))});const X=()=>{let e=34;if(R.value){e=(window.screen.height-60)/10}return"".concat(e,"rem")},$=()=>{var e;R.value=!1,null==document||document.exitFullscreen(),w.value.removeAttribute("style"),null==(e=T.value)||e.resize()},te=()=>{R.value=!0,P.value.hide(),h(()=>{w.value.requestFullscreen&&(w.value.style.backgroundColor="var(--el-fill-color-lighter)",w.value.requestFullscreen())})},ae=()=>{let e=!!document.fullscreenElement;return null==e&&(e=!1),e},le=()=>{ae()&&h(async()=>{document.querySelector(".el-select-dropdown.el-popper")&&h(()=>{w.value.$el.appendChild(document.querySelector(".el-select-dropdown.el-popper"))})})},se=(e,t)=>{try{h(()=>{G(e),K()}),((e,t)=>{switch(t){case"cpu":fe.echartsId=e;break;case"mem":xe.echartsId=e;break;case"disk":be.echartsId=e;break;case"network":ge.echartsId=e;break;case"load":we.echartsId=e}})(T.value.id,t)}catch(a){}};_(()=>[b.compData,T.value],()=>{var e;try{G(b.compData),T.value&&(null==(e=T.value)||e.resize(),j.value=!1,h(()=>{K()}))}catch(t){}});const ie=async e=>{if(e&&f===e)return;Z.value=!1;const t=await N();t.clear(),t.setOption({backgroundColor:"transparent",tooltip:{extraCssText:"background-color: transparent!important;"}}),G(b.compData),h(()=>{K()})};return V(()=>{se(b.compData,b.type),window.addEventListener("fullscreenchange",()=>{ae()||(R.value=!1,document.fullscreenElement&&document.exitFullscreen().catch(console.error))},{passive:!0})}),I(()=>{var e,t,a,l,s,i;T.value&&(T.value.off("brushEnd"),null==(t=null==(e=T.value)?void 0:e.getZr())||t.off("dblclick"),null==(l=null==(a=T.value)?void 0:a.getZr())||l.off("mousedown"),null==(i=null==(s=T.value)?void 0:s.getZr())||i.off("mouseup"))}),a({setConfig:U,echartRef:T,closeTooltip:ie,selfId:f}),(e,a)=>{const l=B,o=D,p=M,v=S("bt-loading");return s(),i("div",{class:"module-ui",ref_key:"chartModulesRef",ref:w},[n("div",nt,[n("div",ot,[c(Ye,C({type:t.type,title:b.title,active:b.active},e.$attrs,{onCutDayClick:le}),null,16,["type","title","active"]),c(l,{ref_key:"tooltipFull",ref:P,effect:"dark",content:"全屏展示",placement:"top",trigger:"hover"},{default:u(()=>[y(R)||y(g)?L("",!0):(s(),i("i",{key:0,class:"full-icon svgtofont-el-fullscreen-expand hover:text-primary",onClick:te}))]),_:1},512)]),y(g)?L("",!0):(s(),i("div",rt,["网络IO："===b.title?(s(),x(o,{key:0,class:"<2xl:hidden 2xl:inline-block",type:"default",onClick:a[0]||(a[0]=e=>y(Xe)(y(w)))},{default:u(()=>[...a[4]||(a[4]=[k("统计 ",-1)])]),_:1})):L("",!0),"网络IO："===b.title?(s(),x(l,{key:1,effect:"dark",content:"网络IO统计",placement:"top-start"},{default:u(()=>[n("i",{onClick:a[1]||(a[1]=e=>y(Xe)(y(w))),class:"cursor-pointer svgtofont-left-control hover:text-primary <2xl:inline-block 2xl:hidden",title:"网络IO统计"})]),_:1})):L("",!0),n("div",dt,[c(l,{effect:"dark",content:"点击刷新数据",placement:"top-start"},{default:u(()=>[c(o,{type:"default",onClick:a[2]||(a[2]=e=>y(je)(b.type)),class:"<2xl:hidden 2xl:inline-block"},{default:u(()=>[...a[5]||(a[5]=[n("i",{class:"svgtofont-el-refresh text-medium"},null,-1)])]),_:1})]),_:1}),c(He,{class:"ml-[1rem]",type:t.type,onCutDayClick:le},null,8,["type"]),y(R)?(s(),i("i",{key:0,title:"退出全屏",class:"mt-2px text-large svgtofont-el-close cursor-pointer ml-[.5rem] hover:text-primary",onClick:$})):L("",!0)])]))]),n("div",ct,[y(g)?(s(),i(m,{key:0},[b.controlValue||void 0!==b.compData.series[0].data?(s(),x(p,{key:1,class:"w-[100%]",description:"我们正在努力为您收集数据，请耐心等待1-2分钟后再尝试查看。"})):(s(),x(p,{key:0,class:"w-[100%]",description:"未开启监控，暂无数据"},{default:u(()=>[n("span",{class:"bt-link",onClick:a[3]||(a[3]=(...e)=>y(Qe)&&y(Qe)(...e))},"点击开启监控 ")]),_:1}))],64)):L("",!0),r((s(),i("div",{style:z([{height:y(E)},{position:"relative"}]),class:"percentage w-full"},[c(y(q),{class:"!h-full"}),b.unitVisible?(s(),i("div",ut,[...a[6]||(a[6]=[O(' 单位： <div class="bt-crontab-select-button"><div class="bt-select-full only-one disk-unit"><div class="select-picker-search"><span class="picker-text-list">KB/s</span><span class="down-select-full"></span></div><div class="select-list-item" style="display:none;"><ul style="width:auto;max-height:auto;" class="active"><li data-attr="KB/s" class="active"><span class="select-name-full active">KB/s</span></li><li data-attr="MB/s"><span class="select-name-full">MB/s</span></li><li data-attr="GB/s" style="display:none;"><span class="select-name-full">GB/s</span></li></ul></div></div></div>',2)])])):L("",!0)],4)),[[d,!y(g)],[v,"{}"===JSON.stringify(b.compData)]])])],512)}}}),pt={class:"w-full flex justify-start items-center top_all text-small"},yt={class:"monitor"},vt={class:"flex items-center flex-row ml-8px"},ht={class:"mr-[3.125rem]"},ft=l({__name:"index",setup(e){const t=R("loadRef"),a=R("cpuRef"),l=R("memRef"),r=R("diskRef"),d=R("networkRef"),m=e=>{var s,i,n,o,c;null==(s=t.value)||s.closeTooltip(e),null==(i=a.value)||i.closeTooltip(e),null==(n=l.value)||n.closeTooltip(e),null==(o=r.value)||o.closeTooltip(e),null==(c=d.value)||c.closeTooltip(e)};return V(async()=>{await(async()=>{F({request:ae({type:"-1"}),data:{status:[Boolean,pe],day:[Number,e=>(ye.value=e,me.value=e)],size:[Number,ve]}})})(),je()}),(e,p)=>{const h=P,f=te,x=D,b=N,g=E,w=q;return s(),i("section",null,[c(w,{span:24,class:"module-ui !rounded-medium !px-[1.6rem] !py-[1.2rem]"},{default:u(()=>[c(g,{span:24,class:"flex"},{default:u(()=>[n("div",pt,[n("div",yt,[p[10]||(p[10]=n("span",{class:"mr-8px align-middle"},"开启监控",-1)),c(h,{modelValue:y(pe),"onUpdate:modelValue":p[0]||(p[0]=e=>v(pe)?pe.value=e:null),checked:"",onChange:p[1]||(p[1]=e=>y(Ae)(!0))},null,8,["modelValue"])]),n("div",vt,[p[12]||(p[12]=n("span",{class:"whitespace-nowrap"},"保存天数：",-1)),c(f,{width:"8.4rem",type:"number",modelValue:y(ye),"onUpdate:modelValue":p[2]||(p[2]=e=>v(ye)?ye.value=e:null)},null,8,["modelValue"]),c(x,{class:"ml-8px",onClick:p[3]||(p[3]=e=>y(Ae)()),type:""},{default:u(()=>[...p[11]||(p[11]=[k("更改",-1)])]),_:1})]),c(b,{style:{margin:"0 2rem",height:"2rem"}}),n("span",ht,"监控日志大小："+o(y(H)(y(ve))),1),c(x,{onClick:p[4]||(p[4]=e=>y(Ee)())},{default:u(()=>[...p[13]||(p[13]=[k("清空记录",-1)])]),_:1})])]),_:1})]),_:1}),c(w,{class:"mt-[1.2rem]"},{default:u(()=>[c(g,{span:24},{default:u(()=>[c(mt,{ref_key:"loadRef",ref:t,controlValue:y(pe),"onUpdate:controlValue":p[5]||(p[5]=e=>v(pe)?pe.value=e:null),title:y(we).title,active:y(we).active,compData:y(we).echartsOption,unitVisible:y(we).unitVisible,type:"load",onReset:m},null,8,["controlValue","title","active","compData","unitVisible"])]),_:1})]),_:1}),c(w,{class:"mt-[1.2rem]",gutter:24,span:24},{default:u(()=>[c(g,{md:12,sm:24,span:12,xs:24},{default:u(()=>[c(mt,{ref_key:"cpuRef",ref:a,controlValue:y(pe),"onUpdate:controlValue":p[6]||(p[6]=e=>v(pe)?pe.value=e:null),title:y(fe).title,active:y(fe).active,compData:y(fe).echartsOption,unitVisible:y(fe).unitVisible,type:"cpu",onReset:m},null,8,["controlValue","title","active","compData","unitVisible"])]),_:1}),c(g,{md:12,sm:24,span:12,xs:24},{default:u(()=>[c(mt,{ref_key:"memRef",ref:l,controlValue:y(pe),"onUpdate:controlValue":p[7]||(p[7]=e=>v(pe)?pe.value=e:null),title:y(xe).title,active:y(xe).active,compData:y(xe).echartsOption,unitVisible:y(xe).unitVisible,type:"mem",onReset:m},null,8,["controlValue","title","active","compData","unitVisible"])]),_:1})]),_:1}),c(w,{class:"mt-[1.2rem]",gutter:24,span:24},{default:u(()=>[c(g,{md:24,sm:24,lg:12,span:12,xs:24},{default:u(()=>[c(mt,{ref_key:"diskRef",ref:r,controlValue:y(pe),"onUpdate:controlValue":p[8]||(p[8]=e=>v(pe)?pe.value=e:null),title:y(be).title,active:y(be).active,compData:y(be).echartsOption,unitVisible:y(be).unitVisible,type:"disk",onReset:m},null,8,["controlValue","title","active","compData","unitVisible"])]),_:1}),c(g,{md:24,lg:12,sm:24,span:12,xs:24},{default:u(()=>[c(mt,{ref_key:"networkRef",ref:d,controlValue:y(pe),"onUpdate:controlValue":p[9]||(p[9]=e=>v(pe)?pe.value=e:null),title:y(ge).title,active:y(ge).active,compData:y(ge).echartsOption,unitVisible:y(ge).unitVisible,selectList:y(ge).selectList,type:"network",onReset:m},null,8,["controlValue","title","active","compData","unitVisible","selectList"])]),_:1})]),_:1})])}}}),xt=Object.freeze(Object.defineProperty({__proto__:null,default:ft},Symbol.toStringTag,{value:"Module"}));export{lt as a,st as c,at as d,it as g,xt as i,et as l,$e as t};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
