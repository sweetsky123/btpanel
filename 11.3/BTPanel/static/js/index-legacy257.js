System.register(["./index-legacy124.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./validator-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./column-legacy.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy107.js?v=1763689792"],function(e,t){"use strict";var n,s,i,a,r,c,l,o,d,m,u,g,b,f,p,y,v,_,k,x,L,w,j,O,h,S;return{setters:[function(e){n=e._},function(e){s=e.o,i=e.c,a=e.v,r=e.aG,c=e.x,l=e.y,o=e.z,d=e.F,m=e.A,u=e.O,g=e.B,b=e.e,f=e.C,p=e.D,y=e.b1,v=e.b6,_=e.H,k=e.L,x=e.G,L=e.aT},function(e){w=e.M,j=e.ay,O=e.u,h=e.f,S=e._},null,null,null,null,null],execute:function(){var t={title:"容器安全一键检测-功能介绍",ps:"检测敏感信息、后门、漏洞、可疑操作等常见风险。",source:151,desc:["异常历史命令","敏感信息泄露","后门排查","容器逃逸"],tabImgs:[{title:"容器检测",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/docker/dockerContainerScan.png"}]},T=[{color:"#ff0000",percentage:20},{color:"#ff0000",percentage:40},{color:"#fc6d26",percentage:60},{color:"#fc6d26",percentage:80},{color:"var(--el-color-primary)",percentage:100}],H=s({title:"立即进行镜像检测,确保您的项目安全。",isFirst:!0,isScan:!1,isEnd:!1,iconType:"normal",detect:0,imageList:[],msg:"",btnObj:{text:"一键检测",type:"primary",disabled:!1},score:100,scanTime:0}),M=[],B=0,J=null,N=function(e){return e+"分"},C=function(e){H.imageList[e].active=!H.imageList[e].active},F=null,E=function(){var e;null===(e=F)||void 0===e||e.close(),F=j({route:"/ws_model",onMessage:I})},I=function(e,t){var n=JSON.parse(t.data);if(n.hasOwnProperty("image_list"))return H.imageList=n.image_list.map(function(e){return e.active=!1,e}),void(M=JSON.parse(JSON.stringify(n.image_list)));if(n.hasOwnProperty("end")){H.msg=n.msg,H.score=H.score-n.score;var s,i=H.imageList[B-1];1!=n.status&&(H.detect++,null==i.riskList&&(i.riskList=[]),null===(s=i.riskList)||void 0===s||s.push(n)),n.end&&B>0&&(void 0===i.riskList&&(i.noWarring=!0),P())}},W=function(){if(B=0,H.scanTime=0,H.detect=0,H.score=100,J=setInterval(function(){H.scanTime++},1e3),H.isFirst){if(0==H.imageList.length)return w.error("请先添加镜像");H.isScan||E(),P(),H.isScan=!0,H.isFirst=!1,G("scan")}else{var e;H.isScan?(null===(e=F)||void 0===e||e.close(),z()):(H.imageList=JSON.parse(JSON.stringify(M)),P(),H.isScan=!0,G("scan"))}},P=function(){var e;B<H.imageList.length?(null===(e=F)||void 0===e||e.send({model_index:"btdocker",mod_name:"security",def_name:"image_safe_scan",image_id:H.imageList[B].id,ws_callback:"123"}),B++):(H.isScan=!1,H.isEnd=!0,H.imageList=H.imageList.sort(function(e,t){return e.noWarring?1:t.noWarring?-1:0}),clearInterval(J),G("end"))},G=function(e){switch(e){case"scan":H.title="正在检测镜像，请稍候...",H.isEnd=!1,H.btnObj.text="取消检测",H.btnObj.type="default";break;case"restart":H.title="立即进行镜像检测,确保您的项目安全。",H.btnObj.text="重新检测",H.btnObj.type="primary";break;case"end":var t="";t=0==H.detect?"未发现安全漏洞":'一共发现<span class="text-warning">'.concat(H.detect,"</span>项风险"),H.title="检测完成,"+t,H.msg="检测完成，共耗时"+H.scanTime+"秒",H.btnObj.text="重新检测",H.btnObj.type="primary"}},z=function(){H.title="立即进行镜像检测,确保您的项目安全。",H.msg="",H.isFirst=!0,H.isScan=!1,H.isEnd=!1,H.iconType="normal",H.detect=0,H.imageList=JSON.parse(JSON.stringify(M)),H.btnObj.text="一键检测",H.btnObj.type="primary",H.btnObj.disabled=!1,H.score=100},A=function(){var e;E(),null===(e=F)||void 0===e||e.send({model_index:"btdocker",mod_name:"security",def_name:"get_image_list",ws_callback:"123"})},D={class:"p-2rem"},q={class:"scanHead flex justify-between mb-2rem"},K={class:"scanHead__left flex"},Q={class:"w-[8rem] h-[8rem]"},R={class:"pt-[2rem] pl-2rem w-[40rem]"},U=["innerHTML"],V={class:"text-secondary mt-1rem"},X={class:"scanHead__right pt-[2.6rem]"},Y={class:"scanBody h-[50rem] overflow-auto"},Z=["onClick"],$={class:"text-base font-bold leading-[3.5rem]"},ee={key:0,class:"flex"},te={key:0,class:"text-danger"},ne={key:1},se={key:2,class:"text-primary"},ie={class:"scanBody__content mb-[2rem] mx-[2rem]"},ae={class:"scanBody__content__title border-b border-light pb-[.4rem] mb-[.4rem]"},re={class:"scanBody__content__desc flex border-b border-light pb-[.4rem] mb-[.4rem]"},ce=["innerHTML"],le={class:"scanBody__content__repair flex"},oe=["innerHTML"],de=i({__name:"index",setup:function(e){var s=O().payment;return a(function(){A()}),r(function(){z(),clearInterval(J)}),function(e,i){var a=h,r=v,w=_,j=L,O=n;return c(),l("section",D,["ltd"===o(s).authType?(c(),l(d,{key:0},[m("div",q,[m("div",K,[m("div",Q,[o(H).isFirst&&!o(H).isScan?(c(),u(a,{key:0,class:"w-full",src:"/firewall/icon-safe-detect.svg"})):(c(),u(r,{key:1,type:"circle",percentage:o(H).score,format:o(N),color:o(T),width:80},null,8,["percentage","format","color"]))]),m("div",R,[m("div",{class:"text-large font-bold",innerHTML:o(H).title},null,8,U),m("div",V,g(o(H).msg.length>35?o(H).msg.substring(0,35)+"...":o(H).msg),1)])]),m("div",X,[b(w,{type:o(H).btnObj.type,disabled:o(H).btnObj.disabled,onClick:o(W)},{default:f(function(){return[p(g(o(H).btnObj.text),1)]}),_:1},8,["type","disabled","onClick"])])]),m("div",Y,[(c(!0),l(d,null,y(o(H).imageList,function(e,t){return c(),l("div",{key:t,class:k(["bg-extraLight mb-1rem",e.active?"active":""])},[m("div",{class:"scanBody__title flex justify-between cursor-pointer rounded-base px-[2rem] h-[3.5rem] leading-[3.5rem] text-base",onClick:function(e){return o(C)(t)}},[b(j,{class:"item",effect:"dark",content:e.name,placement:"top-start"},{default:f(function(){return[m("span",$,g(e.name.length>50?e.name.substring(0,50)+"...":e.name),1)]}),_:2},1032,["content"]),o(H).isEnd||o(H).isScan?(c(),l("div",ee,[e.riskList&&e.riskList.length>0?(c(),l("span",te,"发现"+g(e.riskList.length)+"项风险",1)):e.noWarring||e.riskList?(c(),l("span",se,"无风险项")):(c(),l("span",ne,"检测中")),b(a,{src:"/firewall/arrow-down.svg",class:"w-[1.6rem] ml-2rem"})])):x("",!0)],8,Z),m("div",ie,[(c(!0),l(d,null,y(e.riskList,function(e,t){return c(),l("div",{key:t,class:"bg-[rgba(var(--el-color-danger),0.1)] text-secondary py-1rem px-[1.5rem] mb-[0.8rem] rounded-base"},[m("div",ae,g(e.msg),1),m("div",re,[i[0]||(i[0]=m("span",{class:"w-[6rem] flex-shrink-0 inline-block"},"详情：",-1)),m("span",{innerHTML:e.detail},null,8,ce)]),m("div",le,[i[1]||(i[1]=m("span",{class:"w-[6rem] flex-shrink-0 inline-block"},"修复方案：",-1)),m("span",{innerHTML:e.repair},null,8,oe)])])}),128))])],2)}),128))])],64)):(c(),u(O,{key:1,data:o(t)},null,8,["data"]))])}}});e("default",S(de,[["__scopeId","data-v-31823ec1"]]))}}});
