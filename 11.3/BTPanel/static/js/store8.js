import{j as e,o as t,r as a}from"./base-lib.js?v=1763689792";import{w as s}from"./store5.js?v=1763689792";const i=e("HOME-SECURITY-OVERVIEW-STORE",()=>{const e=t({score:0,scoreLevel:"",riskNum:0,subtitle:""}),i=a(0),l=a(""),u=a(""),c=t({risk_scan:{status:!1,icon:"risk",name:"风险扫描"},safe_detect:{status:!1,icon:"safeDetect",name:"安全检测"},file_detection:{status:!1,icon:"ware",name:"恶意文件检测"},vul_scan:{status:!1,icon:"web",name:"漏洞扫描"},hids:{status:!1,icon:"hids",name:"入侵检测"},tamper:{status:!1,icon:"tamper",name:"防篡改"}}),r=a(!1),o=a([{title:"待修复漏洞",type:"vul_scan",tips:"及时发现网站中存在的漏洞，及时升级版本，可避免黑客趁虚而入",value:0},{title:"待处理恶意文件",type:"file_detection",tips:"检测到可能窃取信息或破坏系统的恶意文件（如病毒、木马）",value:0},{title:"入侵检测",type:"hids",tips:"分析服务器中异常进程行为，第一时间发现潜在入侵并告警",value:0},{title:"首页风险",type:"homepage_risk",tips:"针对网站/面板/系统进行全方面检测，消除隐藏风险",value:0},{title:"基线问题",type:"safe_detect",tips:"检查服务器配置是否符合安全标准",value:0},{title:"企业防篡改",type:"tamper",tips:"实时保护网页内容是否被非法修改",value:0}]),n=t({hids:!1,tamper:!1});return{scoreData:e,safeDay:i,scanTime:l,virusUpdateTime:u,capabilitySwitch:c,risk_details:o,riskInstallDetails:n,getSafeOverviewData:async()=>{try{const{data:t}=await s(),{security_status:a,risk_details:r}=t;e.score=t.score,e.scoreLevel=t.level,e.riskNum=t.risk_count,e.subtitle=t.level_description,i.value=t.protect_days,l.value=t.risk_scan_time.slice(0,10)||"-",u.value=t.virus_update_time.slice(0,10)||"-",c.risk_scan.status=a.risk_scan,c.safe_detect.status=a.safe_detect,c.file_detection.status=a.file_detection,c.vul_scan.status=a.vul_scan,c.hids.status=a.hids,c.tamper.status=a.tamper,n.hids=a.hids_installed,n.tamper=a.tamper_installed,o.value[0].value=r.vul_scan.total||0,o.value[1].value=r.file_detection.total||0,o.value[2].value=r.hids.total||0,o.value[3].value=r.homepage_risk.total||0,o.value[4].value=r.safe_detect.total||0,o.value[5].value=r.tamper.total||0}catch(t){}},isMalwareConfirm:r}});export{i as H};
