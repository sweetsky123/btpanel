import{n as e,H as a,Q as t,W as r,P as s,l,ah as o,p as n}from"./utils-lib.js?v=1763689792";import{_ as i}from"./index109.js?v=1763689792";import{_ as p}from"./index118.js?v=1763689792";import{c as d,r as _,o as m,e as u,v as c,I as f,x as y,y as g,z as j,O as v,C as b,G as x,D as h,R as w,J as E,A as O,B as S,H as A}from"./base-lib.js?v=1763689792";import{_ as H}from"./index137.js?v=1763689792";import{P as I,Q as J}from"./firewall.js?v=1763689792";import{r as P,e as V,f as k}from"./useMethod8.js?v=1763689792";import{g as q}from"./useStore6.js?v=1763689792";import{a as C}from"./column.js?v=1763689792";import{_ as D}from"./index.vue_vue_type_script_setup_true_lang11.js?v=1763689792";import{_ as F}from"./index.vue_vue_type_script_setup_true_lang12.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./validator.js?v=1763689792";import"./index107.js?v=1763689792";import"./index.vue_vue_type_style_index_0_scoped_cdc7f4d3_lang.js?v=1763689792";const N={class:"min-h-[30rem]"},R={class:"mt-16px leading-8 text-small list-disc ml-[2rem]"},T=d({__name:"index",setup(d){const{refs:{firewallInfo:T,systemTabActive:U}}=q(),Q=_(null),z=_([]),B=_(""),G=_(0),L=_(!1),M=m({p:1,limit:20}),W=(t,r)=>{e({title:t?"修改地区规则":"添加地区规则",area:44,component:()=>a(()=>import("./add-area-rule.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),showFooter:!0,compData:{...r,isEdit:t,refreshFn:K}})},K=async(e=1)=>{"area"===U.value&&await t({loading:L,request:I({data:JSON.stringify({...M,query:B.value})}),data:{data:[Array,z],page:r(G)}})},X=[C(),{label:"地区",render:e=>u("span",null,[e.country+"("+e.brief+")"])},{label:"策略",render:(e,a)=>u("span",{class:"text-"+("accept"===e.types?"primary":"danger")},["accept"==e.types?"放行":"禁止"])},{label:"端口",render:e=>u("span",null,[e.ports?e.ports:"全部"])},{label:"时间",prop:"addtime",renderHeader:()=>P("时间","-- : 表示面板数据库中未记录创建时间，规则从系统中直接读取，忽略即可")},V({editEvent:e=>W(!0,e),deleteEvent:async e=>{await n({icon:"warning-filled",title:"删除地区规则",content:"删除选中规则后，该规则屏蔽的地区，端口将恢复正常访问，是否继续操作？"});const a={...e,s_port:e.start_port,d_port:e.ended_port,d_ip:e.ended_ip};delete a.start_port,a.ended_port,a.ended_ip,await t({loading:"正在删除规则，请稍后...",request:J({data:JSON.stringify(a)}),message:!0,success:K})}})],Y=[{label:"删除",value:"delete",event:async(e,a)=>{await k(e,a,async e=>{const a={...e,s_port:e.start_port,d_port:e.ended_port,d_ip:e.ended_ip};return delete a.start_port,a.ended_port,a.ended_ip,await J({data:JSON.stringify(a)})},{label:"地区",prop:"country"},K)}}];return c(()=>K()),(e,a)=>{const t=H,r=A,n=s,d=l,_=o,m=p,c=i,I=f("bt-loading");return y(),g("div",N,[j(T).init_status?x("",!0):(y(),v(t,{key:0,width:"38rem"},{content:b(()=>[u(F)]),_:1})),u(c,null,{"header-left":b(()=>[u(r,{type:"primary",onClick:a[0]||(a[0]=e=>W())},{default:b(()=>[...a[6]||(a[6]=[h(" 添加地区规则 ",-1)])]),_:1}),u(D,{type:"country_rule",refreshFn:K})]),"header-right":b(()=>[u(n,{class:"!w-[32rem]",modelValue:j(B),"onUpdate:modelValue":a[1]||(a[1]=e=>w(B)?B.value=e:null),onSearch:a[2]||(a[2]=e=>K()),placeholder:"请输入地区"},null,8,["modelValue"])]),content:b(()=>[E(u(d,{ref_key:"areaTableRef",ref:Q,column:X,data:j(z),description:"地区列表为空"},null,8,["data"]),[[I,j(L)],[I,"正在加载地区列表，请稍后...","title"]])]),"footer-left":b(()=>[u(_,{"table-ref":j(Q),options:Y},null,8,["table-ref"])]),"footer-right":b(()=>[u(m,{total:j(G),page:j(M).p,"onUpdate:page":a[3]||(a[3]=e=>j(M).p=e),row:j(M).limit,"onUpdate:row":a[4]||(a[4]=e=>j(M).limit=e),onChange:a[5]||(a[5]=e=>K()),name:"area"},null,8,["total","page","row"])]),_:1}),O("ul",R,[O("li",null,"每隔一个月会自动更新一次最新的IP池，最近更新时间："+S(j(T).update_time),1)])])}}});export{T as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
