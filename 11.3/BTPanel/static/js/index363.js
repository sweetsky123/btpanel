import{j as e,r as a,o as r,s,a9 as l,c as o,n as u,x as t,y as d,e as p,C as i,A as n,z as f,U as v,ad as m,ap as c,ab as _}from"./base-lib.js?v=1763689792";import{kW as w,kX as y,b,ax as V}from"./utils-lib.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";const x=e("MAIL_BCC_ADD",()=>{const e=(e,a,r)=>{if(!a)return r(new Error("邮箱不能为空"));if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(a))return r(new Error("请输入正确的邮箱格式"));r()};return{formRef:a(),form:r({user:"",forward_user:"",type:"sender",active:1}),propsData:a({}),typeOptions:[{label:"发送时抄送",value:"sender"},{label:"接收时抄送",value:"recipient"}],rules:{user:[{required:!0,validator:e,trigger:"blur"}],forward_user:[{required:!0,validator:e,trigger:"blur"}],type:[{required:!0,message:"请选择抄送类型",trigger:"change"}]}}}),{form:g,formRef:D,propsData:A}=s(x()),h=b(),j=async e=>{var a;let r;await(null==(a=D.value)?void 0:a.validate());const{isEdit:s,row:o,onRefresh:u}=A.value;r=s&&o?await w({user:o.user,type:o.type,forward_user:o.forward_user,type_new:g.value.type,forward_user_new:g.value.forward_user,active_new:g.value.active}):await y(l(g.value));const{data:t}=r;h.request(t),t.status&&(e(),u&&u())},E=e=>{const{row:a,isEdit:r}=e;A.value=e,g.value.user="",g.value.forward_user="",g.value.type="sender",g.value.active=1,r&&a&&(g.value.user=a.user,g.value.forward_user=a.forward_user,g.value.type=a.type,g.value.active=a.active)},R={class:"p-20px"},U={class:"w-300px"},k={class:"w-300px"},q={class:"w-300px"},z=o({__name:"index",props:{compData:{}},setup(e,{expose:a}){const{form:r,propsData:l,formRef:o}=s(x()),{rules:w,typeOptions:y}=x(),b=e;return u(()=>{E(b.compData)}),a({onConfirm:j}),(e,a)=>{const s=v,u=m,b=V,x=c,g=_;return t(),d("div",R,[p(g,{ref_key:"formRef",ref:o,model:f(r),rules:f(w)},{default:i(()=>[p(u,{label:"被抄送者",prop:"user"},{default:i(()=>[n("div",U,[p(s,{modelValue:f(r).user,"onUpdate:modelValue":a[0]||(a[0]=e=>f(r).user=e),disabled:f(l).isEdit,placeholder:"输入需要密抄用户的邮箱"},null,8,["modelValue","disabled"])])]),_:1}),p(u,{label:"抄送到",prop:"forward_user"},{default:i(()=>[n("div",k,[p(s,{modelValue:f(r).forward_user,"onUpdate:modelValue":a[1]||(a[1]=e=>f(r).forward_user=e),placeholder:"输入您需要收到密抄的邮箱"},null,8,["modelValue"])])]),_:1}),p(u,{label:"抄送类型",prop:"type"},{default:i(()=>[n("div",q,[p(b,{modelValue:f(r).type,"onUpdate:modelValue":a[2]||(a[2]=e=>f(r).type=e),options:f(y)},null,8,["modelValue","options"])])]),_:1}),p(u,{label:"开启","show-feedback":!1},{default:i(()=>[p(x,{modelValue:f(r).active,"onUpdate:modelValue":a[3]||(a[3]=e=>f(r).active=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])}}});export{z as default};
