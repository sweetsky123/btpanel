import{_ as e}from"./index109.js?v=1763689792";import{b as a,Q as s,l,k as t,j as o}from"./utils-lib.js?v=1763689792";import{c as r,r as n,o as u,x as i,y as d,e as c,C as p,J as m,z as f,H as _,b4 as y,K as g,v as k,I as h,O as w,D as b,A as v,R as x,ad as j,ab as C}from"./base-lib.js?v=1763689792";import{outThesaurus as q,delThesaurus as V,clearThesaurus as z,getThesaurus as R,addThesaurus as U}from"./site.js?v=1763689792";import{u as A}from"./column.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";const D=r({__name:"upload-thesaurus",emits:["upload-success"],setup(e,{expose:s,emit:l}){const t=a(),o=n(),r=n(),k=l,h=window.location.protocol+"//"+window.location.host+"/project/content/in_thesaurus",w=u({f_size:0,f_path:"/tmp/",f_name:"inthesaurus.txt",f_start:0}),b=n([]),v=[".txt"].join(","),x=()=>{k("upload-success"),t.success("导入成功")},j=()=>{t.error("导入失败")},C={"x-http-token":window.vite_public_request_token},q=e=>{e.value=e,w.f_size=e.size,w.f_start=0},V=(e,a)=>{b.value=a},z=(e,a,s)=>{w.f_start=e.percent,b.value=s.map(s=>(s.uid===a.uid&&(s.percentage=e.percent),s))};return s({onConfirm:()=>{r.value.submit()},open:()=>{o.value.$el.click()},fileData:w}),(e,a)=>{const s=_,l=y;return i(),d("div",null,[c(l,{class:"upload-demo",ref_key:"uploadRef",ref:r,name:"blob",data:f(w),action:h,headers:C,accept:f(v),"on-error":j,multiple:!1,"show-file-list":!1,"auto-upload":!0,"on-success":x,"on-progress":z,"file-list":f(b),"on-change":V,"before-upload":q},{default:p(()=>[m(c(s,{ref_key:"openRef",ref:o,size:"small",type:"primary"},null,512),[[g,!1]])]),_:1},8,["data","accept","file-list"])])}}}),H=r({__name:"own-thesaurus",setup(a){const r=n(null),d=n([]),y=n(!1),g=n(),H=n(!1),I=u({key:""}),S=u({key:[{trigger:["blur","change"],required:!0,message:"请输入关键词"}]}),F=async()=>{r.value.open()},J=()=>{s({loading:"正在导出关键词文件，请稍后...",request:q(),data:{msg:String},success:e=>{e.msg&&window.open("/download?filename="+e.msg,"_blank","noopener,noreferrer")}})},K=async e=>{T()},O=[{label:"关键词\t",render:e=>c("span",null,[e])},A([{onClick:async e=>{await s({loading:"正在删除关键词，请稍后...",request:V({key:e}),message:!0}),T()},title:"删除"}])],Q=async()=>{await s({loading:"正在清空自定义词库，请稍后...",request:z(),message:!0}),T()},T=async()=>{y.value=!0,await s({loading:"正在加载词库列表，请稍后...",request:R(),data:[Array,d]}),y.value=!1},$=async e=>{await g.value.validate(),await s({loading:"正在添加关键词，请稍候...",request:U(I),message:!0,success:e=>{e.status&&(I.key="",H.value=!1,T())}})};return k(()=>T()),(a,s)=>{const n=_,u=l,k=t,q=j,V=C,z=o,R=e,U=h("bt-loading");return i(),w(R,{class:"px-[1.6rem] py-[1.6rem]"},{"header-left":p(()=>[c(n,{onClick:s[0]||(s[0]=e=>H.value=!0),type:"primary"},{default:p(()=>[...s[3]||(s[3]=[b("添加",-1)])]),_:1}),c(n,{onClick:F},{default:p(()=>[...s[4]||(s[4]=[b("导入",-1)])]),_:1}),c(n,{onClick:J},{default:p(()=>[...s[5]||(s[5]=[b("导出",-1)])]),_:1}),c(n,{onClick:Q},{default:p(()=>[...s[6]||(s[6]=[b("清空",-1)])]),_:1}),c(D,{ref_key:"fileIpRef",ref:r,onUploadSuccess:K},null,512)]),content:p(()=>[m(c(u,{"max-height":"260",column:O,data:f(d),description:"词库列表为空"},null,8,["data"]),[[U,f(y)],[U,"正在加载词库列表，请稍后...","title"]])]),popup:p(()=>[c(z,{title:"添加自定义词库",modelValue:f(H),"onUpdate:modelValue":s[2]||(s[2]=e=>x(H)?H.value=e:null),area:42,onConfirm:$,showFooter:""},{default:p(()=>[c(V,{ref_key:"addThesaurusRef",ref:g,rules:f(S),model:f(I),class:"p-[2rem]","label-width":"5rem"},{default:p(()=>[c(q,{label:"关键词",prop:"key"},{default:p(()=>[c(k,{modelValue:f(I).key,"onUpdate:modelValue":s[1]||(s[1]=e=>f(I).key=e),width:"20rem",placeholder:"请输入你需要扫描的关键词"},null,8,["modelValue"])]),_:1}),s[7]||(s[7]=v("ul",{class:"leading-8 text-small list-disc ml-20px"},[v("li",null,"关键字小于2时会引起大量误报，请设置大于等于2个关键字！")],-1))]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])]),_:1})}}});export{H as default};
