import{u as e,an as a,ao as t,cN as s,q as l,aA as n,bR as i,ap as o,p as r,n as d,H as c,e as m,b as p,_ as u}from"./utils-lib.js?v=1763689792";import{_ as v}from"./index109.js?v=1763689792";import{c as _,W as h,r as b,e as f,D as y,v as x,b as w,a0 as g,x as j,y as C,C as k,A as D,z as S,R as B,H as N,U as R,ad as H}from"./base-lib.js?v=1763689792";import{_ as I}from"./index260.js?v=1763689792";import{_ as T}from"./index113.js?v=1763689792";import{g as V}from"./useStore5.js?v=1763689792";import{e as A}from"./validator.js?v=1763689792";import{s as L,h as P,d as q,c as E,a as M,b as U}from"./useMethod6.js?v=1763689792";import{d as z,s as O}from"./useMethod7.js?v=1763689792";import{g as W,a as F,b as G,d as J,c as K}from"./ssl.js?v=1763689792";import{a as Q,u as X,c as Y}from"./column.js?v=1763689792";import{u as Z}from"./index147.js?v=1763689792";import"./index.vue_vue_type_style_index_0_scoped_cdc7f4d3_lang.js?v=1763689792";import{u as $,p as ee,a as ae}from"./useController7.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./index107.js?v=1763689792";import"./index131.js?v=1763689792";const te={class:"domain-manger module-ui"},se={class:"flex items-center"},le={class:"flex items-center ip-edit-input-group mr-[12px]"},ne=u(_({__name:"index",setup(u){const _=p(),{mainHeight:ne}=e(),{refs:{tabActive:ie,isRefreshDomainList:oe,typeList:re}}=V(),{ipSearchValue:de,publicIp:ce}=$(),me=re;h([]),b([]);const pe=h([]);b(null);const ue=[{content:"添加域名",active:!0,event:()=>{Se()}},{content:"DNS接口设置",dropdownClass:"bg-white",splitButton:!0,event:()=>{q()}}],ve=[{label:"设置分类",value:"type",event:(e,a,t,s)=>O(t.value,"domain")},{label:"配置DNS接口",value:"dnsSet",event:(e,a,t,s)=>z(t.value[0],t.value)},{label:"设置到期时间",value:"dateSet",event:(e,a,t,s)=>L({},t.value)},{label:"删除",value:"delete",event:async(e,a,t,s)=>{const{label:l,value:n}=s,i=new Map([["delete","即将批量删除选中的域名"]]),o=async(e,a)=>{const{domain:t}=e;if("delete"===n)return await K({domains:t})};await e({title:"批量".concat(l),content:"".concat(i.get(n),"，是否继续操作！"),column:[{label:"域名",prop:"domain"},Y()],onConfirm:async()=>(await a(o),oe.value=!0,!1)})}}],_e=Z({key:"type",name:"域名分类",options:()=>[{label:"全部分类",value:"-1"}],event:{get:async()=>{const{data:e}=await F();return me.value=e,me.value=i(e,"array",[]).map(e=>({label:e.name,value:e.type_id})),me.value.unshift({label:"全部分类",value:"all"}),me.value},add:e=>G(e),update:e=>G(e),delete:e=>J({type_id:e.id})},ignore:["0"],field:"name",showEdit:!1}),he=o(ve),{BtTable:be,BtPage:fe,BtRefresh:ye,BtColumn:xe,refresh:we,BtBatch:ge,BtTableCategory:je,BtRecommendSearch:Ce}=a({request:async e=>{try{let a={p:e.p,type_id:l(e.type)||"all"===e.type?"-1":e.type,search:e.search,limit:e.limit};"-1"===a.type_id&&delete a.type_id;const{data:t}=await W(a);return{data:t.data,total:n(t.page),other:{search_history:t.search_history}}}catch(a){return{data:[],total:0}}},columns:[Q(),{label:"域名",prop:"domain"},{label:"分组",width:180,isCustom:!0,render:e=>{const a=me.value.find(a=>a.value==e.type_id);return a?a.label:"未分组"}},{label:"解析数量",prop:"sbd_count",isCustom:!0},{label:"DNS接口",width:200,isCustom:!0,render:e=>{var a;return f("div",{class:"flex items-center"},[(null==(a=e.dns)?void 0:a.dns_name)?f("span",null,[e.dns.dns_name]):f("span",{class:"bt-link cursor-pointer",onClick:()=>z(e)},[y("未配置")]),f("div",{class:"el-divider el-divider--vertical"},null),f("span",{class:"bt-link cursor-pointer",onClick:()=>z(e)},[y("点击配置")])])}},{label:"到期时间",isCustom:!0,render:e=>{const a=(new Date).setHours(0,0,0,0),t=e.endtime?new Date(e.endtime.replace(/-/g,"/")).getTime():0,s=0!==e.endtime&&t<a,l=0!==e.endtime&&t-Date.now()<6048e5;return f("span",{class:"cursor-pointer "+(s?"bt-danger":l?"bt-warn":"bt-link"),onClick:()=>{L(e)}},[s?"已过期":0===e.endtime?"未设置":e.endtime])}},X([{onClick:e=>{E(e)},title:"创建网站"},{onClick:e=>{e.dns_id?M(e):(_.error("请先配置DNS"),z(e))},title:"快速解析"},{onClick:e=>{var a;(null==(a=e.dns)?void 0:a.dns_name)?U(e):(_.error("请先配置DNS"),z(e))},title:"解析记录管理",width:120},{onClick:e=>{De(e)},title:"删除"}])],extension:[_e,he,t(oe),s("search",{name:"ssl",key:"get_domain_list",list:[],showRecommend:!1})]}),ke=()=>{A({title:"域名需求反馈收集",type:28,isNoRate:!0,softName:"1",isCard:!1,id:993})},De=async(e,a=!1)=>{let t;try{a||await r({title:"删除【".concat(e.domain,"】域名"),content:"删除该域名，是否继续操作？",icon:"warning",width:45}),a||(t=_.load("正在删除域名，请稍候..."));const s=await K({domains:e.domain});return a||_.request(s),s.status&&!a&&(oe.value=!0),s}catch(s){}finally{t&&t.close()}},Se=async()=>{d({title:"添加域名",btn:["确认","取消"],component:()=>c(()=>import("./index284.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),area:50})};return x(async()=>{ie.value=w().name,ce.value=await ee(),await ae()}),g("sslHistoryList",pe),(e,a)=>{const t=T,s=I,l=N,n=R,i=H,o=m,r=v;return j(),C("div",te,[f(t,{class:"!mb-[12px]",type:"warning","show-icon":""},{title:k(()=>[...a[2]||(a[2]=[D("div",null,"当前域名列表仅显示顶级域名，配置DNS，可以快速解析域名和申请证书。",-1)])]),_:1}),f(r,null,{"header-left":k(()=>[D("div",se,[f(s,{options:ue}),a[5]||(a[5]=D("span",{class:"bg-darkTertiary w-[1px] h-[16px] mx-[16px]"},null,-1)),D("div",le,[f(i,{prop:"ip",class:"!mb-0"},{default:k(()=>[f(n,{disabled:"",modelValue:S(de),"onUpdate:modelValue":a[1]||(a[1]=e=>B(de)?de.value=e:null),value:"解析IP：".concat(S(de)),placeholder:"解析IP：".concat(S(de))},{append:k(()=>[f(l,{type:"primary",onClick:a[0]||(a[0]=e=>S(P)(S(de)))},{default:k(()=>[...a[3]||(a[3]=[y("修改",-1)])]),_:1})]),_:1},8,["modelValue","value","placeholder"])]),_:1})]),f(o,{class:"flex items-center",onClick:ke},{default:k(()=>[...a[4]||(a[4]=[D("div",{class:"flex items-center"},[D("span",{class:"svgtofont-desired text-medium"}),D("span",null,"需求反馈")],-1)])]),_:1})])]),"header-right":k(()=>[f(S(je),{class:"!w-[140px] mr-[10px]"}),f(S(Ce),{type:"ssl-domain",placeholder:"请输入域名",class:"!w-[270px] mr-[10px]"}),f(S(ye),{class:"mr-4"}),f(S(xe))]),content:k(()=>[f(S(be),{"min-height":S(ne)},null,8,["min-height"])]),"footer-left":k(()=>[f(S(ge))]),"footer-right":k(()=>[f(S(fe))]),_:1})])}}}),[["__scopeId","data-v-13699e2e"]]);export{ne as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
