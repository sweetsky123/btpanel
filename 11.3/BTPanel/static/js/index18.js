import{_ as a}from"./index109.js?v=1763689792";import{_ as e}from"./index118.js?v=1763689792";import{Q as s,e as l,P as t,l as o,ah as r,W as n}from"./utils-lib.js?v=1763689792";import{c as i,r as u,o as d,W as m,g as p,w as c,v as _,I as f,x as v,y as g,z as b,O as y,C as h,e as j,G as x,A as w,D as C,R as k,L as S,F as q,b1 as V,J as R,H as U,am as A,an as H,B as J}from"./base-lib.js?v=1763689792";import{_ as L}from"./index137.js?v=1763689792";import{g as O}from"./useStore2.js?v=1763689792";import{d as T,o as N,a as W,f as z,i as B,g as D,j as F}from"./useMethod4.js?v=1763689792";import{a as G,g as I,u as M}from"./column.js?v=1763689792";import{getModulesCloudServer as P,getModulesList as Q}from"./database.js?v=1763689792";import{e as E}from"./validator.js?v=1763689792";import{_ as K}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1763689792";import{_ as X}from"./index.vue_vue_type_script_setup_true_lang3.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./index.vue_vue_type_style_index_0_scoped_cdc7f4d3_lang.js?v=1763689792";import"./index107.js?v=1763689792";const Y={class:"flex items-center"},Z={class:"w-[20rem] truncate inline-block"},$=i({__name:"index",setup(i){const{refs:{isRefreshTable:$,isLoading:aa,isHaveServer:ea},resetRefresh:sa,refreshTableList:la}=O(),ta=u(null),oa=u([]),ra=d({total:0,page:1,row:10}),na=m([]),ia=u("all"),ua=u(""),da=u([]),ma=T().filter(a=>"back"!==a.value),pa=p(()=>!ea.value),ca=async()=>(await s({request:P({data:JSON.stringify({type:"sqlserver"})},"mongodb"),data:[Array,da]}),da.value.length||(ea.value=!1),da.value),_a=async()=>{let a={p:ra.page,limit:ra.row,tables:"databases",search:ua.value,sid:"all"===ia.value?"":ia.value};""===a.sid&&delete a.sid,await s({loading:aa,request:Q({data:JSON.stringify(a)},"sqlserver"),data:{data:[Array,oa],page:n(ra)}})},fa=async()=>{_a(),await ca(),na.value=[G(),...z(B),D(da.value,"sqlserver"),I({table:"databases"}),M([{onClick:a=>B(a),title:"改密"},{onClick:a=>F(a),title:"删除"}])]};return c(()=>$.value,async a=>{a&&await _a(),sa()}),_(()=>fa()),(s,n)=>{const i=L,u=U,d=l,m=A,p=H,c=t,_=o,O=r,T=e,z=a,B=f("bt-loading");return v(),g("div",null,[b(pa)?(v(),y(i,{key:0},{content:h(()=>[j(X,{type:"SqlServer"})]),_:1})):x("",!0),j(z,null,{"header-left":h(()=>[w("div",Y,[j(u,{type:"primary",onClick:n[0]||(n[0]=a=>b(N)(ca))},{default:h(()=>[...n[6]||(n[6]=[C("添加数据库",-1)])]),_:1}),j(u,{onClick:b(W)},{default:h(()=>[...n[7]||(n[7]=[C("远程数据库",-1)])]),_:1},8,["onClick"]),j(K,{"comp-data":b(da),class:"ml-[10px]"},null,8,["comp-data"]),j(d,{onClick:n[1]||(n[1]=a=>b(E)({name:"数据库",type:12})),icon:"desired",class:"ml-[12px]",iconClass:"text-medium"},{default:h(()=>[...n[8]||(n[8]=[C("需求反馈",-1)])]),_:1})])]),"header-right":h(()=>[j(p,{modelValue:b(ia),"onUpdate:modelValue":n[2]||(n[2]=a=>k(ia)?ia.value=a:null),onChange:b(la),class:S(["!w-[14rem] mr-[8px]",{"custom-types-bg-green":"all"!==b(ia)}])},{default:h(()=>[j(m,{label:"全部",value:"all"}),(v(!0),g(q,null,V(b(da),(a,e)=>(v(),y(m,{key:e,label:"".concat("all"!==b(ia)?"已选：":"").concat(a.ps),value:a.id},{default:h(()=>[w("span",Z,J(a.ps),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","onChange","class"]),j(c,{class:"w-[26rem]",modelValue:b(ua),"onUpdate:modelValue":n[3]||(n[3]=a=>k(ua)?ua.value=a:null),onSearch:b(la),placeholder:"请输入数据库名称/备注"},null,8,["modelValue","onSearch"])]),content:h(()=>[R(j(_,{ref_key:"sqlTableRef",ref:ta,column:b(na),data:b(oa)},null,8,["column","data"]),[[B,b(aa)]])]),"footer-left":h(()=>[j(O,{options:b(ma),"table-ref":b(ta)},null,8,["options","table-ref"])]),"footer-right":h(()=>[j(T,{total:b(ra).total,page:b(ra).page,"onUpdate:page":n[4]||(n[4]=a=>b(ra).page=a),row:b(ra).row,"onUpdate:row":n[5]||(n[5]=a=>b(ra).row=a),onChange:b(la)},null,8,["total","page","row","onChange"])]),_:1})])}}});export{$ as default};
