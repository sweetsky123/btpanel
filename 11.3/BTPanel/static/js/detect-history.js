import{u as t,f0 as e,aA as s,i5 as a,bR as n,V as r,n as i,H as o}from"./utils-lib.js?v=1763689792";import{_ as l}from"./index109.js?v=1763689792";import{getSingleSiteRisk as p,getRisk as m}from"./site.js?v=1763689792";import{c as d,r as _,x as c,O as u,C as b,e as h,z as g,L as f,D as k}from"./base-lib.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";const x=d({__name:"detect-history",props:{compData:{default:()=>({isPopup:!1,name:""})}},setup(d){const x=d,{mainHeight:j}=t(),w=_(x.compData.isPopup);x.compData;const D=t=>{i({title:"风险详情",area:[70,55],component:()=>o(()=>import("./risk-detail.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:t})},P=e({request:async t=>{const e=w.value?p({site_name:x.compData.name,...t}):m({...t}),{data:a}=await e;return{data:a.data||[],total:a.page?s(a.page):0}},columns:[{label:"网站列表",prop:"site_name",width:120},{label:"扫描URL总数",prop:"scans",width:100},{label:"扫描耗时",prop:"time",render:t=>[t.end_time<=1||t.end_time-t.start_time<=0?h("span",null,[k("0秒")]):h("span",null,[a(t.end_time-t.start_time)])]},{label:"风险次数",prop:"risks",render:t=>[0==t.risks?h("span",null,[k("无风险")]):h("span",{class:"bt-link !text-danger",onClick:()=>D(t)},[t.risks])]},{label:"状态",prop:"status",render:t=>[0===t.is_status&&0===t.end_time||1===t.end_time?h("span",{class:"text-red"},[k("扫描未完成")]):1===t.is_status&&0===t.end_time?h("span",{class:"text-warning"},[k("扫描中")]):h("span",null,[k("扫描完成")])]},{label:"扫描时间",prop:"start_time",width:200,render:t=>{const e=n(t.start_time,"number",0);return h("span",null,[r(e)])}},{label:"操作",align:"right",render:t=>[0===t.is_status&&0===t.end_time||1===t.end_time||1===t.is_status&&0===t.end_time?h("span",{class:"text-disabled cursor-not-allowed"},[k("扫描未完成")]):h("span",{class:"bt-link",onClick:()=>(t=>{window.open("/project/content/report/html?id="+t.testing_id,"_blank","noopener,noreferrer")})(t)},[k("查看报告")])]}]}),{BtTable:C,refresh:H}=P,L=P.BtPage;return(t,e)=>{const s=l;return c(),u(s,{class:f({"p-[2rem]":g(w)})},{content:b(()=>[h(g(C),{"max-height":g(w)?500:g(j)-240,description:"检测历史列表为空"},null,8,["max-height"])]),"footer-right":b(()=>[h(g(L))]),popup:b(()=>[...e[0]||(e[0]=[])]),_:1},8,["class"])}}});export{x as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
