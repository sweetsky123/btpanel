import{c as e,s,r as a,x as l,y as r,e as t,C as o,A as n,L as u,z as v,S as c,R as m,aZ as i,U as p}from"./base-lib.js?v=1763689792";import{b as d,p as f,Q as x,_ as y}from"./utils-lib.js?v=1763689792";import{T as _,U as h}from"./ssl.js?v=1763689792";import{u as b}from"./useStore11.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";const g={class:"p-[16px]"},j={class:"flex flex-1 justify-start mt-[16px]"},D={class:"flex-1 mr-[2rem]"},R={class:"flex-1"},w=y(e({__name:"index",emits:["close"],setup(e,{expose:y,emit:w}){const{activeTabs:V,sslIsRefresh:I,testIsRefresh:k,encryptIsRefresh:T,otherIsRefresh:U}=s(b()),z=w,C=a(""),q=a(""),A=a(!1),E=a(!1),F=(e,s)=>{var a;if(s.preventDefault(),"key"===e?A.value=!1:E.value=!1,window.FileReader){const l=null==(a=s.dataTransfer)?void 0:a.files;if(l&&l.length>0){const s=l[0],a=new FileReader;a.onload=s=>{var a;(null==(a=s.target)?void 0:a.result)&&("key"===e?C.value=s.target.result:q.value=s.target.result)},a.onerror=()=>{d().error("请上传证书文件")},a.readAsText(s)}else d().error("无效的证书文件拖拽上传")}else d().error("当前浏览器版本不支持文件拖拽上传，请升级浏览器版本")},S={ssl:()=>I.value=!0,test:()=>k.value=!0,encrypt:()=>T.value=!0,other:()=>U.value=!0};return y({onConfirm:async()=>{var e;try{const s=await _({key:C.value,csr:q.value});d().request(s),s.status&&(z("close"),s.creat_order&&f({title:"创建证书订单",content:"检测到证书文件为let's encrypt证书，是否立即同步证书？",onConfirm:async()=>{x({request:h({ssl_hash:s.ssl_hash}),loading:"正在同步证书",message:!0,success:()=>{var e;null==(e=S[V.value])||e.call(S)}})}}),null==(e=S[V.value])||e.call(S))}catch(s){}}}),(e,s)=>{const a=i,d=p;return l(),r("div",g,[t(a,{type:"success",closable:!1},{title:o(()=>[...s[8]||(s[8]=[n("div",{class:"mr-[3.2rem] text-small pb-[5px]"},"温馨提示：支持拖拽证书文件上传，并自动识别。",-1)])]),_:1}),n("div",j,[n("div",D,[s[9]||(s[9]=n("div",{class:"mb-[.4rem]"},"密钥(KEY)",-1)),n("div",{class:u(["drop-zone mb-[.2rem] p-[.2rem]",{over:v(A)}]),onDragover:s[1]||(s[1]=c(e=>A.value=!0,["prevent"])),onDragleave:s[2]||(s[2]=c(e=>A.value=!1,["prevent"])),onDrop:s[3]||(s[3]=e=>F("key",e))},[t(d,{type:"textarea",rows:22,modelValue:v(C),"onUpdate:modelValue":s[0]||(s[0]=e=>m(C)?C.value=e:null)},null,8,["modelValue"])],34)]),n("div",R,[s[10]||(s[10]=n("div",{class:"mb-[.4rem]"},"证书(PEM格式)",-1)),n("div",{class:u(["drop-zone mb-[.2rem] p-[.2rem]",{over:v(E)}]),onDragover:s[5]||(s[5]=c(e=>E.value=!0,["prevent"])),onDragleave:s[6]||(s[6]=c(e=>E.value=!1,["prevent"])),onDrop:s[7]||(s[7]=e=>F("csr",e))},[t(d,{type:"textarea",rows:22,modelValue:v(q),"onUpdate:modelValue":s[4]||(s[4]=e=>m(q)?q.value=e:null)},null,8,["modelValue"])],34)])])])}}}),[["__scopeId","data-v-6a29ead6"]]);export{w as default};
