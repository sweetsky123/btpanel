!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",l=a.toStringTag||"@@toStringTag";function i(t,a,o,l){var i=a&&a.prototype instanceof c?a:c,f=Object.create(i.prototype);return r(f,"_invoke",function(t,r,a){var o,l,i,c=0,f=a||[],s=!1,m={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return o=n,l=0,i=e,m.n=t,u}};function p(t,r){for(l=t,i=r,n=0;!s&&c&&!a&&n<f.length;n++){var a,o=f[n],p=m.p,d=o[2];t>3?(a=d===r)&&(i=o[(l=o[4])?5:(l=3,3)],o[4]=o[5]=e):o[0]<=p&&((a=t<2&&p<o[1])?(l=0,m.v=r,m.n=o[1]):p<d&&(a=t<3||o[0]>r||r>d)&&(o[4]=t,o[5]=r,m.n=d,l=0))}if(a||t>1)return u;throw s=!0,r}return function(a,f,d){if(c>1)throw TypeError("Generator is already running");for(s&&1===f&&p(f,d),l=f,i=d;(n=l<2?e:i)||!s;){o||(l?l<3?(l>1&&(m.n=-1),p(l,i)):m.n=i:m.v=i);try{if(c=2,o){if(l||(a="next"),n=o[a]){if(!(n=n.call(o,i)))throw TypeError("iterator result is not an object");if(!n.done)return n;i=n.value,l<2&&(l=0)}else 1===l&&(n=o.return)&&n.call(o),l<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),l=1);o=e}else if((n=(s=m.n<0)?i:t.call(r,m))!==u)break}catch(n){o=e,l=1,i=n}finally{c=1}}return{value:n,done:s}}}(t,o,l),!0),f}var u={};function c(){}function f(){}function s(){}n=Object.getPrototypeOf;var m=[][o]?n(n([][o]())):(r(n={},o,function(){return this}),n),p=s.prototype=c.prototype=Object.create(m);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,r(e,l,"GeneratorFunction")),e.prototype=Object.create(p),e}return f.prototype=s,r(p,"constructor",s),r(s,"constructor",f),f.displayName="GeneratorFunction",r(s,l,"GeneratorFunction"),r(p),r(p,l,"Generator"),r(p,o,function(){return this}),r(p,"toString",function(){return"[object Generator]"}),(t=function(){return{w:i,m:d}})()}function r(e,n,t,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}r=function(e,n,t,a){function l(n,t){r(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!a,configurable:!a,writable:!a}):e[n]=t:(l("next",0),l("throw",1),l("return",2))},r(e,n,t,a)}function a(e,n,t,r,a,o,l){try{var i=e[o](l),u=i.value}catch(e){return void t(e)}i.done?n(u):Promise.resolve(u).then(r,a)}function o(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var l=e.apply(n,t);function i(e){a(l,r,o,i,u,"next",e)}function u(e){a(l,r,o,i,u,"throw",e)}i(void 0)})}}System.register(["./index-legacy109.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./index-legacy107.js?v=1763689792","./database-legacy.js?v=1763689792","./useStore-legacy2.js?v=1763689792","./column-legacy.js?v=1763689792","./validator-legacy.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792"],function(n,r){"use strict";var a,l,i,u,c,f,s,m,p,d,b,y,v,_,h,g,w,I,S,j,O,x,k,M,T,A,q,z,D,C,R,P,V,B,G,E,F,J,N,U,Z;return{setters:[function(e){a=e._},function(e){l=e.M,i=e.Q,u=e.x,c=e.l,f=e.ah,s=e.j,m=e.aK},function(e){p=e.c,d=e.r,b=e.o,y=e.v,v=e.I,_=e.x,h=e.y,g=e.e,w=e.a1,I=e.z,S=e.C,j=e.J,O=e.O,x=e.G,k=e.R,M=e.A,T=e.aZ,A=e.ad,q=e.ab},function(e){z=e._},function(e){D=e.exportTableStr,C=e.getTableInfo,R=e.getModulesTableInfo,P=e.conversionTable,V=e.optimizeTable,B=e.repairTable,G=e.modifyTableComment},function(e){E=e.g},function(e){F=e.a,J=e.g,N=e.u,U=e.c},function(e){Z=e.f},null,null],execute:function(){var r={class:"p-[16px]"},H={key:0,class:"mt-[8px] ml-[16px] leading-8 text-small list-disc"};n("default",p({__name:"index",props:{compData:{default:function(){return{name:""}}}},setup:function(n){var p=n,K=E().refs.tabActive,Q=d(),$=d(!1),L=d("暂无数据"),W=d([]),X=d(!1),Y=d(),ee=b({db_name:"",table_name:"",filename:""}),ne=b({filename:[{required:!0,message:"请输入导出文件路径",trigger:["blur","input"]}]}),te=function(){var e=o(t().m(function e(n,r,a,l){var i,u,c;return t().w(function(e){for(;;)switch(e.n){case 0:return i={Repair:["修复",""],Optimization:["优化","，将回收未释放的磁盘空间，"],InnoDB:["转换引擎","为【InnoDB】"],MyISAM:["转换引擎","为【MyISAM】"]},u=l.label,c=l.value,e.n=1,n({title:"批量".concat(u),content:"批量".concat(i[c][0],"已选数据库表").concat(i[c][1],"，是否继续？"),column:[{prop:"table_name",label:"表名"},U()],onConfirm:function(){var e=o(t().m(function e(){return t().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r(function(e){return re(e,c)});case 1:return se(),e.a(2,!1)}},e)}));return function(){return e.apply(this,arguments)}}()});case 1:return e.a(2)}},e)}));return function(n,t,r,a){return e.apply(this,arguments)}}(),re=function(){var e=o(t().m(function e(n,r){var a,o,l,i;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:a=n.table_name,e.p=1,o={db_name:p.compData.name,tables:JSON.stringify([a]),table_type:r},"Repair"!==r&&"Optimization"!==r||delete o.table_type,l=r,e.n="Repair"===l?2:"Optimization"===l?4:"InnoDB"===l||"MyISAM"===l?6:8;break;case 2:return e.n=3,B(o);case 3:return e.a(2,e.v);case 4:return e.n=5,V(o);case 5:return e.a(2,e.v);case 6:return e.n=7,P(o);case 7:return e.a(2,e.v);case 8:e.n=10;break;case 9:e.p=9,i=e.v,m(i,"tools-handleOperateRequest");case 10:return e.a(2)}},e,null,[[1,9]])}));return function(n,t){return e.apply(this,arguments)}}(),ae=function(){var e=o(t().m(function e(n,r){return t().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,i({loading:"正在修改中，请稍后...",request:G({db_name:p.compData.name,table_name:n.table_name,comment:r}),message:!0});case 1:se();case 2:return e.a(2)}},e)}));return function(n,t){return e.apply(this,arguments)}}(),oe=function(){Z({type:"dir",change:function(e){ee.filename=e+"/"+ee.db_name+"_"+ee.table_name+".sql"}})},le=function(){var e=o(t().m(function e(){return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,""!==ee.filename){e.n=1;break}return l.error("请填写导出文件路径"),e.a(2,!1);case 1:return e.n=2,i({loading:"正在导出中，请稍候...",request:D(ee),message:!0,success:function(){ee.table_name="",ee.filename="",Y.value.clearValidate(),X.value=!1}});case 2:e.n=4;break;case 3:e.p=3,e.v;case 4:return e.a(2)}},e,null,[[0,3]])}));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=o(t().m(function e(n,r){var a,o;return t().w(function(e){for(;;)switch(e.n){case 0:return a=l.load("正在操作表【".concat(n.table_name,"】，请稍后...")),e.n=1,re(n,r);case 1:o=e.v,a.close(),l.request(o),se();case 2:return e.a(2)}},e)}));return function(n,t){return e.apply(this,arguments)}}(),ue=[F({key:"table_name"}),{label:"表名",prop:"table_name",showOverflowTooltip:!0},J({request:function(e,n){return ae(e,n)},prop:"comment"}),{label:"引擎",prop:"type",width:80},{label:"字符集",prop:"collation",showOverflowTooltip:!0},{label:"行数",align:"center",width:60,prop:"rows_count"},{label:"大小",prop:"data_size"},N([{onClick:function(e){ee.db_name=p.compData.name,ee.table_name=e.table_name,X.value=!0},title:"导出表结构",width:70},{onClick:function(e){return ie(e,"Repair")},title:"修复"},{onClick:function(e){return ie(e,"Optimization")},title:"优化"},{onClick:function(e){return ie(e,"MyISAM"===e.type?"InnoDB":"MyISAM")},title:"转换引擎",width:70}])],ce=[{label:"集合名称",prop:"collection_name"},{label:"文档数量",prop:"count"},{label:"内存中的大小",render:function(e){return u(e.size)}},{label:"对象平均大小",render:function(e){return u(e.avg_obj_size)}},{label:"存储大小",render:function(e){return u(e.storage_size)}},{label:"索引数量",prop:"nindexes"},{label:"索引大小",render:function(e){return u(e.total_index_size)}}],fe=[{label:"修复",value:"Repair",event:te},{label:"优化",value:"Optimization",event:te},{label:"转为InnoDB",value:"InnoDB",event:te},{label:"转为MyISAM",value:"MyISAM",event:te}],se=function(){var e=o(t().m(function e(){var n,r,a;return t().w(function(e){for(;;)switch(e.n){case 0:return n={db_name:p.compData.name},e.n=1,i({loading:$,request:"mysql"==K.value?C(n):R({data:JSON.stringify(n)},K.value)});case 1:r=e.v,a=r.data,"mysql"===K.value?W.value=a.tables:W.value=a.data.collection_list,"mysql"==K.value?L.value="数据库名称: ".concat(a.database," 大小: ").concat(a.data_size||0):L.value="数据库名称: ".concat(a.data.db,"\n\t\t\t 集合数量: ").concat(a.data.collections||0,"\n\t\t\t 存储大小: ").concat(u(a.data.totalSize)||0,"\n\t\t\t 索引大小: ").concat(u(a.data.indexSize)||0);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();return y(function(){se()}),function(n,t){var o=T,l=c,i=f,u=z,m=A,p=q,d=s,b=a,y=v("bt-loading"),D=v("trim");return _(),h("div",r,[g(b,null,w({"header-left":S(function(){return[g(o,{class:"font-bold",title:I(L),type:"info",closable:!1},null,8,["title"])]}),content:S(function(){return["mysql"===I(K)?j((_(),O(l,{key:0,"max-height":"300",ref_key:"mysqlToolsRef",ref:Q,column:I(ue),data:I(W)},null,8,["column","data"])),[[y,I($)],[y,"正在查询中，请稍后...","title"]]):x("",!0),"mysql"!==I(K)?(_(),O(l,{key:1,"max-height":"300",ref:"modulesToolsRef",column:I(ce),data:I(W)},null,8,["column","data"])):x("",!0)]}),popup:S(function(){return[g(d,{title:"导出表【".concat(I(ee).table_name,"】结构"),modelValue:I(X),"onUpdate:modelValue":t[1]||(t[1]=function(e){return k(X)?X.value=e:null}),area:[50],"show-footer":"",onConfirm:t[2]||(t[2]=function(e){return le()}),onCancel:t[3]||(t[3]=function(e){return X.value=!1,Y.value.resetFields(),void Y.value.clearValidate()})},{default:S(function(){return[g(p,{ref_key:"exportTableForm",ref:Y,class:"px-2rem py-3rem",model:I(ee),rules:I(ne)},{default:S(function(){return[g(m,{label:"导出文件路径",prop:"filename"},{default:S(function(){return[j(g(u,{icon:"icon-file_mode",modelValue:I(ee).filename,"onUpdate:modelValue":t[0]||(t[0]=function(e){return I(ee).filename=e}),name:"filename",onIconClick:oe,width:"32rem"},null,8,["modelValue"]),[[D]])]}),_:1})]}),_:1},8,["model","rules"])]}),_:1},8,["title","modelValue"])]}),_:2},["mysql"==I(K)?{name:"footer-left",fn:S(function(){return[g(i,{options:fe,"table-ref":I(Q)},null,8,["table-ref"])]}),key:"0"}:void 0]),1024),"mysql"===I(K)?(_(),h("ul",H,e(t[4]||(t[4]=[M("li",null,"【优化】执行OPTIMIZE命令，可回收未释放的磁盘空间，建议每月执行一次",-1),M("li",null,"【修复】尝试使用REPAIR命令修复损坏的表，仅能做简单修复，若修复不成功请考虑使用myisamchk工具",-1),M("li",null,"【MyISAM】转换数据表引擎，建议将所有表转为InnoDB",-1),M("li",null,"数据库大小是从数据库表中读取，会与数据库配额容量中获取存在些许误差，请注意",-1)])))):x("",!0)])}}}))}}})}();
