import{c as e,r as t,t as a,v as l,z as s,x as o,y as n,A as i,B as r,G as c,s as d,g as u,e as m,C as p,O as v,P as f,D as y,L as h,d as g,aA as x,at as b,as as w,ar as _,bB as k,w as C,j as S,aH as I,n as P,F as L,b1 as T,bC as j,bD as M,p as E,o as B,R,ap as D,I as O,N as A,J as V,a1 as z,bz as F,bA as H,H as N,aY as W,K as U,aZ as q,be as G,aT as K,M as $,b6 as J,a3 as Z,bE as Q,a8 as Y,bc as X,bd as ee,bF as te,aK as ae,bG as le,bH as se,W as oe,S as ne,by as ie,bw as re,bu as ce,Q as de,bI as ue,U as me,ax as pe,az as ve,Y as fe,Z as ye,bJ as he,am as ge,an as xe,b as be}from"./base-lib.js?v=1763689792";import{u as we,Q as _e,ey as ke,n as Ce,H as Se,ez as Ie,_ as Pe,eA as Le,w as Te,a3 as je,E as Me,s as Ee,e as Be,p as Re,eB as De,b as Oe,af as Ae,aH as Ve,T as ze,av as Fe,eC as He,eD as Ne,az as We,x as Ue,aS as qe,r as Ge,q as Ke,eE as $e,eF as Je,l as Ze,eG as Qe,aK as Ye,b8 as Xe,eH as et,M as tt,eI as at,i as lt,bU as st,aw as ot,V as nt,f as it,j as rt,z as ct,O as dt}from"./utils-lib.js?v=1763689792";import{g as ut,b as mt,e as pt,ak as vt,al as ft,am as yt,l as ht,p as gt,an as xt,ao as bt,ap as wt,aq as _t,ar as kt,as as Ct,f as St,at as It,au as Pt}from"./validator.js?v=1763689792";import{_ as Lt}from"./index116.js?v=1763689792";import{_ as Tt}from"./index110.js?v=1763689792";import{_ as jt}from"./index111.js?v=1763689792";import{H as Mt}from"./store.js?v=1763689792";import{a8 as Et}from"./config.js?v=1763689792";import{H as Bt}from"./store2.js?v=1763689792";import{b as Rt,u as Dt,o as Ot}from"./column.js?v=1763689792";import{H as At}from"./store3.js?v=1763689792";import{c as Vt}from"./hooks.js?v=1763689792";const zt={class:"icon-end-time voucher-logo"},Ft={class:"ml-[4px] font-bold text-[var(--bt-pro-sub-color)]"},Ht=Pe(e({__name:"index",setup(e){const d=t([]),{payment:u,aliyunEcsLtd:m}=we(),{voucherOpenTime:p,isGetCoupon:v}=a(u.value),f=async()=>{_e({request:ke(),data:[Array,d]})},y=()=>{m.value||Ce({area:40,component:()=>Se(()=>import("./index338.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),customClass:"voucherFetchView",compData:{isCoupon:d.value,isHome:!0}})};return l(()=>{const e=Number(sessionStorage.getItem("voucherOpenTime"));if(-100!==e){if(e){e-Math.floor(Date.now()/1e3)<=0&&(v.value=!0,sessionStorage.removeItem("voucherOpenTime"),(async()=>{let e=new Date((new Date).toLocaleDateString()).getTime()+6048e5-1;e=Math.floor(e>0?e/1e3:e),_e({request:Ie({limit_time:e})}),v.value=!0})())}ut({promises:[f],delay:3e3})}}),(e,t)=>s(d).length>0&&!s(v)&&!s(m)?(o(),n("div",{key:0,class:"flex items-center px-[1rem] py-[.4rem] mr-[8px] rounded-small recom-bg",onClick:y},[i("span",zt,[i("span",Ft,"您有"+r(s(d).length)+"个优惠券待领取",1)])])):c("",!0)}}),[["__scopeId","data-v-4f516d2a"]]),Nt={class:"module-ui home-header"},Wt={class:"home-header-left"},Ut={class:"mr-[8px] flex items-center"},qt={class:"cursor-pointer flex items-center mr-[4px] ml-[4px]"},Gt=["title"],Kt={class:"block"},$t={class:"home-header-right"},Jt=["title"],Zt={class:"flex items-center"},Qt={class:"ml-2 text-xs text-info"},Yt={class:"flex items-center"},Xt={class:"flex items-center"},ea=Pe(e({__name:"index",setup(e){const{payment:t,aliyunEcsLtd:C,forceLtd:S,isHideAd:I,mainWidth:P,globalTheme:L}=we(),{authType:T}=a(t.value),j=g(()=>Se(()=>import("./index339.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)),M=g(()=>Se(()=>import("./index217.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)),E=Mt(),{bindUser:B,systemInfo:R,panelInfo:D,panelVersion:O}=d(E),A=u(()=>Le.value),V=()=>{switch(A.value){case"auto":return"tools-adaptive-"+(Me.value?"dark":"light");case"light":return"tools-light";case"dark":return"tools-dark"}return"tools-light"},z=e=>{Ee(e),L.value.theme.preset=e,Et({data:JSON.stringify(L.value)})};l(()=>{Te()});const F=u(()=>P.value<968),H=u(()=>{var e;return R.value.name?null==(e=R.value.name.split(" ")[0])?void 0:e.toLowerCase():""});return u(()=>!C.value||"ltd"===t.value.authType),(e,t)=>{const a=jt,l=x,d=Tt,u=Lt,g=Ht,C=Be,S=b,P=w,L=_,N=k;return o(),n("div",Nt,[i("div",Wt,[m(l,{width:"420","popper-class":"el-popover-shadow",trigger:"hover"},{reference:p(()=>[i("div",Ut,[m(a,{name:"tools-user",size:"26",class:"mr-[4px]"}),s(F)?c("",!0):(o(),n("span",{key:0,class:"user-phone",onClick:t[0]||(t[0]=()=>s(mt)(s(B)?"切换宝塔账号":"绑定宝塔账号，享受更多服务"))},r(s(B)?s(B):"未绑定帐号，点击绑定"),1))])]),default:p(()=>[(o(),v(f(s(j))))]),_:1}),m(d),m(l,{width:"280","popper-class":"el-popover-shadow"},{reference:p(()=>[i("span",qt,[m(a,{name:"system-"+s(H),size:"18",class:"mr-[4px]"},null,8,["name"]),i("span",null,r(s(R).name||"获取中"),1)])]),default:p(()=>[i("div",null,[i("span",{class:"!mb-4px inline-block max-w-[26rem] truncate",title:s(R).simpleName||"获取中"},"系统："+r(s(R).simpleName||"获取中"),9,Gt),i("span",Kt," 持续运行："+r(s(D).runningDays||"获取中"),1)])]),_:1}),s(I)?c("",!0):(o(),v(d,{key:0})),s(I)?c("",!0):(o(),v(l,{key:1,width:"580",disabled:"free"!==s(T),"show-arrow":!1,"popper-style":"padding: 0;border-radius: var(--el-border-radius-round);overflow: hidden;","popper-class":"el-product-state-popover"},{reference:p(()=>[m(u,{"is-home":!0,"disable-pro":!0})]),default:p(()=>[(o(),v(f(s(M))))]),_:1},8,["disabled"])),s(I)||s(F)?c("",!0):(o(),v(g,{key:2}))]),i("div",$t,[s(D).isBeta?(o(),v(C,{key:0,class:"mr-[16px] reset-link bug-feedback",href:"https://www.bt.cn/bbs/forum-39-1.html"},{default:p(()=>[...t[8]||(t[8]=[y("[找Bug奖宝塔币]",-1)])]),_:1})):c("",!0),s(F)?c("",!0):(o(),v(L,{key:1,trigger:"hover",placement:"bottom-end",onCommand:z},{dropdown:p(()=>[m(P,null,{default:p(()=>[m(S,{command:"auto",class:h({"is-active":"auto"===s(A)})},{default:p(()=>[i("div",Zt,[m(a,{name:"tools-adaptive-"+("dark"===s(je)?"dark":"light"),size:"16",class:"mr-2"},null,8,["name"]),t[9]||(t[9]=i("span",null,"自动",-1)),i("span",Qt,"("+r("dark"===s(je)?"暗色":"亮色")+")",1)])]),_:1},8,["class"]),m(S,{command:"light",class:h({"is-active":"light"===s(A)})},{default:p(()=>[i("div",Yt,[m(a,{name:"tools-light",size:"16",class:"mr-2"}),t[10]||(t[10]=i("span",null,"亮色",-1))])]),_:1},8,["class"]),m(S,{command:"dark",class:h({"is-active":"dark"===s(A)})},{default:p(()=>[i("div",Xt,[m(a,{name:"tools-dark",size:"16",class:"mr-2"}),t[11]||(t[11]=i("span",null,"暗色",-1))])]),_:1},8,["class"])]),_:1})]),default:p(()=>[i("div",{class:"header-operation-icon",title:"auto"===s(A)?"自动切换主题":"light"===s(A)?"切换到暗色主题":"切换到亮色主题"},[m(a,{name:V(),size:"18",class:"hob-icon"},null,8,["name"])],8,Jt)]),_:1})),s(F)?c("",!0):(o(),v(l,{key:2,width:"1",placement:"bottom",trigger:"hover"},{reference:p(()=>[i("div",{class:"header-operation-icon",onClick:t[1]||(t[1]=e=>s(E).jumpRouter("ui"))},[m(a,{name:"tools-theme",size:"18",class:"hob-icon"})])]),default:p(()=>[t[12]||(t[12]=i("div",{class:"text-small text-center w-full"},"打开界面设置",-1))]),_:1})),s(F)?c("",!0):(o(),v(l,{key:3,width:"1",placement:"bottom",trigger:"hover"},{reference:p(()=>[i("div",{class:"header-operation-icon",onClick:t[2]||(t[2]=e=>s(E).jumpRouter("alarm"))},[m(a,{name:"tools-alarm",size:"18",class:"hob-icon"})])]),default:p(()=>[t[13]||(t[13]=i("div",{class:"text-small text-center w-full"},"打开告警设置",-1))]),_:1})),s(F)?c("",!0):(o(),v(l,{key:4,width:"20",placement:"bottom",trigger:"hover"},{reference:p(()=>[i("div",{class:"header-operation-icon",onClick:t[3]||(t[3]=e=>s(pt)({type:7,isNoRate:!0,isCard:!0}))},[m(a,{name:"tools-feedback",size:"18",class:"hob-icon"})])]),default:p(()=>[t[14]||(t[14]=i("div",{class:"text-small text-center w-full"},"打开需求反馈",-1))]),_:1})),s(F)?c("",!0):(o(),v(d,{key:5})),i("span",{class:"versionInfo mx-[8px] bt-hover-link cursor-pointer",onClick:t[4]||(t[4]=(...e)=>s(E).histVersionInfoDialog&&s(E).histVersionInfoDialog(...e))}," v"+r((s(D).isBeta?"Beta ":"")+(s(O)||"获取中")),1),m(d),m(N,{class:"mr-[8px]","is-dot":"",hidden:1!==s(D).upgrade||s(D).hideBadge},{default:p(()=>[i("span",{class:"bt-link header-operation-btn",title:"点击获取最新版面板程序",onClick:t[5]||(t[5]=(...e)=>s(E).updateVersionDialog&&s(E).updateVersionDialog(...e))},[m(a,{name:"tools-update",size:"18",class:"hob-icon"}),t[15]||(t[15]=i("span",null,"更新",-1))])]),_:1},8,["hidden"]),i("span",{class:"bt-link header-operation-btn mr-[8px]",title:"修复面板会获取最新的面板代码程序，包含bug修复",onClick:t[6]||(t[6]=(...e)=>s(E).onRepair&&s(E).onRepair(...e))},[m(a,{name:"tools-repair",size:"18",class:"hob-icon"}),t[16]||(t[16]=i("span",null,"修复",-1))]),i("span",{class:"bt-link header-operation-btn",title:"点击可选择重启面板或重启服务器",onClick:t[7]||(t[7]=(...e)=>s(E).restartSeverDialog&&s(E).restartSeverDialog(...e))},[m(a,{name:"tools-restart",size:"18",class:"hob-icon"}),t[17]||(t[17]=i("span",null,"重启",-1))])])])}}}),[["__scopeId","data-v-eb3c6045"]]);const ta=new class{constructor(){this.watchList=new Map;const e=Bt();this.refs=d(e),this.useHomeData()}useRunCallback(){for(const[e,t]of this.watchList.entries())e in this.refs&&t(this.refs[e].value)}async useHomeData(){this.stopWatching=C(this.refs.isRefreshData,e=>{e&&(this.useRunCallback(),this.refs.isRefreshData.value=!1)},{immediate:!0})}useSetCallback(e,t){this.watchList.set(e,t)}stopUseHomeData(){this.stopWatching&&this.stopWatching()}unload(){this.watchList.size>0&&this.watchList.clear(),this.stopUseHomeData()}async getFirewallStatus(){Ce({area:45,component:()=>Se(()=>import("./index340.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})}},aa=S("NOTICE-STORE",()=>{const{panel:e}=we(),a=I(),l=t({memRealUsed:0,memTotal:0,memFree:0,memShared:0,memAvailable:0,memBuffers:0,memCached:0,memNewRealUsed:"0",memNewTotal:"0",memNewRealUsedList:[],memNewTotalList:[]}),s=t([]),o=t(!1),n=t(!1),i=t(!1),r=t(!1),c=t([]),d=t([]),m=u(()=>8888===e.value.port&&!e.value.noticeIgnore.port),p=u(()=>!(window.location.protocol.indexOf("https")>=0||e.value.noticeIgnore.https)),v=u(()=>o.value||n.value||m.value||p.value||i.value||r.value);ta.useSetCallback("memory",e=>{l.value=e;const{memTotal:t,memRealUsed:a}=l.value,s=t-a;o.value=s<64}),ta.useSetCallback("diskUsage",e=>{d.value=e,f()}),ta.useSetCallback("disk",e=>{s.value=e;s.value.some(e=>parseInt(e.data.inodes[3])>90)?(r.value=!0,c.value=[],c.value=s.value.map(e=>{if(parseInt(e.data.inodes[3])>90)return e.data.path})):r.value=!1});const f=()=>{d.value&&Number(d.value[2])<524288&&(i.value=!0)};return{noticeStatus:v,memoryStatus:o,usernameStatus:n,portStatus:m,httpsStatus:p,diskFullStatus:i,inodeFullStatus:r,inodePath:c,setNoticeStatus:async(t,a)=>{try{await Re({title:"忽略通知",content:"是否忽略".concat(a,"通知，不再提醒？")});const{data:l}=await De({name:t});e.value.noticeIgnore[t]=!0,Oe().request(l)}catch(l){}},checkFullDisk:f,onClear:async()=>{await Re({type:"calc",title:"释放内存",content:"若您的站点处于有大量访问的状态，释放内存可能带来无法预测的后果，您确定现在就释放内存吗？"}),_e({loading:"正在释放内存，请稍后...",request:vt(),message:!0})},editPortInfo:()=>{window.localStorage.setItem("config-dialog","port"),a.push({path:"/config/common"})},jumpConfig:()=>{window.localStorage.setItem("config-dialog","ssl"),a.push({path:"/config/common"})},jumpFiles:()=>{a.push({path:"/files"})}}}),la={key:0,class:"module-ui !p-0 mx-[1.2rem] mb-[1.2rem]"},sa={class:"mr-16px"},oa=["title"],na=Pe(e({__name:"index",setup(e){const a=aa(),{noticeStatus:u,memoryStatus:f,usernameStatus:g,portStatus:x,httpsStatus:b,diskFullStatus:w,inodeFullStatus:_,inodePath:k}=d(a),C=t(!1);return l(()=>{a.checkFullDisk(),P(()=>{const e=setInterval(async()=>{if(window.$extension){const t=await window.$extension();Ae(t.extensionElement)&&!t.extensionElement&&clearTimeout(e),t.extensionElement&&(t.extensionElement(),C.value=!0,clearTimeout(e))}},1e3)})}),(e,t)=>{const l=Be,d=j,S=M;return o(),n("div",null,[s(u)?(o(),n("div",la,[m(S,{class:"playTips",height:"5.6rem",direction:"vertical"},{default:p(()=>[s(f)?(o(),v(d,{key:1},{default:p(()=>[t[4]||(t[4]=i("i",{class:"svgtofont-el-warning-filled mr-[8px] text-large"},null,-1)),t[5]||(t[5]=i("span",{class:"mr-[16px]"},"当前可用物理内存小于64M，这可能导致MySQL自动停止，站点502等错误，请尝试释放内存！",-1)),m(l,{type:"info",title:"该风险不可忽略，请尽快处理",class:"align-middle mr-[16px]",size:"1.4rem",disabled:!0,href:"javascript:;"},{default:p(()=>[...t[2]||(t[2]=[y("[ 不可忽略 ]",-1)])]),_:1}),m(l,{onClick:s(a).onClear,class:"align-middle flex items-center",size:"1.4rem"},{default:p(()=>[...t[3]||(t[3]=[y("[ 立即清理 ]",-1)])]),_:1},8,["onClick"])]),_:1})):c("",!0),s(g)?(o(),v(d,{key:2},{default:p(()=>[t[8]||(t[8]=i("i",{class:"svgtofont-el-warning-filled mr-[8px] text-large"},null,-1)),t[9]||(t[9]=i("div",{class:"mr-[16px]"},"当前面板用户为admin,这可能为面板安全带来风险！",-1)),m(l,{type:"info",title:"该风险不可忽略，请尽快处理",class:"align-middle mr-[16px]",size:"1.4rem",disabled:!0,href:"javascript:;"},{default:p(()=>[...t[6]||(t[6]=[y("[ 不可忽略 ]",-1)])]),_:1}),m(l,{onClick:s(ft),class:"align-middle flex items-center",size:"1.4rem"},{default:p(()=>[...t[7]||(t[7]=[y("[ 立即修复 ] ",-1)])]),_:1},8,["onClick"])]),_:1})):c("",!0),s(x)?(o(),v(d,{key:3},{default:p(()=>[t[12]||(t[12]=i("i",{class:"svgtofont-el-warning-filled mr-[8px] text-large"},null,-1)),t[13]||(t[13]=i("div",{class:"mr-[16px]"},"当前面板使用的是默认端口[8888]，可能存在入侵风险，请到面板设置中修改面板端口！",-1)),m(l,{type:"info",title:"该风险可忽略，但存在一定的风险，推荐修改面板端口",class:"align-middle mr-[16px]",size:"1.4rem",onClick:t[0]||(t[0]=e=>s(a).setNoticeStatus("port","面板端口"))},{default:p(()=>[...t[10]||(t[10]=[y("[ 点击忽略 ]",-1)])]),_:1}),m(l,{onClick:s(a).editPortInfo,target:"_self",class:"align-middle flex items-center",size:"1.4rem"},{default:p(()=>[...t[11]||(t[11]=[y("[ 立即修复 ] ",-1)])]),_:1},8,["onClick"])]),_:1})):c("",!0),s(b)?(o(),v(d,{key:4},{default:p(()=>[t[16]||(t[16]=i("i",{class:"svgtofont-el-warning-filled mr-[8px] text-large"},null,-1)),t[17]||(t[17]=i("div",{class:"mr-[16px]"},"警告！当前面板使用HTTP访问，可能存在被窃取敏感信息风险，请立即开启【面板SSL】。",-1)),m(l,{type:"info",title:"该风险可忽略，但存在一定的风险，推荐开启面板SSL访问",class:"align-middle mr-[16px]",disabled:!0,size:"1.4rem",onClick:t[1]||(t[1]=e=>s(a).setNoticeStatus("https","面板SSL"))},{default:p(()=>[...t[14]||(t[14]=[y("[ 点击忽略 ]",-1)])]),_:1}),m(l,{onClick:s(a).jumpConfig,class:"align-middle flex items-center",size:"1.4rem"},{default:p(()=>[...t[15]||(t[15]=[y("[ 立即处理 ]",-1)])]),_:1},8,["onClick"])]),_:1})):c("",!0),s(w)?(o(),v(d,{key:5},{default:p(()=>[t[19]||(t[19]=i("i",{class:"svgtofont-el-warning-filled mr-8px text-large"},null,-1)),t[20]||(t[20]=i("div",{class:"mr-16px"},"警告：检测到磁盘可用空间不足，无法访问面板数据库，请前往文件管理清理",-1)),m(l,{onClick:s(a).jumpFiles,class:"align-middle",size:"1.4rem"},{default:p(()=>[...t[18]||(t[18]=[y("[ 立即前往 ]",-1)])]),_:1},8,["onClick"])]),_:1})):c("",!0),s(_)?(o(),v(d,{key:6},{default:p(()=>[t[24]||(t[24]=i("i",{class:"svgtofont-el-warning-filled mr-8px text-large"},null,-1)),i("div",sa,[t[21]||(t[21]=y(" 警告：检测到磁盘【 ",-1)),i("div",{class:"inline-block",title:s(k).join("\n")},[(o(!0),n(L,null,T(s(k),(e,t)=>(o(),n("span",{key:t},r(e),1))),128))],8,oa),t[22]||(t[22]=y(" 】Inode使用率超过90%，可用空间不足，请前往文件管理清理 ",-1))]),m(l,{onClick:s(a).jumpFiles,class:"align-middle",size:"1.4rem"},{default:p(()=>[...t[23]||(t[23]=[y("[ 立即前往 ]",-1)])]),_:1},8,["onClick"])]),_:1})):c("",!0)]),_:1})])):c("",!0),i("div",{id:"extension",class:h(s(C)?"module-ui !p-0 mx-[1.2rem] mb-[1.2rem]":"")},null,2)])}}}),[["__scopeId","data-v-1b882d8e"]]),ia=S("HOME-STATE-STORE",()=>{const e=Bt(),{payment:l,push:s}=we(),{authType:o}=a(l.value),n=t(0),i=t(12),r=t(!1),c=t(!1),d=E("colSpan",6),u=E("diskColSpan",6),p=E("stateHeight","22rem"),v=E("displayMode","single"),f=t([]),y=t("loadPopover"),h=t(!1),g=t(!0),x=t(null);let b=!1;const w=t([]),_=t({one:0,max:0,five:0,fifteen:0}),k=t({occupy:"",framework:"",coresOccupy:[0,0,0],cpuNumber:0,logicCores:0,cores:0,process:[0,0]}),C=t({memRealUsed:0,memTotal:0,memFree:0,memShared:0,memAvailable:0,memBuffers:0,memCached:0,memNewRealUsedList:[],memNewTotalList:[]}),S=t([]),I=B({memory:"success",cpu:"success",load:"success"}),P=t(null),L=t(!1),T=t(null),j=t(null),M=t(null),R=new Fe,D=B({type:"load",title:"负载",range:0}),O=B({type:"cpu",title:"CPU",range:0,desc:"获取中"}),A=B({type:"mem",title:"内存",range:0,desc:"0 / 0(MB)",disabled:!1});ta.useSetCallback("cpuTimes",e=>{S.value=[[{title:"用户级别的 CPU 时间百分比",name:"user",value:e.user},{title:'运行带有 "nice" 优先级的进程时使用的 CPU 时间百分比',name:"nice",value:e.nice}],[{title:"系统级别的 CPU 时间百分比",name:"system",value:e.system},{title:"空闲状态的 CPU 时间百分比",name:"idle",value:e.idle}],[{title:"等待 I/O 操作完成的 CPU 时间百分比",name:"iowait",value:e.iowait},{title:"处理硬件中断的 CPU 时间百分比",name:"irq",value:e.irq}],[{title:"处理软件中断的 CPU 时间百分比",name:"softirq",value:e.softirq},{title:"当前 CPU 被其他虚拟机偷取的CPU时间百分比",name:"steal",value:e.steal}],[{title:"运行虚拟机时使用的 CPU 时间百分比",name:"guest",value:e.guest},{title:'运行带有 "nice" 优先级的虚拟机时使用的CPU时间百分比',name:"guest_nice",value:e.guest_nice}]]}),ta.useSetCallback("load",e=>{_.value=e,V()}),ta.useSetCallback("disk",e=>{w.value=e});const V=()=>{const{one:e,max:t}=_.value,a=parseInt(Math.round(e/t*100).toFixed(0)),l=a>100?100:a;D.range=l<0?0:l,I.load=l>=90?"danger":l>=80?"warning":"success"};ta.useSetCallback("cpu",e=>{k.value=e,z(),(()=>{const{cpuNumber:e,logicCores:t,cores:a}=k.value;O.desc=e&&t&&a?"".concat(a,"核心"):"获取中"})(),F()});const z=()=>{const{occupy:e}=k.value;O.range=parseInt(e)||0,O.range>80?I.cpu="warning":O.range>90?I.cpu="danger":I.cpu="success"},F=()=>{let e=[],t=0,a="核心 ",l="";for(let s=0;s<k.value.coresOccupy.length;s++)if(t<2){if(t++,s===k.value.coresOccupy.length-1){a+="".concat(s+1," "),l+="".concat(parseFloat(k.value.coresOccupy[s]).toFixed(1),"% "),e.push({name:a,value:l});break}a+="".concat(s+1," / "),l+="".concat(parseFloat(k.value.coresOccupy[s]).toFixed(1),"% / "),k.value.coresOccupy.length%2==1&&s===k.value.coresOccupy.length-1&&e.push({name:a,value:l})}else t=0,a+="".concat(s+1),l+="".concat(parseFloat(k.value.coresOccupy[s]).toFixed(1),"%"),e.push({name:a,value:l}),a="核心 ",l="";f.value=e};ta.useSetCallback("memory",e=>{C.value=e,H()});const H=()=>{const{memRealUsed:e,memTotal:t,memNewRealUsedList:a,memNewTotalList:l}=C.value;if(h.value)return;const s=parseInt((Math.round(e/t*1e3)/10).toFixed(0));I.memory=s>=80?"warning":s>=90?"danger":"success",A.type="mem",A.range=s,A.desc={used:null==a?void 0:a[0],used_unit:null==a?void 0:a[1],total:null==l?void 0:l[0],total_unit:null==l?void 0:l[1]}},N=async()=>{try{(()=>{let e="";h.value=!0,g.value=!1,A.disabled=!0,x.value=setInterval(()=>{let{range:t}=A;e="..."===e?".":"".concat(e,"."),A.rangeText="释放中".concat(e),t>0&&(t-=.2*t),t=Number(t.toFixed(2)),t<0&&(t=0),A.range=t},400)})();const{data:e}=await vt();(e=>{x.value&&clearInterval(x.value);const t=e.memRealUsed-e.memRealUsed,a=We(t)?t:Ue(t);A.range=1,A.rangeText="已释放\n ".concat(a),setTimeout(()=>{h.value=!1,A.rangeText="",A.disabled=!1,g.value=!0},1500)})(e)}catch(e){}},W=t(),U=B({name:"",path:""}),q=B({loading:!0,list:[],total:0}),G=e=>{Z(!0,e)},K=async e=>{await Re({title:"删除告警任务",isHtml:!0,icon:"warning-filled",iconColor:"warning",content:"删除后将不再告警此条任务，是否继续？"}),await _e({loading:"正在删除告警任务，请稍后...",request:He({task_id:e.id}),message:!0,success:Q})},$=[{title:"钉钉",type:"dingding"},{title:"飞书",type:"feishu"},{title:"邮箱",type:"mail"},{title:"企业微信",type:"weixin"},{title:"微信公众号",type:"wx_account"},{title:"短信通知",type:"sms"},{title:"自定义消息通道",type:"webhook"}],J=t([{label:"标题",prop:"title"},Rt({event:async e=>{const t=e.status,a=e.title;await Re({title:(t?"停用":"启用")+"告警任务【"+a+"】",content:"".concat(t?"停用":"启用","选中的告警任务后，该告警任务将").concat(t?"停止":"开启","告警，是否继续操作？"),icon:"warning-filled"}),await _e({loading:"正在设置告警状态，请稍后...",request:Ne({task_id:e.id,status:t?0:1}),message:!0}),await Q()},width:80,data:["已停用","已启用"]}),{label:"告警方式",width:140,showOverflowTooltip:!0,render:e=>{let t=[];return e.sender.forEach(e=>{const a=s.value.config.find(t=>t.id===e);if(null==a?void 0:a.sender_type){const e=$.find(e=>e.type===a.sender_type);(null==e?void 0:e.title)&&t.push("sms"===a.sender_type?e.title:a.data.title?a.data.title+"(".concat(e.title,")"):e.title)}}),m("span",{class:"truncate"},[t.join("、")])}},{label:"告警条件",render:e=>{const t=e.view_msg.match(/<span>(.*?)<\/span>/);return t?t[1]:""}},Dt([{title:"编辑",onClick:G},{title:"删除",onClick:K}])]),Z=(e,t)=>{Ce({title:"进程告警",area:[80],btn:["保存","取消"],component:()=>Se(()=>import("./index120.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:{isEdit:e,row:t||{},diyProcessTemplate:!0,diyProcessTemplateTid:["60","61","62"],onRefresh:Q}})},Q=async()=>{var e;const{data:t}=await ze();q.list=(null==(e=null==t?void 0:t.data)?void 0:e.filter(e=>["60","61","62"].includes(e.template_id)))||[],q.list.length>0||Z(!1),q.loading=!1};return{stateMainWidth:n,gutter:i,isBreakLines:r,isShowAllDisk:c,colSpan:d,diskColSpan:u,stateHeight:p,displayMode:v,cpuCoreDesc:f,statePopoverTimr:P,loadInfo:D,loadPopover:T,processAlarmShow:L,tagsType:I,load:_,cpu:k,loadInfoList:S,cpuInfo:O,cpuPopover:j,memoryInfo:A,memoryPopover:M,memory:C,disk:w,getProcessAlarm:async()=>{const{data:e}=await Ve({sName:"task_manager"});e.setup?L.value=!0:L.value=!1},moveStatePopover:async(t,a)=>{if(y.value=a,"ltd"!==o.value)return;const l=async()=>{b||(b=!0,await e.getHomeProcessInfo(),b=!1)};P.value=setInterval(l,5e3),R.removePending({method:"post",url:"/monitor/process_management/specific_resource_load_type"}),await l()},removeStatePopover:()=>{clearInterval(P.value)},onClearMemory:async()=>{try{await Re({type:"calc",title:"释放内存",content:"若您的站点处于有大量访问的状态，释放内存可能带来无法预测的后果，您确定现在就释放内存吗？"}),N()}catch(e){}},$reset:()=>{R.reset(),clearInterval(P.value),clearInterval(x.value)},setPsFormRef:W,setPsForm:U,onConfirmPs:e=>{_e({loading:"正在修改备注，请稍后...",request:yt(U),message:!0,success:t=>{t.status&&e()}})},processAlarmTableColumn:J,processTableData:q,openProcessAlarm:Z,initAlarm:Q,hoverType:y,isClearMemory:h,showMemoryDesc:g}}),ra=S("HOME-STATE-POPOVER-STORE",()=>{var e;const l=Bt(),{specificResource:s,diskQuota:o}=d(l),{payment:n,push:i,getAlarmData:r}=we(),{authType:c}=a(n.value),u=ia(),{setPsForm:p}=d(u),v=t(),f=t(),y=t();let h=null;const g=[{desc:"运行堵塞",val:90,color:"#dd2f00"},{desc:"运行缓慢",val:80,color:"#ff9900"},{desc:"运行正常",val:70,color:"var(--el-color-primary)"},{desc:"运行流畅",val:30,color:"var(--el-color-primary)"}],x=t("show"),b=t("two"),w=B({loading:!0,list:[]}),_=t((null==(e=i.value)?void 0:e.alarmPopupData)||[]),k={load:{title:"负载",id:"22"},cpu:{title:"cpu",id:"21"},mem:{title:"内存",id:"23"},disk:{title:"磁盘",id:"20"}},C=t({});t();const S=async e=>{var t;C.value={...e,id:e.id||k[null==(t=e.type)?void 0:t.split("-")[0]].id},Ce({title:"告警设置",component:()=>Se(()=>import("./alarm-config.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),area:60,btn:"保存",onConfirm:O,onCancel:()=>{r()}})},I=e=>{let t,a,l;switch(e){case"load":a="平均负载超过";break;case"mem":a="内存超过";break;case"cpu":a="平均CPU超过"}const s=L(e);return t=s.cycle,l=s.count,a||(a=s.text),Ke(t)||Ke(a)?"":"".concat((null==e?void 0:e.includes("disk"))?"":"".concat(t,"分钟内")).concat(a).concat(l,"触发")},P=e=>{var t;const a=k[e.split("-")[0]];return!!Array.isArray(_.value)&&(null==(t=_.value)?void 0:t.find(t=>(null==e?void 0:e.includes("disk"))?t.template_id===a.id&&t.task_data.project===e.split("-")[1]:t.template_id===a.id))},L=e=>{let t,a,l;const s=P(e);if(s){const o=s.task_data;t=o.cycle,l="".concat(o.count,"%"),e.includes("disk")&&o.project===e.split("-")[1]&&(a=2===o.cycle?"该磁盘用量超过":"该磁盘余量不足",l=2===o.cycle?"".concat(o.count,"%"):"".concat(o.count,"GB"))}return{cycle:t,text:a,count:l}},T=t(!1),j=t(),M=B({num:0,usageRate:0,give:[],option:{},type:"",selectOptions:[],typeDetection:"2",next_data:[]}),E=t(100),R=t([]),D=t([]),O=async()=>{await j.value.validate();const{type:e,data:t,id:a}=C.value;let l={task_data:{...t||{},type:e.includes("disk")?e.split("-")[0]:e,count:parseInt("".concat(M.usageRate)),cycle:e.includes("disk")?parseInt(M.typeDetection):5,project:e.split("-")[1]?e.split("-")[1]:"",next_data:M.next_data},time_rule:{send_interval:0,time_range:[0,86399]},number_rule:{day_num:parseInt("".concat(M.num)),total:0},sender:M.give};await _e({loading:"正在保存告警配置，请稍后...",request:$e({task_data:JSON.stringify(l),template_id:a}),message:!0,success:async t=>{await r(),I(e)}})},A=t([{label:"磁盘路径",prop:"filesystem",render:e=>m("div",{class:"flex items-center"},[m("span",{class:"svgtofont-file-hdd mr-4px !text-medium align-text-bottom"},null),m("span",null,[e.filesystem])])},{label:"总大小",prop:"size"}]),V=e=>{if("0"===e)return 0;const t=e.match(/^(\d+(?:\.\d+)?)(?: )?([a-zA-Z]+)$/);if(!t)throw new Error("Invalid size format: ".concat(e));const a=parseFloat(t[1]),l=t[2].toUpperCase(),s=["B","KB","MB","G","GB","T","TB"].indexOf(l);if(-1===s)throw new Error("Invalid unit: ".concat(l));return a*Math.pow(1024,s)};return{virtualRef:v,popover:f,popoverContent:y,chartColorActive:(e,t)=>{let a={};for(let l=0;l<g.length;l++){const t=g[l];if(e>=t.val){a={...t};break}if(e<30){a={...g[g.length-1]};break}}return t&&(a.color="#dd2f00"),a.val=e,a},dirEvent:(e,t)=>{"None"!==t?(qe("Path",e),Ge.push({path:"/files"})):ht({name:"sysdisk"})},init:()=>{h=new ResizeObserver(()=>{f.value&&f.value.updatePopper()}),y.value&&h.observe(y.value)},$reset:()=>{h&&y.value&&h.unobserve(y.value)},authType:c,specificResource:s,tableData:w,foldExpand:x,foldActive:b,useHomeTableColumn:(e,a,l)=>t([{label:"进程名称",minWidth:80,render:e=>{const t="备注：".concat(e.explain,"\n启动路径： ").concat(e.exe_path,"\n运行目录：").concat(e.cwd_path,"\n线程数量：").concat(e.num_threads);return m("span",{title:t},[e.proc_name])}},{label:a,prop:l,minWidth:70},{label:"操作",align:"right",fixed:"right",width:50,render:t=>m("span",{class:"cursor-pointer text-primary",onClick:()=>{(async(e,t)=>{if(1!==e.important){const a=t?"结束进程":"释放内存";await Re({type:"calc",title:a,content:"结束".concat(e.proc_name,"进程会导致").concat(e.explain.split("的进程")[0],"无法正常运行，是否结束?")}),await _e({loading:"正在".concat(a,"，请稍后..."),request:xt({pid:e.pid}),message:!0})}})(t,e)}},[1===t.important?"":"cpu_percent"===l?"结束":"释放"])}]),openProcessAlarmDialog:()=>{Ce({title:"进程告警",area:["100","50"],component:()=>Se(()=>import("./process-alarm-manage.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},openProduct:()=>{gt({sourceId:141})},push:i,devTaskList:_,openAlarmPopup:async(e,t)=>{if(0===t.id)S(t);else try{const a=e?"开启":"关闭";!e&&await Re({title:"".concat(a,"告警"),content:"".concat(a,"告警后，将").concat(e?"":"不再","接收到该项的告警信息，是否继续操作？")});const l=P(t.type);await _e({loading:"正在".concat(a,"告警，请稍后..."),request:Ne({task_id:l.id,status:e?1:0}),message:!0,success:r})}catch(a){t.flag=!e,r()}},setAlarmDialog:S,createPushStatus:I,getCurrentTask:P,onConfirm:O,giveFormDisabled:T,giveFormRef:j,msgForm:M,maxCapacityAndUsageRate:E,nextOptions:R,options:D,alarmInfo:async()=>{(async()=>{try{const e=await Je();R.value=e.data.map(e=>({label:e.title,value:e.value}))}catch(e){}})();const{type:e,data:t,id:a}=C.value;t?(M.usageRate=t.count,M.num=t.push_count,M.next_data=t.next_data||[],-1!==e.indexOf("disk")&&(M.typeDetection=t.cycle.toString()),M.give=t.module):(M.usageRate=80,M.num=3,-1!==e.indexOf("disk")&&(M.typeDetection="2"))},rowData:C,mountColumn:A,computedSpace:(e,t)=>{const a=["B","KB","MB","GB","TB"];let l=V(e)-V(t),s=0;for(;l>=1024&&s<a.length-1;)l/=1024,s++;return l=Math.round(100*l)/100,"".concat(l," ").concat(a[s])},setPsDialog:async e=>{p.value.name=e.ps,p.value.path=e.path,Ce({title:"设置磁盘【"+e.path+"】别名",area:45,component:()=>Se(()=>import("./index341.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),btn:!0,onConfirm:u.onConfirmPs})},scanRubbishFile:async e=>{ht({pluginName:"disk_analysis",source:120,type:"ltd"}),qe("diskPath",e),qe("taskStatus","true")},switchTypeDetection:()=>{const{type:e,data:t,id:a}=C.value;M.typeDetection!==t.cycle&&("2"===M.typeDetection?M.usageRate=80:o.value.forEach(t=>{t.diskName===e.split("-")[1]&&(E.value=t.diskQuota,M.usageRate=parseInt((.2*t.diskQuota).toString()))}))}}}),ca={class:"alarm"},da={class:"w-[21rem] ml-[0.8rem]"},ua=Pe(e({__name:"alarm",props:{type:{},diskName:{}},setup(e){const a=e,c=u(()=>a.type),v=ra(),{push:f,devTaskList:h}=d(v);C(()=>f.value.alarmPopupData,e=>{h.value=e},{deep:!0,immediate:!0});const g=t(!1),x=u(()=>{var e;const t={type:c.value,data:!1,id:0,status:!1},a=v.getCurrentTask(c.value);if(a){const l=a.task_data;(null==(e=c.value)?void 0:e.includes("disk"))?(2===l.cycle?"".concat(l.count,"%"):"".concat(l.count,"GB"),g.value=!!a.status,t.status=!!a.status,t.data={...l,module:a.sender,push_count:a.number_rule.day_num},t.id=a.template_id):(g.value=!!a.status,t.status=!!a.status,t.data={...l,module:a.sender,push_count:a.number_rule.day_num},t.id=a.template_id)}return t});return C(()=>x.value,e=>{g.value=e.status},{deep:!0,immediate:!0}),l(()=>{}),(e,t)=>{const a=D,l=Be;return o(),n("div",ca,[t[4]||(t[4]=i("div",null,[i("span",null,"告警")],-1)),m(a,{size:"small",class:"ml-[0.8rem]",modelValue:s(g),"onUpdate:modelValue":t[0]||(t[0]=e=>R(g)?g.value=e:null),onChange:t[1]||(t[1]=e=>s(v).openAlarmPopup(s(g),s(x)))},null,8,["modelValue"]),t[5]||(t[5]=i("div",{class:"switch"},null,-1)),m(l,{onClick:t[2]||(t[2]=e=>s(v).setAlarmDialog(s(x)))},{default:p(()=>[...t[3]||(t[3]=[y("设置",-1)])]),_:1}),i("span",da,r(s(v).createPushStatus(s(c))),1)])}}}),[["__scopeId","data-v-155cf61f"]]),ma={class:""},pa={class:"flex justify-between w-full"},va={class:"px-[8px] text-secondary"},fa={class:"mt-[10px] space-y-[1rem] mx-[8px] text-secondary"},ya={class:"flex justify-between items-center w-full"},ha={class:"px-[8px] text-secondary leading-[3rem] text-center"},ga={class:"space-y-[1rem] text-secondary leading-[1.4rem] px-[0.8rem]"},xa={class:"flex justify-between w-full"},ba={class:"px-[8px] text-secondary leading-[3rem] text-center"},wa={class:"mt-[8px] space-y-[1rem]"},_a={key:0,class:"mb-1rem"},ka={class:"flex items-center justify-center flex-nowrap w-full"},Ca={class:"whitespace-nowrap"},Sa=Pe(e({__name:"popover-content",props:{loadType:{default:""},type:{default:""},processAlarmShow:{type:Boolean,default:!1}},setup(e,{expose:t}){const a=e,{hoverType:l}=d(ia()),f=ra(),{specificResource:g,authType:x,tableData:b,foldExpand:w,foldActive:_}=d(f),k=u(()=>{const{type:e}=a;return-1!==e.indexOf("未挂载")}),S=u(()=>"loadPopover"===l.value||"cpuPopover"===l.value),I=u(()=>f.useHomeTableColumn(S.value,S.value?"CPU占用率":"内存使用率",S.value?"cpu_percent":"memory_usage").value),P=u(()=>"memoryInfo"!==a.loadType),T=u(()=>"diskInfo"!==a.loadType),j=u(()=>{const{loadType:e}=a,t={one:"",two:"",three:""};return t.one="memoryInfo"===e?"内存信息":"基础信息","diskInfo"!==e?S.value?("loadInfo"===e?t.two="更多负载信息":"cpuInfo"===e&&(t.two="核心使用率"),t.three="CPU占用率top5的进程信息"):"memoryInfo"===e&&(t.two="内存信息",t.three="内存使用率top5的进程信息"):t.two="Inode信息",t});return C(()=>g.value,e=>{"ltd"===x.value?(b.value.loading=!1,S.value?b.value.list=g.value.cpuProcess:b.value.list=g.value.memProcess):(b.value.loading=!1,b.value.list=[])},{deep:!0,immediate:!0}),C(()=>x.value,e=>{"ltd"!==e&&(b.value.loading=!1,b.value.list=[])}),t({showTwo:P,showThree:T}),(t,l)=>{const d=F,u=H,g=N,C=Be,S=Ze,M=W,E=O("bt-loading");return o(),v(M,{shadow:"never",class:"card-popover !p-[8px]"},{default:p(()=>[i("div",ma,[A(t.$slots,"button",{},void 0,!0)]),m(u,{class:"text-small",modelValue:s(w),"onUpdate:modelValue":l[0]||(l[0]=e=>R(w)?w.value=e:null),accordion:!0},{default:p(()=>[m(d,{ref:"base-info",name:"show"},{title:p(()=>[i("div",pa,[i("span",va,r(s(j).one),1)])]),default:p(()=>[i("div",fa,[A(t.$slots,"base-info",{},void 0,!0)]),s(k)?c("",!0):(o(),n(L,{key:0},[l[2]||(l[2]=i("hr",{style:{width:"calc(100% - 16px)",margin:"12px auto","border-top":"1px solid var(--el-color-border-extra-light)"}},null,-1)),m(ua,{type:e.type,class:"mx-[8px]"},null,8,["type"])],64))]),_:3},512)]),_:3},8,["modelValue"]),s(k)?c("",!0):(o(),v(u,{key:0,class:"text-small",modelValue:s(_),"onUpdate:modelValue":l[1]||(l[1]=e=>R(_)?_.value=e:null),accordion:!0},{default:p(()=>[s(P)?(o(),v(d,{key:0,name:"two"},{title:p(()=>[i("div",ya,[i("span",ha,r(s(j).two),1),i("span",null,r("two"===s(_)?"收起":"展开"),1)])]),default:p(()=>[i("div",ga,[A(t.$slots,"content-info",{},void 0,!0)])]),_:3})):c("",!0),s(T)?(o(),v(d,{key:1,name:"three",class:h({"!mb-0":!s(P)})},{title:p(()=>[i("div",xa,[i("span",ba,r(s(j).three),1),i("span",null,r("three"===s(_)?"收起":"展开"),1)])]),default:p(()=>[i("div",wa,[i("div",null,[a.processAlarmShow?(o(),n("div",_a,[m(g,{size:"small",onClick:s(f).openProcessAlarmDialog},{default:p(()=>[...l[3]||(l[3]=[y("进程告警",-1)])]),_:1},8,["onClick"])])):c("",!0),V((o(),v(S,{column:s(I),data:s(b).list,"max-height":450},z({_:2},["ltd"!==s(x)?{name:"empty",fn:p(()=>[i("div",ka,[i("span",Ca,[l[5]||(l[5]=y("当前为企业版专享功能, ",-1)),m(C,{onClick:s(f).openProduct},{default:p(()=>[...l[4]||(l[4]=[y("立即购买",-1)])]),_:1},8,["onClick"])])])]),key:"0"}:void 0]),1032,["column","data"])),[[E,s(b).loading]])])])]),_:1},8,["class"])):c("",!0)]),_:3},8,["modelValue"]))]),_:3})}}}),[["__scopeId","data-v-fe406548"]]),Ia={class:"flex items-center justify-between mb-[1.2rem] leading-[2.8rem]"},Pa={class:"flex items-center"},La={class:"flex align-left flex-col"},Ta={class:"flex items-center"},ja=["title"],Ma={class:"flex align-left flex-col"},Ea={class:"mb-[2px]"},Ba={key:0,class:"m-4x flex items-center"},Ra={class:"!my-[1rem]"},Da={class:"!my-[1rem]"},Oa={class:"!my-[1rem]"},Aa=Pe(e({__name:"disk-popover",props:{custom:{type:Boolean,default:!1},item:{default:[]}},setup(e){const t=e,{enterpriseRec:a}=we(),l=ra(),{mountColumn:f}=d(l),g=u(()=>"None"===t.item.data.path),x=u(()=>{const e="string"==typeof t.item.data.size?0:parseFloat(t.item.data.size[3].substring(0,t.item.data.size[3].lastIndexOf("%")));return e>=90?"danger":e>=80?"warning":"success"});return(d,u)=>{const b=q,w=G,_=N,k=K,C=Be,S=Ze;return o(),v(Sa,{"load-type":"diskInfo",type:"disk-".concat(t.item.info.title)},{button:p(()=>[s(g)?c("",!0):(o(),n(L,{key:0},[parseInt(t.item.data.inodes[3])>90?(o(),v(b,{key:0,title:"Inode可用不足10%，请前往文件管理清理不必要文件",type:"error",class:"!mb-8px !min-h-[24px] !py-4px",closable:!1})):c("",!0),i("div",Ia,[i("div",Pa,[u[2]||(u[2]=i("span",{class:"text-secondary text-base mr-[4px] ml-[8px]"},"检测到当前磁盘",-1)),m(w,{type:s(x)},{default:p(()=>[y(r("容量占用".concat(t.item.data.size[3].substring(0,t.item.data.size[3].lastIndexOf("%")),"%")),1)]),_:1},8,["type"])]),V(m(_,{type:"primary",onClick:u[0]||(u[0]=e=>s(l).scanRubbishFile(t.item.info.title))},{default:p(()=>[...u[3]||(u[3]=[y("立即清理",-1)])]),_:1},512),[[U,s(a)]])])],64))]),"base-info":p(()=>[s(g)?(o(),v(S,{key:1,data:e.item.data.list,column:s(f)},null,8,["data","column"])):(o(),n(L,{key:0},[i("div",La,[i("div",Ta,[i("div",{class:"block truncate max-w-[30rem] mb-[2px]",title:"挂载点：".concat(e.item.info.title,"\n备注：").concat(e.item.data.rname)},"挂载点： "+r(e.item.info.title+(e.item.data.rname?" (".concat(e.item.data.rname,")"):"")),9,ja),m(k,{placement:"right",content:"点击设置备注"},{default:p(()=>[i("i",{class:"svgtofont-el-edit text-primary ml-[8px] cursor-pointer",onClick:u[1]||(u[1]=t=>s(l).setPsDialog({ps:e.item.data.rname||e.item.info.title,path:e.item.info.title}))})]),_:1})]),i("span",null,r("共：".concat(e.item.data.size[0])+"，可用：".concat(e.item.data.size[2])+"，\t已用：".concat(e.item.data.size[1])),1)]),i("div",Ma,[i("span",Ea," 文件系统："+r(e.item.data.filesystem),1),i("span",null," 类型："+r(e.item.data.type+"，系统占用：".concat(e.item.data.size[3])),1)]),"None"!==e.item.data.d_size?(o(),n("div",Ba,[i("span",null," 磁盘大小："+r(e.item.data.d_size),1),m(k,{class:"item",effect:"dark",content:"根据系统设置的不同，如分区/SWAP/LVM/扩容，可能显示大小不一致，点击查看详情",placement:"top-start"},{default:p(()=>[i("span",null,[m(C,{class:"bt-ico-ask ml-3",href:"https://www.bt.cn/bbs/thread-136532-1-1.html",target:"_blank"},{default:p(()=>[...u[4]||(u[4]=[y("?",-1)])]),_:1})])]),_:1})])):c("",!0)],64))]),"content-info":p(()=>[i("p",Ra,"总数："+r(e.item.data.inodes[0]),1),i("p",Da,"已用："+r(e.item.data.inodes[1]),1),i("p",Oa,"可用："+r(e.item.data.inodes[2]),1),i("p",{class:h(["!my-[1rem]",{"text-warning":parseInt(t.item.data.inodes[3])>90&&parseInt(t.item.data.inodes[3])<100,"text-danger":100===parseInt(t.item.data.inodes[3])}])}," 使用率："+r(e.item.data.inodes[3]+(e.item.data.inodes[3].includes("%")?"":"%")),3)]),_:1},8,["type"])}}}),[["__scopeId","data-v-8e7d8285"]]),Va={class:"disk-info flex flex-col items-start flex-1 min-w-0"},za={class:"disk-title text-default text-small md:text-2xl font-semibold mb-2 break-all truncate w-full"},Fa={class:"disk-desc text-small text-gray-500 break-all mb-1 truncate w-full"},Ha={class:"disk-progress ml-5 flex items-center justify-center"},Na={class:"flex flex-col items-center text-small"},Wa={class:"text-medium"},Ua={class:"flex items-center justify-between mb-[1.2rem] leading-[2.8rem]"},qa={class:"flex items-center"},Ga={class:"flex align-left flex-col"},Ka={class:"flex items-center"},$a=["title"],Ja=["onClick"],Za={class:"flex align-left flex-col"},Qa={key:0,class:"m-4x flex items-center"},Ya={class:"mb-[2px]"},Xa={class:"!my-[1rem]"},el={class:"!my-[1rem]"},tl={class:"!my-[1rem]"},al={key:1,class:"p-4 text-gray-400"},ll=Pe(e({__name:"disk-popover-extends",props:{list:{default:()=>[]},isShowAllDisk:{type:Boolean,default:!1}},setup(e){const t=e,{enterpriseRec:a}=we(),l=ra(),{mountColumn:u}=d(l),f=(e,t)=>{var a;const l=null==(a=e.info)?void 0:a.range;return Number(l)>90?"var(--el-color-danger)":Number(l)>80?"var(--el-color-warning)":"var(--el-color-primary)"},g=e=>{const t="string"==typeof e.data.size?0:parseFloat(e.data.size[3].substring(0,e.data.size[3].lastIndexOf("%")));return t>=90?"danger":t>=80?"warning":"success"};return(e,d)=>{const b=J,w=q,_=G,k=N,C=K,S=Be,I=Ze,P=x;return t.list&&t.list.length?(o(!0),n(L,{key:0},T(t.list,(e,x)=>{var T;return o(),v(P,{key:(null==(T=null==e?void 0:e.info)?void 0:T.title)?e.info.title+"-"+x:x,trigger:"hover",width:400,placement:"bottom-start",teleported:!1,"popper-class":"el-popover-shadow","show-after":100,"hide-after":0},{reference:p(()=>{var a,l,s,c,u,v,g,x,w,_,k,C,S,I;return[i("div",{class:h([t.isShowAllDisk?"p-[1rem]":"px-[1rem]","flex items-center justify-between min-w-0 cursor-pointer transition-colors hover:bg-lighter rounded-medium"])},[i("div",Va,[i("div",za,r((null==(a=e.info)?void 0:a.title)||"-"),1),i("div",Fa,["object"==typeof(null==(l=e.info)?void 0:l.desc)&&"disk"===(null==(s=e.info)?void 0:s.type)?(o(),n(L,{key:0},[i("span",{style:$({color:null==(c=e.info)?void 0:c.color})},r(null==(v=null==(u=e.info)?void 0:u.desc)?void 0:v.used)+" "+r(null==(x=null==(g=e.info)?void 0:g.desc)?void 0:x.used_unit),5),d[0]||(d[0]=i("span",null," / ",-1)),i("span",null,r(null==(_=null==(w=e.info)?void 0:w.desc)?void 0:_.total)+" "+r(null==(C=null==(k=e.info)?void 0:k.desc)?void 0:C.total_unit),1)],64)):(o(),n(L,{key:1},[y(r((null==(S=e.info)?void 0:S.desc)||"-"),1)],64))])]),i("div",Ha,[m(b,{"show-text":!0,type:"circle",width:50,"stroke-width":6,color:f(e),percentage:(null==(I=e.info)?void 0:I.range)||0},{default:p(({percentage:t})=>[i("div",Na,[i("span",{class:"percentage-value",style:$({color:f(e)})},[i("span",Wa,r(t),1),d[1]||(d[1]=y("% ",-1))],4)])]),_:2},1032,["color","percentage"])])],2)]}),default:p(()=>[e&&e.data&&e.info?(o(),v(Sa,{key:0,"load-type":"diskInfo",type:"disk-".concat(e.info.title),item:e},{button:p(()=>["None"!==e.data.path?(o(),n(L,{key:0},[parseInt(e.data.inodes[3])>90?(o(),v(w,{key:0,title:"Inode可用不足10%，请前往文件管理清理不必要文件",type:"error",class:"!mb-8px !min-h-[24px] !py-4px",closable:!1})):c("",!0),i("div",Ua,[i("div",qa,[d[2]||(d[2]=i("span",{class:"text-secondary text-base mr-[4px] ml-[8px]"},"检测到当前磁盘",-1)),m(_,{type:g(e)},{default:p(()=>[y(r("容量占用".concat(e.data.size[3].substring(0,e.data.size[3].lastIndexOf("%")),"%")),1)]),_:2},1032,["type"])]),V(m(k,{type:"primary",onClick:t=>s(l).scanRubbishFile(e.info.title)},{default:p(()=>[...d[3]||(d[3]=[y("立即清理",-1)])]),_:1},8,["onClick"]),[[U,s(a)]])])],64)):c("",!0)]),"base-info":p(()=>["None"!==e.data.path?(o(),n(L,{key:0},[i("div",Ga,[i("div",Ka,[i("div",{class:"block truncate max-w-[30rem]",title:"挂载点：".concat(e.info.title,"\n备注：").concat(e.data.rname)},"挂载点： "+r(e.info.title+(e.data.rname?" (".concat(e.data.rname,")"):"")),9,$a),m(C,{placement:"right",content:"点击设置备注"},{default:p(()=>[i("i",{class:"svgtofont-el-edit text-primary ml-[8px] cursor-pointer",onClick:t=>s(l).setPsDialog({ps:e.data.rname||e.info.title,path:e.info.title})},null,8,Ja)]),_:2},1024)]),i("span",null,r("共：".concat(e.data.size[0],"，可用：").concat(e.data.size[2],"，\t已用：").concat(e.data.size[1])),1)]),i("div",Za,[i("span",null," 文件系统："+r(e.data.filesystem),1),i("span",null," 类型："+r(e.data.type+"，系统占用：".concat(e.data.size[3])),1)]),"None"!==e.data.d_size?(o(),n("div",Qa,[i("span",Ya," 磁盘大小："+r(e.data.d_size),1),m(C,{class:"item",effect:"dark",content:"根据系统设置的不同，如分区/SWAP/LVM/扩容，可能显示大小不一致，点击查看详情",placement:"top-start"},{default:p(()=>[i("span",null,[m(S,{class:"bt-ico-ask ml-3",href:"https://www.bt.cn/bbs/thread-136532-1-1.html",target:"_blank"},{default:p(()=>[...d[4]||(d[4]=[y("?",-1)])]),_:1})])]),_:1})])):c("",!0)],64)):(o(),v(I,{key:1,data:e.data.list,column:s(u)},null,8,["data","column"]))]),"content-info":p(()=>[i("p",Xa,"总数："+r(e.data.inodes[0]),1),i("p",el,"已用："+r(e.data.inodes[1]),1),i("p",tl,"可用："+r(e.data.inodes[2]),1),i("p",{class:h(["!my-[1rem]",{"text-warning":parseInt(e.data.inodes[3])>90&&parseInt(e.data.inodes[3])<100,"text-danger":100===parseInt(e.data.inodes[3])}])}," 使用率："+r(e.data.inodes[3]+(e.data.inodes[3].includes("%")?"":"%")),3)]),_:2},1032,["type","item"])):(o(),n("div",al,"无数据"))]),_:2},1024)}),128)):c("",!0)}}}),[["__scopeId","data-v-a44f2c40"]]),sl={class:"w-full"},ol={class:"flex items-center justify-between mb-[1.2rem] leading-[2.8rem]"},nl={class:"flex items-center"},il={class:"disk-body-list flex justify-between"},rl={id:"load_one"},cl={class:"disk-body-list flex justify-between"},dl={id:"load_cpu_times_num"},ul={class:"disk-item-body",id:"other_info_html"},ml={class:"table table-fixed whitespace-nowrap"},pl=["title"],vl=["title"],fl={class:"flex items-center justify-between mb-[1.2rem] leading-[2.8rem]"},yl={class:"flex items-center"},hl={class:"max-h-[8.2rem] overflow-y-auto"},gl={class:"flex items-center justify-between mb-[1.2rem] leading-[2.8rem]"},xl={class:"flex items-center"},bl={class:"flex align-left flex-col"},wl={class:"flex justify-between mb-[4px]"},_l={class:"w-[50%]"},kl={class:"inline-flex justify-start"},Cl={class:"w-[50%]"},Sl={class:"inline-flex justify-start"},Il={class:"flex justify-between mb-[4px]"},Pl={class:"w-[50%]"},Ll={class:"inline-flex justify-start"},Tl={class:"w-[50%]"},jl={class:"inline-flex justify-start"},Ml={class:"flex justify-between mb-[4px]"},El={class:"w-[50%]"},Bl={class:"w-[50%]"},Rl={class:"inline-flex justify-start"},Dl={class:"disk-grid grid gap-4 w-full box-border",style:{"grid-template-columns":"repeat(3, minmax(0, 1fr))"}},Ol={class:"disk-grid grid gap-4 w-full box-border h-full",style:{"grid-template-columns":"repeat(auto-fill, minmax(220px, 1fr))"}},Al={key:1,class:"module-ui mb-[1.2rem]"},Vl={class:"module-ui-body mt-[1.2rem]"},zl={class:"flex items-center justify-between mb-[1.2rem] leading-[2.8rem]"},Fl={class:"flex items-center"},Hl={class:"disk-body-list flex justify-between"},Nl={id:"load_one"},Wl={class:"disk-body-list flex justify-between"},Ul={id:"load_cpu_times_num"},ql={class:"disk-item-body",id:"other_info_html"},Gl={class:"table table-fixed whitespace-nowrap"},Kl=["title"],$l=["title"],Jl={class:"flex items-center justify-between mb-[1.2rem] leading-[2.8rem]"},Zl={class:"flex items-center"},Ql={class:"max-h-[8.2rem] overflow-y-auto"},Yl={class:"flex items-center justify-between mb-[1.2rem] leading-[2.8rem]"},Xl={class:"flex items-center"},es={class:"flex align-left flex-col"},ts={class:"flex justify-between mb-[4px]"},as={class:"w-[50%]"},ls={class:"inline-flex justify-start"},ss={class:"w-[50%]"},os={class:"inline-flex justify-start"},ns={class:"flex justify-between mb-[4px]"},is={class:"w-[50%]"},rs={class:"inline-flex justify-start"},cs={class:"w-[50%]"},ds={class:"inline-flex justify-start"},us={class:"flex justify-between mb-[4px]"},ms={class:"w-[50%]"},ps={class:"w-[50%]"},vs={class:"inline-flex justify-start"},fs="home_state_layout_cache",ys=Pe(e({__name:"index",props:{mainWidth:{}},setup(e){const{globalTheme:a}=we(),f=g(()=>"default"===a.value.home.overview_view?Se(()=>import("./main2.js?v=1763689792"),__vite__mapDeps([]),import.meta.url):Se(()=>import("./main-tile.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)),x=g(()=>"default"===a.value.home.overview_view?Se(()=>import("./disk-main.js?v=1763689792"),__vite__mapDeps([]),import.meta.url):Se(()=>import("./disk-main-tile.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)),b=e,w=t(null),_=t(0);Z(w,e=>{if(!e[0])return;const{width:t}=e[0].contentRect;_.value=t});const k={diskCount:-1,containerWidth:-1},S={baseComponentCount:3,minElementWidth:235,elementGap:12,stackMinWidth:460,stackMaxWidth:650,tileMinWidth:600,tileMaxWidth:800,defaultContainerWidth:1200,maxSingleLineComponents:6,maxHybridDisks:6},I=ia(),{stateMainWidth:P,gutter:j,displayMode:M,stateHeight:E,isBreakLines:B,isShowAllDisk:R,cpuCoreDesc:D,statePopoverTimr:O,loadInfo:A,loadPopover:V,processAlarmShow:z,tagsType:F,load:H,cpu:W,loadInfoList:U,cpuInfo:q,cpuPopover:K,memoryInfo:J,memoryPopover:te,memory:ae,disk:le}=d(I),se=t(null);Z(se,e=>{const t=e[0],{width:a}=t.contentRect;P.value=a}),u(()=>"single"===M.value&&B.value);const oe=sessionStorage.getItem(fs);if(oe)try{const e=JSON.parse(oe);M.value=e.displayMode,E.value=e.stateHeight,B.value=e.isBreakLines,R.value=e.isShowAllDisk}catch(me){sessionStorage.removeItem(fs)}const ne=(e,t,a,l)=>{M.value=e,E.value=t,B.value=a,R.value=l;const s={displayMode:e,stateHeight:t,isBreakLines:a,isShowAllDisk:l};try{sessionStorage.setItem(fs,JSON.stringify(s))}catch(me){}},ie=()=>{const e=P.value||b.mainWidth||S.defaultContainerWidth,t=(le.value||[]).length;if(k.diskCount===t&&k.containerWidth===e)return;k.diskCount=t,k.containerWidth=e;const a=S.baseComponentCount,l=a+t,s=S.minElementWidth,o=S.elementGap;if(e>=s*l+o*(l-1)){if((e-o*(l-1))/l>=s)return void ne("single","18rem",!1,!1)}if(t>=2&&t<=4){if(e>=s*a+S.stackMinWidth+o*a){if((e-S.stackMinWidth-o*a)/a>=s)return void ne("stack","22rem",!1,!1)}}if(t>=5&&t<=6){if(e>=s*a+S.tileMinWidth+o*a)return void ne("tile","22rem",!1,!1)}if(t>6){const l=t-6;return e>=(a+l+1-1)*o+(a+l)*s+S.tileMinWidth?void ne("hybrid","22rem",!1,!0):void ne("tile","18rem",!0,!0)}ne("single","18rem",!0,t>6)},re=u(()=>"".concat(H.value.one.toFixed(2)," / ").concat(H.value.five.toFixed(2)," / ").concat(H.value.fifteen.toFixed(2))),ce=u(()=>{const{process:e}=W.value;return Array.isArray(e)?"".concat(e[0]," / ").concat(e[1]):"获取中"});Q(ie),C(()=>O.value,(e,t)=>{clearInterval(e)},{immediate:!0}),C(()=>[(le.value||[]).length,P.value],([e,t])=>{if(0===t)return;if(k.diskCount!==e||k.containerWidth!==t){const{baseComponentCount:a,minElementWidth:l,elementGap:s,stackMinWidth:o,tileMinWidth:n}=S,i=a*l+(a-1)*s,r=t-i-s;let c="single";if(e>Math.floor(r/(l+s))&&(c=e>=5?t>=i+n?"tile":"stack":t>=i+o?"stack":"single"),e>6&&"single"!==c){const o=e-6;(t-n-(a+o+1)*s)/(a+o)>=l&&(c="hybrid")}ne(c,E.value,B.value,R.value),k.diskCount=e,k.containerWidth=t}},{immediate:!0,deep:!0}),l(async()=>{ut({promises:[I.getProcessAlarm],delay:1e3}),ie()}),Y(I.$reset);const de=e=>{const t=P.value||b.mainWidth||S.defaultContainerWidth,a=S.elementGap;if(M.value,"single"===M.value){if(B.value){const e=S.baseComponentCount+(le.value||[]).length,l=ue(t,e,a),s="calc((100% - ".concat(a*(l-1),"px) / ").concat(l,")");return{flex:"1 0 ".concat(s),minWidth:"".concat(S.minElementWidth,"px")}}{const e=S.baseComponentCount+(le.value||[]).length,l=t-a*(e-1),s=Math.floor(l/e),o=Math.max(s,S.minElementWidth);return{width:"".concat(o,"px"),minWidth:"".concat(S.minElementWidth,"px"),flexShrink:0}}}if("hybrid"===M.value){const l=(le.value||[]).length-6,s=S.baseComponentCount+l,o=(s+1-1)*a;if("disk-area"===e)return{width:"".concat(S.tileMinWidth,"px"),minWidth:"".concat(S.tileMinWidth,"px"),flexShrink:0};{const e=t-S.tileMinWidth-o,a=Math.floor(e/s),l=Math.max(a,S.minElementWidth);return{width:"".concat(l,"px"),minWidth:"".concat(S.minElementWidth,"px"),flexShrink:0}}}{if(B.value)return{width:"100%"};const l="stack"===M.value?S.stackMinWidth:S.tileMinWidth,s="stack"===M.value?S.stackMaxWidth:S.tileMaxWidth,{baseComponentCount:o,minElementWidth:n}=S,i=a*o,r=t-n*o-i,c=Math.max(l,Math.min(r,s));let d=(t-c-i)/o;return d<n&&(d=n),"disk-area"===e?{width:"".concat(c,"px"),minWidth:"".concat(l,"px"),flexShrink:0}:{width:"".concat(d,"px"),minWidth:"".concat(n,"px"),flexShrink:0}}},ue=(e,t,a)=>{const l=S.minElementWidth;for(let s=Math.min(t,6);s>=1;s--){if(l*s+a*(s-1)<=e)return s}return 1};return(e,t)=>{const l=G,d=N,u=X,g=ee;return o(),n("div",sl,["default"===s(a).home.overview_view?(o(),n("div",{key:0,ref_key:"stateMainRef",ref:se},[i("div",{class:h(["state-container flex gap-[1.2rem] mb-[1.2rem]",{"flex-wrap":s(B),"flex-nowrap":!s(B)}])},[i("div",{style:$(de("load")),ref_key:"loadRef",ref:w,class:h(["state-component",s(R)?"flex-1":""])},[m(s(f),{style:$({height:s(E)}),info:s(A),"main-width":s(_),onShow:t[0]||(t[0]=e=>s(I).moveStatePopover(s(V),"loadPopover")),onHide:s(I).removeStatePopover,href:"https://www.bt.cn/bbs/thread-11402-1-1.html"},{default:p(()=>[m(Sa,{"load-type":"loadInfo",ref_key:"loadPopover",ref:V,type:"load","process-alarm-show":s(z)},{button:p(()=>[i("div",ol,[i("div",nl,[t[6]||(t[6]=i("span",{class:"text-secondary text-base mr-[4px] ml-[8px]"},"检测到当前负载",-1)),m(l,{type:s(F).load},{default:p(()=>[y(r("运行达到".concat(s(A).range,"%")),1)]),_:1},8,["type"])])])]),"base-info":p(()=>[i("div",il,[t[7]||(t[7]=i("div",null,"最近1/5/15分钟平均负载：",-1)),i("div",rl,r(re.value),1)]),i("div",cl,[t[8]||(t[8]=i("div",null,"活动进程数 / 总进程数:",-1)),i("div",dl,r(ce.value),1)])]),"content-info":p(()=>[i("div",ul,[i("table",ml,[i("tbody",null,[(o(!0),n(L,null,T(s(U),(e,t)=>(o(),n("tr",{key:t},[(o(!0),n(L,null,T(e,(e,t)=>(o(),n(L,{key:t},[i("td",{title:e.title,class:"break-all text-ellipsis p-[.4rem] pl-0"},[i("span",null,r(e.name),1)],8,pl),i("td",{title:e.title,class:"break-all text-ellipsis"},[i("span",null,r(e.value),1)],8,vl)],64))),128))]))),128))])])])]),_:1},8,["process-alarm-show"])]),_:1},8,["style","info","main-width","onHide"])],6),i("div",{style:$(de("cpu")),class:h(["state-component",s(R)?"flex-1":""])},[m(s(f),{style:$({height:s(E)}),info:s(q),type:"cpu","main-width":s(_),onShow:t[1]||(t[1]=e=>s(I).moveStatePopover(s(K),"cpuPopover")),onHide:s(I).removeStatePopover},{default:p(()=>[m(Sa,{"load-type":"cpuInfo",type:"cpu",ref_key:"cpuPopover",ref:K,"process-alarm-show":s(z)},{button:p(()=>[i("div",fl,[i("div",yl,[t[9]||(t[9]=i("span",{class:"text-secondary text-base mr-[4px] ml-[8px]"},"检测到当前CPU使用率",-1)),m(l,{type:s(F).cpu},{default:p(()=>[y(r("占用".concat(s(q).range,"%")),1)]),_:1},8,["type"])])])]),"content-info":p(()=>[i("div",hl,[(o(!0),n(L,null,T(s(D),(e,t)=>(o(),n("div",{key:t,class:"flex direction-row items-center justify-between my-[1rem]"},[i("span",null,r(e.name),1),i("span",null,r(e.value),1)]))),128))])]),"base-info":p(()=>[i("p",null,r(s(W).framework),1),i("p",null,r("".concat(s(W).cpuNumber,"个物理CPU，").concat(s(W).logicCores,"个物理核心，").concat(s(W).cores,"个逻辑核心")),1)]),_:1},8,["process-alarm-show"])]),_:1},8,["style","info","main-width","onHide"])],6),i("div",{style:$(de("mem")),class:h(["state-component",s(R)?"flex-1":""])},[m(s(f),{style:$({height:s(E)}),type:"mem",info:s(J),"main-width":s(_),onShow:t[2]||(t[2]=e=>s(I).moveStatePopover(s(te),"memoryPopover")),onHide:s(I).removeStatePopover},{default:p(()=>[m(Sa,{"load-type":"memoryInfo",type:"mem",ref_key:"memoryPopover",ref:te,"process-alarm-show":s(z)},{button:p(()=>[i("div",gl,[i("div",xl,[t[10]||(t[10]=i("span",{class:"text-secondary text-base mr-[4px] ml-[8px]"},"检测到当前内存",-1)),m(l,{type:s(F).memory},{default:p(()=>[y(r("占用".concat(s(J).range,"%")),1)]),_:1},8,["type"])]),m(d,{type:"primary",onClick:s(I).onClearMemory},{default:p(()=>[...t[11]||(t[11]=[y("立即释放",-1)])]),_:1},8,["onClick"])])]),"base-info":p(()=>[i("div",bl,[i("div",wl,[i("div",_l,[t[12]||(t[12]=i("span",{class:"w-[81px] inline-flex justify-end"},"空闲内存：",-1)),i("span",kl,r(s(ae).memFree+" MB"),1)]),i("div",Cl,[t[13]||(t[13]=i("span",{class:"w-[81px] inline-flex justify-end"},"已用：",-1)),i("span",Sl,r(s(ae).memRealUsed+" MB"),1)])]),i("div",Il,[i("div",Pl,[t[14]||(t[14]=i("span",{class:"w-[81px] inline-flex justify-end"},"总内存：",-1)),i("span",Ll,r(s(ae).memTotal+" MB"),1)]),i("div",Tl,[t[15]||(t[15]=i("span",{class:"w-[81px] inline-flex justify-end"},"共享：",-1)),i("span",jl,r(s(ae).memShared+" MB"),1)])]),i("div",Ml,[i("div",El,[t[16]||(t[16]=i("span",{class:"w-[81px] inline-flex justify-end"},"可分配内存：",-1)),i("span",null,r(s(ae).memAvailable+"MB"),1)]),i("div",Bl,[t[17]||(t[17]=i("span",{class:"w-[81px] inline-flex justify-end"},"buff/cache：",-1)),i("span",Rl,r(s(ae).memCached+"/"+s(ae).memBuffers+" MB"),1)])])])]),_:1},8,["process-alarm-show"])]),_:1},8,["style","info","main-width","onHide"])],6),"single"===s(M)?(o(!0),n(L,{key:0},T(s(le),(e,t)=>(o(),n("div",{key:t,style:$(de("disk")),class:"state-component"},[m(s(f),{style:$({height:s(E)}),type:"disk",info:e.info,"main-width":s(_),onHide:s(I).removeStatePopover,data:e.data,alert:"None"!==e.data.path&&100===parseInt(e.data.inodes[3])},{default:p(()=>[m(Aa,{item:e},null,8,["item"])]),_:2},1032,["style","info","main-width","onHide","data","alert"])],4))),128)):"hybrid"===s(M)?(o(),n(L,{key:1},[(o(!0),n(L,null,T(s(le).slice(0,s(le).length-6),(e,t)=>(o(),n("div",{key:"hybrid-disk-".concat(t),style:$(de("disk")),class:"state-component"},[m(s(f),{style:$({height:s(E)}),type:"disk",info:e.info,"main-width":s(_),onHide:s(I).removeStatePopover,data:e.data,alert:"None"!==e.data.path&&100===parseInt(e.data.inodes[3])},{default:p(()=>[m(Aa,{item:e},null,8,["item"])]),_:2},1032,["style","info","main-width","onHide","data","alert"])],4))),128)),i("div",{style:$(de("disk-area")),class:"state-component"},[i("div",{class:"module-ui rounded-medium p-[2.4rem]",style:$({height:s(E)})},[i("div",Dl,[m(ll,{list:s(le).slice(s(le).length-6),"is-show-all-disk":s(R)},null,8,["list","is-show-all-disk"])])],4)],4)],64)):(o(),n("div",{key:2,style:$(de("disk-area")),class:"state-component"},["stack"===s(M)?(o(),v(s(x),{key:0,list:s(le),class:"bg-white shadow rounded",style:$({height:s(E)})},null,8,["list","style"])):"tile"===s(M)?(o(),n("div",{key:1,class:"module-ui rounded-medium p-[2.4rem]",style:$({height:s(R)?"auto":s(E)})},[i("div",Ol,[m(ll,{list:s(R)?s(le):s(le).slice(0,6),"is-show-all-disk":s(R)},null,8,["list","is-show-all-disk"])])],4)):c("",!0)],4))],2)],512)):"tile"===s(a).home.overview_view?(o(),n("div",Al,[t[30]||(t[30]=i("div",{class:"module-ui-header"},[i("div",{class:"flex w-full justify-between"},[i("span",{class:"font-alibaba-semibold"},"状态")])],-1)),i("div",Vl,[m(g,{span:24,class:"w-full"},{default:p(()=>[m(u,{class:"state-component",span:4,xs:12,sm:6,md:6,lg:4,xl:4},{default:p(()=>[m(s(f),{info:s(A),onShow:t[3]||(t[3]=e=>s(I).moveStatePopover(s(V),"loadPopover")),onHide:s(I).removeStatePopover,href:"https://www.bt.cn/bbs/thread-11402-1-1.html"},{default:p(()=>[m(Sa,{"load-type":"loadInfo",ref_key:"loadPopover",ref:V,type:"load","process-alarm-show":s(z)},{button:p(()=>[i("div",zl,[i("div",Fl,[t[18]||(t[18]=i("span",{class:"text-secondary text-base mr-[4px] ml-[8px]"},"检测到当前负载",-1)),m(l,{type:s(F).load},{default:p(()=>[y(r("运行达到".concat(s(A).range,"%")),1)]),_:1},8,["type"])])])]),"base-info":p(()=>[i("div",Hl,[t[19]||(t[19]=i("div",null,"最近1/5/15分钟平均负载：",-1)),i("div",Nl,r(re.value),1)]),i("div",Wl,[t[20]||(t[20]=i("div",null,"活动进程数 / 总进程数:",-1)),i("div",Ul,r(ce.value),1)])]),"content-info":p(()=>[i("div",ql,[i("table",Gl,[i("tbody",null,[(o(!0),n(L,null,T(s(U),(e,t)=>(o(),n("tr",{key:t},[(o(!0),n(L,null,T(e,(e,t)=>(o(),n(L,{key:t},[i("td",{title:e.title,class:"break-all text-ellipsis p-[.4rem] pl-0"},[i("span",null,r(e.name),1)],8,Kl),i("td",{title:e.title,class:"break-all text-ellipsis"},[i("span",null,r(e.value),1)],8,$l)],64))),128))]))),128))])])])]),_:1},8,["process-alarm-show"])]),_:1},8,["info","onHide"])]),_:1}),m(u,{class:"state-component",span:4,xs:12,sm:6,md:6,lg:4,xl:4},{default:p(()=>[m(s(f),{info:s(q),type:"cpu",onShow:t[4]||(t[4]=e=>s(I).moveStatePopover(s(K),"cpuPopover")),onHide:s(I).removeStatePopover},{default:p(()=>[m(Sa,{"load-type":"cpuInfo",type:"cpu",ref_key:"cpuPopover",ref:K,"process-alarm-show":s(z)},{button:p(()=>[i("div",Jl,[i("div",Zl,[t[21]||(t[21]=i("span",{class:"text-secondary text-base mr-[4px] ml-[8px]"},"检测到当前CPU使用率",-1)),m(l,{type:s(F).cpu},{default:p(()=>[y(r("占用".concat(s(q).range,"%")),1)]),_:1},8,["type"])])])]),"content-info":p(()=>[i("div",Ql,[(o(!0),n(L,null,T(s(D),(e,t)=>(o(),n("div",{key:t,class:"flex direction-row items-center justify-between my-[1rem]"},[i("span",null,r(e.name),1),i("span",null,r(e.value),1)]))),128))])]),"base-info":p(()=>[i("p",null,r(s(W).framework),1),i("p",null,r("".concat(s(W).cpuNumber,"个物理CPU，").concat(s(W).logicCores,"个物理核心，").concat(s(W).cores,"个逻辑核心")),1)]),_:1},8,["process-alarm-show"])]),_:1},8,["info","onHide"])]),_:1}),m(u,{class:"state-component",span:4,xs:12,sm:6,md:6,lg:4,xl:4},{default:p(()=>[m(s(f),{type:"mem",info:s(J),onShow:t[5]||(t[5]=e=>s(I).moveStatePopover(s(te),"memoryPopover")),onHide:s(I).removeStatePopover},{default:p(()=>[m(Sa,{"load-type":"memoryInfo",type:"mem",ref_key:"memoryPopover",ref:te,"process-alarm-show":s(z)},{button:p(()=>[i("div",Yl,[i("div",Xl,[t[22]||(t[22]=i("span",{class:"text-secondary text-base mr-[4px] ml-[8px]"},"检测到当前内存",-1)),m(l,{type:s(F).memory},{default:p(()=>[y(r("占用".concat(s(J).range,"%")),1)]),_:1},8,["type"])]),m(d,{type:"primary",onClick:s(I).onClearMemory},{default:p(()=>[...t[23]||(t[23]=[y("立即释放",-1)])]),_:1},8,["onClick"])])]),"base-info":p(()=>[i("div",es,[i("div",ts,[i("div",as,[t[24]||(t[24]=i("span",{class:"w-[81px] inline-flex justify-end"},"空闲内存：",-1)),i("span",ls,r(s(ae).memFree+" MB"),1)]),i("div",ss,[t[25]||(t[25]=i("span",{class:"w-[81px] inline-flex justify-end"},"已用：",-1)),i("span",os,r(s(ae).memRealUsed+" MB"),1)])]),i("div",ns,[i("div",is,[t[26]||(t[26]=i("span",{class:"w-[81px] inline-flex justify-end"},"总内存：",-1)),i("span",rs,r(s(ae).memTotal+" MB"),1)]),i("div",cs,[t[27]||(t[27]=i("span",{class:"w-[81px] inline-flex justify-end"},"共享：",-1)),i("span",ds,r(s(ae).memShared+" MB"),1)])]),i("div",us,[i("div",ms,[t[28]||(t[28]=i("span",{class:"w-[81px] inline-flex justify-end"},"可分配内存：",-1)),i("span",null,r(s(ae).memAvailable+"MB"),1)]),i("div",ps,[t[29]||(t[29]=i("span",{class:"w-[81px] inline-flex justify-end"},"buff/cache：",-1)),i("span",vs,r(s(ae).memCached+"/"+s(ae).memBuffers+" MB"),1)])])])]),_:1},8,["process-alarm-show"])]),_:1},8,["info","onHide"])]),_:1}),(o(!0),n(L,null,T(s(le).filter((e,t,a)=>"None"!==e.data.path||a.findIndex(e=>"None"===e.data.path)===t),(e,t)=>(o(),v(u,{key:t,class:"state-component",span:4,xs:12,sm:6,md:6,lg:4,xl:4},{default:p(()=>[m(s(f),{type:"disk",info:e.info,onHide:s(I).removeStatePopover,data:e.data,alert:"None"!==e.data.path&&100===parseInt(e.data.inodes[3])},{default:p(()=>[m(Aa,{item:e},null,8,["item"])]),_:2},1032,["info","onHide","data","alert"])]),_:2},1024))),128))]),_:1})])])):c("",!0)])}}}),[["__scopeId","data-v-2dc75395"]]);function hs(e,t,a={}){let l;const{document:s=le,...o}=a,n={onUpdate:e=>{!function(e,t,a,l=null){null!=l&&((s=l.item).parentNode&&s.parentNode.removeChild(s),function(e,t,a){const l=e.children[a];e.insertBefore(t,l)}(l.from,l.item,t));var s;const o=R(e),n=o?[...se(e)]:se(e);if(a>=0&&a<n.length){const l=n.splice(t,1)[0];P(()=>{n.splice(a,0,l),o&&(e.value=n)})}}(t,e.oldIndex,e.newIndex,e)}},i=()=>{const t=null==s?void 0:s.querySelector(e);t&&void 0===l&&(l=new Qe(t,{...n,...o}))},r=()=>{null==l||l.destroy(),l=void 0};return te(i),ae(r),{stop:r,start:i,option:(e,t)=>{if(void 0===t)return null==l?void 0:l.option(e);null==l||l.option(e,t)}}}const gs=S("HOME-OVERVIEW-STORE",()=>{const e=I(),{mainWidth:l,payment:s}=we(),{authType:o}=a(s.value),n=t([]),i=t(!0),r=t(!1),c=async()=>{try{const e=await _e({request:bt(),data:{data:[Array,n]}});return d(),Promise.resolve(e.data)}catch(e){Ye(e)}finally{i.value=!1,P(()=>{y()})}},d=()=>{const e=n.value.findIndex(e=>"ssh_log"===e.name);-1!==e&&_e({loading:r,request:wt({log_type:n.value[e].params[0].source}),success:t=>{Array.isArray(t.data)&&(n.value[e].value=t.data)}})},u=async e=>Ce({title:"自定义概览模块",area:100,compData:e,component:()=>Se(()=>import("./index342.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)}),m=async()=>Ce({title:"备忘录",area:[70,60],component:()=>Se(()=>import("./index343.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)}),p=async()=>Ce({area:[90,60],component:()=>Se(()=>import("./index344.js?v=1763689792").then(e=>e.i),__vite__mapDeps([]),import.meta.url)}),v=e=>{const{type:t}=e.plugin_info;return"free"===o.value&&(8===t||12===t)||"ltd"!==o.value&&12===t},f=e=>{const{type:t,endtime:a,setup:l}=e.plugin_info,s="total"===e.name?41:"btwaf"===e.name?366:42;if(v(e)&&a<0)return gt({disablePro:!0,sourceId:s});ht({name:e.name})},y=()=>{hs(".overview-wrapper",n,{animation:500,handle:".move-icon",chosenClass:"ghost",onUpdate:async e=>{const t=e.oldIndex,a=e.newIndex,l=n.value[t];n.value.splice(t,1),n.value.splice(a,0,l),(async()=>{const e=n.value.map((e,t)=>e.id);await _e({request:It({overview:JSON.stringify(e)}),message:!0,success:e=>{e.status||c()}})})()}})},h=()=>{qe("searchFile","true"),e.push({path:"/files"})},g=t(""),x=t("/www/server/panel/data/memo.txt"),b=oe([]),w=t([]),_=oe(!1),k=oe(0),C=t({val0:0,val1:0,val2:0,val3:0}),S=t(["sites","databases","total","ssh_log","monitor"]),L=t(["open_dir"]),T=()=>{let e={};w.value=[],n.value.forEach(t=>{e[t.name]=t}),b.value.forEach(t=>{const a=t.template;t.option.forEach(t=>{const l=e[t.name]||!1;w.value.push({...t,isShow:Boolean(l),showItem:l,template:a,overviewPopover:!1})})})},j=(e,t=!1)=>{let a={...e},l=[],s=[];for(const o in C.value)e.params.length&&s.push(C.value[o]);if(0===s.length&&(s=[0]),"open_dir"===e.name){const t=C.value.val0||e.params[0].option[0].source;l=[{name:t,source:t}]}else l=a.params.map((t,a)=>"select"===t.type?t.option[s[a]]:e.params?e.params[a]:void 0);return delete a.overviewPopover,t?(e.showItem.params=l,a={...e.showItem}):(delete a.showItem,a.params=l),a},M=async e=>{const t=Boolean(e.showItem);if(!t&&6===n.value.length)return e.overviewPopover=!1,P(()=>e.isShow=!1),tt.warn("最多只能显示6个模块");const a={overview:JSON.stringify(j(e,t))},l=t&&e.isShow?Ct:kt;_e({loading:"正在".concat(t?"修改":"添加","模块，请稍后..."),request:l(a),message:!0,success:async t=>{e.overviewPopover=!1,e.isShow=!0,E(),t.status&&(await c(),T())}})},E=()=>{C.value={val0:0,val1:0,val2:0,val3:0}},B=async()=>{await _e({loading:_,request:at(),data:{data:[Array,b]}})};return{mainWidth:l,loading:i,isSshLoading:r,overviewShowList:n,getOverviewData:c,openOverviewTemplate:()=>{u({getOverviewData:c})},openModelDialog:async t=>{switch(t.type){case"base":const a=t.params[0].source,l="/"+(["ftps","sites","databases"].includes(t.name)&&"all"===a?"":a).replace("proxy","nginx");return e.push({path:t.source.href+l});case"model":if("memo"===t.name)return m();if("safety_risk"===t.name)return p();if("ssh_log"===t.name)return e.push({path:"/logs/ssh"});case"plugin":return f(t);default:if("search_file"===t.name)return h();if("open_dir"===t.name)return Ot({path:t.params[0].name})}},securityRisksDialog:p,getModelTitle:e=>{let t=e.title,a=0,l=e.params.length||0,s=["ssh_log"];if(!e.status)return t;if("open_dir"===e.name)return t;l>=2&&(t="");for(let o=l-1;o>=0;o--){let n=e.params[o];(t===n.name||s.indexOf(e.name)>-1)&&(t=""),2!==a&&(1===l&&""!=t&&(t+=" - "),t+="".concat(n.name)+(o===l-1&&l>1?" - ":""),a++),a=0}return t.replace(" - 全部","")},getPayStatus:v,getModelTips:e=>{switch(e.template){case"base":return"memo"===e.name||"safety_risk"===e.name?"打开".concat(e.title,"模块"):"跳转至".concat(e.title,"页面");case"browse":return"plugin"===e.type?"打开".concat(e.title,"插件"):"打开".concat(e.title,"模块");case"open_dir":return"打开".concat(e.title)}},content:g,path:x,saveFileEvent:async()=>{_e({loading:"正在保存备忘录，请稍后...",request:Xe({path:x.value,data:g.value,encoding:"utf-8"}),message:!0,success:e=>{e.status&&c()}})},getMemoData:async()=>{_e({loading:"正在获取备忘录数据，请稍后...",request:et(),data:[String,g]})},isLoading:_,overviewModelList:w,supportConfig:S,supportPath:L,form:C,onPathChange:e=>{St({type:"dir",change:t=>{C.value.val0=t,M(e)}})},getOverviewTemplateData:B,dataAlignment:T,setOverviewTemplateShow:async e=>{try{if(e.isShow&&6===n.value.length)return P(()=>e.isShow=!1),tt.warn("最多只能显示6个模块");const t=j(e);!e.isShow&&Ke(e.showItem.id)&&(await B(),(e=w.value.find(t=>t.name===e.name)).isShow=!e.isShow);const a=e.isShow?kt:_t,l=e.isShow?{overview:JSON.stringify(t)}:{overview_id:e.showItem.id};_e({loading:"正在".concat(e.isShow?"删除":"添加","模块，请稍后..."),request:a(l),message:!0,data:{data:Array,msg:String,status:Boolean},success:async t=>{t.status&&(e.isShow&&(e.showItem=t.data.length?t.data[t.data.length-1]:e.showItem),await c(),T())}})}catch(t){Ye(t)}},addOverviewFun:M,setPopoverShow:(e,t)=>{w.value[t].overviewPopover=!0,k.value=t;const a=e.showItem.params,l=Object.entries(C.value);for(let s=0;s<l.length&&s<e.params.length;s++){const t=e.params[s];if("select"===t.type){const e=t.option.findIndex(e=>!a||(!a[s]||e.source===a[s].source));C.value["val"+s]=e}else C.value["val"+s]=a?a[s].source:t.option[s].source}}}}),xs={class:"module-ui mb-[1.2rem] mx-[1.2rem]"},bs={class:"module-ui-header"},ws={class:"flex w-full justify-between"},_s={class:"module-ui-body mt-[1.2rem]"},ks={class:"!mx-0 w-full"},Cs={class:"flex flex-col w-full relative inline-block"},Ss={class:"overview-box"},Is={class:"overview-content"},Ps={class:"content w-full"},Ls={class:"title"},Ts={class:"flex h-[4.4rem] items-center w-full"},js={key:0,class:"risk not-install bt-blink"},Ms={key:1,class:"model font-bold"},Es={class:"to-day"},Bs={class:"yester-day ml-[1.6rem]"},Rs={key:2,class:"path-info bt-link-primary truncate"},Ds={key:3,class:"path-info bt-link-primary truncate"},Os={key:4,class:"icon-open-routes"},As={class:"icon-open-routes-text"},Vs=Pe(e({__name:"index",setup(e){const t=gs(),{mainWidth:a,loading:f,isSshLoading:y,overviewShowList:g}=d(t),x=u(()=>{let e=0;const t=a.value<1100?a.value<800?a.value<400?1:2:4:a.value>1800?8:6,l=Math.floor((a.value-16*t-50)/t);return e=Math.min(Math.max(l,200),270),{number:24/(t>g.value.length?g.value.length:t),width:e}}),b=u(()=>x.value.width<230);return l(async()=>{ut({promises:[t.getOverviewData],delay:100})}),(e,a)=>{const l=ie,d=re,u=X,w=ee,_=ce;return o(),n("div",xs,[i("div",bs,[i("div",ws,[a[3]||(a[3]=i("span",{class:"font-alibaba-semibold"},"概览",-1)),i("span",{title:"自定义概览模块",class:"!ml-[1rem] cursor-pointer",onClick:a[0]||(a[0]=e=>s(t).openOverviewTemplate())},[...a[2]||(a[2]=[i("i",{class:"svgtofont-el-more-filled !text-large hover:text-primary inline-block",style:{transform:"rotate(90deg)"}},null,-1)])])])]),i("div",_s,[i("div",ks,[m(w,{span:24,gutter:20,class:"overview-wrapper draggable-group"},{default:p(()=>[s(f)?(o(),n(L,{key:0},T(5,e=>m(d,{style:$({width:"".concat(s(x).width,"px")}),class:"overview-box",key:e},{template:p(()=>[i("div",Cs,[m(l,{variant:"text",class:"!w-[40%]"}),m(l,{variant:"text",class:"mt-10px"})])]),_:1},8,["style"])),64)):c("",!0),(o(!0),n(L,null,T(s(g),e=>(o(),v(u,{span:s(x).number,xl:s(x).number,class:"rounded-large",key:e.id,onClick:a=>s(t).openModelDialog(e),style:$({minWidth:"".concat(s(x).width,"px")})},{default:p(()=>[i("div",Ss,[i("i",{class:"svgtofont-icon-drag move-icon",onClick:a[1]||(a[1]=ne(()=>{},["stop"])),title:"可拖拽"}),i("div",Is,[i("div",Ps,[i("span",Ls,r(s(t).getModelTitle(e)),1),i("div",Ts,["base"===e.template?(o(),n("span",{key:0,class:h(["bt-link-primary !text-subtitleLarge text-alibaba",{memo:"memo"===e.name,risk:"safety_risk"===e.name&&e.value[0]>0,"!text-disabled":"memo"===e.name&&!e.value[0]}])},r(e.value[0]||("memo"===e.name?"当前内容为空，点击编辑":e.value[0])),3)):"browse"===e.template?(o(),n(L,{key:1},["plugin"!==e.type||e.plugin_info.setup?"plugin"===e.type||"model"===e.type?V((o(),n("div",Ms,[i("div",Es,[a[4]||(a[4]=i("span",{class:""},"今日",-1)),i("span",null,r(e.value[0]||0),1)]),i("div",Bs,[a[5]||(a[5]=i("span",null,"昨日",-1)),i("span",null,r(e.value[1]||0),1)])])),[[_,s(y)&&"ssh_log"===e.name]]):c("",!0):(o(),n("span",js,r(s(t).getPayStatus(e)?"立即购买":"立即安装"),1))],64)):"open_dir"===e.template?(o(),n("span",Rs,r(e.params[0].name),1)):"search_file"===e.template?(o(),n("span",Ds," 点击搜索内容 ")):c("",!0),"base"===e.type||"safety_risk"===e.name?(o(),n("div",Os,[a[6]||(a[6]=i("span",{class:"icon-open-routes-icon"},[i("i",{class:"svgtofont-el-arrow-right font-bold text-medium"})],-1)),i("span",As,r(s(b)?"打开":"打开到".concat(s(t).getModelTitle(e).split("-")[0])),1)])):c("",!0)])])])])]),_:2},1032,["span","xl","onClick","style"]))),128))]),_:1})])])])}}}),[["__scopeId","data-v-d39ddaca"]]),zs={class:"module-ui flex flex-col"},Fs={class:"module-ui-header"},Hs={class:"w-full flex justify-between items-center"},Ns={class:"plugin-search"},Ws={class:"pluginInfo"},Us=["src"],qs={class:"plugin-desc"},Gs={class:"wrapper module-ui-body soft-wrapper"},Ks=["onClick"],$s={key:0,id:"freeTagCon"},Js={class:"h-38 pt-5 w-full text-center flex justify-center items-center"},Zs={class:"w-[6rem] h-[6rem] rounded-large bg-dark flex items-center justify-center"},Qs=["src","custom"],Ys={class:"text-tertiary h-9 leading-9 flex items-center justify-center pb-[8px]"},Xs={class:"w-full truncate text-center"},eo=["onClick"],to={class:"h-38 pt-5 w-full text-center flex justify-center items-center"},ao={class:"w-[6rem] h-[6rem] rounded-large bg-dark flex items-center justify-center"},lo=["src"],so={class:"flex justify-center items-center h-9 leading-9 pb-[8px]"},oo={class:"text-tertiary h-9 leading-9 w-full truncate text-center"},no={class:"flex justify-center align-middle mt-2 mb-4 opacity-70"},io=Pe(e({__name:"index",setup(e){const t=At(),{popShow:a,pluginKeyword:u,recommendList:f,containerRef:g,mySoftList:b,tableLoading:w,isGetSoft:_,softShowList:k}=d(t);return C(f,e=>{e.length>0&&t.createSoftList()},{immediate:!0}),l(async()=>{await ut({promises:[t.getHomeInstallSoftData,t.getRecommendInfo],delay:100}),P(()=>{const{type:e}=Vt();if(e.includes("aliyun")){const e=setInterval(async()=>{if(window.$extension){const t=await window.$extension();Ae(t.extensionElement)&&!t.extensionElement&&clearTimeout(e),t.extensionElement&&(t.extensionElement(),clearTimeout(e))}},1e3)}})}),(e,l)=>{const d=N,f=me,C=pe,S=D,I=ve,P=x,j=O("table-scroll-load"),M=O("bt-loading");return o(),n("div",zs,[i("div",Fs,[i("div",Hs,[i("span",{onClick:l[0]||(l[0]=(...e)=>s(t).goSoft&&s(t).goSoft(...e)),class:"cursor-pointer hover:text-primary font-alibaba-semibold"},"软件"),m(P,{"popper-class":"myPopover",placement:"right-start",visible:s(a),width:"400",onShow:l[7]||(l[7]=e=>s(t).showPopoverHandle(""))},{reference:p(()=>[m(d,{ref:"softButton",class:"soft-button-no-padding",type:"default",title:"软件自定义编辑",link:"",onClick:l[6]||(l[6]=e=>a.value=!s(a))},{default:p(()=>[...l[10]||(l[10]=[i("i",{class:"svgtofont-el-more-filled text-default !text-large hover:text-primary inline-block",style:{transform:"rotate(90deg)"}},null,-1)])]),_:1},512)]),default:p(()=>[i("div",{ref_key:"containerRef",ref:g,class:"plugin-box p-[.8rem]",onMouseleave:l[5]||(l[5]=(...e)=>s(t).leave&&s(t).leave(...e))},[i("div",Ns,[m(f,{placeholder:"请输入要搜索的应用",modelValue:s(u),"onUpdate:modelValue":l[2]||(l[2]=e=>R(u)?u.value=e:null),"fetch-suggestions":s(t).querySearch,"trigger-on-focus":!1,class:"search-input w-full","popper-class":"soft-search-popover",onKeyup:l[3]||(l[3]=de(e=>s(t).searchPluginHandle("select"),["enter","native"])),onSelect:l[4]||(l[4]=e=>s(t).searchPluginHandle())},{append:p(()=>[m(d,{onClick:l[1]||(l[1]=e=>s(t).searchPluginHandle("select"))},{default:p(()=>[...l[9]||(l[9]=[i("i",{class:"svgtofont-el-search"},null,-1)])]),_:1})]),_:1},8,["modelValue","fetch-suggestions"])]),V((o(),v(I,{data:s(b),height:"400"},{default:p(()=>[m(C,{width:"260",property:"date",label:"软件名称"},{default:p(e=>[i("div",Ws,[i("img",{class:"plugin-img",src:s(t).renderSoftImages(e.row.name)},null,8,Us),i("span",qs,r(e.row.title)+" "+r(e.row.version),1)])]),_:1}),m(C,{property:"setup",sortable:"",label:"首页显示",prop:"index_display"},{default:p(e=>[m(S,{modelValue:e.row.index_display,"onUpdate:modelValue":t=>e.row.index_display=t,"active-color":"var(--el-color-primary)","inactive-color":"var(--el-color-text-disabled)",width:32,size:"small",onChange:a=>s(t).changeSwitchHandle(e.row,e.$index)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})]),_:1},8,["data"])),[[j,s(t).load],[M,s(w)]])],544)]),_:1},8,["visible"])])]),V((o(),n("div",Gs,[m(ue,null,{default:p(()=>[(o(!0),n(L,null,T(s(k),(e,a)=>(o(),n("div",{key:e.name+"_id",class:h(e.title?"box-wrapper cursor-pointer relative":"")},[a<12?(o(),n(L,{key:0},[e.id&&e.setup?(o(),n("div",{key:0,onClick:a=>s(t).openSoftView(e)},[i("i",{class:"svgtofont-icon-drag !text-base text-secondary !hidden absolute right-6 top-6 cursor-move mover soft-move",onClick:l[8]||(l[8]=ne(()=>{},["stop"]))}),e.tag?(o(),n("span",$s)):c("",!0),i("div",Js,[i("div",Zs,[i("img",{src:s(t).renderSoftImages(e.name),class:"w-[4rem]",custom:!s(lt)},null,8,Qs)])]),i("div",Ys,[i("span",Xs,[y(r(e.title.replace(/PHP-[{0-9},\.]+/,"PHP-")+" "+e.version)+" ",1),V(i("i",{style:$("color:".concat(s(t).softStatusColor(e))),class:h("ml-[5px] svgtofont-icon-".concat(s(t).softStatus(e)))},null,6),[[U,5===e.type]])])])],8,Ks)):s(st)(e)?c("",!0):(o(),n(L,{key:1},[i("div",{onClick:a=>s(t).openRecommendSoftView(e),class:"absolute rounded- left-2 top-2 py-.5 px-3 transform scale-75 bg-lighter text-tertiary opacity-80"},"推荐",8,eo),i("div",to,[i("div",ao,[i("img",{src:"".concat(s(lt)?"/static/images":"/static/img","/soft_ico/ico-").concat(e.name,".png"),class:"w-[4rem]"},null,8,lo)])]),i("div",so,[i("div",oo,[y(r(e.title)+" "+r(e.version),1),l[11]||(l[11]=i("span",{class:"text-btColor"},null,-1))])]),i("div",no,[e.preview?(o(),v(d,{key:0,type:"default",size:"small",onClick:a=>s(t).openSoftPreLink(e),plain:""},{default:p(()=>[...l[12]||(l[12]=[y("预览",-1)])]),_:1},8,["onClick"])):c("",!0),e.isBuy?c("",!0):(o(),v(d,{key:1,type:"primary",size:"small",plain:"",onClick:a=>s(t).openLtdPayView(e)},{default:p(()=>[...l[13]||(l[13]=[y("购买",-1)])]),_:1},8,["onClick"])),e.isBuy&&!e.install?(o(),v(d,{key:2,type:"primary",size:"small",plain:"",onClick:a=>s(t).openInstall(e)},{default:p(()=>[...l[14]||(l[14]=[y("安装",-1)])]),_:1},8,["onClick"])):c("",!0)])],64))],64)):c("",!0)],2))),128))]),_:1})])),[[M,s(_)],[M,"正在获取软件列表，请稍后...","title"]])])}}}),[["__scopeId","data-v-12d56308"]]),ro={class:"monitor monitor-chart w-full"},co=Pe(e({__name:"main",props:fe({info:{default:()=>({info:[],option:{}})}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e,{expose:a}){const l=ye(e,"modelValue"),i=t();C(l,e=>{e&&u(e)});const{BtECharts:r,getEChart:c,setOption:d}=ot({options:{xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{boundaryGap:[0,"50%"],type:"value"},series:[]}}),u=async e=>{var t;d(p(e)),i.value=await c(),null==(t=i.value)||t.resize()},p=(e={})=>{var t;const a={grid:{right:"5%",bottom:"6%",top:"6%"},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:e.formatter},xAxis:{type:"category",boundaryGap:!1,data:e.tData,axisLine:{lineStyle:{color:Me.value?"#888":"#cccccc"}}},yAxis:{type:"value",boundaryGap:[0,"100%"],splitNumber:e.splitNumber,min:0,...e.axisLabel?{axisLabel:e.axisLabel}:{},..."iostat"===(null==(t=l.value)?void 0:t.type)?{axisLabel:{formatter:(e,t)=>Ue(e,!1,0),color:"#666"}}:{},splitLine:{lineStyle:{color:Me.value?"#888":"#cccccc",type:"dashed"}},axisLine:{lineStyle:{color:Me.value?"#888":"#cccccc"}}},series:[]},{legend:s,dataZoom:o,list:n}=e;return s&&(a.legend=s),o&&(a.dataZoom=o),n.forEach(e=>{const t={name:e.name,data:e.data,type:e.type||"line",smooth:e.smooth||!0,symbol:"circle",symbolSize:6,showSymbol:!0,emphasis:{symbolSize:8},sampling:e.sampling||"average",areaStyle:e.areaStyle||{},lineStyle:{...e.lineStyle||{}},itemStyle:{...e.itemStyle||{},borderColor:"#fff",borderWidth:"1px"}};a.series.push(t)}),a};return a({echartRef:i,setConfig:u}),(e,t)=>(o(),n("div",ro,[A(e.$slots,"default",{},void 0,!0),m(s(r),{class:"w-full"})]))}}),[["__scopeId","data-v-f3782170"]]),uo=S("HOME-MONITOR-STORE",()=>{const e=Bt(),{isRefreshData:a}=d(e),l=t(!0),s=t(!1),o=t(),n=t(),i=t("net"),r=t(0),c=u(()=>_(r.value)),m=oe({}),p=oe({}),v=t([]),f=t([]),y=B({net:{selectVal:"ALL",selectList:[],data:{timeList:[],upList:[],downList:[]},info:{up:{label:"上行",value:"0 B",bgColor:"#20a53a"},down:{label:"下行",value:"0 B",bgColor:" #FF9901"},upTotal:{label:"总发送",value:"0 B"},downTotal:{label:"总接收",value:"0 B"}}},iostat:{selectVal:"ALL",selectList:[],data:{timeList:[],readList:[],writeList:[],tipsList:[]},info:{read:{label:"读取",value:"0 B",bgColor:"#FF4683"},write:{label:"写入",value:"0 B",bgColor:"#6CC0CF"},second:{label:"每秒读写",value:"0次"},io:{label:"IO延迟",value:"0 ms",color:"#20a53a"}}}}),h=t([{label:"KB/s",value:"KB",disable:!1},{label:"MB/s",value:"MB",disable:!1},{label:"GB/s",value:"GB",disable:!1},{label:"TB/s",value:"TB",disable:!1}]);let g;var x;(x=g||(g={})).Net="net",x.Iostat="iostat",ta.useSetCallback("network",e=>{var t,a;if(!e)return;v.value=e,"net"===i.value&&C(e,c.value);const l=M("net","data");m.value=S(l),(null==(a=null==(t=j(i.value))?void 0:t.echartRef)?void 0:a.id)&&(s.value=!1),w()}),ta.useSetCallback("diskIo",async e=>{var t,a;if(!e)return;f.value=e,"iostat"===i.value&&I(e);const l=M("iostat","data");p.value=L(l),(null==(a=null==(t=j(i.value))?void 0:t.echartRef)?void 0:a.id)&&(s.value=!1),w()});const b=u(()=>y[i.value].selectVal),w=()=>{for(const e in y){const t=E(e),a=y[e],{selectList:l}=a;l.length=0,Object.keys(t).forEach(e=>{if("ALL"===e)return a.selectVal||(a.selectVal=e),void l.unshift({label:"所有",value:"ALL"});l.push({label:e,value:e})})}},_=e=>{const t=[" B"," KB"," MB"," GB"," TB"," PB"," EB"];return e<1024?t[0]:e<1048576?t[1]:e<1024**3?t[2]:e<1024**4?t[3]:e<1024**5?t[4]:e<1024**6?t[5]:t[6]},k=(e,t)=>{const{up:a,down:l,upTotal:s,downTotal:o}=e;return{up:Ue(1024*a,!1,2,t),down:Ue(1024*l,!1,2,t),upTotal:Ue(1024*s,!1,2,t),downTotal:Ue(1024*o,!1,2,t)}},C=(e,t)=>{const{info:a,data:l}=M("net"),s=e[b.value||"ALL"];if(!s)return;const{up:o,down:n,upTotal:i,downTotal:d}=a;for(let c=0;c<l.upList.length;c++){const e=l.upList[c];e>r.value&&(r.value=e);const t=l.downList[c];t>r.value&&(r.value=t)}k(s,c.value);const u=k(s,"MB");if(o.value=Ue(1024*s.up,!0,1),n.value=Ue(1024*s.down,!0,1),i.value=Ue(s.upTotal,!0,1),d.value=Ue(s.downTotal,!0,1),100*parseFloat(u.down)==0||100*parseFloat(u.down)==0)h.value=[{label:"KB/s",value:"KB",disable:!1},{label:"MB/s",value:"MB",disable:!0},{label:"GB/s",value:"GB",disable:!0},{label:"TB/s",value:"TB",disable:!0}];else{const e=k(s,"GB");if(100*parseFloat(e.down)==0||100*parseFloat(e.down)==0)h.value=[{label:"KB/s",value:"KB",disable:!1},{label:"MB/s",value:"MB",disable:!1},{label:"GB/s",value:"GB",disable:!0},{label:"TB/s",value:"TB",disable:!0}];else{const e=k(s,"TB");100*parseFloat(e.down)!=0&&100*parseFloat(e.down)!=0||(h.value=[{label:"KB/s",value:"KB",disable:!1},{label:"MB/s",value:"MB",disable:!1},{label:"GB/s",value:"GB",disable:!1},{label:"TB/s",value:"TB",disable:!0}])}}T("net",[{key:"timeList"},{key:"upList",value:Number(1024*s.up)},{key:"downList",value:Number(1024*s.down)}])},S=e=>({dataZoom:[],tData:e.timeList,list:[{name:"上行",data:e.upList,circle:"circle",itemStyle:{color:"#20a53a"},lineStyle:{width:2,color:"#20a53a"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(32, 165, 58, .6)"},{offset:.8,color:"rgba(32, 165, 58, 0)"}]}}},{name:"下行",data:e.downList,circle:"circle",itemStyle:{color:" #FF9901"},lineStyle:{width:2,color:"#FF9901"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(255, 153, 1, .6)"},{offset:.8,color:"rgba(255, 153, 1, 0)"}]}}}],axisLabel:{formatter:e=>Ue(e,!1,0,c.value)},formatter(e){let t="";for(let a=0;a<e.length;a++){const l=e[a];if(Ke(l.data))return!1;t+='<span class="inline-block w-[1rem] h-[1rem] mr-[1rem]" style="border-radius: var(--el-border-radius-circle); background: '.concat(l.color,';"></span>').concat(l.seriesName,"：").concat(Ue(parseFloat(l.data),!0,1),"/s ").concat(e.length-1!==a?"<br />":"")}return"时间：".concat(e[0].axisValue,"<br />").concat(t)}}),I=e=>{const{info:t}=M("iostat"),a=e[y.iostat.selectVal||"ALL"],{read:l,write:s,second:o,io:n}=t;if(!a)return;const{read_bytes:i,write_bytes:r}=a,{read_count:c,write_count:d}=a,{read_time:u,write_time:m}=a;l.value=Ue(i,!0,1),s.value=Ue(r,!0,1),o.value="".concat(c+d," 次"),n.value="".concat(m>u?m:u," ms");const p=parseInt(n.value);n.color=p>=1e3?"var(--el-color-danger)":p>100&&p<1e3?"var(--el-color-warning)":"var(--el-color-primary)",T("iostat",[{key:"timeList"},{key:"readList",value:i},{key:"writeList",value:r},{key:"tipsList",value:a}])},L=e=>({dataZoom:[],type:"iostat",tData:e.timeList,list:[{name:"读取字节数",data:e.readList,circle:"circle",itemStyle:{color:"#FF4683"},lineStyle:{width:2,color:"#FF4683"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(255, 70, 131, .8)"},{offset:.8,color:"rgba(255, 70, 131, 0)"}]}}},{name:"写入字节数",data:e.writeList,circle:"circle",itemStyle:{color:"#6CC0CF"},lineStyle:{width:2,color:"#6CC0CF"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(108, 192, 207, .8)"},{offset:.8,color:"rgba(108, 192, 207, 0)"}]}}}],formatter(t){let a="时间：".concat(t[0].axisValue,"<br />");const l={read_bytes:"读取字节数",read_count:"读取字节数",read_merged_count:"合并读取次数",read_time:"读取延迟",write_bytes:"写入字节数",write_count:"写入次数",write_merged_count:"合并写入次数",write_time:"写入延迟"},s=e.tipsList[t[0].dataIndex];for(let e=0;e<t.length;e++){const l=t[e];if(Ke(l.data))return!1;a+='<span class="inline-block w-[1rem] h-[1rem] mr-[.1rem]" style="border-radius: var(--el-border-radius-circle); background: '.concat(l.color,';"></span>&nbsp;&nbsp;<span>').concat(l.seriesName,"：").concat(Ue(parseFloat(l.data),!0,1),"/s</span><br />")}return["read_count","write_count","read_merged_count","write_merged_count","read_time","write_time"].forEach(e=>{const t=s[e],o=t>100&&t<1e3?"#ff9900":t>=1e3?"red":"#20a53a",n=e.indexOf("time")>-1?"color: ".concat(o):"",i=e.indexOf("time")>-1?" ms":" 次/秒";a+='<span class="inline-block w-[1rem] h-[1rem]"></span>&nbsp;&nbsp;<span style="'.concat(n,'">').concat(l[e],"：").concat(t+i,"</span><br />")}),a}}),T=(e,t,a=8)=>{const l=M(e,"data");t.forEach(e=>{const{key:t,value:s}=e,o=l[t];o.length>=a&&o.splice(0,1),"timeList"==t?o.push(nt((new Date).getTime(),"hh:mm:ss",!0)):o.push(s)})},j=e=>"net"==e?o.value:"iostat"==e?n.value:void 0,M=(e="net",t="")=>t?y[e][t]:y[e],E=(e="net")=>"net"==e?v.value:"iostat"==e?f.value:{};return{netRefs:o,iostatRefs:n,loading:s,iostatConfig:p,resource:y,unitList:h,activeName:i,netConfig:m,netUnit:c,initChart:()=>{s.value=!0;const e=localStorage.getItem("home-model-active"),t=localStorage.getItem("home-".concat(e,"-active"));e&&(i.value=e,y[e].selectVal=t||"ALL"),P(()=>{a.value=!0});const l=M("net","data");m.value=S(l);const o=M("iostat","data");p.value=L(o)},onSelectChange:()=>{localStorage.setItem("home-model-active",i.value),localStorage.setItem("home-".concat(i.value,"-active"),b.value),"net"===i.value?C(v.value,c.value):I(f.value)},onNetUnitChange:()=>{y.net.data.timeList=[],y.net.data.upList=[],y.net.data.downList=[],localStorage.setItem("netUnit",c.value),C(v.value,c.value)},onTabsChange:()=>{const e=i.value;localStorage.setItem("home-model-active",e);const t=localStorage.getItem("home-".concat(e,"-active"));t&&y[e].selectList.some(e=>e.value===t)?y[e].selectVal=t:y[e].selectVal="ALL",P(()=>{const t=j(e);if((null==t?void 0:t.echartRef)&&setTimeout(()=>{t.echartRef.resize()},100),l.value&&"iostat"===e){l.value=!1;const e=M("iostat","data");t&&e&&t.setConfig(L(e))}})}}}),mo={class:"module-ui"},po={class:"module-ui-header"},vo={class:"flex justify-between items-center w-full -ml-[1.4rem]"},fo={class:"flex items-center"},yo={class:"flex items-center"},ho={class:"text-tertiary font-500 text-small mr-[1.5rem] whitespace-pre"},go={class:"module-ui-body"},xo=e({__name:"index",setup(a){const c=t(!1),y=t(!1),g=e({name:"NetMonitor",setup(e,{emit:t}){const a=uo(),{netConfig:s,resource:o,unitList:n,netUnit:i,netRefs:r}=d(a);return l(()=>{t("cache-status",{type:"net",cached:!0})}),()=>m("div",{class:"home-monitor-content"},[m("div",{class:"home-monitor__stats-grid"},[Object.values(o.value.net.info).map((e,t)=>m("div",{key:t,class:"home-monitor__stat-item"},[m("div",{class:"home-monitor__stat-content"},[m("div",{class:"home-monitor__stat-left"},[e.bgColor&&m("div",{class:"home-monitor__stat-dot-wrapper"},[m("span",{class:"home-monitor__stat-dot",style:{backgroundColor:e.bgColor}},null),m("span",{class:"home-monitor__stat-dot-ripple",style:{borderColor:e.bgColor}},null)]),m("span",{class:"home-monitor__stat-label"},[e.label])]),m("div",{class:"home-monitor__stat-right"},[m("div",{class:"home-monitor__stat-value",style:{color:e.color||"var(--el-color-text-secondary)"}},[e.value])])])]))]),m("div",{class:"home-monitor__chart-container"},[m(co,{ref:r,modelValue:s.value,info:o.value.net.info},null)])])}}),x=e({name:"IostatMonitor",setup(e,{emit:t}){const a=uo(),{iostatConfig:s,resource:o,iostatRefs:n}=d(a);return l(()=>{t("cache-status",{type:"iostat",cached:!0})}),()=>m("div",{class:"home-monitor-content"},[m("div",{class:"home-monitor__stats-grid"},[Object.values(o.value.iostat.info).map((e,t)=>m("div",{key:t,class:"home-monitor__stat-item"},[m("div",{class:"home-monitor__stat-content"},[m("div",{class:"home-monitor__stat-left"},[e.bgColor&&m("div",{class:"home-monitor__stat-dot-wrapper"},[m("span",{class:"home-monitor__stat-dot",style:{backgroundColor:e.bgColor}},null),m("span",{class:"home-monitor__stat-dot-ripple",style:{borderColor:e.bgColor}},null)]),m("span",{class:"home-monitor__stat-label"},[e.label])]),m("div",{class:"home-monitor__stat-right"},[m("div",{class:"home-monitor__stat-value",style:{color:e.color||"var(--el-color-text-secondary)"}},[e.value])])])]))]),m("div",{class:"home-monitor__chart-container"},[m(co,{ref:n,modelValue:s.value,info:o.value.iostat.info},null)])])}}),b=uo(),{loading:w,resource:_,activeName:k}=d(b),C=u(()=>"net"===k.value?g:x),S=u(()=>"net"===k.value?"正在获取流量信息，请稍候...":"正在获取磁盘IO信息，请稍候..."),I=e=>{"net"===e.type?c.value=e.cached:"iostat"===e.type&&(y.value=e.cached)},P=e=>{k.value!==e&&(performance.now(),k.value=e,b.onTabsChange())};return l(()=>{const e=localStorage.getItem("home-model-active");e&&["net","iostat"].includes(e)&&(k.value=e),b.initChart()}),(e,t)=>{const a=ge,l=xe,c=O("bt-loading");return o(),n("div",mo,[i("div",po,[i("div",vo,[i("div",fo,[i("div",{class:h(["tab-item",{active:"net"===s(k)},"font-alibaba-semibold"]),onClick:t[0]||(t[0]=e=>P("net"))},"流量",2),i("div",{class:h(["tab-item",{active:"iostat"===s(k)},"font-alibaba-semibold"]),onClick:t[1]||(t[1]=e=>P("iostat"))},"磁盘IO",2)]),i("div",yo,[i("span",ho,r("net"===s(k)?"网卡":"磁盘"),1),(o(!0),n(L,null,T(s(_),(e,t)=>V((o(),v(l,{key:t,modelValue:e.selectVal,"onUpdate:modelValue":t=>e.selectVal=t,placeholder:"请选择","fit-input-width":!0,onChange:s(b).onSelectChange,size:"small",class:"!min-w-[100px] !rounded-large"},{default:p(()=>[(o(!0),n(L,null,T(e.selectList,e=>(o(),v(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])),[[U,"".concat(t)==s(k)]])),128))])])]),i("div",go,[(o(),v(he,null,[V((o(),v(f(s(C)),{key:s(k),"v-bt-loading:title":s(S),onCacheStatus:I},null,40,["v-bt-loading:title"])),[[c,s(w)]])],1024))])])}}}),bo=S("RECOMMEND-STORE",()=>{const{payment:e}=we(),{authType:l,authExpirationTime:s}=a(e.value),o=t(!1),n=t([["time","5分钟极速响应"],["refund","15天无理由退款"],["plunge","30+款付费插件"],["function","20+企业版专享功能"],["certificate","2张SSL商用证书（年付）"],["message","1000条免费短信（年付）"]]),i=t([["speed","5分钟极速响应"],["fifteen","15天无理由退款"],["plugin","30+款付费插件"],["more","20+企业版专享功能"],["recom","2张SSL商用证书（年付）"],["message","1000条免费短信（年付）"]]),r=t(["多对一技术支持","全年5次安全排查","5分钟极速响应","30+款付费插件","20+企业版专享功能","1000条免费短信（年付）","2张SSL商用证书（年付）","一对一服务（年付）","WAF防火墙","更换授权IP","客服优先响应","15+款付费插件","15天无理由退款"]),c=t([0,0,0,0,0,0,0,0,1,1,1,1,1]),d=t([0,0,1,1,1,1,1,1,1,1,1,1,1]),u=t([1,1,1,1,1,1,1,1,1,1,1,1,1]),m=t(!1),p=t(!0);return{plusPrivilegeList:u,ltdPrivilegeList:d,proPrivilegeList:c,privilegeList:r,limitTimeShow:m,advantageList:n,newAdvantageList:i,recommendShow:p,showPrivilege:o,authType:l,authExpirationTime:s,setRecommendHide:e=>{const t=((new Date).getTime()+864e5*e).toString();localStorage.setItem("HOME-RECOMMEND-HIDE-TIME",t),p.value=!1},checkRecommendHide:()=>{const e=parseInt(localStorage.getItem("HOME-RECOMMEND-HIDE-TIME")||"0");e&&(p.value=e<(new Date).getTime())},openProduct:e=>gt({sourceId:e,disablePro:!0})}}),wo={key:0,class:"h-auto"},_o={class:"absolute left-0 right-0 flex items-center px-[16px]"},ko={class:"advantage-list"},Co={class:"text-tertiary text-base"},So={class:"absolute left-0 right-0 flex items-center px-[16px]"},Io={class:"flex items-center"},Po={class:"relative mr-[2rem]"},Lo={class:"advantage-list"},To={class:"text-tertiary text-base"},jo={class:"p-[24px] flex justify-center flex-col items-center"},Mo={class:"flex items-center mt-[20px]"},Eo={class:"flex-col items-center border border-base justify-center w-[22rem]"},Bo={class:"flex flex-col text-base text-secondary function-text"},Ro={class:"flex-col border border-[var(--bt-pro-border-color)] items-center bg-[var(--bt-pro-bg-color)] justify-center w-[22rem]"},Do={class:"text-extraLarge text-default font-medium h-[9.4rem] leading-[9.4rem] text-center"},Oo={class:"flex flex-col text-base text-secondary pro-text"},Ao={key:0,class:"svgtofont-el-close text-danger text-large font-bold"},Vo={key:1,class:"svgtofont-el-check text-[var(--el-color-warning-light-3)] text-large font-bold"},zo={key:0,class:"recommend-left"},Fo={class:"text-[var(--bt-ltd-sub-bg-color)] flex justify-center font-bold"},Ho={class:"flex flex-col text-base text-secondary ltd-text"},No={key:0,class:"svgtofont-el-close text-danger text-large font-bold"},Wo={key:1,class:"svgtofont-el-check text-[var(--el-color-warning-light-3)] text-large font-bold"},Uo={key:0,class:"svgtofont-el-close text-danger text-large font-bold"},qo={key:1,class:"svgtofont-el-check text-[var(--el-color-warning-light-3)] text-large font-bold"},Go=Pe(e({__name:"index",setup(e){const{forceLtd:t,aliyunEcsLtd:a,authRemainingDays:u,ltdRemarks:v}=we(),f=bo(),{plusPrivilegeList:g,ltdPrivilegeList:x,proPrivilegeList:b,privilegeList:w,limitTimeShow:_,recommendShow:k,showPrivilege:C,authType:S,authExpirationTime:I}=d(f);return l(()=>{f.checkRecommendHide()}),(e,t)=>{const l=Be,d=jt,P=it,j=rt;return s(k)&&!s(a)?(o(),n("div",wo,["ltd"===s(S)?(o(),n("div",{key:0,class:"advantage-view",onMouseover:t[2]||(t[2]=e=>_.value=!0),onMouseleave:t[3]||(t[3]=e=>_.value=!1)},[i("div",_o,[i("div",{class:"flex items-center text-base mr-[3rem] flex-shrink-0 cursor-pointer",onClick:t[0]||(t[0]=e=>s(f).openProduct(28))},[t[11]||(t[11]=i("div",{class:"ltd-privilege-title flex flex-shrink-0 items-center ltd-title-edit"},[i("span",{class:"text-base pl-[2.4rem] font-bold !text-[#fff]"}," 企业版 ")],-1)),i("span",{class:h({"text-danger":s(u)<7,"text-warning":s(u)>=7,"ml-[8px]":!0,"font-bold":!0})},r(s(nt)(s(I),"yyyy-MM-dd")),3),m(l,{class:"ml-[8px]",size:"13px"},{default:p(()=>[...t[10]||(t[10]=[y("续费",-1)])]),_:1})]),i("div",ko,[(o(!0),n(L,null,T(s(v),(e,t)=>(o(),n("div",{class:"advantage-item",key:t},[m(d,{name:"tools-".concat(e[0].split("_")[0]),size:"20",class:"mr-[4px]"},null,8,["name"]),i("span",Co,r(e[1]),1)]))),128))])]),V(i("div",{class:"day-not-display",onClick:t[1]||(t[1]=e=>s(f).setRecommendHide(3))},[...t[12]||(t[12]=[i("i",{class:"svgtofont-el-close"},null,-1),i("span",null,"近3天不再显示",-1)])],512),[[U,s(_)]])],32)):"free"===s(S)?(o(),n("div",{key:1,class:"advantage-view",onMouseover:t[6]||(t[6]=e=>_.value=!0),onMouseleave:t[7]||(t[7]=e=>_.value=!1)},[i("div",So,[i("div",Io,[i("div",Po,[i("button",{class:"product-payment-btn",onClick:t[4]||(t[4]=e=>s(f).openProduct(27))},[...t[13]||(t[13]=[i("span",{class:"ml-[1.2rem text-base"}," 立即开通 ",-1)])])]),t[14]||(t[14]=i("div",{class:"ltd-privilege-title flex flex-shrink-0 items-center mr-[8px]"},[i("span",{class:"text-medium ml-[.4rem] mr-[2rem] pl-[3rem] font-bold"}," 企业版VIP特权 ")],-1))]),i("div",Lo,[(o(!0),n(L,null,T(s(v),(e,t)=>(o(),n("div",{class:"advantage-item",key:t},[m(d,{name:"tools-".concat(e[0].split("_")[0]),size:"20",class:"mr-[4px]"},null,8,["name"]),i("span",To,r(e[1]),1)]))),128))])]),V(i("div",{class:"day-not-display",onClick:t[5]||(t[5]=e=>s(f).setRecommendHide(1))},[...t[15]||(t[15]=[i("i",{class:"svgtofont-el-close"},null,-1),y("近24小时不再显示",-1)])],512),[[U,s(_)]])],32)):c("",!0),m(j,{modelValue:s(C),"onUpdate:modelValue":t[9]||(t[9]=e=>R(C)?C.value=e:null),area:96},{default:p(()=>[i("div",jo,[m(P,{src:"/advantage/privilege-contrast.png"}),i("div",Mo,[i("div",Eo,[t[16]||(t[16]=i("p",{class:"text-extraLarge text-default font-bold h-[9.4rem] leading-[9.4rem] text-center"},"功能特权",-1)),i("ul",Bo,[(o(!0),n(L,null,T(s(w),(e,t)=>(o(),n("li",{class:"px-[24px] h-[4rem] leading-[4rem]",key:t},r(e),1))),128))])]),i("div",Ro,[i("div",Do,[i("p",null,[m(P,{src:"/advantage/privilege-pro.svg",class:"mr-[8px]"}),t[17]||(t[17]=y("专业版",-1))])]),i("ul",Oo,[(o(!0),n(L,null,T(s(b),(e,t)=>(o(),n("li",{class:"px-[24px] h-[4rem] leading-[4rem] text-center",key:t},[e?(o(),n("i",Vo)):(o(),n("i",Ao))]))),128))])]),(o(),n(L,null,T(2,(e,a)=>i("div",{class:h(["w-[22rem] bg-[var(--bt-ltd-bg-color)] flex-col relative",a?"":"border-2 border-darkSecondary h-[64.6rem] shadow"]),key:a},[0===a?(o(),n("span",zo)):c("",!0),i("div",{class:h(["text-extraLarge flex flex-col justify-center items-center",a?" h-[9.4rem]":" h-[11rem]"])},[i("div",Fo,[m(P,{class:"mr-[8px]",src:"/advantage/privilege-diamond.svg"}),i("span",{class:h(a?"":"linear")},r(a?"企业运维托管":"企业版"),3)]),i("button",{class:h(["px-[20px] py-[4px]",a?"linear text-border privilege-button font-bold":"button-linear privilege-button"]),onClick:t[8]||(t[8]=e=>s(f).openProduct(45))},"立即购买",2)],2),i("ul",Ho,[0===a?(o(!0),n(L,{key:0},T(s(x),(e,t)=>(o(),n("li",{key:t},[e?(o(),n("i",Wo)):(o(),n("i",No))]))),128)):c("",!0),0!=a?(o(!0),n(L,{key:1},T(s(g),(e,t)=>(o(),n("li",{key:t},[e?c("",!0):(o(),n("i",Uo)),e?(o(),n("i",qo)):c("",!0)]))),128)):c("",!0)])],2)),64))])])]),_:1},8,["modelValue"])])):c("",!0)}}}),[["__scopeId","data-v-44adae4e"]]),Ko={class:"pt-[1.2rem]"},$o=Pe(e({__name:"index",setup(e){const{getAlarmData:r,forceLtd:u,payment:f,aliyunEcsLtd:y,getUserInfo:h,isHideAd:g,panel:x,getSoftRemarks:b}=we(),w=Bt(),{panelInfo:_}=d(w),{isRestart:k}=a(_.value),S=I(),P=be(),L=t(null),T=t(0);Z(L,e=>{const t=e[0];T.value=t.contentRect.width});let j=null;return C(()=>x.value.initInstall,e=>{if(!e){if(y.value&&"free"===f.value.authType)return;w.recommendInstallDialog()}},{immediate:!0,deep:!0}),C(()=>x.value.oem,e=>{e&&Pt()},{immediate:!0}),l(async()=>{if("bind-cupon"===P.query.model){const e={...P.query};delete e.model,S.replace({path:P.path,query:e}),await h(),gt({disablePro:!0,sourceId:999})}w.monitorLoginInfo(),j=ct({idle:36e5,request:async()=>(await w.getSystemInfo(),k.value),timeout:3e3,retries:3}),w.getHomeConfig(),ut({promises:[r,w.getUpdateInfoNew,b],delay:1e3})}),Y(()=>{null==j||j.stop(),dt(["/system?action=GetNetWork","/panel/overview/GetOverview","/plugin?action=get_index_list","/ajax?action=get_pay_type","/mod/push/task/get_task_list","/auth?action=get_coupon_list"])}),(e,t)=>{const a=X,l=ee;return o(),n("section",Ko,[m(ea,{class:"mx-[1.2rem]"}),m(l,{span:24},{default:p(()=>[m(a,{span:24},{default:p(()=>[m(na),i("div",{ref_key:"stateMainRef",ref:L},[m(ys,{class:"px-[1.2rem]","main-width":s(T)},null,8,["main-width"])],512),m(Vs)]),_:1})]),_:1}),m(l,{span:24,class:"px-[1.2rem]"},{default:p(()=>[m(l,{span:24,gutter:12,class:"flex-1"},{default:p(()=>[m(a,{md:24,sm:24,span:12,xs:24,lg:12},{default:p(()=>[m(xo,{class:"mb-0 monitor-view"})]),_:1}),m(a,{md:24,sm:24,span:12,xs:24,lg:12},{default:p(()=>[m(io,{class:"mb-0 software-view"})]),_:1})]),_:1})]),_:1}),s(g)?c("",!0):(o(),v(Go,{key:0,class:"mt-[1.2rem] mx-[1.2rem]"}))])}}}),[["__scopeId","data-v-8a00f024"]]),Jo=Object.freeze(Object.defineProperty({__proto__:null,default:$o},Symbol.toStringTag,{value:"Module"}));export{ia as H,ra as a,Aa as b,gs as c,Jo as i};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
