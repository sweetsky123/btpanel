import{g as e}from"./useStore.js?v=1763689792";import{Q as a,T as l,j as t,n as s,H as n,M as u,e as o,k as r,U as i,_ as d,V as c,B as m,p,W as v,l as f}from"./utils-lib.js?v=1763689792";import{c as _,r as y,o as g,v as w,x as h,y as x,e as V,C as b,z as k,R as C,D as U,A,ap as j,H as S,ad as q,ab as T,O as I,w as P,I as L,J as B,F as D,G as E,K as F,V as H,W as z,b1 as M,an as N,am as R,S as O,b2 as G,al as J,aj as K,g as W}from"./base-lib.js?v=1763689792";import{_ as Q}from"./validator.js?v=1763689792";import{t as $,u as X,v as Y,w as Z,x as ee,y as ae,z as le,A as te,B as se,C as ne,D as ue,E as oe,F as re,G as ie,H as de,I as ce,J as me,K as pe,L as ve,M as fe,N as _e,O as ye,P as ge}from"./config.js?v=1763689792";import{C as we}from"./index117.js?v=1763689792";import{a as he,_ as xe,P as Ve,S as be}from"./index.vue_vue_type_script_setup_true_lang2.js?v=1763689792";import{o as ke}from"./useMethod.js?v=1763689792";import{_ as Ce}from"./index109.js?v=1763689792";import{_ as Ue}from"./index118.js?v=1763689792";import{u as Ae}from"./column.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./index107.js?v=1763689792";import"./index108.js?v=1763689792";const je={class:"p-16px"},Se=_({__name:"index",setup(e){const s=y([]),n=y(null),u=y(!1),o=y(!1),r=g({type:[],options:"",id:""});let i=null;const d={type:[{required:!0,validator:(e,a,l)=>{0===r.type.length?l(new Error("请选择告警方式")):l()},trigger:["blur","change"]}]},c=async e=>{e?o.value=!0:await a({loading:"正在保存信息配置，请稍后...",request:$({task_id:r.id,status:e?1:0}),message:!0,success:a=>{a.status||(u.value=!e)}})},m=()=>{o.value=!1,v()},p=async()=>{await a({request:l(),data:{data:[Array,s]}})},v=()=>{var e;const a=null==(e=s.value)?void 0:e.find(e=>"panel_safe_push"===e.keyword);a?(r.type=a.sender,u.value=a.status,r.id=a.id,i=a):(r.type=[],u.value=!1,i=null)};return w(async()=>{await p(),v()}),(e,l)=>{const s=j,f=S,_=q,y=Q,g=T,w=t;return h(),x("div",null,[V(k(we),{label:"面板安全告警"},{value:b(()=>[V(s,{modelValue:k(u),"onUpdate:modelValue":l[0]||(l[0]=e=>C(u)?u.value=e:null),onChange:c},null,8,["modelValue"]),V(f,{size:"small",class:"!ml-12px",onClick:l[1]||(l[1]=e=>o.value=!0)},{default:b(()=>[...l[6]||(l[6]=[U("提醒方式",-1)])]),_:1})]),desc:b(()=>[...l[7]||(l[7]=[A("span",null,"告警内容包含：面板用户变更、面板日志删除、面板开启开发者、面板开启API",-1)])]),_:1}),V(w,{title:"面板安全告警",modelValue:k(o),"onUpdate:modelValue":l[4]||(l[4]=e=>C(o)?o.value=e:null),showFooter:"",area:[48],onConfirm:l[5]||(l[5]=e=>(async()=>{await n.value.validate();let e={},l={send_interval:0,time_range:[0,86399]},t={day_num:0,total:0};e=i?{task_data:i.task_data,sender:r.type,time_rule:l,number_rule:t}:{task_data:{tid:"6",type:"panel_safe_push",title:"面板安全告警",status:u.value,count:0,interval:600,project:"",help:600},sender:r.type,time_rule:l,number_rule:t},await a({loading:"正在保存信息配置，请稍后...",request:X({task_data:JSON.stringify(e),template_id:"6"}),message:!0}),await p(),v(),o.value=!1})()),onCancel:m,confirmText:"保存配置"},{default:b(()=>[A("div",je,[V(g,{ref_key:"ruleFormRef",ref:n,"label-width":"10rem",rules:d,model:k(r)},{default:b(()=>[V(_,{label:"安全提醒"},{default:b(()=>[V(s,{modelValue:k(u),"onUpdate:modelValue":l[2]||(l[2]=e=>C(u)?u.value=e:null)},null,8,["modelValue"])]),_:1}),V(_,{label:"告警方式",prop:"type"},{default:b(()=>[V(y,{class:"!w-[30rem]",modelValue:k(r).type,"onUpdate:modelValue":l[3]||(l[3]=e=>k(r).type=e),limit:["sms"]},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"])])}}}),qe=["innerHTML"],Te=_({__name:"index",setup(l){const{getCertListData:t}=e(),u=y({}),o=y('配置一个域名来访问面板，<span class="text-danger">注意: 通过域名访问面板时，重启Nginx会短暂断开连接</span>');let r=!1;const i=()=>{s({title:"免端口访问配置",component:()=>n(()=>import("./no-port-config.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:{...u.value,refresh:d},area:80,onCancel:()=>{u.value.proxy_stats=r}})},d=async()=>{await a({request:Z(),success:({data:e})=>{u.value={addr:(null==e?void 0:e.addr)||"",cert:(null==e?void 0:e.cert)||"",key:(null==e?void 0:e.key)||"",proxy_stats:(null==e?void 0:e.proxy_stats)||!1,domain:(null==e?void 0:e.domain)||"",use_ssl:(null==e?void 0:e.use_ssl)||!1},r=(null==e?void 0:e.proxy_stats)||!1}})};return w(()=>d()),(e,l)=>{const s=j,n=S;return h(),I(k(we),{label:"免端口访问"},{value:b(()=>[V(s,{modelValue:k(u).proxy_stats,"onUpdate:modelValue":l[0]||(l[0]=e=>k(u).proxy_stats=e),onChange:l[1]||(l[1]=e=>(async e=>{e?i():await a({loading:"正在删除面板生成的域名，请稍候...",request:Y(),message:!0,success:t})})(k(u).proxy_stats))},null,8,["modelValue"]),V(n,{size:"small",class:"!ml-12px",onClick:l[2]||(l[2]=e=>i())},{default:b(()=>[...l[3]||(l[3]=[U(" 免端口访问配置 ",-1)])]),_:1})]),desc:b(()=>[A("span",{innerHTML:k(o)},null,8,qe)]),_:1})}}}),Ie={class:"p-[24px]"},Pe=_({__name:"index",setup(a){const{refs:{safeConfig:l}}=e();y(!1);const s=y(!1);y(!1);const n=g({basic_user:"",basic_pwd:"",open:!0});return(e,a)=>{const i=j,d=o,c=q,m=r,p=S,v=T,f=t;return h(),x("div",null,[V(k(we),{label:"BasicAuth认证"},{value:b(()=>[V(i,{modelValue:k(l).basicAuth,"onUpdate:modelValue":a[0]||(a[0]=e=>k(l).basicAuth=e),onChange:a[1]||(a[1]=e=>(async e=>{if(e)ke({content:['<span class="text-danger">必须要用到且了解此功能才决定自己是否要开启!!<span>',"开启后，以任何方式访问面板，将先要求输入BasicAuth用户名和密码","开启后，能有效防止面板被扫描发现，但并不能代替面板本身的帐号密码","请牢记BasicAuth密码，一但忘记将无法访问面板","如忘记密码，可在SSH通过bt命令来关闭BasicAuth验证"],isShowAppCode:!1,checkTip:'我已了解详情,并愿意承担风险！<a class="bt-link" href="https://www.bt.cn/bbs/thread-34374-1-1.html" target="_blank" rel="noreferrer noopener">什么是BasicAuth认证？</a>',onConfirm:()=>s.value=!0,onCancel:()=>l.value.basicAuth=!1});else{const{data:e}=await ee({open:"False",basic_user:"",basic_pwd:""});u.request(e),e.status&&setTimeout(()=>window.location.reload(),1e3)}})(k(l).basicAuth))},null,8,["modelValue"])]),desc:b(()=>[a[10]||(a[10]=A("span",null,"为面板增加一道基于BasicAuth的认证服务，有效防止面板被扫描，",-1)),V(d,{href:"https://www.bt.cn/bbs/thread-34374-1-1.html"},{default:b(()=>[...a[9]||(a[9]=[U("了解详情",-1)])]),_:1})]),_:1}),V(f,{title:"配置BasicAuth认证",modelValue:k(s),"onUpdate:modelValue":a[7]||(a[7]=e=>C(s)?s.value=e:null),area:50,onCancel:a[8]||(a[8]=e=>(l.value.basicAuth=!l.value.basicAuth,void n.open))},{default:b(()=>[A("div",Ie,[V(v,{modelValue:k(n),"onUpdate:modelValue":a[6]||(a[6]=e=>C(n)?n.value=e:null)},{default:b(()=>[V(c,{label:"服务状态"},{default:b(()=>[V(i,{modelValue:k(n).open,"onUpdate:modelValue":a[2]||(a[2]=e=>k(n).open=e)},null,8,["modelValue"])]),_:1}),V(c,{label:"用户名"},{default:b(()=>[V(m,{class:"!w-[28.8rem]",modelValue:k(n).basic_user,"onUpdate:modelValue":a[3]||(a[3]=e=>k(n).basic_user=e),placeholder:"请设置用户名"},null,8,["modelValue"])]),_:1}),V(c,{label:"密码"},{default:b(()=>[V(m,{class:"!w-[28.8rem]",modelValue:k(n).basic_pwd,"onUpdate:modelValue":a[4]||(a[4]=e=>k(n).basic_pwd=e),placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),V(c,{label:" "},{default:b(()=>[V(p,{type:"primary",onClick:a[5]||(a[5]=e=>(async()=>{try{const{data:e}=await ee({...n,open:n.open?"True":"False"});u.request(e),e.status&&(s.value=!1,window.location.reload())}catch(e){}})())},{default:b(()=>[...a[11]||(a[11]=[U("保存",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a[12]||(a[12]=A("ul",{class:"pl-[32px] list-disc help leading-8"},[A("li",null,"注意：请不要在这里使用您的常用密码，这可能导致密码泄漏!"),A("li",null,"开启后，以任何方式访问面板，将先要求输入BasicAuth用户名和密码"),A("li",null,"开启后，能有效防止面板被扫描发现，但并不能代替面板本身的帐号密码"),A("li",null,"请牢记BasicAuth密码，一但忘记将无法访问面板"),A("li",null,"如忘记密码，可在SSH通过bt命令来关闭BasicAuth验证")],-1))])]),_:1},8,["modelValue"])])}}}),Le=_({__name:"index",setup(l){const{refs:{safeConfig:t}}=e();y(!1);const u=()=>{ke({content:['<span class="text-danger">必须要用到且了解此功能才决定自己是否要开启!!<span>','<span class="text-danger">如果无法验证，命令行输入"bt 24" 取消动态口令认证<span>',"服务器的时间与网络时间需一致，否则无法验证。","开启服务后，请立即绑定，以免出现面板不能访问。","请先下载宝塔APP或(谷歌认证器)，并完成安装和初始化。",'基于google Authenticator 开发,如遇到问题请<a class="btlink" href="https://www.bt.cn/bbs/forum.php?mod=viewthread&tid=105839" rel="noreferrer noopener">查看详情</a>'],isShowAppCode:!0,onConfirm:()=>d(1)})},r=()=>{t.value.checkTwoStep?i():u()},i=()=>{s({title:"动态口令配置",component:()=>n(()=>import("./dyname-pwd-config.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),area:55})},d=async e=>{(await a({loading:"正在设置动态口令配置，请稍候...",request:ae({act:e}),message:!0,success:()=>{e&&i()}})).status&&(t.value.checkTwoStep=Boolean(e))};return w(()=>{(async()=>{const{data:e}=await le();t.value.checkTwoStep=e.status})()}),(e,a)=>{const l=j,s=S,n=o;return h(),x("div",null,[V(k(we),{label:"动态口令认证"},{value:b(()=>[V(l,{modelValue:k(t).checkTwoStep,"onUpdate:modelValue":a[0]||(a[0]=e=>k(t).checkTwoStep=e),onChange:a[1]||(a[1]=e=>{return a=k(t).checkTwoStep,t.value.checkTwoStep=!a,void(a?u():d(Number(a)));var a})},null,8,["modelValue"]),V(s,{size:"small",class:"!ml-12px",onClick:r},{default:b(()=>[...a[2]||(a[2]=[U("动态口令配置",-1)])]),_:1})]),desc:b(()=>[a[4]||(a[4]=A("span",null,"(Google Authenticator，谷歌身份认证)为面板提供动态口令的登录的验证，",-1)),V(n,{href:"https://www.bt.cn/bbs/forum.php?mod=viewthread&tid=105839"},{default:b(()=>[...a[3]||(a[3]=[U("了解详情",-1)])]),_:1})]),_:1})])}}}),Be={class:"p-[2rem]"},De={class:"flex mt-12px"},Ee={class:"flex-1 mr-20px relative"},Fe={class:"placeholder"},He={class:"flex-1 relative"},ze={class:"placeholder"},Me={key:1,class:"help-list !pl-20px mt-12px !py-0"},Ne={class:"text-small flex items-center"},Re=d(_({__name:"index",setup(l){const{refs:{safeConfig:s}}=e(),n=y(!1),d=y(!1),c=y(!1),m=g({loading:!1,title:"正在获取证书信息，请稍候..."}),p=y({crl:"",cert:""}),v=async()=>{m.title="正在获取证书信息，请稍候...",m.loading=!0,n.value=!0;try{const{data:e}=await te();s.value.sslVerify=e.status,p.value.crl=e.crl,p.value.cert=e.ca}catch(e){n.value=!1}finally{m.loading=!1}},f=async()=>{try{if(!p.value.crl)return u.error("注销列表(crl)不能为空"),!1;if(!p.value.cert)return u.error("证书(cert)不能为空"),!1;if(d.value&&!c.value)return u.error("请勾选并同意承担风险"),!1;m.title="正在保存，请稍候...",m.loading=!0;const e=await a({request:se({crl:p.value.crl,cert:p.value.cert,status:d.value?1:0}),message:!0});return await i(),e.status&&window.location.reload(),e.status}catch(e){}finally{m.loading=!1}};return P(n,(e,a)=>{!e&&(p.value.crl="",p.value.cert="")}),w(()=>{(async()=>{const{data:e}=await te();p.value.crl=e.crl,p.value.cert=e.ca,s.value.sslVerify=e.status})()}),(e,a)=>{const l=j,i=S,_=o,y=r,g=H,w=t,q=L("bt-loading");return h(),x("div",null,[V(k(we),{label:"访问设备验证"},{value:b(()=>[V(l,{modelValue:k(s).sslVerify,"onUpdate:modelValue":a[0]||(a[0]=e=>k(s).sslVerify=e),onChange:a[1]||(a[1]=e=>(async e=>{try{if(!s.value.panelSSl)return u.error("请先开启面板SSL证书后重试"),void(s.value.sslVerify=!1);const{data:a}=await te();if(p.value.crl=a.crl,p.value.cert=a.ca,d.value=!0,e)n.value=!0;else{const{data:e}=await se({status:0});e.status&&window.location.reload()}}catch(a){}})(k(s).sslVerify))},null,8,["modelValue"]),V(i,{size:"small",class:"!ml-12px",onClick:v},{default:b(()=>[...a[7]||(a[7]=[U("访问设备验证配置",-1)])]),_:1})]),desc:b(()=>[a[9]||(a[9]=A("span",null," 基于SSL证书双向验证，开启后电脑需要安装此证书，否则将无法访问，属于极高安全级别的访问限制方式，类似银行账号U盘密钥登录。 ",-1)),V(_,{href:"https://www.bt.cn/bbs/thread-77863-1-1.html"},{default:b(()=>[...a[8]||(a[8]=[U("了解详情",-1)])]),_:1})]),_:1}),V(w,{title:"自定义证书",modelValue:k(n),"onUpdate:modelValue":a[5]||(a[5]=e=>C(n)?n.value=e:null),area:70,showFooter:"",onConfirm:f,onCancel:a[6]||(a[6]=e=>(d.value&&(s.value.sslVerify=!s.value.sslVerify),void(d.value=!1)))},{default:b(()=>[B((h(),x("div",Be,[k(d)?(h(),x(D,{key:0},[a[10]||(a[10]=A("div",{class:"flex items-center"},[A("i",{class:"svgtofont-el-warning-filled text-warningDark !text-titleLarge pr-4"}),A("p",{class:"text-extraLarge"},"风险操作！此功能不懂请勿开启！")],-1)),a[11]||(a[11]=A("ul",{class:"help-list"},[A("li",{class:"text-danger"},"必须要用到且了解此功能才决定自己是否要开启！"),A("li",null,"开启后电脑需要安装此证书，否则将无法访问，属于【极高安全级别】的限制，类似银行账号U盘密钥登录。"),A("li",null,"注销列表(crl)和证书(cert)可通过企业版插件[堡塔限制访问型证书->双向认证->服务器证书]获取。"),A("li",null,"开启之前请先下载好对应的[客户端证书]，否则将无法访问面板。"),A("li",null,"开启访问设备验证后，未授权的用户访问将会出现400错误。"),A("li",null,"开启后导致面板不能访问，命令行：bt 29 关闭访问设备验证。")],-1))],64)):E("",!0),A("div",De,[A("div",Ee,[a[12]||(a[12]=A("div",{class:"text-small mb-8px"},"注销列表(crl)",-1)),V(y,{class:"text-small",type:"textarea",modelValue:k(p).crl,"onUpdate:modelValue":a[2]||(a[2]=e=>k(p).crl=e),rows:13,size:"small"},null,8,["modelValue"]),B(A("span",Fe,"请粘贴您的注销列表（crl）",512),[[F,""===k(p).crl]])]),A("div",He,[a[13]||(a[13]=A("div",{class:"text-small mb-8px"},"证书(cert)",-1)),V(y,{type:"textarea",modelValue:k(p).cert,"onUpdate:modelValue":a[3]||(a[3]=e=>k(p).cert=e),rows:13,size:"small"},null,8,["modelValue"]),B(A("span",ze,"请粘贴您的证书(cert)",512),[[F,""===k(p).cert]])])]),k(d)?(h(),I(g,{key:2,modelValue:k(c),"onUpdate:modelValue":a[4]||(a[4]=e=>C(c)?c.value=e:null),class:"mt-12px px-16px"},{default:b(()=>[A("div",Ne,[a[16]||(a[16]=U(" 已了经解详情,并愿意承担风险！ ",-1)),V(_,{href:"https://www.bt.cn/bbs/thread-77863-1-1.html",target:"_blank"},{default:b(()=>[...a[15]||(a[15]=[U(" 了解详情 ",-1)])]),_:1})])]),_:1},8,["modelValue"])):(h(),x("ul",Me,[...a[14]||(a[14]=[A("li",null,"粘贴您的注销列表(crl)以及证书(cert)，然后保存即可。",-1),A("li",null,"注销列表(crl)和证书(cert)可通过企业版插件[堡塔限制访问型证书->双向认证->服务器证书]获取。",-1)])]))])),[[q,k(m).loading],[q,k(m).title,"title"]])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-2fca8520"]]),Oe=_({__name:"index",setup(l){const{refs:{safeConfig:s}}=e(),n=y(!1),u=y(!1),o=e=>{e?n.value=!0:u.value=!0},r=e=>{const a=e?n:u;a.value&&(s.value.pawComplexity=!s.value.pawComplexity,a.value=!1)},i=e=>{const a=e?n:u;a.value&&(a.value=!1,c())},d=async()=>{try{const{data:e}=await ue();s.value.pawComplexity=e.password_safe}catch(e){}},c=async()=>{await a({loading:"正在设置密码复杂度，请稍候...",request:ne(),message:!0,success:d})};return(e,a)=>{const l=j,d=t;return h(),x("div",null,[V(k(we),{label:"密码复杂度验证"},{value:b(()=>[V(l,{modelValue:k(s).pawComplexity,"onUpdate:modelValue":a[0]||(a[0]=e=>k(s).pawComplexity=e),onChange:o},null,8,["modelValue"])]),desc:b(()=>[...a[7]||(a[7]=[A("span",null,"为面板密码提供复杂度验证方式，复杂度验证规则：",-1),A("span",{class:"text-danger"},"密码必须满足密码长度大于8位且大写字母、小写字母、数字、特殊字符至少3项组合",-1)])]),_:1}),V(d,{title:"开启 密码复杂度验证",modelValue:k(n),"onUpdate:modelValue":a[1]||(a[1]=e=>C(n)?n.value=e:null),area:36,"show-footer":!0,onConfirm:a[2]||(a[2]=e=>i(!0)),onCancel:a[3]||(a[3]=e=>r(!0))},{default:b(()=>[...a[8]||(a[8]=[A("div",{class:"p-[2rem] flex"},[A("i",{class:"svgtofont-el-warning-filled text-warningDark !text-titleLarge pr-4"}),A("p",{class:"text-base leading-8"},[U(" 开启密码复杂度验证后，将会对密码进行复杂度判断，规则： "),A("span",{class:"text-danger"},"密码必须满足密码长度大于8位且大写字母、小写字母、数字、特殊字符至少3项组合"),U(" ，继续操作！ ")])],-1)])]),_:1},8,["modelValue"]),V(d,{title:"关闭 密码复杂度验证",modelValue:k(u),"onUpdate:modelValue":a[4]||(a[4]=e=>C(u)?u.value=e:null),area:[36,"auto"],"show-footer":!0,onConfirm:a[5]||(a[5]=e=>i(!1)),onCancel:a[6]||(a[6]=e=>r(!1))},{default:b(()=>[...a[9]||(a[9]=[A("div",{class:"p-[2rem] flex"},[A("i",{class:"svgtofont-el-warning-filled text-warningDark !text-titleLarge pr-4"}),A("p",{class:"text-base leading-8"},"关闭密码复杂度后，密码登录将不再验证密码复杂度，这将会导致面板安全性下降，继续操作！")],-1)])]),_:1},8,["modelValue"])])}}}),Ge={class:"w-[26rem]"},Je=_({__name:"index",setup(a){const{refs:{safeConfig:l},saveConfig:t}=e();return(e,a)=>{const s=r,n=S;return h(),I(k(we),{label:"授权IP"},{value:b(()=>[A("div",Ge,[V(s,{modelValue:k(l).limitip,"onUpdate:modelValue":a[0]||(a[0]=e=>k(l).limitip=e),placeholder:"示例: 1.1.1.1,2.2.2.1-2.2.2.2"},null,8,["modelValue"])]),V(n,{type:"primary",class:"!ml-12px",onClick:a[1]||(a[1]=e=>(async()=>{let e=/^((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}$/,a=l.value.limitip.split(",").join("-").split("-"),s=!0;if(a.length)for(let l=0;l<a.length;l++)0==e.test(a[l])&&(s=!1);if(!s&&l.value.limitip.length>0)return u.error("请输入正确的ip地址");t("正在保存授权IP，请稍候...")})())},{default:b(()=>[...a[2]||(a[2]=[U("保存",-1)])]),_:1})]),desc:b(()=>[...a[3]||(a[3]=[A("span",null,"设置访问授权IP，多个IP地址，请使用“,”分割，",-1),A("span",{class:"text-danger"},"注意：一旦设置授权IP，只有指定IP的电脑能访问面板",-1)])]),_:1})}}}),Ke={class:"p-[2rem]"},We=d(_({__name:"index",setup(l){var s;const{refs:{safeConfig:n}}=e(),u=z([{key:403,title:"403-拒绝访问"},{key:404,title:"404-页面不存在"},{key:416,title:"416-无效的请求"},{key:408,title:"408-客户端超时"},{key:400,title:"400-客户端请求错误"},{key:401,title:"401-未授权访问"}]),o=y(!1),i=y(404),d=y(null==(s=u.value.find(e=>e.key===n.value.statusCode))?void 0:s.title),c=async e=>{e?Number(e):e+="",await a({loading:"正在设置未认证响应状态，请稍候...",request:oe({status_code:e}),message:!0}),u.value.forEach(e=>{e.key==i.value&&(n.value.statusCode=e.key,d.value=e.title)})};return P(()=>n.value.statusCode,e=>{u.value.forEach(e=>{e.key===n.value.statusCode&&(d.value=e.title)})}),(e,a)=>{const l=r,s=S,m=R,p=N,v=q,f=T,_=t;return h(),x("div",null,[V(k(we),{label:"未认证响应状态"},{value:b(()=>[V(l,{modelValue:k(d),"onUpdate:modelValue":a[0]||(a[0]=e=>C(d)?d.value=e:null),disabled:"",class:"!w-[26rem]"},null,8,["modelValue"]),V(s,{type:"primary",class:"!ml-12px",onClick:a[1]||(a[1]=e=>(o.value=!0,void u.value.forEach(e=>{e.key==n.value.statusCode&&(i.value=e.key)})))},{default:b(()=>[...a[5]||(a[5]=[U("设置",-1)])]),_:1})]),desc:b(()=>[...a[6]||(a[6]=[A("span",null,"陌生IP在未登录且未正确输入安全入口时的响应，可用于隐藏面板特征",-1)])]),_:1}),V(_,{title:"设置未认证时的响应状态",modelValue:k(o),"onUpdate:modelValue":a[3]||(a[3]=e=>C(o)?o.value=e:null),area:42,"show-footer":"",onConfirm:a[4]||(a[4]=e=>(o.value=!1,void c(i.value)))},{default:b(()=>[A("div",Ke,[V(f,{class:"my-[12px] flex justify-center","label-position":"right"},{default:b(()=>[V(v,{label:"响应状态"},{default:b(()=>[V(p,{modelValue:k(i),"onUpdate:modelValue":a[2]||(a[2]=e=>C(i)?i.value=e:null),placeholder:"请选择",class:"!w-[20rem]"},{default:b(()=>[(h(!0),x(D,null,M(k(u),e=>(h(),I(m,{key:e.key,label:e.title,value:e.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a[7]||(a[7]=A("ul",{class:"px-[16px] py-[2px] list-disc"},[A("li",{class:"h-[2.4rem] text-danger"},"用于未登录且未正确输入安全入口时的响应,用于隐藏面板特征")],-1))])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-548f910f"]]),Qe={class:"w-[26rem]"},$e={class:"p-[2rem]"},Xe=_({__name:"index",setup(l){const{refs:{safeConfig:s}}=e(),n=y(),u=y({day:0}),o=y(""),i=y(!1);let d=0;const m=g({day:[{validator:(e,a,l)=>{Number.parseInt(a)<0||!Number.isInteger(parseFloat(a))?l(new Error("请输入大于等于0的整数")):l()},trigger:["input","change"]}]});P(()=>i.value,e=>{e&&(u.value.day=d)});const p=async()=>{try{const{data:e}=await ue();e.expire?o.value=c(e.expire_time,"yyyy/MM/dd HH:mm:ss")+" （剩余"+e.expire_day+"天过期）":o.value="未设置",u.value.day=e.expire,d=e.expire,s.value.pawComplexity=e.password_safe}catch(e){}},v=async e=>{await a({loading:"正在设置密码过期时间，请稍候...",request:re({expire:e}),message:!0})};return w(()=>{p()}),(e,a)=>{const l=r,s=S,d=q,c=T,f=t;return h(),x("div",null,[V(k(we),{label:"密码过期时间"},{value:b(()=>[A("div",Qe,[V(l,{modelValue:k(o),"onUpdate:modelValue":a[0]||(a[0]=e=>C(o)?o.value=e:null),disabled:""},null,8,["modelValue"])]),V(s,{type:"primary",class:"!ml-12px",onClick:a[1]||(a[1]=e=>i.value=!0)},{default:b(()=>[...a[6]||(a[6]=[U("设置",-1)])]),_:1})]),desc:b(()=>[...a[7]||(a[7]=[A("span",null,"为面板密码设置过期时间，过期后需要重新设置密码",-1)])]),_:1}),V(f,{title:"设置密码过期时间",modelValue:k(i),"onUpdate:modelValue":a[4]||(a[4]=e=>C(i)?i.value=e:null),area:40,"show-footer":!0,onConfirm:a[5]||(a[5]=e=>(async()=>{await n.value.validate(),i.value=!1,v(u.value.day),p()})())},{default:b(()=>[A("div",$e,[V(c,{ref_key:"pwdFormRef",ref:n,rules:k(m),model:k(u),class:"my-[12px] flex justify-center","label-position":"left",onSubmit:a[3]||(a[3]=O(()=>{},["prevent"]))},{default:b(()=>[V(d,{label:"密码过期时间",prop:"day"},{default:b(()=>[V(l,{modelValue:k(u).day,"onUpdate:modelValue":a[2]||(a[2]=e=>k(u).day=e),"text-type":"天",type:"number",min:"0",class:"!w-[16rem]"},{append:b(()=>[...a[8]||(a[8]=[U(" 天 ",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["rules","model"]),a[9]||(a[9]=A("ul",{class:"px-[1.6rem] py-[.2rem] list-disc"},[A("li",{class:"h-[2.4rem] text-danger"},"面板密码过期时间设置，过期后需要重新设置密码"),A("li",{class:"h-[2.4rem]"},"密码过期时间为“0天”，则关闭密码过期时间功能")],-1))])]),_:1},8,["modelValue"])])}}}),Ye={class:"p-[2rem] flex"},Ze={class:"p-[2rem]"},ea=_({__name:"index",setup(e){const l=y(!1),s=y([]),n=y(!1),u=y(0),o=g({p:1,rows:10}),i=y(!1),d=y(!1),_=y([]),j=y(!1),P=y(),D=y({checkboxValue:"3小时",day:1}),F=y(""),H=y(),z=y(),M=y(!1),N={day:[{validator:(e,a,l)=>{(a<=0||a%1!=0)&&"自定义"===D.value.checkboxValue?l(new Error("自定义时间为大于0的整数！")):l()},trigger:["blur","change","input"]}]},R=[{label:"登录IP",render:e=>e.login_addr||"未登录"},{label:"状态",width:90,render:(e,a)=>{switch(e.state){case-1:return V("span",{class:"text-[brown]"},[U("已过期")]);case 0:return V("span",{class:"text-primary"},[U("待使用")]);case 1:return"已使用"}}},{label:"登录时间",render:e=>0==e.login_time?"未登录":c(e.addtime,"yyyy/MM/dd HH:mm:ss")},{label:"过期时间",render:e=>c(e.expire)},{label:"操作",width:120,align:"right",render:e=>V("div",{class:"flex items-center justify-end"},[V("div",{class:"1"==e.state?"":"hidden"},[V("span",{class:"bt-link",onClick:()=>Q(e.id,e.login_addr)},[U("操作日志")]),V(G,{direction:"vertical"},null)]),V("span",{class:"bt-link",onClick:()=>W(e.id)},[U("删除")])])}],O=[{label:"操作类型",prop:"type"},{label:"操作时间",prop:"addtime"},{label:"日志",prop:"log",width:350}],W=async e=>{H.value=e,await p({title:"删除授权",content:"删除授权记录，是否继续？",icon:"warning-filled"}),await a({loading:"正在删除临时授权，请稍候...",request:ie({id:e}),message:!0}),Z()},Q=(e,a)=>{i.value=!0,H.value=e,z.value=a,$()},$=()=>Y(H.value),X=async()=>{const{checkboxValue:e,day:l}=D.value;let t="自定义"===e?24*l:e.replaceAll("小时",""),s=Math.floor(Date.now()/1e3);t=60*parseInt(t)*60+s;const n=await a({loading:"正在创建临时授权链接，请稍候...",request:de({expire_time:t}),message:!0,data:{token:String,expire:Number,status:Boolean}});Z();let u=window.location.protocol+"//"+window.location.host+"/login?";return F.value="".concat(u,"tmp_token=").concat(n.token),n},Y=async e=>{await a({loading:d,request:ce({id:e}),data:[Array,_]})},Z=async()=>{await a({loading:n,request:me(o),data:{data:[Array,s],page:v(u)}})};return w(()=>{Z()}),(e,a)=>{const c=S,p=f,v=Ue,y=Ce,g=t,w=J,H=K,G=q,W=r,Q=T,Y=L("bt-loading");return h(),x("div",null,[V(k(we),{label:"临时访问授权"},{value:b(()=>[V(c,{type:"primary",onClick:a[0]||(a[0]=e=>(async()=>l.value=!0)())},{default:b(()=>[...a[13]||(a[13]=[U("临时访问授权管理",-1)])]),_:1})]),desc:b(()=>[...a[14]||(a[14]=[A("span",null,"为非管理员临时提供面板访问权限",-1)])]),_:1}),V(g,{title:"临时授权管理",modelValue:k(l),"onUpdate:modelValue":a[4]||(a[4]=e=>C(l)?l.value=e:null),area:70},{default:b(()=>[V(y,{class:"p-6"},{"header-left":b(()=>[V(c,{type:"primary",onClick:a[1]||(a[1]=e=>M.value=!0)},{default:b(()=>[...a[15]||(a[15]=[U("创建临时授权 ",-1)])]),_:1})]),content:b(()=>[B(V(p,{ref:"tempAuthTable",data:k(s),column:R,"max-height":380},null,8,["data"]),[[Y,k(n)]])]),"footer-right":b(()=>[V(v,{page:k(o).p,"onUpdate:page":a[2]||(a[2]=e=>k(o).p=e),row:k(o).rows,"onUpdate:row":a[3]||(a[3]=e=>k(o).rows=e),total:k(u),onChange:Z},null,8,["page","row","total"])]),_:1})]),_:1},8,["modelValue"]),V(g,{title:"风险提示",modelValue:k(M),"onUpdate:modelValue":a[7]||(a[7]=e=>C(M)?M.value=e:null),area:54,"show-footer":!0,onConfirm:a[8]||(a[8]=e=>(async()=>{await P.value.validate(),M.value=!1;const e=await X();(null==e?void 0:e.status)&&(j.value=!0)})())},{default:b(()=>[A("div",Ye,[a[19]||(a[19]=A("i",{class:"svgtofont-el-warning-filled text-warningDark !text-titleLarge pr-4"},null,-1)),A("div",null,[a[17]||(a[17]=A("p",{class:"text-base leading-10 text-danger"},"注意1：滥用临时授权可能导致安全风险。",-1)),a[18]||(a[18]=A("p",{class:"text-base leading-10 text-danger"},"注意2：请勿在公共场合发布临时授权连接",-1)),V(Q,{ref_key:"authFormRef",ref:P,rules:N,model:k(D),"label-position":"left",class:"my-[1rem]"},{default:b(()=>[V(G,{label:"授权时间"},{default:b(()=>[V(H,{modelValue:k(D).checkboxValue,"onUpdate:modelValue":a[5]||(a[5]=e=>k(D).checkboxValue=e)},{default:b(()=>[V(w,{label:"3小时"}),V(w,{label:"6小时"}),V(w,{label:"9小时"}),V(w,{label:"12小时"}),V(w,{label:"自定义"})]),_:1},8,["modelValue"])]),_:1}),"自定义"===k(D).checkboxValue?(h(),I(G,{key:0,label:"自定义时间",prop:"day"},{default:b(()=>[V(W,{modelValue:k(D).day,"onUpdate:modelValue":a[6]||(a[6]=e=>k(D).day=e),width:"16rem",textType:"天",min:"1",type:"number"},{append:b(()=>[...a[16]||(a[16]=[U("天",-1)])]),_:1},8,["modelValue"])]),_:1})):E("",!0)]),_:1},8,["model"])])])]),_:1},8,["modelValue"]),V(g,{title:"创建临时授权",modelValue:k(j),"onUpdate:modelValue":a[11]||(a[11]=e=>C(j)?j.value=e:null),area:57},{default:b(()=>[A("div",Ze,[a[21]||(a[21]=A("div",null,"临时授权地址",-1)),V(W,{class:"my-5",type:"textarea",rows:2,modelValue:k(F),"onUpdate:modelValue":a[9]||(a[9]=e=>C(F)?F.value=e:null)},null,8,["modelValue"]),V(c,{type:"primary",class:"copy",onClick:a[10]||(a[10]=e=>{return a=k(F),m({value:a});var a})},{default:b(()=>[...a[20]||(a[20]=[U("复制地址",-1)])]),_:1}),a[22]||(a[22]=A("ul",{class:"ml-6 mt-8 list-disc"},[A("li",{class:"text-secondary h-[2.4rem]"},"临时授权生成后1小时内使用有效，为一次性授权，使用后立即失效"),A("li",{class:"text-secondary h-[2.4rem]"},"使用临时授权登录面板后1小时内拥有面板所有权限，请勿在公共场合发布临时授权连接"),A("li",{class:"text-secondary h-[2.4rem]"},"授权连接信息仅在此处显示一次，若在使用前忘记，请重新生成")],-1))])]),_:1},8,["modelValue"]),V(g,{title:"查看操作日志【".concat(k(z),"】"),modelValue:k(i),"onUpdate:modelValue":a[12]||(a[12]=e=>C(i)?i.value=e:null),area:70},{default:b(()=>[V(y,{class:"p-6"},{"header-left":b(()=>[V(c,{onClick:$,type:"primary"},{default:b(()=>[...a[23]||(a[23]=[U("刷新日志",-1)])]),_:1})]),content:b(()=>[B(V(p,{ref:"tempAuthLogTable","max-height":380,data:k(_),column:O},null,8,["data"]),[[Y,k(d)],[Y,"正在获取日志，请稍候...","title"]])]),_:1})]),_:1},8,["title","modelValue"])])}}}),aa=_({__name:"index",setup(e){const l=y({}),t=W(()=>{var e;return"true"==(null==(e=l.value)?void 0:e.limit_area_status)}),u=async()=>{s({title:"设置地区登录限制",component:()=>n(()=>import("./area-config.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:{limitArea:l.value,onRefresh:r},showFooter:!0,area:70})},o=async e=>{await p({title:"".concat(e?"开启":"关闭","地区登录限制"),content:"".concat(e?"开启后，将会对面板登录地区进行限制":"关闭后，设置的地区登录将失效","，是否继续操作？"),icon:"warning-filled"}),await a({loading:"正在设置，请稍候...",request:pe({limit_area_status:e}),message:!0,success:r})},r=async()=>{const e=await a({request:ve(),data:{limit_area:Object,limit_area_status:String,limit_type:String}});l.value=e};return w(async()=>r()),(e,a)=>{const l=j,s=S;return h(),I(k(we),{label:"地区登录限制"},{value:b(()=>[V(l,{modelValue:k(t),"onUpdate:modelValue":a[0]||(a[0]=e=>C(t)?t.value=e:null),onChange:o},null,8,["modelValue"]),V(s,{type:"default",size:"small",class:"!ml-12px",disabled:e.loading,onClick:u},{default:b(()=>[...a[1]||(a[1]=[U("设置地区登录限制",-1)])]),_:1},8,["disabled"])]),desc:b(()=>[...a[2]||(a[2]=[A("span",null,"设置面板地区登录策略",-1)])]),_:1})}}}),la={class:"px-[2rem]"},ta={class:"p-[2rem]"},sa=_({__name:"index",setup(l){const{refs:{safeConfig:s}}=e(),n=y(!1),o=y(!1),i=y([]),d=y(!1),c=y(),m=y(!1),p=async()=>{await a({request:_e(),success:({data:e})=>{const{status:a,ua_list:l}=e.msg||e;s.value.uaAstrict=1===Number(a),i.value=l}})},v=async()=>{if(!c.value)return u.error("请输入User-Agent");await a({loading:"正在设置，请稍候...",request:m.value?fe({new_name:c.value,id:m.value}):ye({ua_list:c.value}),message:!0}),p(),m.value=!1,c.value="",d.value=!1},_=[{label:"User-Agent",prop:"name"},Ae([{onClick:e=>{m.value=e.id,c.value=e.name,d.value=!0},title:"编辑"},{onClick:e=>(async e=>{await a({loading:"正在删除，请稍候...",request:ge({id:e.id}),message:!0}),p()})(e),title:"删除"}])];return w(()=>p()),(e,l)=>{const u=j,y=S,g=f,w=Ce,I=t,P=r,D=q,E=T,F=L("bt-loading");return h(),x("div",null,[V(k(we),{label:"User-Agent限制"},{value:b(()=>[V(u,{modelValue:k(s).uaAstrict,"onUpdate:modelValue":l[0]||(l[0]=e=>k(s).uaAstrict=e),onChange:l[1]||(l[1]=e=>(async e=>{await a({loading:"正在设置，请稍候...",request:fe({status:e?1:0}),message:!0,success:e=>{e.status||"请先添加ua后再开启！"!==e.msg||(n.value=!0)}}),p()})(k(s).uaAstrict))},null,8,["modelValue"]),V(y,{size:"small",class:"!ml-12px",onClick:l[2]||(l[2]=e=>n.value=!0)},{default:b(()=>[...l[7]||(l[7]=[U("User-Agent限制配置",-1)])]),_:1})]),desc:b(()=>[...l[8]||(l[8]=[A("span",null,"设置限制访问User-Agent",-1)])]),_:1}),V(I,{modelValue:k(n),"onUpdate:modelValue":l[4]||(l[4]=e=>C(n)?n.value=e:null),area:70,title:"User-Agent限制配置"},{default:b(()=>[A("div",la,[V(w,{class:"py-20px"},{"header-left":b(()=>[V(y,{onClick:l[3]||(l[3]=e=>d.value=!0),type:"primary"},{default:b(()=>[...l[9]||(l[9]=[U("添加User-Agent",-1)])]),_:1})]),content:b(()=>[B(V(g,{ref:"uaTable",column:_,data:k(i),description:"User-Agent列表为空","max-height":400},null,8,["data"]),[[F,k(o)],[F,"正在加载User-Agent列表，请稍后...","title"]])]),_:1})])]),_:1},8,["modelValue"]),V(I,{modelValue:k(d),"onUpdate:modelValue":l[6]||(l[6]=e=>C(d)?d.value=e:null),area:50,title:(k(m)?"编辑":"添加")+"User-Agent",showFooter:"",onConfirm:v},{default:b(()=>[A("div",ta,[V(E,{ref:"uaFormRef",model:k(c),"label-position":"left"},{default:b(()=>[V(D,{label:"User-Agent",prop:"name"},{default:b(()=>[V(P,{modelValue:k(c),"onUpdate:modelValue":l[5]||(l[5]=e=>C(c)?c.value=e:null),type:"textarea",width:"32rem",rows:4},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue","title"])])}}}),na=_({__name:"index",setup:a=>(e(),(e,a)=>(h(),x("div",null,[V(Se),V(he),V(Te),V(Pe),V(Le),V(Re),V(Oe),V(xe),V(Je),V(Ve),V(be),V(We),V(Xe),V(ea),V(aa),V(sa)])))});export{na as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
