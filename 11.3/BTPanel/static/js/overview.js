import{_ as e}from"./index123.js?v=1763689792";import{c as a,r as l,x as t,y as o,e as s,C as r,F as n,b1 as u,z as d,O as i,D as m,B as c,R as p,L as v,H as y,b9 as f,ba as h,c9 as w,o as g,aB as _,W as b,g as V,w as x,aG as k,v as D,I as N,J as j,A as C,G as U,n as q,am as A,an as M,aA as T,aZ as O,ap as R,b2 as E,ad as $,ab as F}from"./base-lib.js?v=1763689792";import{_ as I}from"./validator.js?v=1763689792";import{V as L,_ as S,u as H,e as P,Q as Y,aK as J,p as z,aA as B,aC as G,l as W,$ as K,k as Q,j as Z,b as X}from"./utils-lib.js?v=1763689792";import{_ as ee}from"./index109.js?v=1763689792";import{_ as ae}from"./index118.js?v=1763689792";import{_ as le}from"./index130.js?v=1763689792";import{t as te}from"./useController6.js?v=1763689792";import{u as oe}from"./useStore4.js?v=1763689792";import{addExcloud as se,setSiteStatusProof as re,modifyPathConfig as ne,multiCreate as ue,setTamperAlarm as de,setPushStatus as ie,setPushConfig as me,getGlabalTotal as ce,getTamperRuleByPath as pe,delTempClose as ve,setTempClose as ye,modifyGlobalConfig as fe,getTamperCoreLogs as he,getTamperAlarm as we,getPushList as ge,delLogs as _e,getProofIndex as be,getProofLog as Ve}from"./site.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";const xe={class:"time flex"},ke=S(a({__name:"day-cut",props:{days:{default:""}},emits:["cut-day","cut-day-click"],setup(e,{emit:a}){const w=a,g=l(""),_=l(1),b=l(),V=l([{content:"昨天",active:!1,event:()=>{_.value=0;const e=L(new Date((new Date).getTime()-864e5),"yyyy-MM-dd");w("cut-day",0,e),x.value=""}},{content:"今天",active:!0,event:e=>{_.value=1;const a=L(new Date,"yyyy-MM-dd");w("cut-day",1,a),x.value=""}}]),x=l(""),k=e=>e.getTime()>Date.now(),D=e=>{g.value="自定义时间",_.value=2,w("cut-day",2,L(e,"yyyy-MM-dd"))};return(e,a)=>{const l=y,w=f,g=h;return t(),o("div",xe,[s(w,{class:"control-btn"},{default:r(()=>[(t(!0),o(n,null,u(d(V),(e,a)=>(t(),i(l,{key:a,type:d(_)===a?"primary":"",onClick:e.event},{default:r(()=>[m(c(e.content),1)]),_:2},1032,["type","onClick"]))),128))]),_:1}),s(g,{align:"right",type:"date",modelValue:d(x),"onUpdate:modelValue":a[0]||(a[0]=e=>p(x)?x.value=e:null),placeholder:"自定义时间",ref_key:"player",ref:b,class:v(["auto-time !w-[13rem]","".concat(2===d(_)?"active":"")]),onChange:D,"disabled-date":k},null,8,["modelValue","class"])])}}}),[["__scopeId","data-v-deb01e80"]]),De={key:0,class:"flex justify-between mb-[1.6rem]"},Ne={class:"flex items-center"},je={class:"flex items-center"},Ce={class:"bt-danger"},Ue={key:1,class:"flex items-center justify-center mb-[1.6rem]"},qe={class:"flex items-center flex-1 mr-1rem"},Ae={key:0,class:"flex-1"},Me={class:"flex items-center"},Te={class:"current-box"},Oe={class:"current-box-item"},Re=["title"],Ee={class:"current-box-item"},$e=["title"],Fe={key:0,class:"flex justify-between"},Ie={class:"flex items-center"},Le={class:"flex items-center"},Se={class:"flex items-center"},He={class:"flex items-center"},Pe={class:"flex items-center"},Ye={class:"mt-8 leading-10 list-disc pl-2rem"},Je={class:"flex-wrap"},ze=S(a({__name:"overview",props:{compData:{default:{}}},setup(a,{expose:v}){const f=a,S=X(),{getSenderAlarmListInfo:xe}=H(),{siteInfo:ze}=oe(),Be=l(!1),Ge=w(),We=l(!1),Ke=l(1),Qe=l(L(new Date,"yyyy-MM-dd")),Ze=l({}),Xe=g({p:1,rows:10,total:0}),ea=l(!1),aa=l([]),la=l([]),ta=l({logContent:"",logDialog:!1,name:""}),oa=[{content:"如果需要频繁修改当前文件，确认提交即可。"},{content:"如果需要频繁修改该文件同级文件内容，请删除路径尾部文件名，确认提交即可。"},{content:s(n,null,[m("若大量临时缓存文件被拦截，可参考："),s("code",null,[m("/www/wwwroot/bt.cn/cache/bt_1234.php")]),m("，直接添加"),s("code",null,[m("/www/wwwroot/bt.cn/cache/bt*.php")]),m("即可")])},{content:"注意：以上操作会解除对文件或目录的限制，请确保你信任这些内容，以防止安全问题。"}],sa=l(!1),ra=l(),na=l(!1),ua=g({path:""}),da=g({path:[{required:!0,message:"请输入目录/文件",trigger:"blur"}]}),ia=_("kernelModuleStatus",b(!0)),ma=l({}),ca=l(!1),pa=l(!1),va=l(),ya=g({expire:30,unit:"minute"}),fa=l(),ha=l(!1),wa=g({name:ze.value.path+"/"+ze.value.name,cycle:30,count:3,interval:600,push_count:1,module:[],limit:["sms"]}),ga=V(()=>"tamper_proof_refactored"===f.compData.type?[{content:"如果开启防篡改后您的网站出现异常，请尝试排除网站日志、缓存、临时文件、上传等目录后重试，或直接关闭异常网站防篡改功能"}]:[{content:"开启防篡改后，部分项目【无法更新，文件无法上传，无法操作等】，需要关闭防篡改或添加白名单"}]),_a=g({cycle:[{required:!0,message:"请输入时间",trigger:"blur"},{validator:(e,a,l)=>{/^[1-9]\d*$/.test(a)?l():l(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],count:[{required:!0,message:"请输入次数",trigger:"blur"},{validator:(e,a,l)=>{/^[1-9]\d*$/.test(a)?l():l(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],push_count:[{required:!0,message:"请输入次数",trigger:"blur"},{validator:(e,a,l)=>{/^[1-9]\d*$/.test(a)?l():l(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],interval:[{required:!0,message:"请输入时间",trigger:"blur"},{validator:(e,a,l)=>{/^[1-9]\d*$/.test(a)?l():l(new Error("必须为大于0的整数"))},trigger:["blur","change"]}],module:[{validator:(e,a,l)=>{0===wa.module.length?l(new Error("请选择告警方式")):l()},trigger:["change"]}]}),ba=l("log"),Va=l([{label:"日志",name:"log",lazy:!0,render:()=>{}}]),xa=g({expire:[{required:!0,message:"请输入时间",trigger:"blur"},{validator:(e,a,l)=>{/^[1-9]\d*$/.test(a)?l():l(new Error("时间必须为大于0的整数"))},trigger:["blur","change"]}]}),ka=l(),Da=l(!1),Na=g({date:""}),ja=g({date:[{required:!0,message:"请选择日期",trigger:"blur"}]}),Ca=e=>e.getTime()>Date.now(),Ua=[{label:"关闭防护",value:0},{label:"拦截模式",value:1},{label:"观察模式",value:2}],qa=g({create:"创建",delete:"删除",modify:"修改",move:"移动",rename:"重命名",chmod:"权限变更"}),Aa=g({0:"关闭",1:"拦截",2:"观察"}),Ma=l([{label:"时间",prop:"time",width:150,render:e=>L(e[0])},{label:"模式",prop:"mode",width:60,render:e=>s("span",{class:"text-[".concat(1===e[1]?"#20a53a":"#f0ad4e","]")},[Aa[e[1]]])},{label:"类型",prop:"type",width:70,render:e=>qa[e[2]]},{label:"文件",prop:"type",showOverflowTooltip:!0,render:e=>s("div",{class:"truncate"},[e[3]])},{label:"溯源日志",prop:"ip",width:78,render:e=>s("span",{class:"bt-link cursor-pointer",onClick:()=>{ta.value.logContent=e[4]&&e[4].length?e[4].join("\n"):"当前日志为空",ta.value.name=e[3],ta.value.logDialog=!0}},[m("溯源日志")])},{label:"状态",prop:"action",width:75,render:e=>"防护成功"},{label:"操作",align:"right",width:90,render:e=>s(P,{onClick:()=>{ua.path=e[3],sa.value=!0}},{default:()=>[m("加入白名单")]})}]),Ta=l([{label:"时间",prop:"date",width:150},{label:"目录",prop:"content"},{label:"类型",prop:"type",width:100,render:e=>s("span",null,[te[e.type]])},{label:"用户",prop:"user",width:90},{label:"进程",prop:"process",width:90}]),Oa=async()=>{await ra.value.validate();(await Y({loading:na,request:se({siteName:ze.value.name,excludePath:ua.path}),message:!0})).status&&(sa.value=!1)},Ra=async e=>{var a,l;try{We.value=!0;const{data:t}=await be({day:e});Ze.value=null==(a=t.sites)?void 0:a.find(e=>e.siteName==ze.value.name),Ze.value.totalNum=Ze.value.total.site.total,Ze.value.theNum=Ze.value.total.day.total,Ze.value.open=Ze.value.open,la.value=null==(l=t.sites)?void 0:l.map(e=>({siteName:e.siteName,path:e.path}))}catch(t){J(t)}finally{We.value=!1}},Ea=async e=>{Y({loading:ea,request:Ve({day:e,siteName:ze.value.name}),data:{logs:[Array,aa]}})},$a=async e=>{var a;Ze.value.open=e;try{const l=await re({siteName:ze.value.name,status:e});(null==(a=l.data)?void 0:a.length)?(S.request(l.data[0]),l.status&&Ra(Qe.value)):S.request(l)}catch(l){J(l)}},Fa=()=>{ya.expire=30,ya.unit="minute",pa.value=!0},Ia=async e=>{var a;try{if(await z({title:"".concat(e?"开启":"关闭","保护目录配置【").concat(ze.value.name,"】"),content:e?"启用该保护目录配置后，目录将受到保护，是否继续操作？":"关闭该保护目录配置后，目录将失去保护，是否继续操作？",icon:"warning"}),null==(a=Ze.value)?void 0:a.path){(await Y({loading:"正在设置防篡改，请稍侯...",request:ne({path_id:Ze.value.pid,key:"status",value:e?1:0}),message:!0})).status&&za()}else{const{data:e}=await ue({paths:JSON.stringify([{path:ze.value.path+"/",ps:ze.value.name}])});e.length&&e[0].status?(S.success("开启防篡改成功"),za()):S.error("开启防篡改失败")}}catch(l){"cancel"===l&&q(()=>{Ze.value={...Ze.value,open:!e}})}},La=async e=>{var a;if(!(null==(a=Ze.value)?void 0:a.path))return S.warn("请先开启防篡改开关再进行告警设置"),void q(()=>{ca.value=!1});if(e){if(!f.compData.isNewAlarmVersion)return S.warn("当前企业级防篡改插件版本小于5.6，请升级插件"),void q(()=>{ca.value=!1});ha.value=!0}else try{await z({title:"关闭保护目录告警【".concat(ze.value.name,"】"),content:"关闭该保护目录告警后，该配置将无法发送告警，是否继续操作？",icon:"warning"});(await Y({loading:"正在关闭告警任务，请稍侯...",request:f.compData.isNewAlarmVersion?de({project:Ze.value.pid},"delete"):ie({id:Ze.value.pid,name:"tamper_push",status:0}),message:!0})).status&&za()}catch(l){ca.value=!0}},Sa=async()=>{await xe(),S.success("刷新成功")},Ha=()=>{ha.value=!1,ca.value=!1},Pa=async()=>{await fa.value.validate();(await Y({loading:"正在设置告警任务，请稍侯...",request:f.compData.isNewAlarmVersion?de({project:Ze.value.pid,cycle:Number(wa.cycle),count:Number(wa.count),interval:Number(wa.interval),day_num:Number(wa.push_count),status:1,sender:wa.module.join(",")},"add"):me({id:Ze.value.pid,name:"tamper_push",data:JSON.stringify({cycle:Number(wa.cycle),count:Number(wa.count),interval:Number(wa.interval),push_count:Number(wa.push_count),module:wa.module.join(","),type:"",title:"【".concat(ze.value.path,"】篡改告警")})}),message:!0})).status&&(ha.value=!1,Ka())},Ya=async(e,a)=>{Ke.value=e,Qe.value=a,"tamper_proof_refactored"===f.compData.type?(await Ra(a),await Ea(a)):(Xe.p=1,await Wa(a))},Ja=async()=>{try{We.value=!0;const{data:e}=await ce();ma.value=e,ia.value=e.glabal_status.kernel_module_status}catch(e){J(e)}finally{We.value=!1}},za=async()=>{try{const{data:e}=await pe({path:ze.value.path});if(Ze.value=e,e.hasOwnProperty("status")){Ze.value.open=!!e.status;let a=0,l=0,t=[],o=[];for(let s in e.total.all)a+=e.total.all[s],t.push("".concat(te[s],": ").concat(e.total.all[s]));for(let s in e.total.today)l+=e.total.today[s],o.push("".concat(te[s],": ").concat(e.total.today[s]));Ze.value.totalNum=a,Ze.value.totalTitle=t.join("\n"),Ze.value.theNum=l,Ze.value.theTitle=o.join("\n"),Wa(Qe.value)}else Ze.value.open=!1,Ze.value.totalNum="--",Ze.value.theNum="--"}catch(e){J(e)}},Ba=async(e=!1)=>{e&&await va.value.validate();(await Y({loading:"正在设置临时关闭防护，请稍侯...",request:e?ye(ya):ve(),message:!0})).status&&(pa.value=!1,Ja(),za())},Ga=async()=>{await z({title:"开启全局开关",content:"开启后，站点目录对应的防篡改配置将生效，是否继续操作？",icon:"warning"});(await Y({loading:"正在开启全局开关，请稍侯...",request:fe({value:1,key:"status"}),message:!0})).status&&Ja()},Wa=async e=>{var a,l;try{const t=await he({path_id:Ze.value.pid,date:e||Qe.value,rows:Xe.rows,p:Xe.p});Array.isArray(t.data)?(aa.value=t.data,Xe.total=t.hasOwnProperty("page")?B(t.page):t.data.length):Array.isArray(null==(a=null==t?void 0:t.data)?void 0:a.data)?(aa.value=t.data.data,Xe.total=t.data.hasOwnProperty("page")?B(t.data.page):(null==(l=t.data)?void 0:l.total)||t.data.data.length):(aa.value=[],Xe.total=0)}catch(t){}},Ka=async()=>{var e;try{if(f.compData.isNewAlarmVersion){const{data:a}=await we();ca.value=null==(e=a.task_list.find(e=>e.project===Ze.value.pid))?void 0:e.status}else{const{data:e}=await ge();var a=e.tamper_push&&e.tamper_push[Ze.value.pid]||{};ca.value=!!(null==a?void 0:a.status)}}catch(l){J(l)}},Qa=()=>{Na.date="",Da.value=!0},Za=async()=>{try{await ka.value.validate();const e=await _e({path_id:Ze.value.pid,date:Na.date});S.request(e),e.status&&(Da.value=!1,Wa())}catch(e){}};x([()=>ma.value.temp_close_time,()=>Ge.value],([e,a])=>{!Be.value&&0!==e&&1e3*e+3e3<a&&(ma.value.temp_close_time=0,Ja(),za())});const Xa=async()=>{var e;if(f.compData.maskLayer)if(Qe.value=L(new Date,"yyyy-MM-dd"),"tamper_proof_refactored"===f.compData.type)await Ra(Qe.value),await Ea(Qe.value);else{if(!f.compData.isVersion)return;await Ja(),await za(),(null==(e=Ze.value)?void 0:e.path)&&await Ka()}};return k(()=>{Be.value=!0}),D(Xa),v({sitesList:la,init:Xa}),(l,v)=>{var f,w,g,_,b,V;const x=A,k=M,D=T,q=P,S=O,H=R,Y=E,J=y,z=G,B=le,X=W,te=ae,oe=ee,se=K,re=Q,ne=$,ue=F,de=Z,ie=I,me=h,ce=e,pe=N("bt-loading");return j((t(),o("div",null,["tamper_proof_refactored"===a.compData.type?(t(),o("div",De,[C("div",Ne,[v[26]||(v[26]=C("span",{class:"mr-1rem"},"防篡改状态",-1)),s(k,{class:"!w-[16rem]",modelValue:d(Ze).open,"onUpdate:modelValue":v[0]||(v[0]=e=>d(Ze).open=e),onChange:$a},{default:r(()=>[(t(),o(n,null,u(Ua,e=>s(x,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),s(D,{placement:"top-start",width:"200","popper-class":"green-tips-popover",trigger:"hover",content:""},{reference:r(()=>[...v[24]||(v[24]=[C("i",{class:"svgtofont-el-question-filled text-warning ml-[12px] text-[16px]"},null,-1)])]),default:r(()=>[v[25]||(v[25]=C("ul",{class:"list-disc pl-1.6rem"},[C("li",null,"拦截模式：拦截，并记录"),C("li",null,"观察模式：不拦截，只记录")],-1))]),_:1})]),s(ke,{days:d(Ke),onCutDay:Ya},null,8,["days"])])):(t(),o(n,{key:1},[(null==(f=d(ma))?void 0:f.temp_close_time)?(t(),i(S,{key:0,type:"warning",class:"!mb-[1.6rem] !p-[1.2rem]",closable:!1,"show-icon":""},{title:r(()=>[C("div",je,[v[28]||(v[28]=m(" 当前已临时关闭全局防篡改，将在 ",-1)),C("span",Ce,c(d(L)(d(ma).temp_close_time)),1),v[29]||(v[29]=m(" 恢复防护 ",-1)),s(q,{class:"bt-link ml-1rem",onClick:v[1]||(v[1]=e=>Ba(!1))},{default:r(()=>[...v[27]||(v[27]=[m(" 点击立即恢复 ",-1)])]),_:1})])]),_:1})):(t(),o("div",Ue,[C("div",qe,[v[32]||(v[32]=C("span",{class:"mr-1rem"},"防篡改开关",-1)),s(H,{modelValue:d(Ze).open,"onUpdate:modelValue":v[2]||(v[2]=e=>d(Ze).open=e),width:36,onChange:Ia},null,8,["modelValue"]),s(Y,{direction:"vertical",class:"!h-2rem !mx-1.6rem"}),v[33]||(v[33]=C("span",{class:"mr-1rem"},"告警设置",-1)),s(H,{class:"mr-[1.6rem]",modelValue:d(ca),"onUpdate:modelValue":v[3]||(v[3]=e=>p(ca)?ca.value=e:null),width:36,onChange:La},null,8,["modelValue"]),(null==(g=null==(w=d(ma))?void 0:w.glabal_status)?void 0:g.settings_status)?U("",!0):(t(),o("div",Ae,[s(S,{type:"warning",class:"h-3.2rem",closable:!1,"show-icon":""},{title:r(()=>[C("div",Me,[v[31]||(v[31]=m(" 未启用企业级防篡改，请先开启 ",-1)),s(q,{class:"underline",type:"danger",onClick:Ga},{default:r(()=>[...v[30]||(v[30]=[m(" 全局开关 ",-1)])]),_:1})])]),_:1})]))]),s(J,{type:"primary",onClick:Fa},{default:r(()=>[...v[34]||(v[34]=[m(" 全局临时开关 ",-1)])]),_:1})]))],64)),C("div",Te,[C("div",Oe,[v[35]||(v[35]=C("div",null,"总拦截次数",-1)),C("div",{title:null==(_=d(Ze))?void 0:_.totalTitle},c(d(Ze).totalNum),9,Re)]),C("div",Ee,[v[36]||(v[36]=C("div",null,"当日拦截次数",-1)),C("div",{title:null==(b=d(Ze))?void 0:b.theTitle},c(d(Ze).theNum),9,$e)])]),"tamper_core"===a.compData.type?(t(),o(n,{key:2},[s(z,{ref:"tamperRef",type:"",class:"mt-1rem",modelValue:d(ba),"onUpdate:modelValue":v[4]||(v[4]=e=>p(ba)?ba.value=e:null),options:d(Va)},null,8,["modelValue","options"]),(null==(V=d(Ze))?void 0:V.path)?(t(),o("div",Fe,[s(J,{type:"default",onClick:Qa},{default:r(()=>[...v[37]||(v[37]=[m("清理日志",-1)])]),_:1}),C("div",Ie,[s(ke,{days:d(Ke),onCutDay:Ya},null,8,["days"]),s(B,{onRefresh:Wa,class:"ml-1rem"})])])):U("",!0)],64)):U("",!0),s(oe,null,{"header-left":r(()=>[...v[38]||(v[38]=[])]),"header-right":r(()=>[...v[39]||(v[39]=[])]),content:r(()=>["tamper_core"==a.compData.type?j((t(),i(X,{key:0,column:d(Ta),maxHeight:320,data:d(aa)},null,8,["column","data"])),[[pe,d(ea)]]):j((t(),i(X,{key:1,column:d(Ma),maxHeight:400,data:d(aa)},null,8,["column","data"])),[[pe,d(ea)]])]),"footer-left":r(()=>[...v[40]||(v[40]=[])]),"footer-right":r(()=>["tamper_core"===a.compData.type?(t(),i(te,{key:0,class:"mb-1rem",page:d(Xe).p,"onUpdate:page":v[5]||(v[5]=e=>d(Xe).p=e),row:d(Xe).rows,"onUpdate:row":v[6]||(v[6]=e=>d(Xe).rows=e),total:d(Xe).total,"pager-count":4,onChange:v[7]||(v[7]=e=>Wa())},null,8,["page","row","total"])):U("",!0)]),_:1}),s(se,{options:d(ga),"list-style":"disc",class:"ml-2rem"},null,8,["options"]),s(de,{title:"临时关闭防篡改",modelValue:d(pa),"onUpdate:modelValue":v[10]||(v[10]=e=>p(pa)?pa.value=e:null),area:58,onConfirm:v[11]||(v[11]=e=>Ba(!0)),"show-footer":""},{default:r(()=>[s(ue,{class:"p-[2rem]",ref_key:"tempFormRef",ref:va,model:d(ya),rules:d(xa)},{default:r(()=>[s(ne,{label:"临时关闭",prop:"expire"},{default:r(()=>[C("div",Le,[s(re,{type:"number",modelValue:d(ya).expire,"onUpdate:modelValue":v[8]||(v[8]=e=>d(ya).expire=e),width:"14rem",class:"!w-14rem",placeholder:"请输入时间"},null,8,["modelValue"]),s(k,{class:"ml-1rem !w-[10rem]",modelValue:d(ya).unit,"onUpdate:modelValue":v[9]||(v[9]=e=>d(ya).unit=e)},{default:r(()=>[s(x,{label:"分钟",value:"minute"}),s(x,{label:"小时",value:"hour"}),s(x,{label:"天",value:"day"})]),_:1},8,["modelValue"]),v[41]||(v[41]=C("span",{class:"text-secondary ml-[4px]"},"，到期后自动恢复防护",-1))])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),s(de,{title:"设置告警任务",modelValue:d(ha),"onUpdate:modelValue":v[18]||(v[18]=e=>p(ha)?ha.value=e:null),area:54,onConfirm:Pa,onCancel:Ha,"show-footer":""},{default:r(()=>[s(ue,{class:"p-[2rem]",ref_key:"alarmFormRef",ref:fa,model:d(wa),rules:d(_a)},{default:r(()=>[s(ne,{label:"保护列表"},{default:r(()=>[s(re,{modelValue:d(wa).name,"onUpdate:modelValue":v[12]||(v[12]=e=>d(wa).name=e),disabled:"",width:"35rem"},null,8,["modelValue"])]),_:1}),s(ne,{label:"触发条件"},{default:r(()=>[C("div",Se,[s(ne,{prop:"cycle"},{default:r(()=>[s(re,{modelValue:d(wa).cycle,"onUpdate:modelValue":v[13]||(v[13]=e=>d(wa).cycle=e),type:"number",width:"12rem"},null,8,["modelValue"])]),_:1}),v[42]||(v[42]=C("span",{class:"text-secondary mx-[.6rem]"},"分钟内，篡改",-1)),s(ne,{prop:"count"},{default:r(()=>[s(re,{modelValue:d(wa).count,"onUpdate:modelValue":v[14]||(v[14]=e=>d(wa).count=e),type:"number",width:"12rem"},null,8,["modelValue"])]),_:1}),v[43]||(v[43]=C("span",{class:"text-secondary mx-[.6rem]"},"次",-1))])]),_:1}),s(ne,{label:"间隔时间",prop:"interval"},{default:r(()=>[C("div",He,[s(re,{modelValue:d(wa).interval,"onUpdate:modelValue":v[15]||(v[15]=e=>d(wa).interval=e),type:"number",width:"12rem",class:"!w-12rem"},null,8,["modelValue"]),v[44]||(v[44]=C("span",{class:"text-secondary mx-[.6rem]"},"秒后再次监控触发条件",-1))])]),_:1}),s(ne,{label:"推送次数",prop:"push_count"},{default:r(()=>[C("div",Pe,[s(re,{modelValue:d(wa).push_count,"onUpdate:modelValue":v[16]||(v[16]=e=>d(wa).push_count=e),type:"number",width:"12rem",class:"!w-12rem"},null,8,["modelValue"]),v[45]||(v[45]=C("span",{class:"text-secondary mx-[.6rem]"}," 次后停止推送，次日再次监控 ",-1))])]),_:1}),s(ne,{label:"告警方式",prop:"module"},{default:r(()=>[s(ie,{modelValue:d(wa).module,"onUpdate:modelValue":v[17]||(v[17]=e=>d(wa).module=e),class:"!w-35rem",limit:d(wa).limit},null,8,["modelValue","limit"])]),_:1}),C("ul",Ye,[C("li",null,[v[47]||(v[47]=m(" 点击配置后状态未更新，尝试点击【 ",-1)),s(q,{class:"!inline-block",onClick:Sa},{default:r(()=>[...v[46]||(v[46]=[m("手动刷新",-1)])]),_:1}),v[48]||(v[48]=m(" 】 ",-1))])])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),s(de,{title:"清理日志",modelValue:d(Da),"onUpdate:modelValue":v[20]||(v[20]=e=>p(Da)?Da.value=e:null),area:38,onConfirm:Za,"show-footer":""},{default:r(()=>[s(ue,{class:"p-[2rem]",ref_key:"clearFormRef",ref:ka,model:d(Na),rules:d(ja)},{default:r(()=>[s(ne,{label:"需要清理的日期",prop:"date"},{default:r(()=>[s(me,{modelValue:d(Na).date,"onUpdate:modelValue":v[19]||(v[19]=e=>d(Na).date=e),type:"date",class:"date",placeholder:"选择日期","value-format":"YYYY-MM-DD","disabled-date":Ca},null,8,["modelValue"])]),_:1}),s(se,{class:"pl-2rem",options:[{content:"当前仅支持按日期清理日志"}]})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),s(de,{title:"溯源日志[".concat(d(ta).name,"]"),modelValue:d(ta).logDialog,"onUpdate:modelValue":v[21]||(v[21]=e=>d(ta).logDialog=e),area:[60]},{default:r(()=>[C("div",Je,[s(ce,{class:"h-[40rem] !rounded-none",content:d(ta).logContent},null,8,["content"])])]),_:1},8,["title","modelValue"]),s(de,{title:"清理日志",modelValue:d(sa),"onUpdate:modelValue":v[23]||(v[23]=e=>p(sa)?sa.value=e:null),area:56,onConfirm:Oa,"show-footer":""},{default:r(()=>[s(ue,{class:"p-[2rem]",ref_key:"addWhiteListFormRef",ref:ra,model:d(ua),rules:d(da),disabled:d(na)},{default:r(()=>[s(ne,{label:"目录/文件",prop:"path"},{default:r(()=>[s(re,{modelValue:d(ua).path,"onUpdate:modelValue":v[22]||(v[22]=e=>d(ua).path=e),width:"35rem",placeholder:"请输入目录/文件"},null,8,["modelValue"])]),_:1}),s(ne,null,{default:r(()=>[s(se,{options:oa,class:"pl-1rem leading-2rem","list-style":"disc"})]),_:1})]),_:1},8,["model","rules","disabled"])]),_:1},8,["modelValue"])])),[[pe,d(We)],[pe,"正在获取站点防篡改信息，请稍侯","title"]])}}}),[["__scopeId","data-v-28fe5bf0"]]);export{ze as default};
