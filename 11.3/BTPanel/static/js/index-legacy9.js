!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||n(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,a,o,u,i=[],s=!0,l=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=o.call(r)).done)&&(i.push(n.value),i.length!==e);s=!0);}catch(t){l=!0,a=t}finally{try{if(!s&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(l)throw a}}return i}}(t,e)||n(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){if(t){if("string"==typeof t)return a(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function i(r,n,a,o){var i=n&&n.prototype instanceof l?n:l,c=Object.create(i.prototype);return u(c,"_invoke",function(r,n,a){var o,u,i,l=0,c=a||[],f=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,r){return o=e,u=0,i=t,p.n=r,s}};function v(r,n){for(u=r,i=n,e=0;!f&&l&&!a&&e<c.length;e++){var a,o=c[e],v=p.p,m=o[2];r>3?(a=m===n)&&(i=o[(u=o[4])?5:(u=3,3)],o[4]=o[5]=t):o[0]<=v&&((a=r<2&&v<o[1])?(u=0,p.v=n,p.n=o[1]):v<m&&(a=r<3||o[0]>n||n>m)&&(o[4]=r,o[5]=n,p.n=m,u=0))}if(a||r>1)return s;throw f=!0,n}return function(a,c,m){if(l>1)throw TypeError("Generator is already running");for(f&&1===c&&v(c,m),u=c,i=m;(e=u<2?t:i)||!f;){o||(u?u<3?(u>1&&(p.n=-1),v(u,i)):p.n=i:p.v=i);try{if(l=2,o){if(u||(a="next"),e=o[a]){if(!(e=e.call(o,i)))throw TypeError("iterator result is not an object");if(!e.done)return e;i=e.value,u<2&&(u=0)}else 1===u&&(e=o.return)&&e.call(o),u<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),u=1);o=t}else if((e=(f=p.n<0)?i:r.call(n,p))!==s)break}catch(e){o=t,u=1,i=e}finally{l=1}}return{value:e,done:f}}}(r,a,o),!0),c}var s={};function l(){}function c(){}function f(){}e=Object.getPrototypeOf;var p=[][n]?e(e([][n]())):(u(e={},n,function(){return this}),e),v=f.prototype=l.prototype=Object.create(p);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,u(t,a,"GeneratorFunction")),t.prototype=Object.create(v),t}return c.prototype=f,u(v,"constructor",f),u(f,"constructor",c),c.displayName="GeneratorFunction",u(f,a,"GeneratorFunction"),u(v),u(v,a,"Generator"),u(v,n,function(){return this}),u(v,"toString",function(){return"[object Generator]"}),(o=function(){return{w:i,m:m}})()}function u(t,e,r,n){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}u=function(t,e,r,n){function o(e,r){u(t,e,function(t){return this._invoke(e,r,t)})}e?a?a(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r:(o("next",0),o("throw",1),o("return",2))},u(t,e,r,n)}function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach(function(e){l(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function l(e,r,n){return(r=function(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,r||"default");if("object"!=t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function c(t,e,r,n,a,o,u){try{var i=t[o](u),s=i.value}catch(t){return void r(t)}i.done?e(s):Promise.resolve(s).then(n,a)}function f(t){return function(){var e=this,r=arguments;return new Promise(function(n,a){var o=t.apply(e,r);function u(t){c(o,n,a,u,i,"next",t)}function i(t){c(o,n,a,u,i,"throw",t)}u(void 0)})}}System.register(["./index-legacy123.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./form-item-legacy.js?v=1763689792","./config-legacy.js?v=1763689792","./useMethod-legacy2.js?v=1763689792","./useController-legacy2.js?v=1763689792"],function(t,n){"use strict";var a,u,i,l,c,p,v,m,d,g,y,b,h,w,_,j,S,O,x,k,P,T,L,F,C,A,I,E,N,D,K,q,z,G,H,M,B,J,R;return{setters:[function(t){a=t._},function(t){u=t.r,i=t.g,l=t.e,c=t.c,p=t.v,v=t.x,m=t.y,d=t.z,g=t.A,y=t.B,b=t.G,h=t.O,w=t.D,_=t.aZ,j=t.b6},function(t){S=t.x,O=t.p,x=t.Q,k=t.M,P=t.n,T=t.H,L=t.L,F=t.aq,C=t.ar,A=t._},function(t){I=t.b,E=t.c,N=t.d,D=t.e,K=t.f,q=t.g},function(t){z=t.a3,G=t.a4,H=t.a5,M=t.a6,B=t.a7},function(t){J=t.d},function(t){R=t.a}],execute:function(){var V=t("s",u({last_update:"",total_time:"",start_time:"",panel_addr:"",panel_user:"",panel_password:"",panel_port:""}));u("计算中..."),u("计算中..."),u({total:0,use:0});var Q=u({}),U=t("e",u([])),Z=t("p",u({status:0,progress:0,msg:"准备开始迁移",progressLog:"",remain_time:100})),$=u(!1),W=(t("a",[{type:"index"},{label:"失败项",prop:"name"},{label:"失败原因",prop:"msg",width:320,render:function(t){return l("span",{class:"text-dangerDark"},[t.msg])}}]),u({})),X=function(){var t=f(o().m(function t(e){var r,n,a,u;return o().w(function(t){for(;;)switch(t.p=t.n){case 0:return W.value=e,t.p=1,t.n=2,O({title:"整机迁移提醒",content:"迁移至目标服务器【"+e.server_ip+"】，迁移过程中网站访问受影响，是否继续操作？",type:"calc"});case 2:return $.value=!0,ot(),r=k.load("正在检查目标服务器连接，请稍后..."),t.n=3,M(e);case 3:if(n=t.v,r.close(),!n.status){t.n=5;break}return a=k.load("正在开始迁移，请稍后..."),t.n=4,B(s(s({},e),Q.value));case 4:u=t.v,a.close(),u.status?(Z.value.status=0,Z.value.msg="准备迁移中...",Z.value.progress=0,Z.value.progressLog="",ut()):k.error(u.msg),t.n=6;break;case 5:k.error(n.msg);case 6:t.n=8;break;case 7:t.p=7,t.v;case 8:return t.a(2)}},t,null,[[1,7]])}));return function(e){return t.apply(this,arguments)}}(),Y=(t("r",f(o().m(function t(){return o().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,ot(),Z.value.status=1,$.value=!0,t.n=1,B(W.value);case 1:t.v,Z.value.msg="准备迁移中...",Z.value.progress=0,Z.value.progressLog="",ut(),t.n=3;break;case 2:t.p=2,t.v;case 3:return t.a(2)}},t,null,[[0,2]])}))),function(){return Q.value={},J.value.operateType="add",P({area:84,title:"设置迁移数据",component:function(){return T(function(){return n.import("./index-legacy121.js?v=1763689792")},void 0,n.meta.url)},compData:{saveConfig:function(t,e,n,a){var o={site:"site",database:"database",wptools:"wp_tools",plugin:"plugin",runtime:"soft",Ftp:"ftp",Crontab:"crontab",Vmail:"vmail",Terminal:"ssh",Firewall:"firewall",node:"node"},u=[];Object.entries(e).map(function(t){var e=r(t,2),i=e[0],s=e[1];("database"===i&&a.length>0||"site"===i&&n.length>0||s)&&u.push(o[i])}),Q.value={site_id:JSON.stringify(n.map(function(t){return t.id})),database_id:JSON.stringify(a.map(function(t){return t.id})),backup_data:JSON.stringify(u)}}},btn:["确定","取消"],showFooter:!0})}),tt=u([]);i(function(){return S(tt.value.reduce(function(t,e){return t+Number(e.size)},0))});var et=u([]);i(function(){return S(et.value.reduce(function(t,e){return t+Number(e.size)},0))});var rt=u([]);i(function(){return S(rt.value.reduce(function(t,e){return t+Number(e.size)},0))}),u([]);var nt=u([]);i(function(){return S(nt.value.reduce(function(t,e){return t+Number(e.size)},0))}),u({ftpList:[],crontabList:[],termList:[],firewallList:[]}),u({site:!0,database:!0,ftp:!0,crontab:!0,terminal:!0,firewall:!0,wptools:!0,plugin:!0,runtime:!0}),i(function(){return{Ftp:{title:"FTP",icon:"ftp",dataKey:"ftpList",loadingKey:"Ftp",tooltip:"仅备份FTP账号和密码，不备份FTP目录"},Crontab:{title:"计划任务",icon:"crontab",dataKey:"crontabList",loadingKey:"Crontab"},Terminal:{title:"终端",icon:"xterm",dataKey:"termList",loadingKey:"Terminal"},Firewall:{title:"系统防火墙",icon:"firewall",dataKey:"firewallList",loadingKey:"Firewall"}}});var at=function(){var t=f(o().m(function t(){var e,r;return o().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,z();case 1:e=t.v,r=e.data,ot(),r.data.task_status&&($.value=!0,ut()),t.n=3;break;case 2:t.p=2,t.v;case 3:return t.a(2)}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}(),ot=function(){Z.value={status:0,progress:0,msg:"准备开始迁移",progressLog:"",remain_time:100}},ut=function(){var t=f(o().m(function t(){var e,r,n,a,u,i;return o().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,G();case 1:e=t.v,r=e.data,Z.value.progress=r.data.migrate_progress,Z.value.progressLog=r.data.migrate_log,Z.value.msg=r.data.migrate_msg,Z.value.status=r.data.run_status,2!==r.data.run_status&&3!==r.data.run_status?setTimeout(function(){ut()},1e3):(2===r.data.run_status||(U.value=r.data.err_info),V.value=r.data,r.data.task_info.panel_info&&(n=r.data.task_info.panel_info,a=n.panel_url,u=n.password,i=n.username,V.value.panel_addr=a,V.value.panel_user=i,V.value.panel_password=u),$.value=!1,lt()),t.n=3;break;case 2:t.p=2,t.v;case 3:return t.a(2)}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}(),it=function(){var t=f(o().m(function t(){var e=arguments;return o().w(function(t){for(;;)switch(t.n){case 0:if(!(!(e.length>0&&void 0!==e[0])||e[0])){t.n=1;break}return t.n=1,O({title:"取消迁移",content:"取消迁移后，迁移任务将被删除，是否继续操作？"});case 1:x({loading:"正在取消迁移，请稍后...",request:H(),message:!0,success:function(t){k.success("迁移任务已取消"),$.value=!1,Z.value.status=0,Z.value.msg="准备开始迁移",Z.value.progress=0,Z.value.progressLog=""}});case 2:return t.a(2)}},t)}));return function(){return t.apply(this,arguments)}}(),st=function(){P({area:60,title:"迁移历史",component:function(){return T(function(){return n.import("./migrate-history-legacy.js?v=1763689792")},void 0,n.meta.url)}})},lt=function(){P({area:60,title:!1,component:function(){return T(function(){return n.import("./migrate-progress-legacy.js?v=1763689792")},void 0,n.meta.url)}})},ct={class:""},ft={class:"p-2rem"},pt={class:"w-[56rem]"},vt={key:0,class:"flex-col flex"},mt={class:"text-base"},dt={class:"mb-1.2rem mt-[0.4rem] flex items-center"},gt=c({__name:"index",setup:function(t){var r,n=[{label:"密码认证",value:"password"},{label:"私钥验证",value:"key"}],u=function(t,e,r,n){r?n():n(new Error("password"===t.value.auth_type?"请输入SSH密码":"请输入SSH私钥"))},s=L({data:function(){return{auth_type:"password",server_ip:"",ssh_port:"22",ssh_user:"",password:""}},options:function(t){return i(function(){var r=[I("密码","password",{attrs:{placeholder:"请输入SSH密码",class:"mr-4 !w-[275px]"},rules:[{required:!0,validator:function(e,r,n){return u(t,0,r,n)},trigger:["change","blur"]}]})],a=[E("私钥","password",{attrs:{placeholder:"请输入SSH私钥",class:"mr-4 !w-[275px]",autosize:{minRows:4,maxRows:4}},rules:[{required:!0,validator:function(e,r,n){return u(t,0,r,n)},trigger:["change","blur"]}]})];return[N([I("服务器IP","server_ip",{attrs:{class:"mr-[8px] !w-[180px]",placeholder:"请输入服务器IP",onInput:function(){t.value.ps=t.value.server_ip},onBlur:function(){return R(t)}},rules:[{required:!0,message:"请输入服务器IP",trigger:["change","blur"]},F()]}),I("端口","ssh_port",{attrs:{placeholder:"请输入端口",class:"!w-[84px]"},rules:[{required:!0,message:"请输入端口",trigger:["change","blur"]},C()]})]),I("账号","ssh_user",{attrs:{placeholder:"请输入SSH账号",class:"mr-4 !w-[275px]"},rules:[{required:!0,message:"请输入SSH账号",trigger:["change","blur"]}]}),D("验证方式","auth_type",n,{attrs:{class:"mr-4 !w-[275px]",onChange:function(){var e;t.value.password="",null===(e=O.value)||void 0===e||e.clearValidate()}}})].concat(e("password"===(null==t?void 0:t.value.auth_type)?r:a),[K("",[{content:"请在上方输入目标服务器的root账号信息进行迁移"},{content:"迁移后本机旧数据仍然存在"},{content:l("span",{class:"bt-link",onClick:Y},[w("点击选择迁移数据（默认为全部）")])}],{attrs:{class:"ml-[6rem]"}}),N([q("迁移记录",{attrs:{class:"ml-[4rem]",onClick:st}}),q("开始迁移",{attrs:{class:"ml-[40rem]",type:"primary",onClick:S}})])])})},submit:(r=f(o().m(function t(e,r){return o().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,r();case 1:X(e.value);case 2:return t.a(2)}},t)})),function(t,e){return r.apply(this,arguments)})}),c=s.BtForm,S=s.submit,O=s.ref;return p(function(){at()}),function(t,e){var r=_,n=j,o=a;return v(),m("div",ct,[l(r,{class:"!mb-[1.2rem] !text-small","show-icon":"",title:"整机迁移会自动安装宝塔面板，建议使用【全新机器】进行迁移，如有数据将会覆盖，支持不同系统之间进行迁移！",closable:!1,type:"warning"}),l(d(c)),g("div",ft,[g("div",pt,[1===d(Z).status?(v(),m("div",vt,[e[1]||(e[1]=g("span",{class:"text-secondary font-bold text-base mb-[2rem]"},"迁移进度",-1)),g("span",mt,y(d(Z).msg),1),g("div",dt,[l(n,{class:"w-full","text-inside":!0,"stroke-width":20,percentage:d(Z).progress,status:"success"},null,8,["percentage"]),g("i",{class:"svgtofont-el-circle-close text-dangerDark !text-large pl-4px cursor-pointer",onClick:e[0]||(e[0]=function(){return d(it)&&d(it).apply(void 0,arguments)})})])])):b("",!0),1===d(Z).status?(v(),h(o,{key:1,class:"h-22rem !rounded-none w-[56rem] mt-[2rem]",content:d(Z).progressLog,fullScreen:{title:"全屏查看日志",onRefresh:function(){}}},null,8,["content"])):b("",!0)])])])}}}),yt=A(gt,[["__scopeId","data-v-11ad9586"]]),bt=Object.freeze(Object.defineProperty({__proto__:null,default:yt},Symbol.toStringTag,{value:"Module"}));t("i",bt)}}})}();
