import{_ as e}from"./index109.js?v=1763689792";import{aQ as a,ap as t,Q as s,cx as i,p as l,cy as n,n as o,H as r,cz as m,u as c,b3 as u,an as p,V as d}from"./utils-lib.js?v=1763689792";import{c as f,a as h,u as v}from"./column.js?v=1763689792";import{o as b,r as g,c as y,w as C,e as _,aT as N,aE as j,v as w,a8 as x,x as O,O as R,C as T,A as k,z as L}from"./base-lib.js?v=1763689792";import{b as B,N as W}from"./useMethods.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";const{refs:{customLimit:A,isRefreshStorageList:q}}=a(),S=b({isRefresh:!0}),E=g([]),H=[{active:!0,label:"添加存储卷",onClick:()=>{o({component:()=>r(()=>import("./index270.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),title:"添加存储卷",area:58,btn:"添加"})}},{label:"清理存储卷",onClick:async()=>{await l({type:"calc",title:"清理存储卷",content:"您真的要清理所有未被容器使用的存储卷吗？（可能不会包含您自己创建的卷）"}),s({request:m(),message:!0,loading:"正在清理存储卷，请稍后...",success:()=>{q.value=!0}})}},{type:"link",label:"需求反馈",class:"ml-[2rem]",onClick:()=>{W()}}],z=async e=>{await l({type:"calc",title:"删除存储卷【".concat(e.Name,"】"),content:"您真的要删除存储卷【".concat(e.Name,"】吗？")}),s({request:n({data:JSON.stringify({name:e.Name})}),message:!0,success:()=>{q.value=!0}})},D=t([{label:"删除项目",value:"delete",event:async(e,a,t,s)=>{const{label:i,value:l}=s,o=async(e,a)=>{const{Name:t}=e;if("delete"===l)return await n({data:JSON.stringify({name:t})})};await e({title:"批量".concat(i,"存储卷"),content:"批量".concat(i,"已选的存储卷，是否继续操作！"),column:[{label:"存储卷",prop:"Name"},f()],onConfirm:async()=>(await a(o),q.value=!0,!1)})}}]),J=(e,a)=>{setTimeout(()=>{A.value.storage||((e,a)=>{setTimeout(()=>{e.value>900?a.value.limit=20:a.value.limit=10},0)})(e,a)},0)},M={class:"flex items-center"},P=y({__name:"index",setup(t){const{refs:{isRefreshStorageList:l}}=a(),{mainHeight:n}=c(),{BtOperation:o}=u({options:H});C(()=>l.value,e=>{e&&(S.isRefresh=!0,g())});const{BtTable:r,BtPage:m,BtBatch:f,BtColumn:b,refresh:g,param:y}=p({request:e=>(async e=>{if(q.value=!1,!S.isRefresh)return{data:B({limit:e.limit,list:E.value,p:e.p})||[],total:E.value.length};S.isRefresh=!1;const a=await s({request:i(),data:Array});return E.value=a,{data:B({limit:e.limit,list:E.value,p:e.p})||[],total:E.value.length}})(e),columns:[h({key:"Name"}),{label:"存储卷",prop:"Name",minWidth:100,render:e=>_(N,{placement:"top"},{default:()=>_("div",null,[e.Name]),content:()=>_("div",null,[e.Name])})},{label:"挂载点",prop:"Mountpoint",minWidth:100,isCustom:!0,showOverflowTooltip:!0},{label:"所属容器",prop:"container",minWidth:100,isCustom:!0},{label:"设备",prop:"Driver",minWidth:100,isCustom:!0},{label:"创建时间",prop:"CreatedAt",minWidth:100,isCustom:!0,render:e=>d(e.CreatedAt)},{label:"标签",prop:"Labels",minWidth:100,showOverflowTooltip:!0,isCustom:!0,render:e=>{if(!e.Labels)return j("span","");return(Object.entries(e.Labels)||[]).map(e=>"".concat(e[0],":").concat(e[1])).join(",")}},v([{onClick:z,title:"删除"}])],extension:[D]});return w(async()=>{J(n,y)}),x(()=>{S.isRefresh=!0,E.value=[]}),(a,t)=>{const s=e;return O(),R(s,{class:""},{"header-left":T(()=>[k("div",M,[_(L(o))])]),"header-right":T(()=>[_(L(b))]),content:T(()=>[_(L(r),{key:"storageTable","max-height":L(n)-220},null,8,["max-height"])]),"footer-left":T(()=>[_(L(f))]),"footer-right":T(()=>[_(L(m))]),popup:T(()=>[...t[0]||(t[0]=[])]),_:1})}}});export{P as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
