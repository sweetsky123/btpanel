import{c as e,r as a,v as l,x as s,y as t,e as o,C as m,z as u,A as n,R as r,D as i,V as d}from"./base-lib.js?v=1763689792";import{Q as c,ho as p,b as v,b8 as f,l as x,$ as V,j as h}from"./utils-lib.js?v=1763689792";import{B as j}from"./index119.js?v=1763689792";import{_ as b}from"./index109.js?v=1763689792";import{d as _,u as g}from"./column.js?v=1763689792";import{bj as y,bk as q}from"./firewall.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./ace.js?v=1763689792";import"./index110.js?v=1763689792";const w={class:"p-[2rem]"},C={class:"p-[2rem]"},k={class:"flex items-center p-[2rem] text-base"},U={class:"flex flex-col ml-[1.2rem]"},A={class:"flex items-center mt-[1.2rem]"},D=e({__name:"index",setup(e){const D=v(),F=a([]),z=a(""),B=a(!1),H=a({}),J=a(!1),L=a(!1),N=a([{label:"隔离时间",prop:"time"},_({label:"文件",prop:"path"}),g([{title:"样本文件",width:60,onClick:async e=>{H.value=e;const a=await c({request:p({path:e.path})});a.data.msg?D.request(a):(z.value=a.data.data,B.value=!0)}},{title:"删除",onClick:async e=>{J.value=!0,H.value=e}}])]),O=async()=>{c({request:y(),data:[Array,F]})},Q=async()=>{c({request:f({path:H.value.path,data:z.value,encoding:"utf-8"}),message:!0})},R=async()=>{c({request:q({data:JSON.stringify({md5:H.value.md5,path:H.value.path,type:L.value?"delete":""})}),message:!0,success:()=>{O(),L.value=!1,J.value=!1}})};return l(()=>{O()}),(e,a)=>{const l=x,c=b,p=V,v=j,f=h,_=d;return s(),t("div",w,[o(c,null,{content:m(()=>[o(l,{column:u(N),data:u(F)},null,8,["column","data"])]),_:1}),o(p,{options:[{content:"样本文件：查杀时的文件内容被记录形成的样本文件"}],class:"ml-[2rem] mt-[1.2rem]"}),o(f,{title:"在线编辑",showFooter:"",modelValue:u(B),"onUpdate:modelValue":a[1]||(a[1]=e=>r(B)?B.value=e:null),area:70,onConfirm:Q},{default:m(()=>[n("div",C,[o(v,{modelValue:u(z),"onUpdate:modelValue":a[0]||(a[0]=e=>r(z)?z.value=e:null),class:"!h-[40rem]"},null,8,["modelValue"])])]),_:1},8,["modelValue"]),o(f,{title:"删除文件",showFooter:"",area:40,modelValue:u(J),"onUpdate:modelValue":a[3]||(a[3]=e=>r(J)?J.value=e:null),onConfirm:R},{default:m(()=>[n("div",k,[a[6]||(a[6]=n("i",{class:"svgtofont-el-question text-warningDark text-titleLarge"},null,-1)),n("div",U,[a[5]||(a[5]=n("span",{class:"leading-8"},"是否要删除关联的源文件？",-1)),n("div",A,[o(_,{modelValue:u(L),"onUpdate:modelValue":a[2]||(a[2]=e=>r(L)?L.value=e:null),class:"!mr-[.4rem]"},null,8,["modelValue"]),a[4]||(a[4]=i(" 源文件 ",-1))])])])]),_:1},8,["modelValue"])])}}});export{D as default};
