!function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",l=a.toStringTag||"@@toStringTag";function i(t,a,u,l){var i=a&&a.prototype instanceof s?a:s,c=Object.create(i.prototype);return r(c,"_invoke",function(t,r,a){var u,l,i,s=0,c=a||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return u=n,l=0,i=e,d.n=t,o}};function p(t,r){for(l=t,i=r,n=0;!f&&s&&!a&&n<c.length;n++){var a,u=c[n],p=d.p,m=u[2];t>3?(a=m===r)&&(i=u[(l=u[4])?5:(l=3,3)],u[4]=u[5]=e):u[0]<=p&&((a=t<2&&p<u[1])?(l=0,d.v=r,d.n=u[1]):p<m&&(a=t<3||u[0]>r||r>m)&&(u[4]=t,u[5]=r,d.n=m,l=0))}if(a||t>1)return o;throw f=!0,r}return function(a,c,m){if(s>1)throw TypeError("Generator is already running");for(f&&1===c&&p(c,m),l=c,i=m;(n=l<2?e:i)||!f;){u||(l?l<3?(l>1&&(d.n=-1),p(l,i)):d.n=i:d.v=i);try{if(s=2,u){if(l||(a="next"),n=u[a]){if(!(n=n.call(u,i)))throw TypeError("iterator result is not an object");if(!n.done)return n;i=n.value,l<2&&(l=0)}else 1===l&&(n=u.return)&&n.call(u),l<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),l=1);u=e}else if((n=(f=d.n<0)?i:t.call(r,d))!==o)break}catch(n){u=e,l=1,i=n}finally{s=1}}return{value:n,done:f}}}(t,u,l),!0),c}var o={};function s(){}function c(){}function f(){}n=Object.getPrototypeOf;var d=[][u]?n(n([][u]())):(r(n={},u,function(){return this}),n),p=f.prototype=s.prototype=Object.create(d);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,r(e,l,"GeneratorFunction")),e.prototype=Object.create(p),e}return c.prototype=f,r(p,"constructor",f),r(f,"constructor",c),c.displayName="GeneratorFunction",r(f,l,"GeneratorFunction"),r(p),r(p,l,"Generator"),r(p,u,function(){return this}),r(p,"toString",function(){return"[object Generator]"}),(t=function(){return{w:i,m:m}})()}function r(e,n,t,a){var u=Object.defineProperty;try{u({},"",{})}catch(e){u=0}r=function(e,n,t,a){function l(n,t){r(e,n,function(e){return this._invoke(n,t,e)})}n?u?u(e,n,{value:t,enumerable:!a,configurable:!a,writable:!a}):e[n]=t:(l("next",0),l("throw",1),l("return",2))},r(e,n,t,a)}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach(function(n){l(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function l(n,t,r){return(t=function(n){var t=function(n,t){if("object"!=e(n)||!n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var a=r.call(n,t||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"==e(t)?t:t+""}(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function i(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=o(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,l=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return l=e.done,e},e:function(e){i=!0,u=e},f:function(){try{l||null==t.return||t.return()}finally{if(i)throw u}}}}function o(e,n){if(e){if("string"==typeof e)return s(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?s(e,n):void 0}}function s(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function c(e,n,t,r,a,u,l){try{var i=e[u](l),o=i.value}catch(e){return void t(e)}i.done?n(o):Promise.resolve(o).then(r,a)}function f(e){return function(){var n=this,t=arguments;return new Promise(function(r,a){var u=e.apply(n,t);function l(e){c(u,r,a,l,i,"next",e)}function i(e){c(u,r,a,l,i,"throw",e)}l(void 0)})}}System.register(["./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./useStore-legacy5.js?v=1763689792","./index-legacy109.js?v=1763689792","./index-legacy260.js?v=1763689792","./ssl-legacy.js?v=1763689792","./useMethod-legacy7.js?v=1763689792","./useStore-legacy11.js?v=1763689792","./useMethod-legacy12.js?v=1763689792","./useController-legacy15.js?v=1763689792","./validator-legacy.js?v=1763689792","./column-legacy.js?v=1763689792","./index-legacy147.js?v=1763689792","./index-legacy110.js?v=1763689792","./index.vue_vue_type_style_index_0_scoped_cdc7f4d3_lang-legacy.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./site-legacy.js?v=1763689792","./useStore-legacy12.js?v=1763689792","./useStore-legacy4.js?v=1763689792","./useController-legacy6.js?v=1763689792","./useController-legacy5.js?v=1763689792","./useMethod-legacy5.js?v=1763689792","./useController-legacy4.js?v=1763689792","./index-legacy107.js?v=1763689792","./index-legacy131.js?v=1763689792"],function(e,r){"use strict";var a,l,o,s,c,d,p,m,v,h,y,g,b,w,x,_,k,C,j,D,S,T,E,O,B,N,P,R,I,M,A,V,L,q,H,U,G,F,z,J,X,Y,Q,W,Z,$,K,ee,ne,te,re,ae,ue,le,ie,oe,se,ce,fe,de,pe,me,ve,he,ye,ge,be,we,xe,_e,ke,Ce,je,De,Se,Te,Ee,Oe,Be,Ne,Pe,Re,Ie,Me,Ae,Ve,Le,qe,He,Ue,Ge,Fe,ze,Je,Xe,Ye,Qe,We,Ze,$e,Ke,en;return{setters:[function(e){a=e.R,l=e.Q,o=e.b,s=e.u,c=e.n,d=e.H,p=e.e,m=e.M,v=e.an,h=e.q,y=e.bm,g=e.aA,b=e.ao,w=e.cN,x=e.ap,_=e.f,k=e.j,C=e._,j=e.hx,D=e.aC},function(e){S=e.c,T=e.s,E=e.o,O=e.r,B=e.g,N=e.w,P=e.x,R=e.y,I=e.A,M=e.B,A=e.z,V=e.e,L=e.C,q=e.D,H=e.G,U=e.V,G=e.H,F=e.t,z=e.W,J=e.aA,X=e.aE,Y=e.ar,Q=e.at,W=e.as,Z=e.b2,$=e.v,K=e.b,ee=e.R,ne=e.i,te=e.aH,re=e.aT,ae=e.ap,ue=e.n,le=e.aP,ie=e.aZ},function(e){oe=e.g},function(e){se=e._},function(e){ce=e._},function(e){fe=e.e,de=e.f,pe=e.r,me=e.h,ve=e.i,he=e.j,ye=e.k,ge=e.l,be=e.m,we=e.n,xe=e.u,_e=e.o},function(e){ke=e.r,Ce=e.s,je=e.a},function(e){De=e.u},function(e){Se=e.d,Te=e.a,Ee=e.c,Oe=e.r,Be=e.b,Ne=e.h,Pe=e.C,Re=e.o,Ie=e.e,Me=e.f,Ae=e.g,Ve=e.i,Le=e.v,qe=e.u},function(e){He=e.C,Ue=e.b,Ge=e.a,Fe=e.d,ze=e.o,Je=e.r,Xe=e.g},function(e){Ye=e.b,Qe=e.j,We=e.e},function(e){Ze=e.c,$e=e.a},function(e){Ke=e.u},function(e){en=e._},null,null,null,null,null,null,null,null,null,null,null],execute:function(){var nn,tn,rn={class:"p-[2rem] w-[480px]"},an={class:"flex items-center"},un={class:"text-base ml-[.8rem] leading-10"},ln={key:0,class:"flex items-center ml-[4.8rem] mt-[1.2rem]"},on={class:"bg-light footer-btn flex items-center justify-end p-[1.2rem] w-full"},sn=S({__name:"index",props:{compData:{},isMulti:{type:Boolean},delType:{}},emits:["cancel"],setup:function(e,r){var s=r.expose,c=r.emit,d=T(De()),p=d.activeTabs,m=d.sslIsRefresh,v=d.testIsRefresh,h=d.encryptIsRefresh,y=d.otherIsRefresh,g=o(),b=e,w=c,x=E({addend1:Math.round(9*Math.random()+1),addend2:Math.round(9*Math.random()+1),sum:void 0,cloud:!1,local:!0}),_=O(null),k=O(!1),C=B(function(){return k.value?_.value.filter(function(e){return e.use_site.length>0}).map(function(e){return e.use_site}).flat():null===(e=_.value)||void 0===e?void 0:e.use_site;var e}),j=function(){var e=f(t().m(function e(){var n,r,o,s,c,f,d,j,D,S,T,E,O,B,N,P,R,I,M,A,V,L,q;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=g.load("正在".concat(k.value?"批量":"","删除证书，请稍候...")),e.p=1,r={ssl:function(){return m.value=!0},test:function(){return v.value=!0},encrypt:function(){return h.value=!0},other:function(){return y.value=!0}},!k.value){e.n=17;break}if(s=[],"ssl"!==b.delType){e.n=13;break}c=i(_.value),e.p=2,c.s();case 3:if((f=c.n()).done){e.n=9;break}if(d=f.value,e.p=4,!(d.endDay>=0)){e.n=5;break}return s.push({name:d.title||(null===(D=d.domainName)||void 0===D?void 0:D.join(","))||"未知证书",status:!1,msg:"证书未过期，无法删除"}),e.a(3,8);case 5:return e.n=6,fe(d.oid);case 6:S=e.v,T=S.data,s.push({name:d.title||(null===(j=d.domainName)||void 0===j?void 0:j.join(","))||"未知证书",status:T.status,msg:T.msg}),e.n=8;break;case 7:e.p=7,L=e.v,s.push({name:d.title||(null===(E=d.domainName)||void 0===E?void 0:E.join(","))||"未知证书",status:!1,msg:(null==L?void 0:L.message)||"删除失败"});case 8:e.n=3;break;case 9:e.n=11;break;case 10:e.p=10,q=e.v,c.e(q);case 11:return e.p=11,c.f(),e.f(11);case 12:e.n=15;break;case 13:if(O=[],B=[],_.value.forEach(function(e){void 0!==e.hash&&null!==e.hash?B.push(e.hash):void 0!==e.index&&null!==e.index?O.push(e.index):s.push({name:e.title,status:!1,msg:"不支持删除"})}),!O.length&&!B.length){e.n=15;break}return N={ssl_hash:B.join(","),index:O.join(","),local:1,cloud:x.cloud?1:0},C.value.length&&(N.force=!0),e.n=14,de(N);case 14:P=e.v,R=P.data,a(R.finish_list)&&R.finish_list.forEach(function(e){s.push({name:e.name,status:e.status,msg:e.status?"删除成功":e.msg})});case 15:return w("cancel"),e.n=16,ke({resultData:s,resultTitle:"删除"});case 16:null===(o=r[p.value])||void 0===o||o.call(r),e.n=20;break;case 17:if("ssl"!==b.delType){e.n=18;break}I=_.value.oid,l({request:fe(I),loading:"正在删除证书，请稍候...",message:!0,success:function(){var e;w("cancel"),null===(e=r[p.value])||void 0===e||e.call(r)}}),e.n=20;break;case 18:return M={ssl_id:_.value.id,ssl_hash:_.value.hash,index:_.value.index},_.value.order_status?(delete M.ssl_id,delete M.ssl_hash):delete M.index,C.value.length&&(M.force=1),e.n=19,pe(u(u({},M),{},{local:1,cloud:x.cloud?1:0}));case 19:A=e.v,a(A.data.finish_list)&&g.request(A.data.finish_list[0]),A.status&&(w("cancel"),null===(V=r[p.value])||void 0===V||V.call(r));case 20:e.n=22;break;case 21:e.p=21,e.v;case 22:return e.p=22,n&&n.close(),x.addend1=Math.round(9*Math.random()+1),x.addend2=Math.round(9*Math.random()+1),x.sum=void 0,e.f(22);case 23:return e.a(2)}},e,null,[[4,7],[2,10,11,12],[1,21,22,23]])}));return function(){return e.apply(this,arguments)}}(),D=function(){w("cancel"),x.addend1=Math.round(9*Math.random()+1),x.addend2=Math.round(9*Math.random()+1),x.sum=void 0};return N(function(){return b.compData},function(e){_.value=e},{deep:!0,immediate:!0}),N(function(){return b.isMulti},function(e){k.value=e},{deep:!0,immediate:!0}),s({handleCancel:D}),function(t,r){var a=U,u=G;return P(),R("div",null,[I("div",rn,[I("div",an,[r[1]||(r[1]=I("span",{class:"!text-warning !text-titleLarge svgtofont-el-warning-filled"},null,-1)),I("span",un,M("".concat(A(k)?"批量删除":"删除该","证书，是否继续操作？")),1)]),"other"===e.delType?(P(),R("div",ln,[V(a,{modelValue:A(x).cloud,"onUpdate:modelValue":r[0]||(r[0]=function(e){return A(x).cloud=e})},{default:L(function(){return[q(M("".concat(A(k)?"批量":"","同步删除云端证书")),1)]}),_:1},8,["modelValue"])])):H("",!0)]),I("div",on,[V(u,{type:"default",onClick:D},{default:L(function(){return n(r[2]||(r[2]=[q("取消",-1)]))}),_:1}),V(u,{type:"danger",onClick:j},{default:L(function(){return n(r[3]||(r[3]=[q("删除",-1)]))}),_:1})])])}}}),cn=oe(),fn=cn.refs,dn=(fn.tabActive,fn.typeList),pn=(cn.router,s().payment),mn=F(pn.value).bindUser,vn=[{content:"申请证书",dropdownClass:"bg-white",splitButton:!0,active:!0,event:function(){if(!mn.value)return Ye(),!1;Sn()}}],hn=z([]),yn=Ke({key:"type",name:"证书分组",options:function(){return[{label:"全部分组",value:"all"}]},event:{get:(nn=f(t().m(function e(){var r;return t().w(function(e){for(;;)switch(e.n){case 0:return r=[],e.n=1,l({request:me(),data:Array,success:function(e){r=[{label:"全部分组",value:"all"}].concat(n(e.map(function(e){return{label:e.name,value:String(e.group_id)}})))}});case 1:return dn.value=r,e.a(2,r)}},e)})),function(){return nn.apply(this,arguments)}),add:function(e){return ve({name:e.name,group_id:Date.now()})},delete:function(e){return he({group_id:e.id})}},ignore:["0"],field:"name",showEdit:!1}),gn=O(!1),bn=O(!1),wn=O(null),xn=O(null),_n=function(e,n){bn.value=n,wn.value=e,gn.value=!0},kn=function(){gn.value=!1},Cn=function(){var e=f(t().m(function e(n,a,u,l){var i,o,s,p,m;return t().w(function(e){for(;;)switch(e.n){case 0:return i=l.label,o=l.value,s=[],p=[],u.value.forEach(function(e){void 0!==e.hash&&null!==e.hash?p.push(e.hash):void 0!==e.index&&null!==e.index&&s.push(e.index)}),m=function(){var e=f(t().m(function e(){var n;return t().w(function(e){for(;;)switch(e.n){case 0:n=o,e.n="delete"===n?1:3;break;case 1:return e.n=2,_n(u.value,!0);case 2:return e.a(2,e.v);case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),e.n=1,c({title:"批量".concat(i,"证书"),area:46,component:function(){return d(function(){return r.import("./index-legacy125.js?v=1763689792")},void 0,r.meta.url)},compData:{resultTitle:"批量".concat(i,"证书"),resultData:u.value,resultColumn:[{label:"名称",prop:"title"},Ze()],autoTitle:"批量".concat(i,"证书")},showFooter:!0,onConfirm:function(){var e=f(t().m(function e(){return t().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,m();case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}()});case 1:return e.a(2)}},e)}));return function(n,t,r,a){return e.apply(this,arguments)}}(),jn=[{label:"批量分组",value:"group",event:function(e,n,t,r){return Ce(t.value,"certificate")}},{label:"批量设置告警",value:"alarm",event:function(e,n,t,r){Ne(t.value,Pe.SSL)}},{label:"批量下载",value:"download",event:(tn=f(t().m(function e(n,r,a,u,l){return t().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Dn(a.value);case 1:l&&l();case 2:return e.a(2)}},e)})),function(e,n,t,r,a){return tn.apply(this,arguments)})},{label:"删除",value:"delete",event:Cn}],Dn=function(){var e=f(t().m(function e(n){var r,a,u,l,i,o,s,c,f,d;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=null,a=[],u=[],l=function(e){a.push(e)},e.p=1,r=m.load("正在批量下载证书，请稍候..."),n.forEach(function(e){l(e)}),!(a.length>0)){e.n=4;break}if(i=a.filter(function(e){return void 0!==e.oid&&null!==e.oid&&e.download_status}),o=i.map(function(e){return e.oid}).join(","),s={oid:o},o){e.n=2;break}return r.close&&r.close(),m.error("选择的证书中没有可下载的证书！"),e.a(2);case 2:return e.n=3,ye(s);case 3:c=e.v,f=c.data,c.status&&(f.url&&window.open(f.url,"_blank","noopener,noreferrer"),(null===(d=f.finish_list)||void 0===d?void 0:d.length)>0&&f.finish_list.forEach(function(e){var t=JSON.parse(e.cert.info);u.push({name:n.find(function(e){return e.id==t.issuer}).domainName.join(","),oid:t.issuer,status:e.status})}));case 4:ke({resultData:u,resultTitle:"下载",resultColumn:[{label:"名称",prop:"name"},{label:"订单编号",prop:"oid"},{label:"结果",render:function(e){var n="",t="";return e.status?(n="下载成功",t="text-primary"):(n="下载失败",t="text-danger"),X("span",{class:t},n)}}]}),e.n=6;break;case 5:e.p=5,e.v;case 6:return e.p=6,r&&r.close(),e.f(6);case 7:return e.a(2)}},e,null,[[1,5,6,7]])}));return function(n){return e.apply(this,arguments)}}(),Sn=function(){c({isAsync:!0,title:"购买商业证书",area:[82],component:function(){return d(function(){return r.import("./index-legacy407.js?v=1763689792")},void 0,r.meta.url)}})},Tn=function(e){var n=function(e,n){return V("span",{class:"bt-link",onClick:n},[e])},t=n("人工服务",function(){return Qe()}),a=n("详情",function(){return function(e){c({title:"多年期证书详情",area:52,compData:e,component:function(){return d(function(){return r.import("./mulit-cert-detail-legacy.js?v=1763689792")},void 0,r.meta.url)}})}(e)}),u=n("下载",function(){return Se(e)}),l=n("部署",function(){return Te(e)}),i=n("验证",function(){return Ee(e.oid,e.cert_ssl_type,e.pid)}),o=n("续签",function(){return Oe(e.oid)}),s=n("完善资料",function(){return Be(e)}),f=e.orderStatus,p=[];switch(e.years&&e.years>1&&[5,15].includes(Number(f))&&p.push(a),Number(f)){case 0:e.install&&p.push(t),p.push(s);break;case 3:case 11:e.install&&p.push(t),p.push(i);break;case 5:p.push(l),p.push(u);break;case 7:p.push(o)}var m=[];return p.map(function(e,n){m.push(e),n<p.length-1&&m.push(V(en,null,null))}),m},En={class:"flex items-center"},On={class:"flex items-center ml-[12px]"},Bn={class:"flex items-center"};var Nn=S({__name:"index",setup:function(e,r){var a,l=r.expose,i=oe().refs,o=i.tabActive,c=i.expiringCertificateCount,d=i.expiredCertificateCount,m=T(De()),C=m.sslSearchType,j=m.sslIsRefresh,D=s().mainHeight,S=x(jn),E=v({request:(a=f(t().m(function e(n){var r,a,u,l;return t().w(function(e){for(;;)switch(e.n){case 0:return"-1"===(r={p:n.p,group_id:h(n.type)||"all"===n.type?"-1":n.type,search:n.search,limit:n.limit,status_id:C.value,cert_type:"1"}).group_id&&delete r.group_id,"-1"===r.status_id&&delete r.status_id,""===r.search&&delete r.search,e.n=1,ge(r);case 1:return a=e.v,u=a.data,hn.value=u.data,(l=y(u))("will_num")&&(c.value=(null==u?void 0:u.will_num)||0),l("end_num")&&(d.value=(null==u?void 0:u.end_num)||0),e.a(2,{data:u.data,total:g(u.page),other:{search_history:u.search_history}})}},e)})),function(e){return a.apply(this,arguments)}),columns:[$e(),{label:"认证域名",render:function(e){var n;return(null===(n=e.domainName)||void 0===n?void 0:n.join(", "))||"--"}},{label:"证书类型",prop:"title",showOverflowTooltip:!0,width:180},{label:"部署网站",isCustom:!0,showOverflowTooltip:!0,render:function(e){var n;return(null===(n=e.use_site)||void 0===n?void 0:n.join(", "))||"--"}},{label:"分组",prop:"group_name",width:100,showOverflowTooltip:!0,isCustom:!1},{label:"到期时间",isCustom:!0,render:function(e){var n,t,r,a=function(e,n){return V("span",{class:e<=10?"text-danger":n},[e>0?"剩余".concat(e,"天"):"已过期"])},u=(r=e.endDay)<=0||r<=7?"text-danger":r<=15?"text-warning":"text-primary";return"1"===e.type?e.endDate?a(e.endDay,e.endDay<=30?"text-warning":u):V("span",null,[q("--")]):"2"===e.type?null!=e&&e.endDay&&0!==(null==e?void 0:e.endDay)?a(e.endDay,e.endDay<=30?"text-warning":u):V("span",null,[q("--")]):V("span",{class:null!==(n=e.domainName)&&void 0!==n&&n.length?u:"text-default"},[null!==(t=e.domainName)&&void 0!==t&&t.length?e.endDay>0?"剩余".concat(e.endDay,"天"):"已过期":"--"])}},{label:"订单状态",isCustom:!0,renderHeader:function(){var e=[{title:"全部",key:"-1"},{title:"验证中",key:"0"},{title:"未到期/订单完成",key:"1"},{title:"即将到期",key:"2"},{title:"已到期",key:"3"}];return X("div",{class:"flex items-center flex-nowrap"},["",X(Y,{onCommand:function(e){C.value=e,z()}},{default:function(){return X("span",{class:"text-small flex items-center"},[[V("span",{class:"status-header-text"},[q("订单状态"),"-1"===C.value?"(全部)":"(".concat(e.find(function(e){return e.key===C.value}).title,")")])],X("i",{class:"svgtofont-el-arrow-down "})])},dropdown:function(){var n,t;return V(W,null,"function"==typeof(t=n=e.map(function(e){return V(Q,{command:e.key},{default:function(){return[e.title]}})}))||"[object Object]"===Object.prototype.toString.call(t)&&!ne(t)?n:{default:function(){return[n]}})}})])},render:function(e){if(e.cert_ssl_type)return function(e){var n=V(J,{placement:"bottom-end",width:"400","popper-class":"white-theme",trigger:"click"},{default:function(){return V("div",{class:"bus-ssl-popover"},[V("div",{class:"ssl-popover-item"},[V("span",{class:"ssl-popover-title"},[q("自行排查")]),V("p",null,[q("以图文的形式，一步步教您验证并部署商业SSL")]),V(p,{href:"https://www.bt.cn/bbs/thread-85379-1-1.html",target:"_blank"},{default:function(){return[q("如何验证商用证书?")]}})]),V("div",{class:"ssl-popover-item"},[V("span",{class:"ssl-popover-title"},[q("购买人工")]),V("p",null,[q("不会部署?人工客服帮你全程部署，不成功可退款")]),V(G,{size:"small",type:"primary",onClick:function(){return Qe()}},{default:function(){return[q("购买人工")]}})])])},reference:function(){return V("span",{class:"bt-link"},[q("排查方法?")])}}),t=e.orderStatus,r=[];switch(Number(t)){case-1:r.push(V("span",{class:"text-danger"},[q("已取消")]));break;case 0:e.install||r.push(n),r.push(V("span",{class:"text-warning"},[q("待完善资料")]));break;case 1:r.push(V("span",{class:"text-warning"},[q("待审核")]));break;case 2:r.push(V("span",{class:"text-warning"},[q("正在提交CA")]));break;case 3:r.push(V("span",{class:"text-warning"},[q("待域名验证")]));break;case 4:r.push(V("span",{class:"text-warning"},[q("签发中")]));break;case 5:r.push(V("span",{class:"text-success"},[q("已签发")]));break;case 6:r.push(V("span",{class:"text-warning"},[q("取消确认")]));break;case 7:r.push(V("span",{class:"text-warning"},[q("待续费")]));break;case 8:r.push(V("span",{class:"text-warning"},[q("待吊销确认")]));break;case 9:r.push(V("span",{class:"text-warning"},[q("待重颁发")]));break;case 10:r.push(V("span",{class:"text-warning"},[q("重颁发中")]));break;case 11:r.push(V("span",{class:"text-warning"},[q("吊销中")]));break;case 12:r.push(V("span",{class:"text-danger"},[q("已吊销")]));break;default:r.push(V("span",{class:"text-warning"},[q("待完善资料")]))}var a=[];return r.map(function(e,n){a.push(e),n<r.length-1&&a.push(V(en,null,null))}),a}(e);if("1"===e.type){var n=[],t=function(e,n){return V("span",{class:e},[n])},r=e.domainName&&e.domainName.length>0;if(""!=e.certId||r)if(""==e.certId&&0!==e.domainName.length)n.push(t("text-warningDark","待提交"));else if(1===e.status)switch(e.orderStatus){case"COMPLETE":n.push(t("text-primary","订单完成"));break;case"REISSUED":n.push(t("text-primary","已重签"));break;case"PENDING":n.push((u="orange",l="验证中",V(J,{trigger:"hover",placement:"left","popper-class":"popover-default",width:"300",enterable:!1,"open-delay":100,"close-delay":0},{default:function(){return V("div",{class:"flex items-center p-[2px] whitespace-nowrap"},[q("1、如填写错误，联系人工可重置订单"),V("br",null,null),q("2、如验证方式选择错误，联系人工修改验证方式")])},reference:function(){return V("div",{style:"color: ".concat(u,";")},[l])}})));break;case"CANCELLED":n.push(t("text-tertiary","已取消"));break;case"FAILED":n.push(t("text-[var(--el-color-error-light-8)]","申请失败"));break;case"EXPIRED":n.push(t("text-[var(--el-color-error-light-8)]","已过期"));break;default:n.push(t("text-warningDark","待验证"))}else switch(e.status){case 0:n.push(t("text-warningDark","未支付"));break;case-1:n.push(t("text-tertiary","已取消"))}else n.push(V("span",{class:"cursor-pointer bt-warn",onClick:function(){return Be(e)}},[q("待完善资料")]));var a=[];return n.map(function(e,t){a.push(e),t<n.length-1&&a.push(V(Z,{direction:"vertical"},null))}),a}return[];var u,l}},{label:"操作",align:"right",fixed:"right",width:280,render:function(e){if(e.cert_ssl_type)return Tn(e);var n=function(e,n){return V("span",{class:"bt-link",onClick:n},[e])},t=n("人工服务",function(){return Qe()}),r=n("下载",function(){return Se(e)}),a=n("部署",function(){return Te(e)}),l=n("验证",function(){return Ee(e.oid,e.cert_ssl_type,e.pid)}),i=n("续签",function(){return Oe(e.oid)}),o=n("删除",function(){return _n(e,!1)}),s=n("到期告警",function(){return je(u(u({},e),{},{cancel:function(){}}))}),c=[];if(e.endDay<=0||c.push(s),e.renew&&c.push(V("span",{class:"cursor-pointer bt-link",onClick:function(){return Oe(e.oid)}},[q("续签")])),""==e.certId)e.install&&c.push(t),c.push(n("完善资料",function(){return Be(e)}));else if(1===e.status){switch(e.orderStatus){case"COMPLETE":1===e.ssl_state?c.push(V("span",null,[q("已部署")])):c.push(a),e.endDay<30&&c.push(i);break;case"PENDING":default:e.install&&c.push(t),c.push(l);break;case"CANCELLED":c.push(V("span",null,[q("无操作")]));break;case"FAILED":c.push(V("span",{class:"cursor-pointer bt-danger"},[q("申请失败")]));break;case"EXPIRED":c.push(a);case"REISSUED":}e.download_status&&c.push(r),e.endDay&&e.endDay<=0&&c.push(o)}else c.push(V("span",null,[q("无操作")]));var f=[];return c.map(function(e,n){f.push(e),n<c.length-1&&f.push(V(Z,{direction:"vertical"},null))}),c=f}}],extension:[yn,S,b(j),w("search",{name:"ssl",key:"get_cert_list",list:[],showRecommend:!1})]}),O=E.BtTable,B=E.BtPage,N=E.BtRefresh,M=E.BtTableCategory,H=E.BtRecommendSearch,U=E.BtColumn,F=E.BtBatch,z=(E.BtErrorMask,E.refresh);return $(function(){o.value=K().name}),l({init:z}),function(e,t){var r=ce,a=_,u=p,l=k,i=se;return P(),R("div",null,[V(i,null,{"header-left":L(function(){return[I("div",En,[V(r,{options:A(vn)},null,8,["options"]),V(He,{placement:"right"},{default:L(function(){return[I("div",On,[V(a,{src:"/static/icons/we-com.svg",class:"mx-[4px] w-2rem h-2rem",all:!0}),t[2]||(t[2]=I("span",{class:"bt-link"},"售前客服",-1))])]}),_:1}),V(u,{class:"ml-[12px] flex items-center",onClick:A(Re)},{default:L(function(){return n(t[3]||(t[3]=[I("div",{class:"flex items-center"},[I("span",{class:"svgtofont-desired text-medium"}),I("span",null,"需求反馈")],-1)]))}),_:1},8,["onClick"])])]}),"header-right":L(function(){return[I("div",Bn,[V(A(M),{class:"!w-[140px] mr-[10px]"}),V(A(H),{type:"ssl-certificate",placeholder:"请输入证书名称",class:"!w-[270px] mr-[10px]"}),V(A(N),{class:"mr-[10px]"}),V(A(U))])]}),content:L(function(){return[V(A(O),{"min-height":A(D)},null,8,["min-height"])]}),"footer-left":L(function(){return[V(A(F))]}),"footer-right":L(function(){return[V(A(B))]}),popup:L(function(){return[V(l,{title:"证书删除确认",modelValue:A(gn),"onUpdate:modelValue":t[0]||(t[0]=function(e){return ee(gn)?gn.value=e:null}),area:["auto"],onCancel:t[1]||(t[1]=function(e){return A(xn).handleCancel()})},{default:L(function(){return[V(sn,{ref_key:"delRef",ref:xn,delType:"ssl",isMulti:A(bn),compData:A(wn),onCancel:A(kn)},null,8,["isMulti","compData","onCancel"])]}),_:1},8,["modelValue"])]}),_:1})])}}}),Pn=C(Nn,[["__scopeId","data-v-9c320238"]]),Rn=T(De()).encryptIsRefresh,In=O(!1),Mn=O(!1),An=O(null),Vn=O(null),Ln=function(e,n){Mn.value=n,An.value=e,In.value=!0},qn=function(){var e=f(t().m(function e(n,u,i,o){var s,p,m,v,h;return t().w(function(e){for(;;)switch(e.n){case 0:return s=o.label,p=o.value,m=[],v=[],i.value.forEach(function(e){void 0!==e.hash&&null!==e.hash?v.push(e.hash):void 0!==e.index&&null!==e.index&&m.push(e.index)}),h=function(){var e=f(t().m(function e(){var n;return t().w(function(e){for(;;)switch(e.n){case 0:n=p,e.n="download"===n?1:"delete"===n?3:5;break;case 1:return e.n=2,ye({ssl_hash:v.join(","),index:m.join(",")});case 2:case 4:return e.a(2,e.v);case 3:return e.n=4,Ln(i.value,!0);case 5:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),e.n=1,c({title:"批量".concat(s,"证书"),area:46,component:function(){return d(function(){return r.import("./index-legacy125.js?v=1763689792")},void 0,r.meta.url)},compData:{resultTitle:"批量".concat(s,"证书"),resultData:i.value,resultColumn:[{label:"名称",prop:"title"},Ze()],autoTitle:"批量".concat(s,"证书")},showFooter:!0,onConfirm:function(){var e=f(t().m(function e(){var n,r,u;return t().w(function(e){for(;;)switch(e.n){case 0:if("delete"!==p){e.n=2;break}return e.n=1,h();case 1:return e.a(2);case 2:return n=l,e.n=3,h();case 3:r=e.v,u="正在批量".concat(s,"证书"),n({request:r,loading:u,success:function(e){var n=e.data;if(e.status){var t,r=[],u=[];if("download"===p)n.url&&window.open(n.url,"_blank","noopener,noreferrer"),(null===(t=n.finish_list)||void 0===t?void 0:t.length)>0&&n.finish_list.forEach(function(e){var n=JSON.parse(e.cert.info);r.push({name:n.issuer,status:e.status})}),u=[{label:"名称",prop:"name"},{label:"结果",render:function(e){var n="",t="";return e.status?(t="text-primary",n="下载成功"):(t="text-danger",n="下载失败"),X("span",{class:t},n)}}];else a(n.finish_list)&&(n.finish_list.forEach(function(e){r.push({name:e.name,status:e.status,msg:e.status?"删除成功":e.msg})}),u=[{label:"名称",prop:"name"},{label:"结果",render:function(e){var n=e.msg,t="";return t=e.status?"text-primary":"text-danger",X("span",{class:t},n)}}],Rn.value=!0);ke({resultTitle:"批量".concat(s,"证书"),resultData:r,resultColumn:u})}}});case 4:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}()});case 1:return e.a(2)}},e)}));return function(n,t,r,a){return e.apply(this,arguments)}}(),Hn=function(){var e=f(t().m(function e(n){var a,u;return t().w(function(e){for(;;)switch(e.n){case 0:return a=l,e.n=1,be(n.crontab_id);case 1:u=e.v,a({request:u,loading:"正在获取异常日志",success:function(e){var t=e.msg;c({title:"续签异常/失败日志",area:66,component:function(){return d(function(){return r.import("./exception-log-legacy.js?v=1763689792")},void 0,r.meta.url)},compData:{reason:n.crontab_data.error_msg,logContent:t||"暂无异常日志"}})}});case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),Un={class:"flex items-center"},Gn={class:"flex items-center ml-[12px]"},Fn={class:"flex items-center"};var zn=S({__name:"index",setup:function(e,a){var i=a.expose,o=oe().refs,m=o.tabActive,C=o.expiringCertificateCount,j=o.expiredCertificateCount,D=o.typeList,S=T(De()),E=S.encryptIsRefresh,O=S.encryptSearchType,B=s().mainHeight;te();var N,M,H=[{content:"申请证书",dropdownClass:"bg-white",splitButton:!0,active:!0,event:function(){c({isAsync:!0,title:"申请Let's Encrypt证书",area:64,component:function(){return d(function(){return r.import("./apply-lest-ssl-legacy.js?v=1763689792")},void 0,r.meta.url)}})}}],U=z([]),G=function(){In.value=!1},F=Ke({key:"type",name:"证书分组",options:function(){return[{label:"全部分组",value:"all"}]},event:{get:(N=f(t().m(function e(){var r;return t().w(function(e){for(;;)switch(e.n){case 0:return r=[],e.n=1,l({request:me(),data:Array,success:function(e){r=[{label:"全部分组",value:"all"}].concat(n(e.map(function(e){return{label:e.name,value:String(e.group_id)}})))}});case 1:return D.value=r,e.a(2,r)}},e)})),function(){return N.apply(this,arguments)}),add:function(e){return ve({name:e.name,group_id:Date.now()})},delete:function(e){return he({group_id:e.id})}},ignore:["0"],field:"name",showEdit:!1}),le=x([{label:"批量分组",value:"group",event:function(e,n,t,r){return Ce(t.value,"certificate")}},{label:"批量设置告警",value:"alarm",event:function(e,n,t,r){Ne(t.value,Pe.ENCRYPT)}},{label:"下载",value:"download",event:qn},{label:"删除",value:"delete",event:qn}]),ie=v({request:(M=f(t().m(function e(n){var r,a,u,l;return t().w(function(e){for(;;)switch(e.n){case 0:return"-1"===(r={p:n.p,group_id:h(n.type)||"all"===n.type?"-1":n.type,search:n.search,limit:n.limit,status_id:O.value,cert_type:"3"}).group_id&&delete r.group_id,"-1"===r.status_id&&delete r.status_id,""===r.search&&delete r.search,e.n=1,ge(r);case 1:return a=e.v,u=a.data,U.value=u.data,(l=y(u))("will_num")&&(C.value=(null==u?void 0:u.will_num)||0),l("end_num")&&(j.value=(null==u?void 0:u.end_num)||0),e.a(2,{data:u.data,total:g(u.page),other:{search_history:u.search_history}})}},e)})),function(e){return M.apply(this,arguments)}),columns:[$e(),{label:"认证域名",render:function(e){var n;return(null===(n=e.domainName)||void 0===n?void 0:n.join(", "))||"--"}},{label:"部署网站",isCustom:!0,render:function(e){var n;return(null===(n=e.use_site)||void 0===n?void 0:n.join(", "))||"--"}},{label:"分组",prop:"group_name",width:100,showOverflowTooltip:!0,isCustom:!1},{label:"到期时间",isCustom:!0,render:function(e){var n,t,r,a=function(e,n){return V("span",{class:e<=10?"text-danger":n},[e>0?"剩余".concat(e,"天"):"已过期"])},u=(r=e.endDay)<=0||r<=7?"text-danger":r<=15?"text-warning":"text-primary";return"1"===e.type?e.endDate?a(e.endDay,e.endDay<=30?"text-warning":u):V("span",null,[q("--")]):"2"===e.type?null!=e&&e.endDay&&0!==(null==e?void 0:e.endDay)?a(e.endDay,e.endDay<=30?"text-warning":u):V("span",null,[q("--")]):V("span",{class:null!==(n=e.domainName)&&void 0!==n&&n.length?u:"text-default"},[null!==(t=e.domainName)&&void 0!==t&&t.length?e.endDay>0?"剩余".concat(e.endDay,"天"):"已过期":"--"])}},{label:"验证方式",isCustom:!0,prop:"auth_type",render:function(e,n){return V("span",null,["dns"===e.auth_type?"DNS验证":"文件验证"])}},{label:"订单状态",isCustom:!0,renderHeader:function(){var e=[{title:"全部",key:"-1"},{title:"验证中",key:"0"},{title:"未到期/订单完成",key:"1"},{title:"即将到期",key:"2"},{title:"已到期",key:"3"}];return X("div",{class:"flex items-center flex-nowrap"},["",X(Y,{onCommand:function(e){O.value=e,xe()}},{default:function(){return X("span",{class:"text-small flex items-center"},[[V("span",{class:"status-header-text"},[q("订单状态"),"-1"===O.value?"(全部)":"(".concat(e.find(function(e){return e.key===O.value}).title,")")])],X("i",{class:"svgtofont-el-arrow-down "})])},dropdown:function(){var n,t;return V(W,null,"function"==typeof(t=n=e.map(function(e){return V(Q,{command:e.key},{default:function(){return[e.title]}})}))||"[object Object]"===Object.prototype.toString.call(t)&&!ne(t)?n:{default:function(){return[n]}})}})])},render:function(e){var n;if(null==e||!e.order_status||""===(null==e?void 0:e.order_status))return V("span",{class:"text-primary"},[q("订单完成")]);switch(e.order_status){case"pending":return null!==(n=e.domainName)&&void 0!==n&&n.length&&e.endDay>0?V("span",{class:"text-warningDark"},[q("待验证")]):V("span",null,[q("--")]);case"invalid":return V(re,{content:"验证失败，请尝试删除此订单后重新申请",placement:"top"},{default:function(){return[V("span",{class:"text-warningDark"},[e.order_status_nm])]}});default:return V("span",{class:"text-primary"},[q("订单完成")])}}},{label:"自动续签",renderHeader:function(){return V("div",{class:"flex items-center"},[V("span",null,[q("自动续签")]),V(J,{placement:"top-start",width:"200",trigger:"hover",content:"只支持let's Encrypt证书订单续签"},{reference:function(){return V("span",{class:" ml-[4px] bt-ico-ask"},[q("?")])}})])},isCustom:!1,render:function(e){var n=!("3"!==e.type||!e.order_status||-1===e.crontab_id),t="3"!==e.type||"valid"!==e.order_status;return V("span",{class:"flex items-center"},[V(ae,{size:"small",modelValue:n,"onUpdate:modelValue":function(e){return n=e},disabled:t,onChange:function(n){n?(e.crontab_id=1,Ie(u(u({},e),{},{cancel:function(){ue(function(){e.crontab_id=-1})}}))):Me(e)}},null),e.crontab_data&&-1===Number(e.crontab_data.status)&&V("span",{class:"bt-link !text-danger ml-[4px]",onClick:function(){return Hn(e)}},[q("异常")])])}},{label:"操作",align:"right",fixed:"right",width:280,render:function(e){var n,t=[];"valid"===e.order_status&&(t.push(V("span",{class:"cursor-pointer bt-link",onClick:function(){Ae(e)}},[q("续签")])),Ve(e,Pe.ENCRYPT)&&t.push(V("span",{class:"cursor-pointer bt-link",onClick:function(){return je(u(u({},e),{},{cancel:function(){}}))}},[q("到期告警")]))),"pending"!==e.order_status&&"invalid"!==e.order_status?(t.push(V("span",{class:"cursor-pointer bt-link",onClick:function(){return Te(e)}},[q("部署")])),t.push(V("span",{class:"cursor-pointer bt-link",onClick:function(){return Se(e)}},[q("下载")]))):null!==(n=e.domainName)&&void 0!==n&&n.length&&e.endDay>0&&e.order_status&&"invalid"!==e.order_status&&t.push(V("span",{class:"cursor-pointer bt-link",onClick:function(){return Le(e)}},[q("验证")])),t.push(V("span",{class:"cursor-pointer bt-link",onClick:function(){return Ln(e,!1)}},[q("删除")]));var r=[];return t.map(function(e,n){r.push(e),n<t.length-1&&r.push(V(Z,{direction:"vertical"},null))}),t=r}}],extension:[F,le,b(E),w("search",{name:"ssl",key:"get_cert_list",list:[],showRecommend:!1})]}),fe=ie.BtTable,de=ie.BtPage,pe=(ie.BtRefresh,ie.BtTableCategory),ye=ie.BtRecommendSearch,be=ie.BtColumn,we=ie.BtBatch,xe=(ie.BtErrorMask,ie.refresh);return $(function(){m.value=K().name}),i({init:xe}),function(e,t){var r=ce,a=_,u=p,l=k,i=se;return P(),R("div",null,[V(i,null,{"header-left":L(function(){return[I("div",Un,[V(r,{options:H}),V(He,{placement:"right"},{default:L(function(){return[I("div",Gn,[V(a,{src:"/static/icons/we-com.svg",class:"mx-[4px] w-2rem h-2rem",all:!0}),t[2]||(t[2]=I("span",{class:"bt-link"},"联系客服",-1))])]}),_:1}),V(u,{class:"ml-[12px] flex items-center",onClick:A(Re)},{default:L(function(){return n(t[3]||(t[3]=[I("div",{class:"flex items-center"},[I("span",{class:"svgtofont-desired text-medium"}),I("span",null,"需求反馈")],-1)]))}),_:1},8,["onClick"])])]}),"header-right":L(function(){return[I("div",Fn,[V(A(pe),{class:"!w-[140px] mr-[10px]"}),V(A(ye),{type:"ssl-certificate",placeholder:"请输入证书名称",class:"!w-[270px] mr-[10px]"}),V(A(be))])]}),content:L(function(){return[V(A(fe),{"min-height":A(B)},null,8,["min-height"])]}),"footer-left":L(function(){return[V(A(we))]}),"footer-right":L(function(){return[V(A(de))]}),popup:L(function(){return[V(l,{title:"证书删除确认",modelValue:A(In),"onUpdate:modelValue":t[0]||(t[0]=function(e){return ee(In)?In.value=e:null}),area:["auto"],onCancel:t[1]||(t[1]=function(e){return A(Vn).handleCancel()})},{default:L(function(){return[V(sn,{ref_key:"delRef",ref:Vn,delType:"encrypt",isMulti:A(Mn),compData:A(An),onCancel:G},null,8,["isMulti","compData"])]}),_:1},8,["modelValue"])]}),_:1})])}}}),Jn=s().payment,Xn=F(Jn.value).bindUser,Yn=T(De()),Qn=Yn.btSearchType,Wn=Yn.btCertProductId,Zn=oe().refs,$n=Zn.expiringCertificateCount,Kn=Zn.expiredCertificateCount,et=[{content:"申请证书",dropdownClass:"bg-white",splitButton:!0,active:!0,event:function(){if(!Xn.value)return Ye(),!1;nt()}}],nt=function(){c({isAsync:!0,title:"购买宝塔证书",area:[79],component:function(){return d(function(){return r.import("./index-legacy408.js?v=1763689792")},void 0,r.meta.url)}})},tt=function(){We({title:"宝塔证书需求反馈收集",type:28,isNoRate:!0,softName:"1",isCard:!1,id:1e3})},rt=function(){var e=f(t().m(function e(n){var r,a,u,l,i,o;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=n.p,a=n.limit,u=n.search,e.p=1,e.n=2,we({url:"/api/v1/ssl/get_order_list",p:r,limit:a,search:u,status:Qn.value,product_id:Wn.value});case 2:if(l=e.v,i=l.data,o=i.data,$n.value=o.count_will_expire||0,Kn.value=o.count_expired||0,o){e.n=3;break}return e.a(2,{data:[],total:0,other:{}});case 3:return e.a(2,{data:o.data,total:o.count});case 4:return e.p=4,e.v,e.a(2,{data:[],total:0,other:{}})}},e,null,[[1,4]])}));return function(n){return e.apply(this,arguments)}}(),at={class:"flex items-center"},ut={class:"flex items-center ml-[12px]"},lt={class:"flex items-center"};function it(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!ne(e)}var ot=S({__name:"index",setup:function(e){var t=s().mainHeight,r=T(De()),a=r.activeTabs,u=r.btIsRefresh,l=r.btSearchType,i=r.btCertProductId,o=v({request:rt,columns:[{label:"域名",prop:"domain",render:function(e){return V("span",{class:"w-full whitespace-pre-line"},[e.cert_info?e.cert_info.domain:"--"])}},{label:"证书类型",prop:"product_name",showOverflowTooltip:!0,isCustom:!0,renderHeader:function(){var e=[{title:"全部",key:""},{title:"单域名型",key:"1"},{title:"通配符型",key:"2"},{title:"单IP型",key:"3"}];return X("div",{class:"flex items-center flex-nowrap"},["",X(Y,{onCommand:function(e){i.value=e,d()}},{default:function(){return X("span",{class:"text-small flex items-center"},[[V("span",{class:"status-header-text"},[q("订单状态"),""===i.value?" (全部) ":"(".concat(e.find(function(e){return e.key===i.value}).title,")")])],X("i",{class:"svgtofont-el-arrow-down "})])},dropdown:function(){var n;return V(W,null,it(n=e.map(function(e){return V(Q,{command:e.key},{default:function(){return[e.title]}})}))?n:{default:function(){return[n]}})}})])}},{label:"到期时间",render:Je,showOverflowTooltip:!0,isCustom:!0},{label:"状态",prop:"expire",showOverflowTooltip:!1,isCustom:!0,renderHeader:function(){var e=[{title:"全部",key:""},{title:"待完善资料",key:"0"},{title:"验证中",key:"1"},{title:"已签发",key:"2"},{title:"即将到期",key:"3"},{title:"已到期",key:"4"},{title:"异常",key:"-1"}];return X("div",{class:"flex items-center flex-nowrap"},["",X(Y,{onCommand:function(e){l.value=e,d()}},{default:function(){return X("span",{class:"text-small flex items-center"},[[V("span",{class:"status-header-text"},[q("订单状态"),""===l.value?" (全部) ":"(".concat(e.find(function(e){return e.key===l.value}).title,")")])],X("i",{class:"svgtofont-el-arrow-down "})])},dropdown:function(){var n;return V(W,null,it(n=e.map(function(e){return V(Q,{command:e.key},{default:function(){return[e.title]}})}))?n:{default:function(){return[n]}})}})])},render:function(e){return Xe(e)}},{label:"操作",prop:"ps",align:"right",render:function(e){return function(e){var n=function(e,n){return V("span",{class:"bt-link",onClick:n},[e])},t=[];if(0===e.status){var r=n("完善资料",function(){return Ue(e)});t.push(r)}else{var a,u=null===(a=e.cert_info)||void 0===a?void 0:a.status;if(0===u){var l=n("验证",function(){return Ge(e)});t.push(l)}else if(1===u){var i=n("部署",function(){e.title=e.product_name,e.type="bt",Te(e)}),o=n("下载",function(){return Fe(e)}),s=n("查看",function(){return ze(e)});t.push(i),t.push(o),t.push(s)}}var c=[];return t.map(function(e,n){c.push(e),n<t.length-1&&c.push(V(en,null,null))}),c}(e)}}],extension:[j(),b(u)]}),c=o.BtTable,f=o.BtRefresh,d=o.refresh,m=o.BtPage,h=o.BtColumn,y=o.BtSearch;return N(function(){return a.value},function(e){"bt"===e&&(u.value=!0)}),function(e,r){var a=ce,u=_,l=p,i=le("BtTableCategory"),o=le("BtBatch"),s=se;return P(),R("div",null,[V(s,null,{"header-left":L(function(){return[I("div",at,[V(a,{options:A(et)},null,8,["options"]),V(He,{placement:"right"},{default:L(function(){return[I("div",ut,[V(u,{src:"/static/icons/we-com.svg",class:"mx-[4px] w-2rem h-2rem",all:!0}),r[0]||(r[0]=I("span",{class:"bt-link"},"联系客服",-1))])]}),_:1}),V(l,{class:"ml-[12px] flex items-center",onClick:A(tt)},{default:L(function(){return n(r[1]||(r[1]=[I("div",{class:"flex items-center"},[I("span",{class:"svgtofont-desired text-medium"}),I("span",null,"需求反馈")],-1)]))}),_:1},8,["onClick"])])]}),"header-right":L(function(){return[I("div",lt,[V(i,{class:"!w-[140px] mr-[10px]"}),V(A(y),{type:"bt-cert",placeholder:"请输入证书名称",class:"!w-[270px] mr-[10px]"}),V(A(f),{class:"mr-[10px]"}),V(A(h))])]}),content:L(function(){return[V(A(c),{"min-height":A(t)},null,8,["min-height"])]}),"footer-left":L(function(){return[V(o)]}),"footer-right":L(function(){return[V(A(m))]}),_:1})])}}}),st=T(De()).otherIsRefresh,ct=O(!1),ft=O(!1),dt=O(null),pt=O(null),mt=function(e,n){ft.value=n,dt.value=e,ct.value=!0},vt=function(){var e=f(t().m(function e(n,u,i,o){var s,p,v,h,y,g;return t().w(function(e){for(;;)switch(e.n){case 0:return s=o.label,p=o.value,v=[],h=[],y=[],i.value.forEach(function(e){void 0!==e.hash&&null!==e.hash?h.push(e.hash):void 0!==e.index&&null!==e.index?v.push(e.index):void 0!==e.oid&&null!==e.oid&&y.push(e.oid)}),g=function(){var e=f(t().m(function e(){var n;return t().w(function(e){for(;;)switch(e.n){case 0:n=p,e.n="download"===n?1:"delete"===n?3:5;break;case 1:return e.n=2,ye({ssl_hash:h.join(","),index:v.join(","),oid:y.join(",")});case 2:case 4:return e.a(2,e.v);case 3:return e.n=4,mt(i.value,!0);case 5:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),e.n=1,c({title:"批量".concat(s,"证书"),area:46,component:function(){return d(function(){return r.import("./index-legacy125.js?v=1763689792")},void 0,r.meta.url)},compData:{resultTitle:"批量".concat(s,"证书"),resultData:i.value,resultColumn:[{label:"名称",prop:"title"},Ze()],autoTitle:"批量".concat(s,"证书")},showFooter:!0,onConfirm:function(){var e=f(t().m(function e(){var n,r,u;return t().w(function(e){for(;;)switch(e.n){case 0:if("delete"!==p){e.n=2;break}return e.n=1,g();case 1:return e.a(2);case 2:return n=m.load("正在批量".concat(s,"证书")),r=l,e.n=3,g();case 3:u=e.v,r({request:u,success:function(e){var t=e.data;if(e.status){var r=[],u=[];"download"===p?(t.url&&window.open(t.url,"_blank","noopener,noreferrer"),a(t.finish_list)&&t.finish_list.forEach(function(e){var n=JSON.parse(e.cert.info);r.push({name:n.issuer,status:e.status})}),u=[{label:"名称",prop:"name"},{label:"结果",render:function(e){var n="",t="";return e.status?(t="text-primary",n="下载成功"):(t="text-danger",n="下载失败"),X("span",{class:t},n)}}]):a(t.finish_list)&&(t.finish_list.forEach(function(e){r.push({name:e.name,status:e.status,msg:e.status?"删除成功":e.msg})}),u=[{label:"名称",prop:"name"},{label:"结果",render:function(e){var n=e.msg,t="";return t=e.status?"text-primary":"text-danger",X("span",{class:t},n)}}],st.value=!0),ke({resultTitle:"".concat(s,"证书"),resultData:r,resultColumn:u}),n&&n.close()}}});case 4:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}()});case 1:return e.a(2)}},e)}));return function(n,t,r,a){return e.apply(this,arguments)}}(),ht=function(){var e=f(t().m(function e(n){var r;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,r=m.load("正在上传云端证书，请稍候..."),e.n=1,xe({ssl_id:n.id,ssl_hash:n.hash});case 1:st.value=!0,r&&r.close(),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.p=3,r&&r.close(),e.f(3);case 4:return e.a(2)}},e,null,[[0,2,3,4]])}));return function(n){return e.apply(this,arguments)}}(),yt=function(){l({request:_e(),loading:"正在从云端同步证书，请稍后...",message:!0,success:function(e){e.status&&(st.value=!0)}})},gt=function(){var e=f(t().m(function e(n){var r,a;return t().w(function(e){for(;;)switch(e.n){case 0:return r=l,e.n=1,pe({ssl_id:n.id,ssl_hash:n.hash,local:!1,cloud:!0});case 1:a=e.v,r({loading:"正在从云端删除证书，请稍后...",message:!0,request:a,success:function(e){e.status&&(st.value=!0)}});case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),bt={class:"flex items-center"},wt={class:"flex items-center ml-[12px]"},xt={class:"flex items-center"},_t=S({__name:"index",setup:function(e,r){var a,i,o=r.expose,c=oe().refs,d=c.tabActive,m=c.certificateParams,C=c.expiringCertificateCount,j=c.expiredCertificateCount,D=c.typeList,S=T(De()).otherIsRefresh,E=s().mainHeight,O=[{content:"上传证书",dropdownClass:"bg-white",splitButton:!0,active:!0,event:function(){qe()}},{content:"从云端同步",dropdownClass:"bg-white",splitButton:!0,event:function(){yt()}}],B=z([]),N=function(){ct.value=!1},M=Ke({key:"type",name:"证书分组",options:function(){return[{label:"全部分组",value:"all"}]},event:{get:(a=f(t().m(function e(){var r;return t().w(function(e){for(;;)switch(e.n){case 0:return r=[],e.n=1,l({request:me(),data:Array,success:function(e){r=[{label:"全部分组",value:"all"}].concat(n(e.map(function(e){return{label:e.name,value:String(e.group_id)}})))}});case 1:return D.value=r,e.a(2,r)}},e)})),function(){return a.apply(this,arguments)}),add:function(e){return ve({name:e.name,group_id:Date.now()})},delete:function(e){return he({group_id:e.id})}},ignore:["0"],field:"name",showEdit:!1}),H=x([{label:"批量分组",value:"group",event:function(e,n,t,r){return Ce(t.value,"certificate")}},{label:"批量设置告警",value:"alarm",event:function(e,n,t,r){Ne(t.value,Pe.OTHER)}},{label:"下载",value:"download",event:vt},{label:"删除",value:"delete",event:vt}]),U=v({request:(i=f(t().m(function e(n){var r,a,u,l;return t().w(function(e){for(;;)switch(e.n){case 0:return"-1"===(r={p:n.p,group_id:h(n.type)||"all"===n.type?"-1":n.type,search:n.search,limit:n.limit,status_id:m.value.status_id,cert_type:"4"}).group_id&&delete r.group_id,"-1"===r.status_id&&delete r.status_id,""===r.search&&delete r.search,e.n=1,ge(r);case 1:return a=e.v,u=a.data,B.value=u.data,(l=y(u))("will_num")&&(C.value=(null==u?void 0:u.will_num)||0),l("end_num")&&(j.value=(null==u?void 0:u.end_num)||0),e.a(2,{data:u.data,total:g(u.page),other:{search_history:u.search_history}})}},e)})),function(e){return i.apply(this,arguments)}),columns:[$e(),{label:"认证域名",render:function(e){var n;return(null===(n=e.domainName)||void 0===n?void 0:n.join(", "))||"--"}},{label:"证书类型",prop:"title",showOverflowTooltip:!0,width:180},{label:"部署网站",isCustom:!0,render:function(e){var n;return(null===(n=e.use_site)||void 0===n?void 0:n.join(", "))||"--"}},{label:"分组",prop:"group_name",width:100,showOverflowTooltip:!0,isCustom:!1},{label:"到期时间",isCustom:!0,render:function(e){var n,t,r,a=function(e,n){return V("span",{class:e<=10?"text-danger":n},[e>0?"剩余".concat(e,"天"):"已过期"])},u=(r=e.endDay)<=0||r<=7?"text-danger":r<=15?"text-warning":"text-primary";return"1"===e.type?e.endDate?a(e.endDay,e.endDay<=30?"text-warning":u):V("span",null,[q("--")]):"2"===e.type?null!=e&&e.endDay&&0!==(null==e?void 0:e.endDay)?a(e.endDay,e.endDay<=30?"text-warning":u):V("span",null,[q("--")]):V("span",{class:null!==(n=e.domainName)&&void 0!==n&&n.length?u:"text-default"},[null!==(t=e.domainName)&&void 0!==t&&t.length?e.endDay>0?"剩余".concat(e.endDay,"天"):"已过期":"--"])}},{label:"操作",align:"right",fixed:"right",width:280,render:function(e){var n=function(e,n){return V("span",{class:"cursor-pointer bt-link",onClick:n},[e])},t=[];return e.endDay>0&&(t.push(n("部署",function(){return Te(e)})),t.push(n("下载",function(){return Se(e)})),-1===e.cloud_id?t.push(n("上传云端",function(){return ht(e)})):t.push(n("从云端删除",function(){return gt(e)})),Ve(e,Pe.OTHER)&&t.push(n("到期告警",function(){return je(u(u({},e),{},{cancel:function(){}}))}))),t.push(n("删除",function(){return mt(e,!1)})),t.map(function(e,n){return V("div",null,[e,n<t.length-1&&V(Z,{direction:"vertical"},null)])})}}],extension:[M,H,b(S),w("search",{name:"ssl",key:"get_cert_list",list:[],showRecommend:!1})]}),G=U.BtTable,F=U.BtPage,J=(U.BtRefresh,U.BtTableCategory),X=U.BtRecommendSearch,Y=U.BtColumn,Q=U.BtBatch,W=(U.BtErrorMask,U.refresh);return $(function(){d.value=K().name}),o({init:W}),function(e,t){var r=ce,a=_,u=p,l=k,i=se;return P(),R("div",null,[V(i,null,{"header-left":L(function(){return[I("div",bt,[V(r,{options:O}),V(He,{placement:"right"},{default:L(function(){return[I("div",wt,[V(a,{src:"/static/icons/we-com.svg",class:"mx-[4px] w-2rem h-2rem",all:!0}),t[2]||(t[2]=I("span",{class:"bt-link"},"联系客服",-1))])]}),_:1}),V(u,{class:"ml-[12px] flex items-center",onClick:A(Re)},{default:L(function(){return n(t[3]||(t[3]=[I("div",{class:"flex items-center"},[I("span",{class:"svgtofont-desired text-medium"}),I("span",null,"需求反馈")],-1)]))}),_:1},8,["onClick"])])]}),"header-right":L(function(){return[I("div",xt,[V(A(J),{class:"!w-[140px] mr-[10px]"}),V(A(X),{type:"ssl-certificate",placeholder:"请输入证书名称",class:"!w-[270px] mr-[10px]"}),V(A(Y))])]}),content:L(function(){return[V(A(G),{"min-height":A(E)},null,8,["min-height"])]}),"footer-left":L(function(){return[V(A(Q))]}),"footer-right":L(function(){return[V(A(F))]}),popup:L(function(){return[V(l,{title:"证书删除确认",modelValue:A(ct),"onUpdate:modelValue":t[0]||(t[0]=function(e){return ee(ct)?ct.value=e:null}),area:["auto"],onCancel:t[1]||(t[1]=function(e){return A(pt).handleCancel()})},{default:L(function(){return[V(sn,{ref_key:"delRef",ref:pt,delType:"other",isMulti:A(ft),compData:A(dt),onCancel:N},null,8,["isMulti","compData"])]}),_:1},8,["modelValue"])]}),_:1})])}}}),kt={class:"text-base"};e("default",S({__name:"index",setup:function(e){var n=T(De()).activeTabs,t=oe().refs,r=t.expiringCertificateCount,a=t.expiredCertificateCount,u=O([{label:"宝塔证书",name:"bt",render:function(){return V(ot,null,null)}},{label:"商用SSL",name:"ssl",lazy:!0,render:function(){return V(Pn,null,null)}},{label:"Let's Encrypt",name:"encrypt",lazy:!0,render:function(){return V(zn,null,null)}},{label:"其他证书",name:"other",lazy:!0,render:function(){return V(_t,null,null)}}]);return function(e,t){var l=ie,i=D;return P(),R("div",null,[V(l,{type:"warning",class:"!mb-[1.2rem] !p-[1.2rem]",closable:!1,"show-icon":""},{title:L(function(){return[I("span",kt,[I("span",null," 提示：即将到期证书 "+M(A(r))+" 个，已过期证书 "+M(A(a))+" 个",1)])]}),_:1}),V(i,{type:"card",modelValue:A(n),"onUpdate:modelValue":t[0]||(t[0]=function(e){return ee(n)?n.value=e:null}),options:A(u)},null,8,["modelValue","options"])])}}}))}}})}();
