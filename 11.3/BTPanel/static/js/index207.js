import{p as e,Q as a,iQ as s,M as t,iR as l,aH as n,b8 as i,n as o,H as r,V as c,x as _,bW as u,r as d,aK as m,ho as f,$ as p,ax as b,j as h,k as y,aC as z,_ as v}from"./utils-lib.js?v=1763689792";import{s as g,r as q,o as w,c as x,g as k,v as C,I as V,x as j,y as B,e as S,C as N,A as M,z as U,O as I,D as L,G as F,R as O,B as P,J as D,F as E,b1 as G,K as H,H as Q,ad as K,ab as R,aD as T,bP as A,bO as J,ax as W,az as Y,am as X,an as Z,b2 as $,ap as ee}from"./base-lib.js?v=1763689792";import{_ as ae}from"./index123.js?v=1763689792";import{_ as se}from"./index107.js?v=1763689792";import{B as te}from"./index119.js?v=1763689792";import{S as le,_ as ne}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1763689792";import{S as ie,_ as oe}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1763689792";import{aM as re,f as ce,aN as _e,aO as ue,aP as de,aQ as me,aR as fe,aS as pe,aT as be,aU as he,aV as ye,aW as ze,aX as ve,aY as ge,aZ as qe}from"./validator.js?v=1763689792";import{H as we}from"./store2.js?v=1763689792";import{u as xe}from"./useMethod4.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./ace.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./database.js?v=1763689792";import"./useStore2.js?v=1763689792";const ke=le(),Ce=ie(),{compData:Ve}=g(ie()),je=we();g(je);const Be=q("service"),Se=q(!1);q(!0);const Ne=q(""),Me=q(!1),Ue=w({re_level:1,tips:""}),Ie=[{label:"级别一",value:1},{label:"级别二",value:2},{label:"级别三",value:3},{label:"级别四",value:4},{label:"级别五",value:5},{label:"级别六",value:6}],Le=q(null),Fe={recover:[{content:"启动完成后请立即备份和检查数据库完整性"},{content:"恢复级别说明（从1到6进行尝试）："},{content:"级别一：尝试忽略损坏的页，适用于轻微损坏的情况，可以尝试从数据中恢复。"},{content:"级别二：禁用后台线程，适合解决由于并发操作导致的问题。"},{content:"级别三：适用于需要快速恢复的场景，但可能会导致最近的数据丢失。"},{content:"级别四：适用于插入缓冲区引起问题时的恢复，可能会导致数据文件损坏。"},{content:"级别五：适合于需要快速启动但可能会导致数据一致性问题的情况。"},{content:"级别六：适用于最严重的情况，可能会导致较高的数据丢失及数据文件损坏。"}],config:[{content:"此处为mysql主配置文件，若您不了解配置规则，请勿随意修改"}],storage:[{content:"风险提示：迁移过程中Mysql将会停止运行，请谨慎操作"},{content:"风险提示：迁移过程中请等待迁移完成后再进行其他操作"}],memoryProtection:[{content:"说明：开启后将调整Mysql内存优先级，设置mysql为永不被系统杀死，可确保Mysql稳定运行。但可能导致其他进程异常被杀，严重时可能影响系统运行，建议需要Mysql稳定运行时在开启。"}]},Oe=async()=>{await e({title:"mysqld服务",icon:"warning-filled",content:"即将开始修复mysql启动问题，是否继续？"}),await a({loading:"正在修复启动，请稍后...",request:s(),success:async e=>{"data_err"===e.err_type?(Ue.tips=e.msg,Me.value=!0):"log_err"===e.err_type?Pe(e.msg):(Ee(),t.msg({dangerouslyUseHTMLString:!0,message:e.msg,type:e.status?"success":"error",duration:e.status?2e3:0,showClose:!e.status,customClass:"".concat("port_in_use"===e.err_type?"max-w-[48rem]":"")}))}})},Pe=async s=>{await e({title:"修复MySQL启动",icon:"warning-filled",content:s}),a({loading:"正在修复MySQL启动，请稍后...",request:re(),message:!0,success:e=>{Ee()}})},De=async()=>{Ue.re_level>=4&&await e({title:"修复MYSQL启动",width:"39rem",isHtml:!0,content:'警告：当前选择的恢复等级将可能导致<span class="text-danger">数据文件损坏会丢失</span>，请做好服务器快照或备份好数据库数据目录【/www/server/data】如果启动成功，数据库将会进入只读模式'}),await a({loading:"正在修复启动，请稍后...",request:l({re_level:Ue.re_level}),message:!0,success:async e=>{e.status&&(Me.value=!1),Ee()}})},Ee=()=>{a({request:n({sName:"mysql"}),success:e=>{Ve.value=e.data}})},Ge=q(""),He=async()=>{await a({loading:"正在保存配置，请稍后...",request:i({path:"/etc/my.cnf",data:Ge.value,encoding:"utf-8"}),message:!0})},Qe=w({path:"",port:"",oldData:{path:"",port:""}}),Ke=()=>{ce({type:"dir",path:Qe.path,change:e=>{Qe.path=e}})},Re=async()=>{const s="port"===Be.value;if(!Qe.path&&!s)return t.error("存储位置不能为空");if(!Qe.port&&s)return t.error("端口不能为空");if(s&&Qe.port===Qe.oldData.port)return t.success("未修改端口数据");if(!s&&Qe.path===Qe.oldData.path)return t.success("未修改存储位置数据");!s&&await e({title:"数据库迁移",icon:"warning-filled",content:"请确定是否迁移至:【".concat(Qe.path,"】？")});const l={[s?"port":"datadir"]:Qe[s?"port":"path"]};a({loading:"正在设置，请稍后...",request:(s?ze:ve)(l),message:!0,success:async e=>{(await Le.value).unmount(),Ae()}}),setTimeout(()=>{!s&&Te()},1e3)},Te=async()=>{Le.value=o({title:"迁移任务",area:60,component:()=>r(()=>import("./progress2.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},Ae=async()=>{await a({loading:Se,request:_e(),success:e=>{var a,s,t,l;Qe.path=(null==(a=null==e?void 0:e.data)?void 0:a.datadir)||"",Qe.port=(null==(s=null==e?void 0:e.data)?void 0:s.port)||"",Qe.oldData.path=(null==(t=null==e?void 0:e.data)?void 0:t.datadir)||"",Qe.oldData.port=(null==(l=null==e?void 0:e.data)?void 0:l.port)||""}})},Je=q([{name:"启动时间",field:"Run",value:"无",function:e=>c(e.Run)},{name:"总连接次数",field:"Connections",value:"无"},{name:"发送",value:"无",field:"other",function:e=>_(Number(e.Bytes_sent))},{name:"接收",value:"无",field:"other",function:e=>_(Number(e.Bytes_received))},{name:"每秒查询",value:"无",field:"other",function:e=>parseInt((e.Questions/e.Uptime).toString())},{name:"每秒事务",value:"无",field:"other",function:e=>parseInt(((parseInt(e.Com_commit)+parseInt(e.Com_rollback))/e.Uptime).toString())},{name:"File",value:"无",field:"File"},{name:"Position",value:"无",field:"Position"}]),We=q([{name:"活动/峰值连接数",function:e=>e.Threads_running+"/"+e.Max_used_connections,value:"",ps:"若值过大,增加max_connections"},{name:"线程缓存命中率",value:"",function:e=>{let a=(100*(1-e.Threads_created/e.Connections)).toFixed(2);return isNaN(a)?"0":a+"%"},ps:"若过低,增加thread_cache_size"},{value:"",name:"索引命中率",function:e=>{let a=(100*(1-e.Key_reads/e.Key_read_requests)).toFixed(2);return isNaN(a)?"0":a+"%"},ps:"若过低,增加key_buffer_size"},{value:"",name:"Innodb索引命中率",function:e=>{let a=(100*(1-e.Innodb_buffer_pool_reads/e.Innodb_buffer_pool_read_requests)).toFixed(2);return isNaN(a)?"0":a},ps:"若过低,增加innodb_buffer_pool_size"},{value:"",name:"查询缓存命中率",function:e=>{let a=(parseInt(e.Qcache_hits)/(parseInt(e.Qcache_hits)+parseInt(e.Qcache_inserts))*100).toFixed(2)+"%";return"NaN%"==a&&(a="OFF"),a},ps:"若过低,增加query_cache_size"},{value:"",name:"创建临时表到磁盘",function:e=>{let a=(e.Created_tmp_disk_tables/e.Created_tmp_tables*100).toFixed(2);return isNaN(a)?"0":a+"%"},ps:"若过大,尝试增加tmp_table_size"},{value:"",name:"已打开的表",function:e=>e.Open_tables,ps:"table_open_cache配置值应大于等于此值"},{value:"",name:"没有使用索引的量",function:e=>e.Select_full_join,ps:"若不为0,请检查数据表的索引是否合理"},{value:"",name:"没有索引的JOIN量",function:e=>e.Select_range_check,ps:"若不为0,请检查数据表的索引是否合理"},{value:"",name:"排序后的合并次数",function:e=>e.Sort_merge_passes,ps:"若值过大,增加sort_buffer_size"},{value:"",name:"锁表次数",function:e=>e.Table_locks_waited,ps:"若值过大,请考虑增加您的数据库性能"}]),Ye=[{title:"1-2GB",data:{key_buffer_size:32,query_cache_size:32,tmp_table_size:32,innodb_buffer_pool_size:64,sort_buffer_size:256,read_buffer_size:256,read_rnd_buffer_size:256,join_buffer_size:512,thread_stack:256,binlog_cache_size:64,thread_cache_size:64,table_open_cache:128,max_connections:100}},{title:"2-4GB",data:{key_buffer_size:64,query_cache_size:64,tmp_table_size:64,innodb_buffer_pool_size:128,sort_buffer_size:512,read_buffer_size:512,read_rnd_buffer_size:512,join_buffer_size:1024,thread_stack:256,binlog_cache_size:64,thread_cache_size:96,table_open_cache:192,max_connections:200}},{title:"4-8GB",data:{key_buffer_size:128,query_cache_size:128,tmp_table_size:128,innodb_buffer_pool_size:256,sort_buffer_size:1024,read_buffer_size:1024,read_rnd_buffer_size:768,join_buffer_size:2048,thread_stack:256,binlog_cache_size:128,thread_cache_size:128,table_open_cache:384,max_connections:300}},{title:"8-16GB",data:{key_buffer_size:256,query_cache_size:256,tmp_table_size:256,innodb_buffer_pool_size:1024,sort_buffer_size:1024,read_buffer_size:2048,read_rnd_buffer_size:1024,join_buffer_size:2048,thread_stack:384,binlog_cache_size:192,thread_cache_size:192,table_open_cache:1024,max_connections:400}},{title:"16-32GB",data:{key_buffer_size:512,query_cache_size:384,tmp_table_size:1024,innodb_buffer_pool_size:2048,sort_buffer_size:4096,read_buffer_size:4096,read_rnd_buffer_size:2048,join_buffer_size:4096,thread_stack:512,binlog_cache_size:256,thread_cache_size:256,table_open_cache:2048,max_connections:500}},{title:"32-48GB",data:{key_buffer_size:1024,query_cache_size:512,tmp_table_size:1536,innodb_buffer_pool_size:4096,sort_buffer_size:4096,read_buffer_size:4096,read_rnd_buffer_size:3072,join_buffer_size:6144,thread_stack:512,binlog_cache_size:384,thread_cache_size:384,table_open_cache:3072,max_connections:750}},{title:"48-64GB",data:{key_buffer_size:2048,query_cache_size:768,tmp_table_size:2048,innodb_buffer_pool_size:8192,sort_buffer_size:4096,read_buffer_size:4096,read_rnd_buffer_size:4096,join_buffer_size:8192,thread_stack:512,binlog_cache_size:512,thread_cache_size:512,table_open_cache:4096,max_connections:1e3}},{title:"64-96GB",data:{key_buffer_size:2048,query_cache_size:1024,tmp_table_size:3072,innodb_buffer_pool_size:16384,sort_buffer_size:8192,read_buffer_size:8192,read_rnd_buffer_size:4096,join_buffer_size:8192,thread_stack:768,binlog_cache_size:768,thread_cache_size:768,table_open_cache:6144,max_connections:1500}},{title:"96-128GB",data:{key_buffer_size:2048,query_cache_size:1536,tmp_table_size:4096,innodb_buffer_pool_size:32768,sort_buffer_size:8192,read_buffer_size:8192,read_rnd_buffer_size:8192,join_buffer_size:8192,thread_stack:1024,binlog_cache_size:1024,thread_cache_size:1024,table_open_cache:8192,max_connections:2e3}},{title:"128-256GB",data:{key_buffer_size:4096,query_cache_size:2048,tmp_table_size:8192,innodb_buffer_pool_size:65536,sort_buffer_size:8192,read_buffer_size:8192,read_rnd_buffer_size:8192,join_buffer_size:8192,thread_stack:2048,binlog_cache_size:2048,thread_cache_size:2048,table_open_cache:16384,max_connections:4e3}}],Xe={key_buffer_size:"MB,用于索引的缓冲区大小",query_cache_size:"MB,查询缓存,不开启请设为0",tmp_table_size:"MB,临时表缓存大小",innodb_buffer_pool_size:"MB,Innodb缓冲区大小",innodb_log_buffer_size:"MB,Innodb日志缓冲区大小",sort_buffer_size:"KB * 连接数,每个线程排序的缓冲大小",read_buffer_size:"KB * 连接数读入缓冲区大小",read_rnd_buffer_size:"KB * 连接数随机读取缓冲区大小",join_buffer_size:"KB * 连接数关联表缓存大小",thread_stack:"KB * 连接数每个线程的堆栈大小",binlog_cache_size:"KB * 连接数二进制日志缓存大小(4096的倍数)",thread_cache_size:"线程池大小",table_open_cache:"表缓存",max_connections:"最大连接数"},Ze=q(""),$e=q([]),ea=q(),aa=e=>{if(!e||"object"!=typeof e)return"";for(let a=0;a<Ye.length;a++){const s=Ye[a].data;let t=!0;for(const[a,l]of Object.entries(s)){let s=a,n=l;if("query_cache_size"===a){if("disable"===e.query_cache_supprot)continue;if(void 0!==e.bt_query_cache_size)s="bt_query_cache_size";else if(void 0!==e.query_cache_type){if(0===e.query_cache_type&&0===Number(l))continue;if(1===e.query_cache_type&&Number(l)>0){if(e.query_cache_size!==l){t=!1;break}continue}}}if(void 0!==e[s]&&e[s]!==n){t=!1;break}}if(t)return a}return""},sa=async e=>{const a=Number(e);$e.value.forEach(e=>{Ye[a].data[e.name]&&(e.value=Ye[a].data[e.name]),"query_cache_size"!==e.name||Ye[a].data.query_cache_size||(e.value=0)}),ta()},ta=()=>{let e=0,a=0,s=0;const t=["key_buffer_size","query_cache_size","tmp_table_size","innodb_buffer_pool_size","innodb_log_buffer_size"],l=["sort_buffer_size","read_buffer_size","read_rnd_buffer_size","join_buffer_size","thread_stack","binlog_cache_size"],n=Number($e.value.find(e=>"max_connections"===e.name).value);$e.value.forEach(e=>{t.includes(e.name)?a+=Number(e.value):l.includes(e.name)&&(s+=Number(e.value)/1024)}),e=a+s*n,ea.value=e},la=async()=>{let e={query_cache_type:0};$e.value.forEach(a=>{const s="bt_query_cache_size"===a.name?"query_cache_size":a.name;e[s]=a.value}),e.query_cache_size>0&&(e.query_cache_type=1),delete e.query_cache_supprot,e.max_heap_table_size=e.tmp_table_size,await a({loading:"正在保存中，请稍后...",request:ue(e),message:!0,success:e=>{e.status&&(t.success("设置成功，重启数据库后配置生效，请重启数据库"),(()=>{const e={};$e.value.forEach(a=>{a.name&&void 0!==a.value&&null!==a.value&&(e[a.name]=Number(a.value))}),0===e.query_cache_size&&(e.query_cache_supprot="disable");const a=aa(e);Ze.value=a})())}})},na=async s=>{const t={restart:"重启",stop:"停止",reload:"重载配置",start:"启动"};await e({title:"".concat(t[s],"mysqld服务"),content:"是否".concat(t[s],"mysqld服务？")}),await a({loading:"正在".concat(t[s],"mysqld服务，请稍后..."),request:u({name:"mysqld",type:s}),message:!0,success:e=>{e.status&&d.go(0)}})},ia=q(""),oa=async()=>{await e({title:"清空日志操作提示",icon:"warning-filled",content:"清空日志会导致运行错误信息丢失，无法排除问题，请谨慎操作，是否继续？"}),await a({loading:"正在清空日志，请稍后...",request:de({close:1}),message:!0,success:ra})},ra=async()=>{await a({loading:Se,request:me(),data:[String,ia]}),ia.value=ia.value||"当前暂无数据"},ca=async()=>{await a({loading:Se,request:fe(),data:{msg:[String,ia]}}),ia.value=ia.value||"当前暂无数据"},_a=q(!1),ua=q(),da=q([]),ma=w({status:!1,size:""}),fa=q(!1),pa=w({days:""}),ba=w({days:[{required:!0,message:"请输入天数",trigger:"blur"},{validator:(e,a,s)=>{a<7?s(new Error("请输入大于7的天数")):s()}}]}),ha=async s=>{ma.status=!s,await e({title:(s?"开启":"关闭")+"二进制日志",icon:"warning-filled",content:(s?"开启二进制日志可以保护Mysql的数据安全，但同时会消耗一定磁盘存储，是否继续?":"关闭二进制日志后，将不会再记录所有对数据库的修改操作")+"二进制日志?"}),await a({loading:"正在"+(s?"开启":"关闭")+"二进制日志，请稍后...",request:pe(),message:!0,success:e=>{va()}})},ya=async()=>{await ua.value.validate(),await e({title:"清理日志",content:"即将清理【"+pa.days+"】天前的MySQL二进制日志，是否继续？",icon:"warning-filled"}),await a({loading:"正在清理日志，请稍后...",request:re({days:pa.days}),message:!0,success:e=>{e.status&&(fa.value=!1,za(),va(),ga())}})},za=()=>{var e,a;fa.value=!1,null==(e=ua.value)||e.clearValidate(),null==(a=ua.value)||a.resetFields()},va=async()=>{await a({request:pe({status:1}),success:e=>{ma.status=e.data.binlog_status,ma.size=_(e.data.size)}})},ga=async()=>{await a({loading:Se,request:be(),data:{data:[Array,da]}})},qa=async({row:s})=>{await e({title:"删除日志",icon:"warning-filled",content:"您真的要删除【".concat(s.name,"】日志？"),type:"calc"}),await a({loading:"正在删除【".concat(s.name,"】日志，请稍后..."),request:he({path:s.path}),message:!0,success:ga})},wa=q(!1),xa=async e=>{try{let a="get"===e?{}:{status:Number(e)};const s=await ye(a);"get"===e?(s.status||"当前状态关闭中！"===s.msg||t.request(s),wa.value=Boolean(s.status)):t.request(s)}catch(a){m(a)}},ka=async e=>{switch(e){case"config":(async()=>{await a({loading:Se,request:f({path:"/etc/my.cnf"}),data:{data:[String,Ge]}})})();break;case"port":case"storage":Ae();break;case"state":(async()=>{await a({loading:Se,request:ge(),success:e=>{var a;if(!1===e.status||(null==(a=e.data)?void 0:a.status))return t.msg({customClass:"bt-message-error-html",dangerouslyUseHTMLString:!0,message:e.msg||e.data.msg,type:"error",showClose:!0});Je.value.forEach(a=>{a.function?a.value=a.function(e.data):a.value=e.data[a.field]}),We.value.forEach(a=>{a.function&&(a.value=a.function(e.data))})}})})();break;case"performance":(async()=>{Se.value=!0;try{const{data:e}=await qe();$e.value=[],e.mem.hasOwnProperty("join_buffer_size")||(e.mem.join_buffer_size=512),e.mem.hasOwnProperty("thread_stack")||(e.mem.thread_stack=256),e.mem.hasOwnProperty("binlog_cache_size")||(e.mem.binlog_cache_size=32);const a="disable"===e.mem.query_cache_supprot;e.mem.hasOwnProperty("bt_query_cache_size")&&!a&&$e.value.push({name:"query_cache_size",value:e.mem.bt_query_cache_size,ps:Xe.query_cache_size?Xe.query_cache_size:""}),Object.keys(e.mem).forEach(a=>{"query_cache_size"!==a&&"bt_query_cache_size"!==a&&$e.value.push({name:a,value:e.mem[a],ps:Xe[a]?Xe[a]:""})}),ea.value=e.mem.bt_mem_size;const s=aa(e.mem);Ze.value=s,ta()}catch(e){m(e)}finally{Se.value=!1}})();break;case"errorLogs":ra();break;case"slowLogs":ca();break;case"binaryLogs":await ga(),va();break;case"memoryProtection":xa("get")}},Ca={key:0},Va={class:"p-2rem"},ja={class:"content flex items-center"},Ba={class:"message flex-1 ml-4 py-[.3rem] leading-[2.4rem] text-base"},Sa={class:"text text-[15px] leading-[2.5rem] flex !flex-wrap break-all"},Na={class:"my-[12px]"},Ma={class:"flex text-secondary items-center"},Ua={class:"flex text-secondary items-center"},Ia={class:"text-secondary performance"},La={class:"flex items-center justify-center"},Fa={class:"flex items-center"},Oa={class:"ml-2rem"},Pa={class:"my-[12px]"},Da={class:"my-[12px]"},Ea={class:"flex items-center"},Ga={class:"ml-[16rem]"},Ha=["onClick"],Qa={class:"p-[20px]"},Ka=v(x({__name:"index",props:{compData:{default:{}}},setup(e){const{compData:a}=g(ie()),s=e,t=k(()=>a.value.status);return C(()=>{(e=>{Be.value="service",e&&(Ve.value=e);const a={...Ve.value,name:"mysqld"};Ce.init(a),ke.init(a),Ne.value=Ve.value.status})(s.compData),a.value.refreshEvent=async()=>{const e=await xe("mysql");a.value.status=e.s_status}}),(e,a)=>{const s=Q,l=p,n=b,i=K,o=R,r=h,u=T,d=te,m=se,f=y,v=A,g=J,q=W,w=Y,x=X,k=Z,C=$,le=ae,ie=ee,re=z,ce=V("bt-loading");return j(),B("div",null,[S(re,{modelValue:U(Be),"onUpdate:modelValue":a[12]||(a[12]=e=>O(Be)?Be.value=e:null),type:"left-bg-card",position:"left",class:"h-full",onChange:U(ka)},{default:N(()=>[S(u,{label:"服务",name:"service"},{default:N(()=>[M("div",null,[S(oe),S(ne),U(t)?F("",!0):(j(),I(s,{key:0,class:"mt-4rem",onClick:U(Oe)},{default:N(()=>[...a[13]||(a[13]=[L("修复启动",-1)])]),_:1},8,["onClick"])),S(l,{options:[{content:"如需更换mysql版本，请备份好数据后，卸载mysql重新安装"}],class:"pl-1rem"},{default:N(()=>[U(t)?F("",!0):(j(),B("li",Ca,"如无法正常启动，请尝试使用修复启动按钮进行修复启动"))]),_:1}),S(r,{modelValue:U(Me),"onUpdate:modelValue":a[1]||(a[1]=e=>O(Me)?Me.value=e:null),area:50,title:"修复启动-恢复模式-innodb_force_recovery","show-footer":"",onConfirm:U(De)},{default:N(()=>[M("div",Va,[M("div",ja,[a[14]||(a[14]=M("i",{class:"svgtofont-el-warning-filled !text-[4rem] text-warning"},null,-1)),M("div",Ba,[M("div",Sa,P(U(Ue).tips),1)])]),S(o,{model:U(Ue),"label-width":"80px"},{default:N(()=>[S(i,{label:"恢复级别"},{default:N(()=>[S(n,{modelValue:U(Ue).re_level,"onUpdate:modelValue":a[0]||(a[0]=e=>U(Ue).re_level=e),options:U(Ie),class:"!w-20rem"},null,8,["modelValue","options"])]),_:1})]),_:1},8,["model"]),S(l,{options:U(Fe).recover,class:"pl-3rem"},null,8,["options"])])]),_:1},8,["modelValue","onConfirm"])])]),_:1}),S(u,{label:"配置文件",name:"config",lazy:!0},{default:N(()=>[D((j(),B("div",null,[a[16]||(a[16]=M("span",{class:"my-[4px] text-secondary"}," 提示：Ctrl+F 搜索关键字，Ctrl+S 保存，Ctrl+H 查找替换 ",-1)),M("div",Na,[S(d,{class:"!h-[48rem] !w-full",modelValue:U(Ge),"onUpdate:modelValue":a[2]||(a[2]=e=>O(Ge)?Ge.value=e:null),id:"configContent",onSave:U(He)},null,8,["modelValue","onSave"])]),S(s,{type:"primary",onClick:U(He)},{default:N(()=>[...a[15]||(a[15]=[L("保存",-1)])]),_:1},8,["onClick"]),S(l,{options:U(Fe).config,class:"pl-2rem"},null,8,["options"])])),[[ce,U(Se)]])]),_:1}),S(u,{label:"存储位置",name:"storage",lazy:!0},{default:N(()=>[D((j(),B("div",null,[M("div",Ma,[S(m,{icon:"icon-file_mode",onIconClick:U(Ke),width:"32rem",modelValue:U(Qe).path,"onUpdate:modelValue":a[3]||(a[3]=e=>U(Qe).path=e),class:"!w-32rem"},null,8,["onIconClick","modelValue"]),S(s,{class:"ml-[12px]",onClick:U(Re),type:"primary"},{default:N(()=>[...a[17]||(a[17]=[L("迁移",-1)])]),_:1},8,["onClick"])]),S(l,{options:U(Fe).storage,class:"pl-2rem"},null,8,["options"])])),[[ce,U(Se)]])]),_:1}),S(u,{label:"端口配置",name:"port",lazy:!0},{default:N(()=>[D((j(),B("div",Ua,[S(f,{modelValue:U(Qe).port,"onUpdate:modelValue":a[4]||(a[4]=e=>U(Qe).port=e),type:"number",width:"10rem",class:"!w-10rem"},null,8,["modelValue"]),S(s,{type:"primary",class:"ml-[12px]",onClick:U(Re)},{default:N(()=>[...a[18]||(a[18]=[L("修改",-1)])]),_:1},8,["onClick"])])),[[ce,U(Se)]])]),_:1}),S(u,{label:"当前状态",name:"state",lazy:!0},{default:N(()=>[D((j(),B("div",null,[S(g,{class:"margin-top table-descriptions",column:2,border:""},{default:N(()=>[(j(!0),B(E,null,G(U(Je),(e,a)=>(j(),I(v,{key:a},{label:N(()=>[L(P(e.name),1)]),default:N(()=>[L(" "+P(e.value),1)]),_:2},1024))),128))]),_:1}),S(w,{data:U(We),class:"mt-[20px]","max-height":"400"},{default:N(()=>[S(q,{prop:"name",label:"字段",width:"180"}),S(q,{prop:"value",label:"当前值",width:"100"}),S(q,{prop:"ps",label:"注意"})]),_:1},8,["data"])])),[[ce,U(Se)]])]),_:1}),S(u,{label:"性能调整",name:"performance",lazy:!0},{default:N(()=>[D((j(),B("div",Ia,[M("div",La,[a[19]||(a[19]=L(" 优化方案 ",-1)),S(k,{class:"!w-[12rem] mr-[20px] ml-8px",modelValue:U(Ze),"onUpdate:modelValue":a[5]||(a[5]=e=>O(Ze)?Ze.value=e:null),onChange:U(sa),placeholder:"自定义"},{default:N(()=>[(j(!0),B(E,null,G(U(Ye),(e,a)=>(j(),I(x,{key:a,value:a,label:e.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue","onChange"]),a[20]||(a[20]=L(" 最大使用内存 ",-1)),S(f,{"text-type":"MB",width:"16rem",class:"!w-16rem ml-8px",readonly:"",modelValue:U(ea),"onUpdate:modelValue":a[6]||(a[6]=e=>O(ea)?ea.value=e:null)},null,8,["modelValue"])]),S(C),S(o,{class:"performance-form","label-position":"right","label-width":"146px"},{default:N(()=>[(j(!0),B(E,null,G(U($e),(e,a)=>D((j(),I(i,{label:e.name,key:a},{default:N(()=>[M("div",Fa,[S(f,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,width:"16rem",class:"!w-16rem",type:"number",onChange:U(ta)},null,8,["modelValue","onUpdate:modelValue","onChange"]),M("span",Oa,P(e.ps),1)])]),_:2},1032,["label"])),[[H,e.ps]])),128)),S(i,{label:" ",class:"mt-1rem"},{default:N(()=>[S(s,{type:"primary",onClick:U(la)},{default:N(()=>[...a[21]||(a[21]=[L("保存",-1)])]),_:1},8,["onClick"]),S(s,{onClick:a[7]||(a[7]=e=>U(na)("restart"))},{default:N(()=>[...a[22]||(a[22]=[L("重启数据库",-1)])]),_:1}),a[23]||(a[23]=M("span",{class:"ml-3rem"},"* 修改配置后，需重启数据库生效",-1))]),_:1})]),_:1})])),[[ce,U(Se)]])]),_:1}),S(u,{label:"错误日志",name:"errorLogs",lazy:!0},{default:N(()=>[D((j(),B("div",null,[S(s,{type:"default",onClick:U(oa)},{default:N(()=>[...a[24]||(a[24]=[L("清空日志",-1)])]),_:1},8,["onClick"]),M("div",Pa,[S(le,{class:"!h-[56rem] !w-full",content:U(ia),id:"errorLogs",isHtml:!0,fullScreen:{title:"全屏查看【错误日志】",onRefresh:U(ra)}},null,8,["content","fullScreen"])])])),[[ce,U(Se)]])]),_:1}),S(u,{label:"慢日志",name:"slowLogs",lazy:!0},{default:N(()=>[D((j(),B("div",Da,[S(le,{content:U(ia),isHtml:!0,class:"!h-[60rem] !w-full",id:"slowLogs",fullScreen:{title:"全屏查看【慢日志】",onRefresh:U(ca)}},null,8,["content","fullScreen"])])),[[ce,U(Se)]])]),_:1}),S(u,{label:"二进制日志",name:"binaryLogs",lazy:!0},{default:N(()=>[M("div",null,[M("div",Ea,[M("div",null,[a[25]||(a[25]=L(" 二进制日志 ",-1)),S(ie,{modelValue:U(ma).status,"onUpdate:modelValue":a[8]||(a[8]=e=>U(ma).status=e),onChange:U(ha)},null,8,["modelValue","onChange"])]),M("span",Ga,P(U(ma).size),1)]),S(C),a[27]||(a[27]=M("span",null," · 温馨提示：Mysql二进制日志是记录当前的操作日志，可用于数据恢复，数据备份。 ",-1)),D((j(),I(w,{class:"mt-[20px]",data:U(da),"max-height":"500"},{default:N(()=>[S(q,{prop:"name",label:"文件名"}),S(q,{prop:"size",label:"大小"},{default:N(e=>[L(P(U(_)(e.row.size)),1)]),_:1}),S(q,{prop:"last_modified",label:"最后修改时间"},{default:N(e=>[L(P(U(c)(e.row.last_modified)),1)]),_:1}),S(q,{align:"right",label:"操作"},{default:N(e=>[M("span",{class:"bt-link",onClick:a=>U(qa)(e)},"删除",8,Ha)]),_:1})]),_:1},8,["data"])),[[ce,U(Se)]]),S(r,{title:"清理日志",modelValue:U(fa),"onUpdate:modelValue":a[10]||(a[10]=e=>O(fa)?fa.value=e:null),area:42,showFooter:"",onCancel:U(za),onConfirm:U(ya)},{default:N(()=>[M("div",Qa,[S(o,{disabled:U(_a),class:"flex justify-center","label-position":"right",model:U(pa),ref_key:"binlogFormRef",ref:ua,rules:U(ba)},{default:N(()=>[S(i,{label:"清理周期",prop:"days"},{default:N(()=>[S(f,{modelValue:U(pa).days,"onUpdate:modelValue":a[9]||(a[9]=e=>U(pa).days=e),type:"number",min:7,width:"24","text-type":"天"},null,8,["modelValue"])]),_:1})]),_:1},8,["disabled","model","rules"]),a[26]||(a[26]=M("ul",{class:"leading-8 text-small list-disc ml-[48px]"},[M("li",null,"只能清理7天前的日志,请输入大于7的天数")],-1))])]),_:1},8,["modelValue","onCancel","onConfirm"])])]),_:1}),S(u,{label:"内存保护",name:"memoryProtection",lazy:!0},{default:N(()=>[M("div",null,[M("div",null,[a[28]||(a[28]=L(" 内存保护 ",-1)),S(ie,{modelValue:U(wa),"onUpdate:modelValue":a[11]||(a[11]=e=>O(wa)?wa.value=e:null),onChange:U(xa)},null,8,["modelValue","onChange"])]),S(l,{options:U(Fe).memoryProtection,class:"pl-2rem"},null,8,["options"])])]),_:1})]),_:1},8,["modelValue","onChange"])])}}}),[["__scopeId","data-v-39835eaa"]]);export{Ka as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
