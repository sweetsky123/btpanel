import{u as a,n as e,H as l,Q as s,M as t,p as n,aH as i,l as r,k as o,j as u}from"./utils-lib.js?v=1763689792";import{_ as m}from"./index124.js?v=1763689792";import{_ as d}from"./index109.js?v=1763689792";import{c,r as p,b8 as _,e as y,ap as w,v as f,I as g,x as v,y as h,z as b,C as j,D as x,J as k,A as C,O as V,R as H,H as I}from"./base-lib.js?v=1763689792";import{a1 as S,Z as q,a2 as D,a3 as T,a4 as A,x as E}from"./firewall.js?v=1763689792";import{u as O}from"./column.js?v=1763689792";import{l as z}from"./validator.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./index107.js?v=1763689792";const F={key:0},P={class:"p-[2rem] flex items-center"},R=c({__name:"index",setup(c){const{mainHeight:R,payment:L}=a(),N=p(!1),U=p(""),J=p(!1),M=p([]),Q=p([]),Z=p(!1),B=_({title:"SSH系统账号管理-功能介绍",ps:"SSH系统账号管理通常涉及到在服务器上创建、删除和管理SSH用户账户的过程。这些账户可以用于通过SSH（安全壳层）协议远程访问服务器。这种管理工作通常由系统管理员进行，以确保只有授权的用户可以访问服务器。",source:305,desc:["创建系统用户","修改系统用户密码","删除系统用户","记录日志","防入侵"],isInstall:Z.value,tabImgs:[{title:"概览",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/ssh_system_manage.png"}],pluginInfo:{name:"bt_security"}}),G=async()=>{z({name:"bt_security"})},K=()=>{e({title:"创建系统用户",area:42,showFooter:!0,compData:{refreshFn:Y},component:()=>l(()=>import("./add-user.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},W=async()=>{if(!U.value)return t.error("请输入新密码");await s({loading:"正在设置密码，请稍后...",request:q({username:Q.value[0],password:U.value}),message:!0}),N.value=!1,U.value=""},X=async(a,e,l)=>{await s({loading:"正在"+(a?"开启":"关闭")+(3===l?"防入侵":"记录日志")+"，请稍后...",request:3===l?T(a,{user:e[0]}):A(a,{uid:e[1]}),message:!0}),Y()},Y=async()=>{J.value=!0;const{data:a,msg:e}=await E();if(!a.status&&"插件不存在!"===e)return B.isInstall=!1,Z.value=!0,void $();B.isInstall=!0,Z.value=!1,M.value=a.system_user,J.value=!1},$=async()=>{try{const{data:a}=await i({sName:"bt_security"});B.pluginInfo=a}catch(a){}},aa=[{label:"用户名",render:a=>a[0]},{label:"防入侵",width:100,render:a=>y(w,{modelValue:a[3],size:"small",onChange:e=>X(e,a,3)},null)},{label:"记录日志",width:100,render:a=>y(w,{modelValue:a[5],size:"small",onChange:e=>X(e,a,5)},null)},{label:"备注",render:a=>a[6]},O([{onClick:async a=>{const n=await s({loading:"正在获取日志，请稍后...",request:S({user:a[0]}),data:Array});if(!n.length)return t.error("当前暂无日志");Q.value={user:a[0],dateTime:n[0],dateOptions:n.map(a=>({title:a,key:a}))},e({title:"命令日志",area:72,component:()=>l(()=>import("./index487.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:Q.value})},title:"命令日志",width:70},{onClick:a=>{Q.value=a,N.value=!0},title:"重置密码",width:70},{onClick:async a=>{await n({icon:"warning-filled",title:"删除[".concat(a[0],"]用户"),content:"危险操作，正在删除[".concat(a[0],"]用户，请在下方输入'确认删除'"),input:{content:"确认删除"},type:"input"}),await s({loading:"正在删除中,请稍后...",request:D({username:a[0]}),message:!0}),Y()},title:"删除"}])];return f(Y),(a,e)=>{const l=I,s=r,t=d,n=m,i=o,c=u,p=g("bt-loading");return v(),h("div",null,["ltd"!==b(L).authType||b(Z)?(v(),V(n,{key:1,data:b(B),class:"px-[20%] py-[2rem]"},null,8,["data"])):(v(),h("div",F,[y(t,null,{"header-left":j(()=>[y(l,{type:"primary",onClick:K},{default:j(()=>[...e[3]||(e[3]=[x(" 创建系统用户 ",-1)])]),_:1}),y(l,{onClick:G},{default:j(()=>[...e[4]||(e[4]=[x("堡塔防入侵",-1)])]),_:1})]),content:j(()=>[k(y(s,{column:aa,data:b(M)},null,8,["data"]),[[p,b(J)],[p,"正在加载列表，请稍后...","title"]])]),_:1}),e[5]||(e[5]=C("ul",{class:"mt-[.8rem] leading-8 text-small list-disc ml-[2rem]"},[C("li",null,"开启防提权，系统会针对该用户操作命令进行限制，并记录跟踪"),C("li",null,"不开启防提权，系统只针对该用户操作过的命令做记录跟踪"),C("li",null,"目前防提权默认只针对www,redis,mysql操作引起的提权问题进行处理"),C("li",{class:"text-danger"},"消息推送需要更新至最新面板的版本(2020-06-17日之后安装的版本|或者2020-06-17日之后点击过修复面板)")],-1))])),y(c,{title:"修改密码",modelValue:b(N),"onUpdate:modelValue":e[1]||(e[1]=a=>H(N)?N.value=a:null),area:38,showFooter:"",onConfirm:W,onCancel:e[2]||(e[2]=()=>U.value="")},{default:j(()=>[C("div",P,[e[6]||(e[6]=C("span",{class:"inline-block w-[8rem] text-right"},"新密码",-1)),y(i,{class:"ml-[1.2rem]",isNull:!0,iconType:"refresh",modelValue:b(U),"onUpdate:modelValue":e[0]||(e[0]=a=>H(U)?U.value=a:null),placeholder:"请输入新密码"},null,8,["modelValue"])])]),_:1},8,["modelValue"])])}}});export{R as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
