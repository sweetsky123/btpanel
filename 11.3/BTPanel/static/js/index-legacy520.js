!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",i=a.toStringTag||"@@toStringTag";function o(t,a,s,i){var o=a&&a.prototype instanceof c?a:c,u=Object.create(o.prototype);return r(u,"_invoke",function(t,r,a){var s,i,o,c=0,u=a||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,t){return s=n,i=0,o=e,f.n=t,l}};function p(t,r){for(i=t,o=r,n=0;!d&&c&&!a&&n<u.length;n++){var a,s=u[n],p=f.p,v=s[2];t>3?(a=v===r)&&(o=s[(i=s[4])?5:(i=3,3)],s[4]=s[5]=e):s[0]<=p&&((a=t<2&&p<s[1])?(i=0,f.v=r,f.n=s[1]):p<v&&(a=t<3||s[0]>r||r>v)&&(s[4]=t,s[5]=r,f.n=v,i=0))}if(a||t>1)return l;throw d=!0,r}return function(a,u,v){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,v),i=u,o=v;(n=i<2?e:o)||!d;){s||(i?i<3?(i>1&&(f.n=-1),p(i,o)):f.n=o:f.v=o);try{if(c=2,s){if(i||(a="next"),n=s[a]){if(!(n=n.call(s,o)))throw TypeError("iterator result is not an object");if(!n.done)return n;o=n.value,i<2&&(i=0)}else 1===i&&(n=s.return)&&n.call(s),i<2&&(o=TypeError("The iterator does not provide a '"+a+"' method"),i=1);s=e}else if((n=(d=f.n<0)?o:t.call(r,f))!==l)break}catch(n){s=e,i=1,o=n}finally{c=1}}return{value:n,done:d}}}(t,s,i),!0),u}var l={};function c(){}function u(){}function d(){}n=Object.getPrototypeOf;var f=[][s]?n(n([][s]())):(r(n={},s,function(){return this}),n),p=d.prototype=c.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,r(e,i,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,r(p,"constructor",d),r(d,"constructor",u),u.displayName="GeneratorFunction",r(d,i,"GeneratorFunction"),r(p),r(p,i,"Generator"),r(p,s,function(){return this}),r(p,"toString",function(){return"[object Generator]"}),(t=function(){return{w:o,m:v}})()}function r(e,n,t,a){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}r=function(e,n,t,a){function i(n,t){r(e,n,function(e){return this._invoke(n,t,e)})}n?s?s(e,n,{value:t,enumerable:!a,configurable:!a,writable:!a}):e[n]=t:(i("next",0),i("throw",1),i("return",2))},r(e,n,t,a)}function a(e,n,t,r,a,s,i){try{var o=e[s](i),l=o.value}catch(e){return void t(e)}o.done?n(l):Promise.resolve(l).then(r,a)}function s(e){return function(){var n=this,t=arguments;return new Promise(function(r,s){var i=e.apply(n,t);function o(e){a(i,r,s,o,l,"next",e)}function l(e){a(i,r,s,o,l,"throw",e)}o(void 0)})}}System.register(["./index-legacy124.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./validator-legacy.js?v=1763689792","./site-legacy.js?v=1763689792","./useStore-legacy4.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./column-legacy.js?v=1763689792","./index-legacy107.js?v=1763689792"],function(n,r){"use strict";var a,i,o,l,c,u,d,f,p,v,m,g,y,b,w,h,x,k,_,S,T,E,j,O,C,M,A,I,P,H,L,G,z,F,D,J,N,q,B,K;return{setters:[function(e){a=e._},function(e){i=e.c,o=e.r,l=e.o,c=e.g,u=e.v,d=e.I,f=e.J,p=e.z,v=e.x,m=e.y,g=e.A,y=e.e,b=e.O,w=e.F,h=e.D,x=e.B,k=e.G,_=e.C,S=e.L,T=e.b1,E=e.M,j=e.K,O=e.H,C=e.b2,M=e.bz,A=e.bA},function(e){I=e.u,P=e.p,H=e.V,L=e.d,G=e.f,z=e.e,F=e.b,D=e.ay,J=e._},function(e){N=e.j,q=e.p},function(e){B=e.scanSingleSite},function(e){K=e.u},null,null,null,null],execute:function(){var r={id:"safeDetectList"},R={key:0},U={class:"progress-header"},V={class:"progress-header-cot"},$={class:"flex items-center"},Q={key:0,class:"scan-icon relative h-[8rem] w-[8rem] flex"},W={key:1},X={class:"progress-header-cot"},Y={class:"scanning-progress-title"},Z={class:"text-danger"},ee={class:"scanning-progress-cont"},ne={class:"progress-header-cot"},te={class:"progress-cont-list"},re={key:0},ae={class:"inline-grid grid-cols-4 w-full mt-20px"},se=["onClick"],ie={class:"progress_type"},oe={class:"flex-1"},le={key:0,class:"text-danger mr-4px"},ce={key:1},ue={key:2,class:"text-primary"},de={key:3},fe={class:"progress_fold text-small flex items-center"},pe={class:"mr-4px"},ve={class:"progress_item_body"},me={class:"flex items-center justify-between w-full"},ge={class:"flex items-center ml-12px"},ye=["innerHTML"],be={class:"flex flex-col py-[1rem] px-[1.6rem] text-small progress_item_info"},we={class:"flex items-center"},he=["innerHTML"],xe={class:"flex"},ke=["innerHTML"],_e=i({__name:"index",setup:function(n,i){var J,_e=i.expose,Se=F(),Te=K().siteInfo,Ee=I().payment,je=o(!1),Oe=o([{name:"webscan",title:"网站配置安全性"},{name:"filescan",title:"文件泄露"},{name:"backup",title:"备份文件"},{name:"index",title:"首页内容风险"},{name:"webhorse",title:"挂马排查"},{name:"deadchain",title:"坏链检测"},{name:"database",title:"数据库安全"},{name:"ftps",title:"网站FTP风险"},{name:"backend",title:"网站后台安全"}]),Ce=o(0),Me=o(""),Ae=o(""),Ie=l({scanStatus:!1,isEnd:!1,error:0,warn:0,time:0,progress:0,progressColor:"var(--el-color-primary)",progressConfig:{},statusTotal:{},result:{},progressStatus:{},active:{}}),Pe=null,He=l({0:{text:"警告",bg:"rgba(var(--el-color-warning-rgb), 0.1)",color:"var(--el-color-warning-light-3)"},1:{text:"低危",bg:"rgba(var(--el-color-warning-rgb), 0.1)",color:"var(--el-color-warning-light-3)"},2:{text:"中危",bg:"rgba(var(--el-color-warning-rgb), 0.2)",color:"var(--el-color-warning)"},3:{text:"高危",bg:"rgba(var(--el-color-danger-rgb), 0.1)",color:"var(--el-color-danger)"}}),Le=l({title:"安全扫描-功能介绍",height:36,ps:"扫描服务器系统的漏洞，异常用户，已安装软件的安全问题并提供修复方案.",source:66,desc:["漏洞扫描","网站配置安全性","文件泄露","备份文件","木马程序"],tabImgs:["https://www.bt.cn/Public/new/plugin/introduce/site/security-Introduction.png"]}),Ge=function(){Pe=D({route:"/ws_project",onMessage:Je})},ze=function(e){"free"==Ee.value.authType&&q({sourceId:65})},Fe=c(function(){return Ie.scanStatus&&!Ie.isEnd?"正在扫描":"定期扫描网站，提升网站安全性"}),De=c(function(){return Ie.scanStatus&&!Ie.isEnd?"".concat(Me.value||""):Ie.time?"上次检测时间：".concat(Ie.time):"当前安全风险未知，请立即检测"}),Je=function(e,n){if(n.data){var t=JSON.parse(n.data.replace(/'/g,'"'));if(t.hasOwnProperty("end")&&t.end){var r,a,s;if((null===(r=t.webinfo)||void 0===r||null===(r=r.result)||void 0===r?void 0:r[t.type].length)>0?(Ie.progressConfig[t.type]=t.webinfo.result[t.type],Ie.statusTotal[t.type]=t.webinfo.result[t.type].length):Ie.statusTotal[t.type]=0,Me.value=t.info,Ce.value===Oe.value.length-1)return null===(s=Pe)||void 0===s||s.close(),Ce.value=0,Ie.scanStatus=!1,void(Ie.isEnd=!0);var i=(new Date).getTime();Ce.value++,null===(a=Pe)||void 0===a||a.send({mod_name:"webscanning",def_name:"ScanSingleSite",ws_callback:i,name:Te.value.name,scan_list:[Oe.value[Ce.value].name]})}else Me.value=t.info,Ae.value=t.type,t.is_error&&Ie.error++}},Ne=function(){var e=s(t().m(function e(){var n,r,a,s,i;return t().w(function(e){for(;;)switch(e.n){case 0:if(Ie.scanStatus&&!Ie.isEnd||Ie.isEnd,!Ie.scanStatus||Ie.isEnd){e.n=2;break}return e.n=1,P({title:"取消扫描",content:"确定取消扫描吗?",icon:"warning"});case 1:return null===(a=Pe)||void 0===a||a.close(),Ce.value=0,qe(),e.a(2);case 2:if(!Ie.isEnd){e.n=4;break}return e.n=3,null===(s=Pe)||void 0===s?void 0:s.close();case 3:return Ce.value=0,e.n=4,qe();case 4:Ie.scanStatus=!0,Ge(),i=(new Date).getTime(),null===(n=Pe)||void 0===n||n.send({"x-http-token":window.vite_public_request_token}),null===(r=Pe)||void 0===r||r.send({mod_name:"webscanning",def_name:"ScanSingleSite",ws_callback:i,name:Te.value.name,scan_list:[Oe.value[Ce.value].name]});case 5:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),qe=function(){Ie.scanStatus=!1,Ie.isEnd=!1,Ie.error=0,Ie.warn=0,Ie.time=0,Ie.progress=0,Ie.progressConfig={vulscan:[],webscan:[],filescan:[],backup:[],webshell:[],index:[],webhorse:[],deadchain:[],database:[],ftps:[],backend:[]},Ie.statusTotal={},Ie.result={},Ie.progressStatus={},Ie.active={vulscan:!1,webscan:!1,filescan:!1,backup:!1,webshell:!1,index:!1,webhorse:!1,deadchain:!1,database:!1,ftps:!1,backend:!1}},Be=function(){var e=s(t().m(function e(){var n;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if("ltd"===Ee.value.authType){e.n=1;break}return e.a(2);case 1:return je.value=!0,e.p=2,e.n=3,B({data:JSON.stringify({name:Te.value.name})});case 3:if((n=e.v).status){e.n=4;break}return Se.request(n),e.a(2);case 4:Ie.isEnd=Ie.time||!1,Ie.time=H(n.data.time,"yyyy-MM-dd"),e.n=6;break;case 5:e.p=5,e.v;case 6:return e.p=6,je.value=!1,e.f(6);case 7:return e.a(2)}},e,null,[[2,5,6,7]])}));return function(){return e.apply(this,arguments)}}();return u(function(){Be(),qe()}),_e({onRefresh:(J=s(t().m(function e(){return t().w(function(e){for(;;)switch(e.n){case 0:Be(),qe();case 1:return e.a(2)}},e)})),function(){return J.apply(this,arguments)})}),function(n,t){var s=L,i=O,o=C,l=G,c=z,u=M,I=A,P=a,H=d("bt-loading");return f((v(),m("div",r,["ltd"===p(Ee).authType?(v(),m("div",R,[g("div",U,[g("div",V,[g("div",$,[p(Ie).scanStatus&&!p(Ie).isEnd?(v(),m("div",Q,[t[0]||(t[0]=g("div",{class:"animate-spin absolute top-0 border-warning border-b-2 rounded-full h-full w-full"},null,-1)),y(s,{icon:"scanning-danger",size:60,color:"var(--el-color-warning)",class:"m-auto"})])):(v(),m("div",W,[p(Ie).warn||p(Ie).error?(v(),b(s,{key:0,icon:"scanning-danger",size:70,color:"var(--el-color-danger)"})):(v(),b(s,{key:1,icon:"scanning-"+(p(Ie).isEnd?"success":"danger"),size:72,color:p(Ie).isEnd?"var(--el-color-primary)":"var(--el-color-warning)"},null,8,["icon","color"]))]))])]),g("div",X,[g("div",Y,[p(Ie).isEnd?(v(),m(w,{key:1},[t[3]||(t[3]=h(" 检测完成 ",-1)),p(Ie).error>0||p(Ie).warn>0?(v(),m(w,{key:0},[t[2]||(t[2]=h(" ，共发现 ",-1)),p(Ie).error>0?(v(),m(w,{key:0},[g("span",Z,x(p(Ie).error),1),t[1]||(t[1]=h(" 项风险 ",-1))],64)):k("",!0)],64)):k("",!0)],64)):(v(),m(w,{key:0},[h(x(p(Fe)),1)],64))]),g("div",ee,x(p(De)),1)]),g("div",ne,[y(i,{class:S({"warning-hover":p(Ie).scanStatus&&!p(Ie).isEnd}),type:p(Ie).scanStatus&&!p(Ie).isEnd?"warning":"primary",onClick:Ne,plain:!(!p(Ie).scanStatus||p(Ie).isEnd)},{default:_(function(){return[h(x(p(Ie).scanStatus&&!p(Ie).isEnd?"取消扫描":p(Ie).isEnd?"重新检测":"立即检测"),1)]}),_:1},8,["class","type","plain"]),p(Ie).isEnd?(v(),b(i,{key:0,type:"default",onClick:p(N)},{default:_(function(){return e(t[4]||(t[4]=[h(" 立即修复 ",-1)]))}),_:1},8,["onClick"])):k("",!0)])]),y(o,{class:"!mt-0 !mb-20px !bg-base"}),g("div",te,[p(Ie).scanStatus||p(Ie).isEnd?k("",!0):(v(),m("div",re,[t[5]||(t[5]=g("div",{class:"font-bold text-medium text-secondary mb-[2rem]"},"支持网站以下安全扫描项:",-1)),g("div",ae,[(v(!0),m(w,null,T(p(Oe),function(e,n){return v(),m("div",{key:n,class:"flex flex-col inline-block items-center mb-[20px]"},[y(l,{class:"w-[4rem] inline-block mb-8px opacity-90",src:"/scan/scanning-"+e.name+"-ico.svg"},null,8,["src"]),h(" "+x(e.title),1)])}),128))])])),p(Ie).scanStatus||p(Ie).isEnd?(v(!0),m(w,{key:1},T(p(Oe),function(n,r){return v(),m("div",{key:r,class:S([n.name+"_item "+(p(Ie).active[n.name]?"active":""),"progress_item"])},[g("div",{class:"progress_item_header",onClick:function(e){return function(e){Ie.active[e]=!Ie.active[e]}(n.name)}},[g("div",ie,[g("span",null,x(n.title),1)]),g("div",oe,[p(Ie).statusTotal[n.name]?(v(),m("span",le," 发现"+x(p(Ie).statusTotal[n.name])+"项危险 ",1)):k("",!0),p(Ie).scanStatus&&p(Ae)==n.name?(v(),m("span",ce," 正在扫描... ")):k("",!0),p(Ie).scanStatus||p(Ie).statusTotal[n.name]?k("",!0):(v(),m("span",ue," 无风险项 ")),p(Ie).scanStatus&&p(Ae)!=n.name&&!p(Ie).statusTotal[n.name]?(v(),m("span",de," 等待扫描 ")):k("",!0)]),g("div",fe,[g("span",pe,x(p(Ie).active[n.name]?"收起":"展开"),1),g("i",{class:S(p(Ie).active[n.name]?"svgtofont-el-arrow-up":"svgtofont-el-arrow-down")},null,2)])],8,se),f(g("div",ve,[y(I,{accordion:""},{default:_(function(){return[(v(!0),m(w,null,T(p(Ie).progressConfig[n.name],function(n,r){return v(),b(u,{key:r},{title:_(function(){return[g("div",me,[g("div",ge,[g("span",{class:"text-small h-[2.2rem] flex items-center px-[8px] rounded-small mr-[1rem]",style:E({color:p(He)[n.dangerous||0].color,backgroundColor:p(He)[n.dangerous||0].bg})},x(p(He)[n.dangerous||0].text),5),g("span",{innerHTML:n.name,class:"w-[46rem] truncate"},null,8,ye)]),y(c,{class:"mb-2px mr-4px",onClick:ze},{default:_(function(){return e(t[6]||(t[6]=[h(" 详情 ",-1)]))}),_:1})])]}),default:_(function(){return[g("div",be,[g("div",we,[t[7]||(t[7]=g("span",{class:"w-[6rem] flex-shrink-0 inline-block"}," 详情： ",-1)),g("span",{class:"leading-[1.6rem]",innerHTML:n.name},null,8,he)]),y(o,{class:"!my-8px"}),g("div",xe,[t[8]||(t[8]=g("span",{class:"w-[6rem] flex-shrink-0 inline-block"}," 修复方案： ",-1)),g("span",{innerHTML:n.repair},null,8,ke)])])]}),_:2},1024)}),128))]}),_:2},1024)],512),[[j,p(Ie).active[n.name]]])],2)}),128)):k("",!0)])])):(v(),b(P,{key:1,class:"h-full max-h-[62.5rem] overflow-auto",data:p(Le)},null,8,["data"]))])),[[H,p(je)]])}}});n("default",J(_e,[["__scopeId","data-v-17754910"]]))}}})}();
