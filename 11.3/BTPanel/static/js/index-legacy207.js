!function(){function e(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function t(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(n){i(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function r(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,u,o,i=[],c=!0,l=!1;try{if(u=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(r=u.call(t)).done)&&(i.push(r.value),i.length!==n);c=!0);}catch(e){l=!0,a=e}finally{try{if(!c&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(l)throw a}}return i}}(e,n)||a(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,n){if(e){if("string"==typeof e)return u(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?u(e,n):void 0}}function u(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==o(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function c(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",a=t.toStringTag||"@@toStringTag";function u(t,r,a,u){var c=r&&r.prototype instanceof i?r:i,s=Object.create(c.prototype);return l(s,"_invoke",function(t,r,a){var u,i,c,l=0,s=a||[],f=!1,_={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(n,t){return u=n,i=0,c=e,_.n=t,o}};function d(t,r){for(i=t,c=r,n=0;!f&&l&&!a&&n<s.length;n++){var a,u=s[n],d=_.p,m=u[2];t>3?(a=m===r)&&(c=u[(i=u[4])?5:(i=3,3)],u[4]=u[5]=e):u[0]<=d&&((a=t<2&&d<u[1])?(i=0,_.v=r,_.n=u[1]):d<m&&(a=t<3||u[0]>r||r>m)&&(u[4]=t,u[5]=r,_.n=m,i=0))}if(a||t>1)return o;throw f=!0,r}return function(a,s,m){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,m),i=s,c=m;(n=i<2?e:c)||!f;){u||(i?i<3?(i>1&&(_.n=-1),d(i,c)):_.n=c:_.v=c);try{if(l=2,u){if(i||(a="next"),n=u[a]){if(!(n=n.call(u,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,i<2&&(i=0)}else 1===i&&(n=u.return)&&n.call(u),i<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),i=1);u=e}else if((n=(f=_.n<0)?c:t.call(r,_))!==o)break}catch(n){u=e,i=1,c=n}finally{l=1}}return{value:n,done:f}}}(t,a,u),!0),s}var o={};function i(){}function s(){}function f(){}n=Object.getPrototypeOf;var _=[][r]?n(n([][r]())):(l(n={},r,function(){return this}),n),d=f.prototype=i.prototype=Object.create(_);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=f,l(d,"constructor",f),l(f,"constructor",s),s.displayName="GeneratorFunction",l(f,a,"GeneratorFunction"),l(d),l(d,a,"Generator"),l(d,r,function(){return this}),l(d,"toString",function(){return"[object Generator]"}),(c=function(){return{w:u,m:m}})()}function l(e,n,t,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}l=function(e,n,t,r){function u(n,t){l(e,n,function(e){return this._invoke(n,t,e)})}n?a?a(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(u("next",0),u("throw",1),u("return",2))},l(e,n,t,r)}function s(e,n,t,r,a,u,o){try{var i=e[u](o),c=i.value}catch(e){return void t(e)}i.done?n(c):Promise.resolve(c).then(r,a)}function f(e){return function(){var n=this,t=arguments;return new Promise(function(r,a){var u=e.apply(n,t);function o(e){s(u,r,a,o,i,"next",e)}function i(e){s(u,r,a,o,i,"throw",e)}o(void 0)})}}System.register(["./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./index-legacy123.js?v=1763689792","./index-legacy107.js?v=1763689792","./index-legacy119.js?v=1763689792","./index.vue_vue_type_script_setup_true_lang-legacy8.js?v=1763689792","./index.vue_vue_type_script_setup_true_lang-legacy7.js?v=1763689792","./validator-legacy.js?v=1763689792","./store-legacy2.js?v=1763689792","./useMethod-legacy4.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./ace-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./column-legacy.js?v=1763689792","./database-legacy.js?v=1763689792","./useStore-legacy2.js?v=1763689792"],function(n,a){"use strict";var u,l,s,_,d,m,p,b,y,h,v,g,z,w,q,x,k,j,C,S,O,V,P,B,N,M,I,U,E,F,G,T,D,L,A,H,Q,K,R,J,W,Y,$,X,Z,ee,ne,te,re,ae,ue,oe,ie,ce,le,se,fe,_e,de,me,pe,be,ye,he,ve,ge,ze,we,qe,xe,ke,je,Ce,Se,Oe,Ve,Pe,Be,Ne;return{setters:[function(e){u=e.p,l=e.Q,s=e.iQ,_=e.M,d=e.iR,m=e.aH,p=e.b8,b=e.n,y=e.H,h=e.V,v=e.x,g=e.bW,z=e.r,w=e.aK,q=e.ho,x=e.$,k=e.ax,j=e.j,C=e.k,S=e.aC,O=e._},function(e){V=e.s,P=e.r,B=e.o,N=e.c,M=e.g,I=e.v,U=e.I,E=e.x,F=e.y,G=e.e,T=e.C,D=e.A,L=e.z,A=e.O,H=e.D,Q=e.G,K=e.R,R=e.B,J=e.J,W=e.F,Y=e.b1,$=e.K,X=e.H,Z=e.ad,ee=e.ab,ne=e.aD,te=e.bP,re=e.bO,ae=e.ax,ue=e.az,oe=e.am,ie=e.an,ce=e.b2,le=e.ap},function(e){se=e._},function(e){fe=e._},function(e){_e=e.B},function(e){de=e.S,me=e._},function(e){pe=e.S,be=e._},function(e){ye=e.aM,he=e.f,ve=e.aN,ge=e.aO,ze=e.aP,we=e.aQ,qe=e.aR,xe=e.aS,ke=e.aT,je=e.aU,Ce=e.aV,Se=e.aW,Oe=e.aX,Ve=e.aY,Pe=e.aZ},function(e){Be=e.H},function(e){Ne=e.u},null,null,null,null,null,null],execute:function(){var Me=de(),Ie=pe(),Ue=V(pe()).compData,Ee=Be();V(Ee);var Fe=P("service"),Ge=P(!1);P(!0);var Te=P(""),De=P(!1),Le=B({re_level:1,tips:""}),Ae=[{label:"级别一",value:1},{label:"级别二",value:2},{label:"级别三",value:3},{label:"级别四",value:4},{label:"级别五",value:5},{label:"级别六",value:6}],He=P(null),Qe={recover:[{content:"启动完成后请立即备份和检查数据库完整性"},{content:"恢复级别说明（从1到6进行尝试）："},{content:"级别一：尝试忽略损坏的页，适用于轻微损坏的情况，可以尝试从数据中恢复。"},{content:"级别二：禁用后台线程，适合解决由于并发操作导致的问题。"},{content:"级别三：适用于需要快速恢复的场景，但可能会导致最近的数据丢失。"},{content:"级别四：适用于插入缓冲区引起问题时的恢复，可能会导致数据文件损坏。"},{content:"级别五：适合于需要快速启动但可能会导致数据一致性问题的情况。"},{content:"级别六：适用于最严重的情况，可能会导致较高的数据丢失及数据文件损坏。"}],config:[{content:"此处为mysql主配置文件，若您不了解配置规则，请勿随意修改"}],storage:[{content:"风险提示：迁移过程中Mysql将会停止运行，请谨慎操作"},{content:"风险提示：迁移过程中请等待迁移完成后再进行其他操作"}],memoryProtection:[{content:"说明：开启后将调整Mysql内存优先级，设置mysql为永不被系统杀死，可确保Mysql稳定运行。但可能导致其他进程异常被杀，严重时可能影响系统运行，建议需要Mysql稳定运行时在开启。"}]},Ke=function(){var e=f(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,u({title:"mysqld服务",icon:"warning-filled",content:"即将开始修复mysql启动问题，是否继续？"});case 1:return e.n=2,l({loading:"正在修复启动，请稍后...",request:s(),success:function(){var e=f(c().m(function e(n){return c().w(function(e){for(;;)switch(e.n){case 0:"data_err"===n.err_type?(Le.tips=n.msg,De.value=!0):"log_err"===n.err_type?Re(n.msg):(We(),_.msg({dangerouslyUseHTMLString:!0,message:n.msg,type:n.status?"success":"error",duration:n.status?2e3:0,showClose:!n.status,customClass:"".concat("port_in_use"===n.err_type?"max-w-[48rem]":"")}));case 1:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}()});case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Re=function(){var e=f(c().m(function e(n){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,u({title:"修复MySQL启动",icon:"warning-filled",content:n});case 1:l({loading:"正在修复MySQL启动，请稍后...",request:ye(),message:!0,success:function(e){We()}});case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),Je=function(){var e=f(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:if(!(Le.re_level>=4)){e.n=1;break}return e.n=1,u({title:"修复MYSQL启动",width:"39rem",isHtml:!0,content:'警告：当前选择的恢复等级将可能导致<span class="text-danger">数据文件损坏会丢失</span>，请做好服务器快照或备份好数据库数据目录【/www/server/data】如果启动成功，数据库将会进入只读模式'});case 1:return e.n=2,l({loading:"正在修复启动，请稍后...",request:d({re_level:Le.re_level}),message:!0,success:function(){var e=f(c().m(function e(n){return c().w(function(e){for(;;)switch(e.n){case 0:n.status&&(De.value=!1),We();case 1:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}()});case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),We=function(){l({request:m({sName:"mysql"}),success:function(e){Ue.value=e.data}})},Ye=P(""),$e=function(){var e=f(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,l({loading:"正在保存配置，请稍后...",request:p({path:"/etc/my.cnf",data:Ye.value,encoding:"utf-8"}),message:!0});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Xe=function(){var e=f(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,l({loading:Ge,request:q({path:"/etc/my.cnf"}),data:{data:[String,Ye]}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Ze=B({path:"",port:"",oldData:{path:"",port:""}}),en=function(){he({type:"dir",path:Ze.path,change:function(e){Ze.path=e}})},nn=function(){var e=f(c().m(function e(){var n,t;return c().w(function(e){for(;;)switch(e.n){case 0:if(n="port"===Fe.value,Ze.path||n){e.n=1;break}return e.a(2,_.error("存储位置不能为空"));case 1:if(Ze.port||!n){e.n=2;break}return e.a(2,_.error("端口不能为空"));case 2:if(!n||Ze.port!==Ze.oldData.port){e.n=3;break}return e.a(2,_.success("未修改端口数据"));case 3:if(n||Ze.path!==Ze.oldData.path){e.n=4;break}return e.a(2,_.success("未修改存储位置数据"));case 4:if(!!n){e.n=5;break}return e.n=5,u({title:"数据库迁移",icon:"warning-filled",content:"请确定是否迁移至:【".concat(Ze.path,"】？")});case 5:t=i({},n?"port":"datadir",Ze[n?"port":"path"]),l({loading:"正在设置，请稍后...",request:(n?Se:Oe)(t),message:!0,success:function(){var e=f(c().m(function e(n){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,He.value;case 1:e.v.unmount(),rn();case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}()}),setTimeout(function(){!n&&tn()},1e3);case 6:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),tn=function(){var e=f(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:He.value=b({title:"迁移任务",area:60,component:function(){return y(function(){return a.import("./progress-legacy2.js?v=1763689792")},void 0,a.meta.url)}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),rn=function(){var e=f(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,l({loading:Ge,request:ve(),success:function(e){var n,t,r,a;Ze.path=(null==e||null===(n=e.data)||void 0===n?void 0:n.datadir)||"",Ze.port=(null==e||null===(t=e.data)||void 0===t?void 0:t.port)||"",Ze.oldData.path=(null==e||null===(r=e.data)||void 0===r?void 0:r.datadir)||"",Ze.oldData.port=(null==e||null===(a=e.data)||void 0===a?void 0:a.port)||""}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),an=P([{name:"启动时间",field:"Run",value:"无",function:function(e){return h(e.Run)}},{name:"总连接次数",field:"Connections",value:"无"},{name:"发送",value:"无",field:"other",function:function(e){return v(Number(e.Bytes_sent))}},{name:"接收",value:"无",field:"other",function:function(e){return v(Number(e.Bytes_received))}},{name:"每秒查询",value:"无",field:"other",function:function(e){return parseInt((e.Questions/e.Uptime).toString())}},{name:"每秒事务",value:"无",field:"other",function:function(e){return parseInt(((parseInt(e.Com_commit)+parseInt(e.Com_rollback))/e.Uptime).toString())}},{name:"File",value:"无",field:"File"},{name:"Position",value:"无",field:"Position"}]),un=P([{name:"活动/峰值连接数",function:function(e){return e.Threads_running+"/"+e.Max_used_connections},value:"",ps:"若值过大,增加max_connections"},{name:"线程缓存命中率",value:"",function:function(e){var n=(100*(1-e.Threads_created/e.Connections)).toFixed(2);return isNaN(n)?"0":n+"%"},ps:"若过低,增加thread_cache_size"},{value:"",name:"索引命中率",function:function(e){var n=(100*(1-e.Key_reads/e.Key_read_requests)).toFixed(2);return isNaN(n)?"0":n+"%"},ps:"若过低,增加key_buffer_size"},{value:"",name:"Innodb索引命中率",function:function(e){var n=(100*(1-e.Innodb_buffer_pool_reads/e.Innodb_buffer_pool_read_requests)).toFixed(2);return isNaN(n)?"0":n},ps:"若过低,增加innodb_buffer_pool_size"},{value:"",name:"查询缓存命中率",function:function(e){var n=(parseInt(e.Qcache_hits)/(parseInt(e.Qcache_hits)+parseInt(e.Qcache_inserts))*100).toFixed(2)+"%";return"NaN%"==n&&(n="OFF"),n},ps:"若过低,增加query_cache_size"},{value:"",name:"创建临时表到磁盘",function:function(e){var n=(e.Created_tmp_disk_tables/e.Created_tmp_tables*100).toFixed(2);return isNaN(n)?"0":n+"%"},ps:"若过大,尝试增加tmp_table_size"},{value:"",name:"已打开的表",function:function(e){return e.Open_tables},ps:"table_open_cache配置值应大于等于此值"},{value:"",name:"没有使用索引的量",function:function(e){return e.Select_full_join},ps:"若不为0,请检查数据表的索引是否合理"},{value:"",name:"没有索引的JOIN量",function:function(e){return e.Select_range_check},ps:"若不为0,请检查数据表的索引是否合理"},{value:"",name:"排序后的合并次数",function:function(e){return e.Sort_merge_passes},ps:"若值过大,增加sort_buffer_size"},{value:"",name:"锁表次数",function:function(e){return e.Table_locks_waited},ps:"若值过大,请考虑增加您的数据库性能"}]),on=function(){var e=f(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,l({loading:Ge,request:Ve(),success:function(e){var n;if(!1===e.status||null!==(n=e.data)&&void 0!==n&&n.status)return _.msg({customClass:"bt-message-error-html",dangerouslyUseHTMLString:!0,message:e.msg||e.data.msg,type:"error",showClose:!0});an.value.forEach(function(n){n.function?n.value=n.function(e.data):n.value=e.data[n.field]}),un.value.forEach(function(n){n.function&&(n.value=n.function(e.data))})}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),cn=[{title:"1-2GB",data:{key_buffer_size:32,query_cache_size:32,tmp_table_size:32,innodb_buffer_pool_size:64,sort_buffer_size:256,read_buffer_size:256,read_rnd_buffer_size:256,join_buffer_size:512,thread_stack:256,binlog_cache_size:64,thread_cache_size:64,table_open_cache:128,max_connections:100}},{title:"2-4GB",data:{key_buffer_size:64,query_cache_size:64,tmp_table_size:64,innodb_buffer_pool_size:128,sort_buffer_size:512,read_buffer_size:512,read_rnd_buffer_size:512,join_buffer_size:1024,thread_stack:256,binlog_cache_size:64,thread_cache_size:96,table_open_cache:192,max_connections:200}},{title:"4-8GB",data:{key_buffer_size:128,query_cache_size:128,tmp_table_size:128,innodb_buffer_pool_size:256,sort_buffer_size:1024,read_buffer_size:1024,read_rnd_buffer_size:768,join_buffer_size:2048,thread_stack:256,binlog_cache_size:128,thread_cache_size:128,table_open_cache:384,max_connections:300}},{title:"8-16GB",data:{key_buffer_size:256,query_cache_size:256,tmp_table_size:256,innodb_buffer_pool_size:1024,sort_buffer_size:1024,read_buffer_size:2048,read_rnd_buffer_size:1024,join_buffer_size:2048,thread_stack:384,binlog_cache_size:192,thread_cache_size:192,table_open_cache:1024,max_connections:400}},{title:"16-32GB",data:{key_buffer_size:512,query_cache_size:384,tmp_table_size:1024,innodb_buffer_pool_size:2048,sort_buffer_size:4096,read_buffer_size:4096,read_rnd_buffer_size:2048,join_buffer_size:4096,thread_stack:512,binlog_cache_size:256,thread_cache_size:256,table_open_cache:2048,max_connections:500}},{title:"32-48GB",data:{key_buffer_size:1024,query_cache_size:512,tmp_table_size:1536,innodb_buffer_pool_size:4096,sort_buffer_size:4096,read_buffer_size:4096,read_rnd_buffer_size:3072,join_buffer_size:6144,thread_stack:512,binlog_cache_size:384,thread_cache_size:384,table_open_cache:3072,max_connections:750}},{title:"48-64GB",data:{key_buffer_size:2048,query_cache_size:768,tmp_table_size:2048,innodb_buffer_pool_size:8192,sort_buffer_size:4096,read_buffer_size:4096,read_rnd_buffer_size:4096,join_buffer_size:8192,thread_stack:512,binlog_cache_size:512,thread_cache_size:512,table_open_cache:4096,max_connections:1e3}},{title:"64-96GB",data:{key_buffer_size:2048,query_cache_size:1024,tmp_table_size:3072,innodb_buffer_pool_size:16384,sort_buffer_size:8192,read_buffer_size:8192,read_rnd_buffer_size:4096,join_buffer_size:8192,thread_stack:768,binlog_cache_size:768,thread_cache_size:768,table_open_cache:6144,max_connections:1500}},{title:"96-128GB",data:{key_buffer_size:2048,query_cache_size:1536,tmp_table_size:4096,innodb_buffer_pool_size:32768,sort_buffer_size:8192,read_buffer_size:8192,read_rnd_buffer_size:8192,join_buffer_size:8192,thread_stack:1024,binlog_cache_size:1024,thread_cache_size:1024,table_open_cache:8192,max_connections:2e3}},{title:"128-256GB",data:{key_buffer_size:4096,query_cache_size:2048,tmp_table_size:8192,innodb_buffer_pool_size:65536,sort_buffer_size:8192,read_buffer_size:8192,read_rnd_buffer_size:8192,join_buffer_size:8192,thread_stack:2048,binlog_cache_size:2048,thread_cache_size:2048,table_open_cache:16384,max_connections:4e3}}],ln={key_buffer_size:"MB,用于索引的缓冲区大小",query_cache_size:"MB,查询缓存,不开启请设为0",tmp_table_size:"MB,临时表缓存大小",innodb_buffer_pool_size:"MB,Innodb缓冲区大小",innodb_log_buffer_size:"MB,Innodb日志缓冲区大小",sort_buffer_size:"KB * 连接数,每个线程排序的缓冲大小",read_buffer_size:"KB * 连接数读入缓冲区大小",read_rnd_buffer_size:"KB * 连接数随机读取缓冲区大小",join_buffer_size:"KB * 连接数关联表缓存大小",thread_stack:"KB * 连接数每个线程的堆栈大小",binlog_cache_size:"KB * 连接数二进制日志缓存大小(4096的倍数)",thread_cache_size:"线程池大小",table_open_cache:"表缓存",max_connections:"最大连接数"},sn=P(""),fn=P([]),_n=P(),dn=function(e){if(!e||"object"!==o(e))return"";for(var n=0;n<cn.length;n++){for(var t=cn[n].data,a=!0,u=0,i=Object.entries(t);u<i.length;u++){var c=r(i[u],2),l=c[0],s=c[1],f=l,_=s;if("query_cache_size"===l){if("disable"===e.query_cache_supprot)continue;if(void 0!==e.bt_query_cache_size)f="bt_query_cache_size";else if(void 0!==e.query_cache_type){if(0===e.query_cache_type&&0===Number(s))continue;if(1===e.query_cache_type&&Number(s)>0){if(e.query_cache_size!==s){a=!1;break}continue}}}if(void 0!==e[f]&&e[f]!==_){a=!1;break}}if(a)return n}return""},mn=function(){var e=f(c().m(function e(n){var t;return c().w(function(e){for(;;)switch(e.n){case 0:t=Number(n),fn.value.forEach(function(e){cn[t].data[e.name]&&(e.value=cn[t].data[e.name]),"query_cache_size"!==e.name||cn[t].data.query_cache_size||(e.value=0)}),pn();case 1:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),pn=function(){var e,n=0,t=0,r=["key_buffer_size","query_cache_size","tmp_table_size","innodb_buffer_pool_size","innodb_log_buffer_size"],a=["sort_buffer_size","read_buffer_size","read_rnd_buffer_size","join_buffer_size","thread_stack","binlog_cache_size"],u=Number(fn.value.find(function(e){return"max_connections"===e.name}).value);fn.value.forEach(function(e){r.includes(e.name)?n+=Number(e.value):a.includes(e.name)&&(t+=Number(e.value)/1024)}),e=n+t*u,_n.value=e},bn=function(){var e={};fn.value.forEach(function(n){n.name&&void 0!==n.value&&null!==n.value&&(e[n.name]=Number(n.value))}),0===e.query_cache_size&&(e.query_cache_supprot="disable");var n=dn(e);sn.value=n},yn=function(){var e=f(c().m(function e(){var n;return c().w(function(e){for(;;)switch(e.n){case 0:return n={query_cache_type:0},fn.value.forEach(function(e){var t="bt_query_cache_size"===e.name?"query_cache_size":e.name;n[t]=e.value}),n.query_cache_size>0&&(n.query_cache_type=1),delete n.query_cache_supprot,n.max_heap_table_size=n.tmp_table_size,e.n=1,l({loading:"正在保存中，请稍后...",request:ge(n),message:!0,success:function(e){e.status&&(_.success("设置成功，重启数据库后配置生效，请重启数据库"),bn())}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),hn=function(){var e=f(c().m(function e(n){var t;return c().w(function(e){for(;;)switch(e.n){case 0:return t={restart:"重启",stop:"停止",reload:"重载配置",start:"启动"},e.n=1,u({title:"".concat(t[n],"mysqld服务"),content:"是否".concat(t[n],"mysqld服务？")});case 1:return e.n=2,l({loading:"正在".concat(t[n],"mysqld服务，请稍后..."),request:g({name:"mysqld",type:n}),message:!0,success:function(e){e.status&&z.go(0)}});case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),vn=function(){var e=f(c().m(function e(){var n,t,r,a,u;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:return Ge.value=!0,e.p=1,e.n=2,Pe();case 2:n=e.v,t=n.data,fn.value=[],t.mem.hasOwnProperty("join_buffer_size")||(t.mem.join_buffer_size=512),t.mem.hasOwnProperty("thread_stack")||(t.mem.thread_stack=256),t.mem.hasOwnProperty("binlog_cache_size")||(t.mem.binlog_cache_size=32),r="disable"===t.mem.query_cache_supprot,t.mem.hasOwnProperty("bt_query_cache_size")&&!r&&fn.value.push({name:"query_cache_size",value:t.mem.bt_query_cache_size,ps:ln.query_cache_size?ln.query_cache_size:""}),Object.keys(t.mem).forEach(function(e){"query_cache_size"!==e&&"bt_query_cache_size"!==e&&fn.value.push({name:e,value:t.mem[e],ps:ln[e]?ln[e]:""})}),_n.value=t.mem.bt_mem_size,a=dn(t.mem),sn.value=a,pn(),e.n=4;break;case 3:e.p=3,u=e.v,w(u);case 4:return e.p=4,Ge.value=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),gn=P(""),zn=function(){var e=f(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,u({title:"清空日志操作提示",icon:"warning-filled",content:"清空日志会导致运行错误信息丢失，无法排除问题，请谨慎操作，是否继续？"});case 1:return e.n=2,l({loading:"正在清空日志，请稍后...",request:ze({close:1}),message:!0,success:wn});case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),wn=function(){var e=f(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,l({loading:Ge,request:we(),data:[String,gn]});case 1:gn.value=gn.value||"当前暂无数据";case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),qn=function(){var e=f(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,l({loading:Ge,request:qe(),data:{msg:[String,gn]}});case 1:gn.value=gn.value||"当前暂无数据";case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),xn=P(!1),kn=P(),jn=P([]),Cn=B({status:!1,size:""}),Sn=P(!1),On=B({days:""}),Vn=B({days:[{required:!0,message:"请输入天数",trigger:"blur"},{validator:function(e,n,t){n<7?t(new Error("请输入大于7的天数")):t()}}]}),Pn=function(){var e=f(c().m(function e(n){return c().w(function(e){for(;;)switch(e.n){case 0:return Cn.status=!n,e.n=1,u({title:(n?"开启":"关闭")+"二进制日志",icon:"warning-filled",content:(n?"开启二进制日志可以保护Mysql的数据安全，但同时会消耗一定磁盘存储，是否继续?":"关闭二进制日志后，将不会再记录所有对数据库的修改操作")+"二进制日志?"});case 1:return e.n=2,l({loading:"正在"+(n?"开启":"关闭")+"二进制日志，请稍后...",request:xe(),message:!0,success:function(e){Mn()}});case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),Bn=function(){var e=f(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,kn.value.validate();case 1:return e.n=2,u({title:"清理日志",content:"即将清理【"+On.days+"】天前的MySQL二进制日志，是否继续？",icon:"warning-filled"});case 2:return e.n=3,l({loading:"正在清理日志，请稍后...",request:ye({days:On.days}),message:!0,success:function(e){e.status&&(Sn.value=!1,Nn(),Mn(),In())}});case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Nn=function(){var e,n;Sn.value=!1,null===(e=kn.value)||void 0===e||e.clearValidate(),null===(n=kn.value)||void 0===n||n.resetFields()},Mn=function(){var e=f(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,l({request:xe({status:1}),success:function(e){Cn.status=e.data.binlog_status,Cn.size=v(e.data.size)}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),In=function(){var e=f(c().m(function e(){return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,l({loading:Ge,request:ke(),data:{data:[Array,jn]}});case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),Un=function(){var e=f(c().m(function e(n){var t;return c().w(function(e){for(;;)switch(e.n){case 0:return t=n.row,e.n=1,u({title:"删除日志",icon:"warning-filled",content:"您真的要删除【".concat(t.name,"】日志？"),type:"calc"});case 1:return e.n=2,l({loading:"正在删除【".concat(t.name,"】日志，请稍后..."),request:je({path:t.path}),message:!0,success:In});case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),En=P(!1),Fn=function(){var e=f(c().m(function e(n){var t,r,a;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,t="get"===n?{}:{status:Number(n)},e.n=1,Ce(t);case 1:r=e.v,"get"===n?(r.status||"当前状态关闭中！"===r.msg||_.request(r),En.value=Boolean(r.status)):_.request(r),e.n=3;break;case 2:e.p=2,a=e.v,w(a);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(n){return e.apply(this,arguments)}}(),Gn=function(){var e=f(c().m(function e(n){var t;return c().w(function(e){for(;;)switch(e.n){case 0:t=n,e.n="config"===t?1:"port"===t||"storage"===t?2:"state"===t?3:"performance"===t?4:"errorLogs"===t?5:"slowLogs"===t?6:"binaryLogs"===t?7:"memoryProtection"===t?9:10;break;case 1:return Xe(),e.a(3,10);case 2:return rn(),e.a(3,10);case 3:return on(),e.a(3,10);case 4:return vn(),e.a(3,10);case 5:return wn(),e.a(3,10);case 6:return qn(),e.a(3,10);case 7:return e.n=8,In();case 8:return Mn(),e.a(3,10);case 9:return Fn("get"),e.a(3,10);case 10:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),Tn=function(e){Fe.value="service",e&&(Ue.value=e);var n=t(t({},Ue.value),{},{name:"mysqld"});Ie.init(n),Me.init(n),Te.value=Ue.value.status},Dn={key:0},Ln={class:"p-2rem"},An={class:"content flex items-center"},Hn={class:"message flex-1 ml-4 py-[.3rem] leading-[2.4rem] text-base"},Qn={class:"text text-[15px] leading-[2.5rem] flex !flex-wrap break-all"},Kn={class:"my-[12px]"},Rn={class:"flex text-secondary items-center"},Jn={class:"flex text-secondary items-center"},Wn={class:"text-secondary performance"},Yn={class:"flex items-center justify-center"},$n={class:"flex items-center"},Xn={class:"ml-2rem"},Zn={class:"my-[12px]"},et={class:"my-[12px]"},nt={class:"flex items-center"},tt={class:"ml-[16rem]"},rt=["onClick"],at={class:"p-[20px]"},ut=N({__name:"index",props:{compData:{default:{}}},setup:function(n){var t=V(pe()).compData,r=n,a=M(function(){return t.value.status});return I(function(){Tn(r.compData),t.value.refreshEvent=f(c().m(function e(){var n;return c().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Ne("mysql");case 1:n=e.v,t.value.status=n.s_status;case 2:return e.a(2)}},e)}))}),function(n,t){var r=X,u=x,o=k,i=Z,c=ee,l=j,s=ne,f=_e,_=fe,d=C,m=te,p=re,b=ae,y=ue,g=oe,z=ie,w=ce,q=se,O=le,V=S,P=U("bt-loading");return E(),F("div",null,[G(V,{modelValue:L(Fe),"onUpdate:modelValue":t[12]||(t[12]=function(e){return K(Fe)?Fe.value=e:null}),type:"left-bg-card",position:"left",class:"h-full",onChange:L(Gn)},{default:T(function(){return[G(s,{label:"服务",name:"service"},{default:T(function(){return[D("div",null,[G(be),G(me),L(a)?Q("",!0):(E(),A(r,{key:0,class:"mt-4rem",onClick:L(Ke)},{default:T(function(){return e(t[13]||(t[13]=[H("修复启动",-1)]))}),_:1},8,["onClick"])),G(u,{options:[{content:"如需更换mysql版本，请备份好数据后，卸载mysql重新安装"}],class:"pl-1rem"},{default:T(function(){return[L(a)?Q("",!0):(E(),F("li",Dn,"如无法正常启动，请尝试使用修复启动按钮进行修复启动"))]}),_:1}),G(l,{modelValue:L(De),"onUpdate:modelValue":t[1]||(t[1]=function(e){return K(De)?De.value=e:null}),area:50,title:"修复启动-恢复模式-innodb_force_recovery","show-footer":"",onConfirm:L(Je)},{default:T(function(){return[D("div",Ln,[D("div",An,[t[14]||(t[14]=D("i",{class:"svgtofont-el-warning-filled !text-[4rem] text-warning"},null,-1)),D("div",Hn,[D("div",Qn,R(L(Le).tips),1)])]),G(c,{model:L(Le),"label-width":"80px"},{default:T(function(){return[G(i,{label:"恢复级别"},{default:T(function(){return[G(o,{modelValue:L(Le).re_level,"onUpdate:modelValue":t[0]||(t[0]=function(e){return L(Le).re_level=e}),options:L(Ae),class:"!w-20rem"},null,8,["modelValue","options"])]}),_:1})]}),_:1},8,["model"]),G(u,{options:L(Qe).recover,class:"pl-3rem"},null,8,["options"])])]}),_:1},8,["modelValue","onConfirm"])])]}),_:1}),G(s,{label:"配置文件",name:"config",lazy:!0},{default:T(function(){return[J((E(),F("div",null,[t[16]||(t[16]=D("span",{class:"my-[4px] text-secondary"}," 提示：Ctrl+F 搜索关键字，Ctrl+S 保存，Ctrl+H 查找替换 ",-1)),D("div",Kn,[G(f,{class:"!h-[48rem] !w-full",modelValue:L(Ye),"onUpdate:modelValue":t[2]||(t[2]=function(e){return K(Ye)?Ye.value=e:null}),id:"configContent",onSave:L($e)},null,8,["modelValue","onSave"])]),G(r,{type:"primary",onClick:L($e)},{default:T(function(){return e(t[15]||(t[15]=[H("保存",-1)]))}),_:1},8,["onClick"]),G(u,{options:L(Qe).config,class:"pl-2rem"},null,8,["options"])])),[[P,L(Ge)]])]}),_:1}),G(s,{label:"存储位置",name:"storage",lazy:!0},{default:T(function(){return[J((E(),F("div",null,[D("div",Rn,[G(_,{icon:"icon-file_mode",onIconClick:L(en),width:"32rem",modelValue:L(Ze).path,"onUpdate:modelValue":t[3]||(t[3]=function(e){return L(Ze).path=e}),class:"!w-32rem"},null,8,["onIconClick","modelValue"]),G(r,{class:"ml-[12px]",onClick:L(nn),type:"primary"},{default:T(function(){return e(t[17]||(t[17]=[H("迁移",-1)]))}),_:1},8,["onClick"])]),G(u,{options:L(Qe).storage,class:"pl-2rem"},null,8,["options"])])),[[P,L(Ge)]])]}),_:1}),G(s,{label:"端口配置",name:"port",lazy:!0},{default:T(function(){return[J((E(),F("div",Jn,[G(d,{modelValue:L(Ze).port,"onUpdate:modelValue":t[4]||(t[4]=function(e){return L(Ze).port=e}),type:"number",width:"10rem",class:"!w-10rem"},null,8,["modelValue"]),G(r,{type:"primary",class:"ml-[12px]",onClick:L(nn)},{default:T(function(){return e(t[18]||(t[18]=[H("修改",-1)]))}),_:1},8,["onClick"])])),[[P,L(Ge)]])]}),_:1}),G(s,{label:"当前状态",name:"state",lazy:!0},{default:T(function(){return[J((E(),F("div",null,[G(p,{class:"margin-top table-descriptions",column:2,border:""},{default:T(function(){return[(E(!0),F(W,null,Y(L(an),function(e,n){return E(),A(m,{key:n},{label:T(function(){return[H(R(e.name),1)]}),default:T(function(){return[H(" "+R(e.value),1)]}),_:2},1024)}),128))]}),_:1}),G(y,{data:L(un),class:"mt-[20px]","max-height":"400"},{default:T(function(){return[G(b,{prop:"name",label:"字段",width:"180"}),G(b,{prop:"value",label:"当前值",width:"100"}),G(b,{prop:"ps",label:"注意"})]}),_:1},8,["data"])])),[[P,L(Ge)]])]}),_:1}),G(s,{label:"性能调整",name:"performance",lazy:!0},{default:T(function(){return[J((E(),F("div",Wn,[D("div",Yn,[t[19]||(t[19]=H(" 优化方案 ",-1)),G(z,{class:"!w-[12rem] mr-[20px] ml-8px",modelValue:L(sn),"onUpdate:modelValue":t[5]||(t[5]=function(e){return K(sn)?sn.value=e:null}),onChange:L(mn),placeholder:"自定义"},{default:T(function(){return[(E(!0),F(W,null,Y(L(cn),function(e,n){return E(),A(g,{key:n,value:n,label:e.title},null,8,["value","label"])}),128))]}),_:1},8,["modelValue","onChange"]),t[20]||(t[20]=H(" 最大使用内存 ",-1)),G(d,{"text-type":"MB",width:"16rem",class:"!w-16rem ml-8px",readonly:"",modelValue:L(_n),"onUpdate:modelValue":t[6]||(t[6]=function(e){return K(_n)?_n.value=e:null})},null,8,["modelValue"])]),G(w),G(c,{class:"performance-form","label-position":"right","label-width":"146px"},{default:T(function(){return[(E(!0),F(W,null,Y(L(fn),function(e,n){return J((E(),A(i,{label:e.name,key:n},{default:T(function(){return[D("div",$n,[G(d,{modelValue:e.value,"onUpdate:modelValue":function(n){return e.value=n},width:"16rem",class:"!w-16rem",type:"number",onChange:L(pn)},null,8,["modelValue","onUpdate:modelValue","onChange"]),D("span",Xn,R(e.ps),1)])]}),_:2},1032,["label"])),[[$,e.ps]])}),128)),G(i,{label:" ",class:"mt-1rem"},{default:T(function(){return[G(r,{type:"primary",onClick:L(yn)},{default:T(function(){return e(t[21]||(t[21]=[H("保存",-1)]))}),_:1},8,["onClick"]),G(r,{onClick:t[7]||(t[7]=function(e){return L(hn)("restart")})},{default:T(function(){return e(t[22]||(t[22]=[H("重启数据库",-1)]))}),_:1}),t[23]||(t[23]=D("span",{class:"ml-3rem"},"* 修改配置后，需重启数据库生效",-1))]}),_:1})]}),_:1})])),[[P,L(Ge)]])]}),_:1}),G(s,{label:"错误日志",name:"errorLogs",lazy:!0},{default:T(function(){return[J((E(),F("div",null,[G(r,{type:"default",onClick:L(zn)},{default:T(function(){return e(t[24]||(t[24]=[H("清空日志",-1)]))}),_:1},8,["onClick"]),D("div",Zn,[G(q,{class:"!h-[56rem] !w-full",content:L(gn),id:"errorLogs",isHtml:!0,fullScreen:{title:"全屏查看【错误日志】",onRefresh:L(wn)}},null,8,["content","fullScreen"])])])),[[P,L(Ge)]])]}),_:1}),G(s,{label:"慢日志",name:"slowLogs",lazy:!0},{default:T(function(){return[J((E(),F("div",et,[G(q,{content:L(gn),isHtml:!0,class:"!h-[60rem] !w-full",id:"slowLogs",fullScreen:{title:"全屏查看【慢日志】",onRefresh:L(qn)}},null,8,["content","fullScreen"])])),[[P,L(Ge)]])]}),_:1}),G(s,{label:"二进制日志",name:"binaryLogs",lazy:!0},{default:T(function(){return[D("div",null,[D("div",nt,[D("div",null,[t[25]||(t[25]=H(" 二进制日志 ",-1)),G(O,{modelValue:L(Cn).status,"onUpdate:modelValue":t[8]||(t[8]=function(e){return L(Cn).status=e}),onChange:L(Pn)},null,8,["modelValue","onChange"])]),D("span",tt,R(L(Cn).size),1)]),G(w),t[27]||(t[27]=D("span",null," · 温馨提示：Mysql二进制日志是记录当前的操作日志，可用于数据恢复，数据备份。 ",-1)),J((E(),A(y,{class:"mt-[20px]",data:L(jn),"max-height":"500"},{default:T(function(){return[G(b,{prop:"name",label:"文件名"}),G(b,{prop:"size",label:"大小"},{default:T(function(e){return[H(R(L(v)(e.row.size)),1)]}),_:1}),G(b,{prop:"last_modified",label:"最后修改时间"},{default:T(function(e){return[H(R(L(h)(e.row.last_modified)),1)]}),_:1}),G(b,{align:"right",label:"操作"},{default:T(function(e){return[D("span",{class:"bt-link",onClick:function(n){return L(Un)(e)}},"删除",8,rt)]}),_:1})]}),_:1},8,["data"])),[[P,L(Ge)]]),G(l,{title:"清理日志",modelValue:L(Sn),"onUpdate:modelValue":t[10]||(t[10]=function(e){return K(Sn)?Sn.value=e:null}),area:42,showFooter:"",onCancel:L(Nn),onConfirm:L(Bn)},{default:T(function(){return[D("div",at,[G(c,{disabled:L(xn),class:"flex justify-center","label-position":"right",model:L(On),ref_key:"binlogFormRef",ref:kn,rules:L(Vn)},{default:T(function(){return[G(i,{label:"清理周期",prop:"days"},{default:T(function(){return[G(d,{modelValue:L(On).days,"onUpdate:modelValue":t[9]||(t[9]=function(e){return L(On).days=e}),type:"number",min:7,width:"24","text-type":"天"},null,8,["modelValue"])]}),_:1})]}),_:1},8,["disabled","model","rules"]),t[26]||(t[26]=D("ul",{class:"leading-8 text-small list-disc ml-[48px]"},[D("li",null,"只能清理7天前的日志,请输入大于7的天数")],-1))])]}),_:1},8,["modelValue","onCancel","onConfirm"])])]}),_:1}),G(s,{label:"内存保护",name:"memoryProtection",lazy:!0},{default:T(function(){return[D("div",null,[D("div",null,[t[28]||(t[28]=H(" 内存保护 ",-1)),G(O,{modelValue:L(En),"onUpdate:modelValue":t[11]||(t[11]=function(e){return K(En)?En.value=e:null}),onChange:L(Fn)},null,8,["modelValue","onChange"])]),G(u,{options:L(Qe).memoryProtection,class:"pl-2rem"},null,8,["options"])])]}),_:1})]}),_:1},8,["modelValue","onChange"])])}}});n("default",O(ut,[["__scopeId","data-v-39835eaa"]]))}}})}();
