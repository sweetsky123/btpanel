!function(){function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var r,n,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function l(e,a,i,o){var l=a&&a.prototype instanceof u?a:u,c=Object.create(l.prototype);return t(c,"_invoke",function(e,t,a){var i,o,l,u=0,c=a||[],d=!1,f={p:0,n:0,v:r,a:v,f:v.bind(r,4),d:function(e,t){return i=e,o=0,l=r,f.n=t,s}};function v(e,t){for(o=e,l=t,n=0;!d&&u&&!a&&n<c.length;n++){var a,i=c[n],v=f.p,m=i[2];e>3?(a=m===t)&&(l=i[(o=i[4])?5:(o=3,3)],i[4]=i[5]=r):i[0]<=v&&((a=e<2&&v<i[1])?(o=0,f.v=t,f.n=i[1]):v<m&&(a=e<3||i[0]>t||t>m)&&(i[4]=e,i[5]=t,f.n=m,o=0))}if(a||e>1)return s;throw d=!0,t}return function(a,c,m){if(u>1)throw TypeError("Generator is already running");for(d&&1===c&&v(c,m),o=c,l=m;(n=o<2?r:l)||!d;){i||(o?o<3?(o>1&&(f.n=-1),v(o,l)):f.n=l:f.v=l);try{if(u=2,i){if(o||(a="next"),n=i[a]){if(!(n=n.call(i,l)))throw TypeError("iterator result is not an object");if(!n.done)return n;l=n.value,o<2&&(o=0)}else 1===o&&(n=i.return)&&n.call(i),o<2&&(l=TypeError("The iterator does not provide a '"+a+"' method"),o=1);i=r}else if((n=(d=f.n<0)?l:e.call(t,f))!==s)break}catch(n){i=r,o=1,l=n}finally{u=1}}return{value:n,done:d}}}(e,i,o),!0),c}var s={};function u(){}function c(){}function d(){}n=Object.getPrototypeOf;var f=[][i]?n(n([][i]())):(t(n={},i,function(){return this}),n),v=d.prototype=u.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,o,"GeneratorFunction")),e.prototype=Object.create(v),e}return c.prototype=d,t(v,"constructor",d),t(d,"constructor",c),c.displayName="GeneratorFunction",t(d,o,"GeneratorFunction"),t(v),t(v,o,"Generator"),t(v,i,function(){return this}),t(v,"toString",function(){return"[object Generator]"}),(e=function(){return{w:l,m:m}})()}function t(e,r,n,a){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}t=function(e,r,n,a){function o(r,n){t(e,r,function(e){return this._invoke(r,n,e)})}r?i?i(e,r,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[r]=n:(o("next",0),o("throw",1),o("return",2))},t(e,r,n,a)}function r(e,t,r,n,a,i,o){try{var l=e[i](o),s=l.value}catch(e){return void r(e)}l.done?t(s):Promise.resolve(s).then(n,a)}System.register(["./utils-lib-legacy.js?v=1763689792","./index-legacy109.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./firewall-legacy.js?v=1763689792","./useMethod-legacy8.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./column-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./useStore-legacy6.js?v=1763689792","./validator-legacy.js?v=1763689792","./index-legacy107.js?v=1763689792"],function(t,n){"use strict";var a,i,o,l,s,u,c,d,f,v,m,y,b,p,g,h,x,_,k,w,j,S,O,T,L,P,E,F;return{setters:[function(e){a=e.Q,i=e.bR,o=e.V,l=e.l,s=e.i$,u=e.i5},function(e){c=e._},function(e){d=e.c,f=e.r,v=e.v,m=e.x,y=e.y,b=e.A,p=e.F,g=e.b1,h=e.z,x=e.e,_=e.O,k=e.C,w=e.n,j=e.D,S=e.ay,O=e.L,T=e.B},function(e){L=e.al},function(e){P=e.i,E=e.m,F=e.o},null,null,null,null,null,null],execute:function(){var n={class:"flex"},A={class:"w-[60%] mr-4"},G={class:"flex ml-[0.2rem] mb-[1.6rem]"},C={class:"flex items-center mb-[1.2rem] text-tertiary"},R={class:"border-1 border-lighter rounded-base p-[1.6rem]"},z={key:0,class:"w-full h-[32rem] flex items-center justify-center"},D={class:"border-1 border-lighter rounded-base p-[1.6rem] mt-[1.6rem]"},W={key:0,class:"w-full h-[32rem] flex items-center justify-center"},M={class:"flex-1 ml-4"},N={class:"border-1 border-lighter rounded-base p-[1.6rem]"},I={key:0,class:"w-full h-[24rem]"},q={key:1,class:"w-full h-[24rem] flex items-center justify-center"},B={class:"border-1 border-lighter rounded-base p-[1.6rem] mt-[1.6rem]"},H={class:"w-full h-[24rem]"},Q={class:"border-1 border-lighter rounded-base p-[1.6rem] mt-[1.6rem]"},V={key:0,class:"w-full h-[24rem]"},$={key:1,class:"w-full h-[24rem] flex items-center justify-center"};t("default",d({__name:"index",setup:function(t){var d=f(),J=f(),K=f(),U=f(!1),X=f({}),Y=f([]),Z=f([]),ee=f([]),te=f(),re=f(),ne=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[],r=[],n=[],a=0;a<e.length&&!(a>=5);a++){var i=e[a];r.push(i.site_name),t.push(i.end_time-i.start_time),n.push(i.scans)}return{legend:{left:"left",data:["耗时","检测页面"]},grid:{left:45,top:50,right:15,bottom:20,backgroundColor:"#888"},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(e){return e.length?"检测网站: "+e[0].name+(2===e.length?"</br>耗时: "+u(e[0].value)+"</br>检测页面数量: "+e[1].value:e[0].seriesIndex?"</br>检测页面数量: "+e[0].value:"</br>耗时: "+u(e[0].value)):""}},xAxis:{type:"category",data:r,scale:!0,triggerEvent:!0,axisLabel:{formatter:function(e){return e.length>6?e.substr(0,6)+"...":e}}},yAxis:{type:"value"},series:[{type:"bar",name:"耗时",barWidth:24,data:t,itemStyle:{color:"#fcc858"}},{type:"bar",name:"检测页面",barWidth:24,data:n,itemStyle:{color:"#8dcf6e"}}]}},ae=function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{grid:{left:45,right:15,top:50,bottom:20,backgroundColor:"#888"},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(e){return e[0].name+"</br>风险次数: "+Number(e[0].value||0)}},xAxis:{type:"category",boundaryGap:!1,data:null===(e=Object.keys(r))||void 0===e?void 0:e.map(function(e){return e}).sort(function(e,t){return new Date(e).getTime()<new Date(t).getTime()?-1:1}),axisLabel:{fontSize:10,color:"#666",formatter:function(e){return o(new Date(e).getTime()/1e3,"MM-dd")}}},axisLabel:{fontSize:10,color:"#666"},axisLine:{show:!1},axisTick:{show:!1},yAxis:{type:"value",splitNumber:5,name:"风险次数/次",min:0,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{fontSize:10,color:"#666"}},series:[{type:"line",smooth:.6,data:null===(t=Object.values(r))||void 0===t?void 0:t.map(function(e){return e}),areaStyle:{normal:{}},itemStyle:{normal:{color:"#FF8585",lineStyle:{color:"#FF8585",type:"solid"}}}}]}},ie=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[],r=[],n=0;n<e.length&&!(n>=6);n++){var a=e[n];t.push(a.words),r.push(a.count)}return{grid:{top:10,left:60,right:15,bottom:20,backgroundColor:"#888"},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(e){return"敏感词: "+e[0].name+"</br>次数: "+e[0].value}},xAxis:{type:"value"},yAxis:{type:"category",data:t,scale:!0,triggerEvent:!0,axisLabel:{formatter:function(e){return e.length>4?e.substr(0,4)+"...":e}}},series:[{type:"bar",data:r,barWidth:20,itemStyle:{color:function(e){return["#ffa688","#ffc87d","#98caa5","#acce9b","#cad48f"][e.dataIndex]}}}]}},oe=function(){var t,n=(t=e().m(function t(){var r,n,o;return e().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,a({loading:"正在获取数据，请稍后...",request:L()});case 1:o=e.v,X.value=o.data,Z.value=i(null==o||null===(r=o.data)||void 0===r?void 0:r.site_info,"array",[]),ee.value=i(null==o||null===(n=o.data)||void 0===n?void 0:n.risk_info,"array",[]),Y.value=[{title:"监控网站",value:X.value.site_count},{title:"总风险次数",value:X.value.risk_count},{title:"今日风险次数",value:X.value.day_risk},{title:"今日巡检次数",value:X.value.today_count}],w(function(){var e,t;te.value=null==o?void 0:o.data["7day_risk"],U.value=!(null!=o&&null!==(e=o.data)&&void 0!==e&&e.sensitive_word.length),re.value=null==o||null===(t=o.data)||void 0===t?void 0:t.sensitive_word});case 2:return e.a(2)}},t)}),function(){var e=this,n=arguments;return new Promise(function(a,i){var o=t.apply(e,n);function l(e){r(o,a,i,l,s,"next",e)}function s(e){r(o,a,i,l,s,"throw",e)}l(void 0)})});return function(){return n.apply(this,arguments)}}(),le=[{label:"巡检时间",prop:"time",render:function(e){var t=i(e.time,"number",0);return x("span",null,[o(t)])}},{label:"检测域名",prop:"site_name"},{label:"检测方式",prop:"method",render:function(e){return E[e.method]}},{label:"检测页面数",prop:"scans"},{label:"巡检结果",render:function(e){return[0===e.risks?x("span",{class:"text-primary"},[j("无风险 ")]):x("span",{class:"bt-link !text-danger",onClick:function(){return F(e)}},[e.risks])]}}],se=P();return v(oe),function(e,t){var r=S,a=l,i=c,o=s;return m(),y("div",n,[b("div",A,[b("div",G,[(m(!0),y(p,null,g(h(Y),function(e,t){return m(),y("div",{key:t,class:O("block-bg "+(t>0?"ml-[5rem]":""))},[b("div",C,[b("span",null,T(e.title),1)]),b("div",{class:O("font-bold text-extraLarge leading-none "+(0!==t&&3!==t&&e.value>0?"text-warning":"text-secondary"))},T(e.value),3)],2)}),128))]),b("div",R,[t[0]||(t[0]=b("div",{class:"card_title flex items-center text-secondary text-base mb-[1.2rem]"},"网站内容检测",-1)),0===h(Z).length?(m(),y("div",z,[x(r,{description:"网站内容检测为空"})])):(m(),_(i,{key:1},{content:k(function(){return[x(a,{"max-height":"320",column:le,data:h(Z)},null,8,["data"])]}),_:1}))]),b("div",D,[t[1]||(t[1]=b("div",{class:"card_title flex items-center text-secondary text-base mb-[1.2rem]"},"风险动态",-1)),0===h(ee).length?(m(),y("div",W,[x(r,{description:"风险动态为空"})])):(m(),_(i,{key:1},{content:k(function(){return[x(a,{"max-height":"320",column:h(se),data:h(ee)},null,8,["column","data"])]}),_:1}))])]),b("div",M,[b("div",N,[t[2]||(t[2]=b("div",{class:"card_title flex items-center text-secondary text-base mb-[1.2rem]"},"风险历史",-1)),h(Z).length?(m(),y("div",I,[x(o,{ref_key:"riskEchartRef",ref:d,options:ne(h(Z))},null,8,["options"])])):(m(),y("div",q,[x(r,{description:"风险历史数据为空"})]))]),b("div",B,[t[3]||(t[3]=b("div",{class:"card_title flex items-center text-secondary text-base mb-[1.2rem]"},"近7日巡检情况",-1)),b("div",H,[x(o,{ref_key:"dayRiskEchartRef",ref:J,options:ae(h(te))},null,8,["options"])])]),b("div",Q,[t[4]||(t[4]=b("div",{class:"card_title flex items-center text-secondary text-base mb-[1.2rem]"},"敏感词排行",-1)),h(U)?(m(),y("div",$,[x(r,{description:"敏感词排行数据为空"})])):(m(),y("div",V,[x(o,{ref_key:"sensitiveWordEchartRef",ref:K,options:ie(h(re))},null,8,["options"])]))])])])}}}))}}})}();
