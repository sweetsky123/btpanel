!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function n(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.toStringTag||"@@toStringTag";function o(n,a,i,l){var o=a&&a.prototype instanceof c?a:c,u=Object.create(o.prototype);return r(u,"_invoke",function(n,r,a){var i,l,o,c=0,u=a||[],f=!1,d={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return i=t,l=0,o=e,d.n=n,s}};function m(n,r){for(l=n,o=r,t=0;!f&&c&&!a&&t<u.length;t++){var a,i=u[t],m=d.p,p=i[2];n>3?(a=p===r)&&(o=i[(l=i[4])?5:(l=3,3)],i[4]=i[5]=e):i[0]<=m&&((a=n<2&&m<i[1])?(l=0,d.v=r,d.n=i[1]):m<p&&(a=n<3||i[0]>r||r>p)&&(i[4]=n,i[5]=r,d.n=p,l=0))}if(a||n>1)return s;throw f=!0,r}return function(a,u,p){if(c>1)throw TypeError("Generator is already running");for(f&&1===u&&m(u,p),l=u,o=p;(t=l<2?e:o)||!f;){i||(l?l<3?(l>1&&(d.n=-1),m(l,o)):d.n=o:d.v=o);try{if(c=2,i){if(l||(a="next"),t=i[a]){if(!(t=t.call(i,o)))throw TypeError("iterator result is not an object");if(!t.done)return t;o=t.value,l<2&&(l=0)}else 1===l&&(t=i.return)&&t.call(i),l<2&&(o=TypeError("The iterator does not provide a '"+a+"' method"),l=1);i=e}else if((t=(f=d.n<0)?o:n.call(r,d))!==s)break}catch(t){i=e,l=1,o=t}finally{c=1}}return{value:t,done:f}}}(n,i,l),!0),u}var s={};function c(){}function u(){}function f(){}t=Object.getPrototypeOf;var d=[][i]?t(t([][i]())):(r(t={},i,function(){return this}),t),m=f.prototype=c.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,r(e,l,"GeneratorFunction")),e.prototype=Object.create(m),e}return u.prototype=f,r(m,"constructor",f),r(f,"constructor",u),u.displayName="GeneratorFunction",r(f,l,"GeneratorFunction"),r(m),r(m,l,"Generator"),r(m,i,function(){return this}),r(m,"toString",function(){return"[object Generator]"}),(n=function(){return{w:o,m:p}})()}function r(e,t,n,a){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}r=function(e,t,n,a){function l(t,n){r(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(l("next",0),l("throw",1),l("return",2))},r(e,t,n,a)}function a(e,t,n,r,a,i,l){try{var o=e[i](l),s=o.value}catch(e){return void n(e)}o.done?t(s):Promise.resolve(s).then(r,a)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var l=e.apply(t,n);function o(e){a(l,r,i,o,s,"next",e)}function s(e){a(l,r,i,o,s,"throw",e)}o(void 0)})}}System.register(["./base-lib-legacy.js?v=1763689792","./store-legacy6.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./validator-legacy.js?v=1763689792","./site-legacy.js?v=1763689792","./index-legacy344.js?v=1763689792","./column-legacy.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./index-legacy107.js?v=1763689792"],function(t,r){"use strict";var a,l,o,s,c,u,f,d,m,p,v,y,g,b,h,_,x,w,k,S,j,A,D,O,T,V,C,I,L,P,E,M,z,G,H,U,F,N,B,Q,W,q,R,$,J,K,X,Y,Z,ee,te,ne,re;return{setters:[function(e){a=e.c,l=e.g,o=e.x,s=e.y,c=e.A,u=e.D,f=e.B,d=e.z,m=e.G,p=e.L,v=e.s,y=e.F,g=e.b1,b=e.e,h=e.b2,_=e.o,x=e.b8,w=e.C,k=e.aT,S=e.r,j=e.I,A=e.J,D=e.R,O=e.aD,T=e.aF,V=e.bP,C=e.bO,I=e.w,L=e.n,P=e.bc,E=e.bd},function(e){M=e.H},function(e){z=e._,G=e.u,H=e.p,U=e.Q,F=e.n,N=e.H,B=e.M,Q=e.bK,W=e.aw,q=e.V,R=e.l,$=e.j},function(e){J=e.c$,K=e.d7,X=e.d8,Y=e.l,Z=e.d9,ee=e.da},function(e){te=e.getPluginInfo},function(e){ne=e.H},function(e){re=e.u},null,null,null],execute:function(){var ae={class:"risk-chart"},ie={class:"circle-box"},le={class:"circle-box-inner"},oe={class:"circle-box-value"},se={class:"circle-box-desc"},ce={class:"flex-1 ml-[2rem] mr-[4rem] mt-[2rem]"},ue={key:0,class:"mb-[1rem]"},fe=z(a({__name:"totalScore",setup:function(e){var t=M().scoreData,n=[{color:"var(--el-color-danger)",percentage:60,type:"danger"},{color:"var(--el-color-warning)",percentage:80,type:"warn"},{color:"var(--el-color-warning-light-3)",percentage:90,type:"alert"},{color:"var(--el-color-primary)",percentage:100,type:"safe"}],r=l(function(){return n.find(function(e){return t.score<e.percentage})});return function(e,n){var a;return o(),s("div",{class:p(["flex mt-[2rem] ml-[1rem] items-center","circle-".concat(null===(a=d(r))||void 0===a?void 0:a.type)])},[c("div",ae,[c("div",ie,[n[1]||(n[1]=c("div",{class:"circle-box-bg"},null,-1)),c("div",le,[c("div",oe,[u(f(d(t).score)+" ",1),n[0]||(n[0]=c("div",{class:"unit"},"分",-1))]),c("div",se,f(d(t).scoreLevel),1)])])]),c("div",ce,[d(t).riskNum>0?(o(),s("div",ue,[n[2]||(n[2]=u(" 发现",-1)),c("span",null,f(d(t).riskNum),1),n[3]||(n[3]=u("条风险 ",-1))])):m("",!0),n[4]||(n[4]=c("template",null,[c("div",{class:"mb-[1rem]"},"无风险")],-1)),c("p",null,f(d(t).subtitle),1)])],2)}}}),[["__scopeId","data-v-d8c72a17"]]),de={class:"flex items-center justify-between text-small"},me={class:"text-iconLarge mx-[0.4rem] text-primary"},pe={class:"leading-[2rem]"},ve={class:"flex items-center"},ye={class:"flex ml-[0.6rem]"},ge={class:"mr-[0.1rem]"},be=["title","src"],he={class:"flex ml-[1rem] text-base text-bold"},_e={class:"flex items-center mr-[2rem]"},xe={class:"flex items-center mr-[2rem]"},we={class:"flex items-center"},ke=a({__name:"defenseInfo",setup:function(e){G();var t=M(),a=t.capabilitySwitch,l=v(t),m=l.safeDay,p=l.scanTime,_=l.virusUpdateTime,x=l.isMalwareConfirm,w=function(){var e=i(n().m(function e(t){var r,i;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=t?"开启":"关闭",i=t?"将全天候检测系统是否存在恶意文件":"将不再检测系统是否存在恶意文件",e.p=1,e.n=2,H({title:"".concat(r,"动态查杀"),content:"".concat(r,"后，").concat(i,"，是否继续？")});case 2:return a.file_detection.status=t,e.n=3,U({loading:"正在保存配置，请稍后...",request:J({dynamic_detection:t}),message:!0});case 3:e.n=5;break;case 4:e.p=4,e.v,a.file_detection.status=!t;case 5:return e.a(2)}},e,null,[[1,4]])}));return function(t){return e.apply(this,arguments)}}(),k=function(){F({title:"设置自动扫描",area:54,component:function(){return N(function(){return r.import("./index-legacy523.js?v=1763689792")},void 0,r.meta.url)},showFooter:!0,close:function(){x.value?x.value=!1:a.vul_scan.status=!a.vul_scan.status}})},S=function(){var e=i(n().m(function e(t){var r,l,o;return n().w(function(e){for(;;)switch(e.n){case 0:if(o=function(){return(o=i(n().m(function e(){var t;return n().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,K();case 1:t=e.v,B.request(t);case 2:return e.a(2)}},e)}))).apply(this,arguments)},l=function(){return o.apply(this,arguments)},!t){e.n=5;break}return e.n=1,te({sName:"bt_hids"});case 1:if(r=e.v,!r.data.setup){e.n=3;break}return e.n=2,l();case 2:e.n=4;break;case 3:B.error("请先安装入侵检测插件"),a.hids.status=!1;case 4:e.n=6;break;case 5:return e.n=6,l();case 6:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();return function(e,t){var n=h,r=Q;return o(),s("div",null,[c("div",de,[c("div",null,[t[3]||(t[3]=u(" 已累计保护您的资产",-1)),c("strong",me,f(d(m)),1),t[4]||(t[4]=u("天 ",-1))]),c("div",pe,[c("div",ve,[t[5]||(t[5]=c("span",null,"已开启安全能力",-1)),c("ul",ye,[(o(!0),s(y,null,g(d(a),function(e,t){return o(),s("li",ge,[c("img",{alt:"",title:e.name,src:"/static/images/home/".concat(e.icon).concat(e.status?"-active":"",".svg"),width:"14"},null,8,be)])}),256))])]),c("div",null,"首页风险扫描时间："+f(d(p)),1),c("div",null,"病毒库版本更新时间："+f(d(_)),1)])]),b(n,{direction:"horizontal",class:"!mb-[1.8rem] !mt-0"}),c("div",he,[c("div",_e,[t[6]||(t[6]=c("span",{class:"mr-2"},"恶意文件检测",-1)),b(r,{size:"small",modelValue:d(a).file_detection.status,"onUpdate:modelValue":t[0]||(t[0]=function(e){return d(a).file_detection.status=e}),onChange:w},null,8,["modelValue"])]),c("div",xe,[t[7]||(t[7]=c("span",{class:"mr-2"},"漏洞扫描",-1)),b(r,{size:"small",modelValue:d(a).vul_scan.status,"onUpdate:modelValue":t[1]||(t[1]=function(e){return d(a).vul_scan.status=e}),onChange:k},null,8,["modelValue"])]),c("div",we,[t[8]||(t[8]=c("span",{class:"mr-2"},"入侵检测",-1)),b(r,{size:"small",modelValue:d(a).hids.status,"onUpdate:modelValue":t[2]||(t[2]=function(e){return d(a).hids.status=e}),onChange:S},null,8,["modelValue"])])])])}}}),Se={class:"my-10"},je={class:"flex h-[3.2rem]"},Ae={class:"text-iconLarge mr-[2rem]"},De={class:"flex items-end alertNum"},Oe={class:"bg-danger"},Te={class:"bg-warning"},Ve={class:"bg-darkTertiary"},Ce=a({__name:"pendingAlarm",setup:function(e,t){var r=t.expose,a=_({total:0,high_risk:0,medium_risk:0,low_risk:0}),l=x({tooltip:{trigger:"axis",axisPointer:{type:"line",lineStyle:{width:1,type:"solid"}}},grid:{top:"16%",left:"-8%",right:"0%",bottom:"0%",containLabel:!1},xAxis:{data:[],show:!1},yAxis:{show:!1},series:[]}),u=W({options:{}}),m=u.BtECharts,p=(u.getEChart,u.setOption),v=(u.setQuickOption,function(){return[{name:"风险数量",type:"line",data:arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0,0,0,0],itemStyle:{color:"#ec958d"},smooth:!0,showSymbol:!1,sampling:"average",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"#fcdcd5"},{offset:1,color:"#fcdcd5"}]}}}]}),y=function(){var e=i(n().m(function e(){var t,r,i,o;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,X();case 1:t=e.v,r=t.data,i=r.trend_list.map(function(e){return q(e.timestamp)}),o=r.trend_list.map(function(e){return e.count}),l.xAxis={data:i,show:!1},l.series=v(o),a.total=r.total,a.high_risk=r.high_risk,a.medium_risk=r.medium_risk,a.low_risk=r.low_risk,p(l),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}();return r({setData:y}),function(e,t){return o(),s("div",Se,[t[0]||(t[0]=c("div",null,"待处理风险",-1)),c("div",je,[c("span",Ae,f(d(a).total),1),c("div",De,[c("span",Oe,f(d(a).high_risk),1),c("span",Te,f(d(a).medium_risk),1),c("span",Ve,f(d(a).low_risk),1)])]),b(d(m),{style:{height:"60px"}})])}}}),Ie=z(Ce,[["__scopeId","data-v-b2bac4f2"]]),Le={class:"flex flex-wrap mt-4"},Pe={class:"flex flex-col items-center w-[11rem] mb-[1rem]"},Ee=["onClick"],Me=z(a({__name:"pendingRisk",setup:function(t){var n=M(),r=v(n).risk_details,a=n.riskInstallDetails,i=v(ne()).repairTypeActive;return function(t,n){var l=k;return o(),s("div",Le,[(o(!0),s(y,null,g(d(r),function(t,r){return o(),s("div",Pe,[c("div",null,[c("span",null,f(t.title),1),b(l,{content:t.tips,placement:"top"},{default:w(function(){return e(n[0]||(n[0]=[c("span",{class:"ml-4px bt-ico-ask"},"?",-1)]))}),_:1},8,["content"])]),c("div",{class:p(["text-subtitleLarge cursor-pointer",t.value>0?"text-default":"text-secondary"]),onClick:function(e){return function(e){switch(e.type){case"vul_scan":i.value="web";break;case"file_detection":i.value="malware";break;case"homepage_risk":i.value="risk";break;case"safe_detect":i.value="safeDetect";break;case"hids":if(!a.hids)return B.error("请先安装入侵检测插件");Y({name:"bt_hids"});break;case"tamper":if(!a.tamper)return B.error("请先安装堡塔企业级防篡改插件");Y({name:"tamper_core"})}}(t)}},f(t.value),11,Ee)])}),256))])}}}),[["__scopeId","data-v-ca9a2035"]]),ze={class:""},Ge=a({__name:"securityTrend",setup:function(t,r){var a=r.expose,l=x({tooltip:{trigger:"axis",axisPointer:{type:"shadow",label:{show:!0}}},legend:{bottom:0,itemWidth:12,itemHeight:10,itemGap:10,textStyle:{fontSize:10,color:"#666666"},data:[]},grid:{top:"4%",right:"10%",bottom:"24%"},xAxis:[{type:"category",axisTick:{alignWithLabel:!0},axisLabel:{textStyle:{color:"#666666"}},data:[]}],yAxis:[{type:"value",min:0,axisLabel:{textStyle:{color:"#666666"}}}],series:[]}),u=W({options:{}}),f=u.BtECharts,m=(u.getEChart,u.setOption),p=(u.setQuickOption,function(e){return[{name:e,type:"line",lineStyle:{normal:{}},smooth:!0,showSymbol:!1,sampling:"average",data:arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]}]}),v=function(e){return[{name:e,type:"bar",barWidth:"8px",itemStyle:{normal:{color:arguments.length>2?arguments[2]:void 0}},data:arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]}]},y=function(){var t=i(n().m(function t(){var r,a,i,o,s,c,u;return n().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,Z();case 1:r=t.v,a=r.data,i=[],o=[],s=[],c=[],u=[],a.trend_list.forEach(function(e){i.push(e.unhandled_risks),o.push(e.handled_risks),s.push(e.risk_scan),c.push(e.vul_scan),u.push(e.server_risks)}),l.xAxis[0].data=a.trend_list.map(function(e){return q(e.timestamp,"MM/dd")}),l.series=[].concat(e(p("未处理风险",i,"rgb(255,221,214,1)")),e(p("已处理风险",o,"var(--el-color-primary)")),e(v("首页",s,"rgb(29, 159, 234, 1)")),e(v("漏洞",c,"rgb(30,67,180,1)")),e(v("基线",u,"rgb(70,44,104,1)"))),l.legend.data=["未处理风险","已处理风险","首页","漏洞","基线"],m(l),t.n=3;break;case 2:t.p=2,t.v;case 3:return t.a(2)}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}();return a({setData:y}),function(e,t){return o(),s("div",ze,[t[0]||(t[0]=c("div",{class:"h-[4rem] leading-[4rem]"},"安全趋势",-1)),b(d(f),{class:"!h-[20rem]"})])}}}),He={class:"p-[2rem]"},Ue=a({__name:"securityDynamic",setup:function(e,t){var r=t.expose,a=S("safeDynamic"),l=S(!1),m=S({type:"",behavior:"",level:0,time:"",scan_type:"",description:"",solution:""}),p=S({total:0,loading:!1,data:[]}),v=[{label:"风险行为",prop:"description",render:function(e){return b("span",{class:"truncate !w-[12rem]",title:e.description},[e.description])}},{label:"风险等级",prop:"level",width:64,render:function(e){var t=y(e.level),n=t.text,r=t.style;return b("span",{style:r},[u("["),n,u("]")])}},{label:"发现时间",prop:"time",width:64,render:function(e){return q(e.time,"MM-dd")}},re([{onClick:function(e){l.value=!0,m.value=e},title:"详情"}])],y=function(e){switch(e){case 2:return{text:"中危",style:"color: var(--el-color-warning-light-3)"};case 3:return{text:"高危",style:"color: var(--el-color-danger)"};case 4:return{text:"紧急",style:"color: var(--el-color-danger-dark-2)"};default:return{text:"--",style:"color: var(--el-color-black)"}}},g=function(){var e=i(n().m(function e(){var t,r;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return p.value.loading=!0,e.p=1,e.n=2,ee();case 2:t=e.v,r=t.data,p.value.data=r.events;case 3:return e.p=3,p.value.loading=!1,e.f(3);case 4:return e.a(2)}},e,null,[[1,,3,4]])}));return function(){return e.apply(this,arguments)}}();return r({getListData:g}),function(e,t){var n=R,r=O,i=T,g=V,h=C,_=$,x=j("bt-loading");return o(),s("div",null,[b(i,{modelValue:d(a),"onUpdate:modelValue":t[0]||(t[0]=function(e){return D(a)?a.value=e:null}),class:"dynamic-tabs"},{default:w(function(){return[b(r,{label:"安全动态",name:"safeDynamic"},{default:w(function(){return[A(b(n,{ref:"malwareTable",column:v,data:d(p).data,"max-height":"185"},null,8,["data"]),[[x,d(p).loading],[x,"正在获取安全动态列表，请稍后...","title"]])]}),_:1})]}),_:1},8,["modelValue"]),b(_,{title:"【".concat(d(m).scan_type,"】详情"),modelValue:d(l),"onUpdate:modelValue":t[1]||(t[1]=function(e){return D(l)?l.value=e:null}),area:53},{default:w(function(){return[c("div",He,[b(h,{column:2,size:"small",border:"",class:"table-descriptions"},{default:w(function(){return[b(g,{label:"风险行为："},{default:w(function(){return[u(f(d(m).behavior),1)]}),_:1}),b(g,{label:"风险等级："},{default:w(function(){return[u(f(y(d(m).level).text),1)]}),_:1}),b(g,{label:"发现时间："},{default:w(function(){return[u(f(d(q)(d(m).time,"yyyy-MM-dd HH:mm:ss")),1)]}),_:1}),b(g,{label:"扫描类型："},{default:w(function(){return[u(f(d(m).scan_type),1)]}),_:1}),b(g,{label:"描述：",span:2},{default:w(function(){return[u(f(d(m).description),1)]}),_:1}),b(g,{label:"解决方案：",span:2},{default:w(function(){return[u(f(d(m).solution),1)]}),_:1})]}),_:1})])]}),_:1},8,["title","modelValue"])])}}}),Fe=z(Ue,[["__scopeId","data-v-df55157c"]]);t("default",a({__name:"index",setup:function(e){var t=ne(),n=M(),r=v(t).repairTypeActive,a=S(),i=S(),l=S();return I(r,function(e){"overview"===e&&L(function(){n.getSafeOverviewData(),a.value.setData(),i.value.setData(),l.value.getListData()})},{immediate:!0}),function(e,t){var n=P,r=E,u=h;return o(),s("section",null,[t[0]||(t[0]=c("div",{class:"text-large mb-6"},"安全总览",-1)),b(r,null,{default:w(function(){return[b(n,{span:13},{default:w(function(){return[b(fe)]}),_:1}),b(n,{span:11},{default:w(function(){return[b(ke)]}),_:1})]}),_:1}),b(r,null,{default:w(function(){return[b(n,{span:13},{default:w(function(){return[b(Ie,{ref_key:"pendingAlarm",ref:a},null,512)]}),_:1}),b(n,{span:11},{default:w(function(){return[b(Me)]}),_:1})]}),_:1}),b(u,{direction:"horizontal",class:"!my-0"}),b(r,null,{default:w(function(){return[b(n,{span:14},{default:w(function(){return[b(Ge,{ref_key:"securityTrend",ref:i},null,512)]}),_:1}),b(n,{span:10},{default:w(function(){return[b(Fe,{ref_key:"securityDynamic",ref:l},null,512)]}),_:1})]}),_:1})])}}}))}}})}();
