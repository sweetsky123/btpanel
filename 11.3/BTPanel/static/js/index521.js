import{u as t,n as e,H as a,l,k as o,j as n,b as i,p as s,Q as r}from"./utils-lib.js?v=1763689792";import{_ as c}from"./index124.js?v=1763689792";import{_ as p}from"./index109.js?v=1763689792";import{c as d,r as u,o as m,e as _,D as f,v as w,I as h,x as y,y as b,z as g,O as v,C as j,J as k,A as V,R as x,H as P,ad as C,ab as D}from"./base-lib.js?v=1763689792";import{_ as E}from"./index130.js?v=1763689792";import{d as O,u as A}from"./column.js?v=1763689792";import{getSingleSiteContentMonitorList as R,searchFiles as S,delContentMonitorInfo as T,scanning as I}from"./site.js?v=1763689792";import{u as L}from"./useStore4.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./validator.js?v=1763689792";import"./index110.js?v=1763689792";import"./index107.js?v=1763689792";const F={class:"p-[20px]"},U={class:"p-[20px]"},H=d({__name:"index",props:{compData:{default:{}}},setup(d){const{siteInfo:H}=L(),J=i(),{payment:N}=t(),q=u([]),z=u(!1),Q=m({word:""}),B=u([O(),{label:"违规词",prop:"key"}]),G=u([]),K=u(!1),M=u(!1),W=u(!1),X=u(),Y=m({title:"违规词检测-功能介绍",ps:"违规词检测能帮助检测网站内容中的合法及非法字段，并输出对应的检测结果，利用图表充分展示各个域名的风险历史、检测情况、敏感词排行等，并实时输出风险动态。",source:111,desc:["违规词内容检测","网页内容修改检测","输出检测报告"],tabImgs:[{title:"概览",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/content_detect_detail_1.png"},{title:"监控列表",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/content_detect_detail_2.png"},{title:"检测历史",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/content_detect_detail_3.png"},{title:"风险列表",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/content_detect_detail_4.png"},{title:"检测报告",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/firewall/content_detect_detail_5.png"}]}),Z=async()=>{if("ltd"===N.value.authType){z.value=!0;try{const t=await R({site_name:H.value.name});q.value=t.data}catch(t){}finally{z.value=!1}}},$=async()=>{tt({...H.value,id:!1})},tt=t=>{e({title:"".concat(t.id?"编辑":"添加","监控").concat(t.id?"【".concat(t.name,"】"):""),area:68,showFooter:!0,compData:{...t,refreshEvent:Z,isSite:!0},component:()=>a(()=>import("./add-monitor2.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},et=()=>{e({isAsync:!0,title:"自定义词库",area:[44,39],component:()=>a(()=>import("./own-thesaurus2.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},at=()=>{e({isAsync:!0,title:"检测历史",area:80,component:()=>a(()=>import("./detect-history.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:{isPopup:!0,...H.value}})},lt=()=>{e({isAsync:!0,title:"风险列表",area:80,component:()=>a(()=>import("./risk-list.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:{isPopup:!0}})},ot=()=>{var t;null==(t=X.value)||t.resetFields(),M.value=!1},nt=async()=>{let t=J.load("正在扫描，请稍后...");try{const t=await S({search:Q.word,path:H.value.path});G.value=t.data.result.map(t=>({path:t.name,key:Q.word})),ot(),W.value=!0}catch(e){}finally{M.value=!1,t.close()}},it=u([{label:"监控名称",prop:"name",showOverflowTooltip:!0},{label:"网站/URL",prop:"url"},{label:"状态",prop:"content",render:t=>{if(1===t.crontab_status)return"正常"}},{label:"发送告警",prop:"send_msg",render:t=>1===t.send_msg?_("span",{class:"text-primary"},[f("已开启")]):"未开启"},{label:"检测频率",prop:"crontab_info.cycle",showOverflowTooltip:!0},A([{onClick:async t=>{try{const l=J.load("正在检测，请稍后..."),o=await I({data:JSON.stringify({id:t.id})}),n={name:t.name,id:t.id,path_info:o.data.path_info};l.close(),e({title:"检测日志",area:[64,50],btn:["停止检测"],component:()=>a(()=>import("./scan-details2.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:n,showFooter:!0})}catch(l){}},title:"检测"},{onClick:t=>{tt(t)},title:"编辑"},{onClick:async t=>{await s({title:"删除违规词检测",content:"删除后无法继续监控该网站，是否继续？"}),r({loading:"正在删除，请稍后...",request:T({data:JSON.stringify({id:t.id})}),message:!0,success:t=>{t.status&&Z()}})},title:"删除"}])]);return w(()=>{Z()}),(t,e)=>{const a=P,i=E,s=l,r=o,d=C,u=D,m=n,w=p,O=c,A=h("bt-loading");return y(),b("div",null,["ltd"===g(N).authType?(y(),v(w,{key:0},{"header-left":j(()=>[_(a,{type:"primary",onClick:$},{default:j(()=>[...e[4]||(e[4]=[f("添加监控",-1)])]),_:1}),_(a,{type:"default",onClick:e[0]||(e[0]=t=>M.value=!0)},{default:j(()=>[...e[5]||(e[5]=[f(" 自定义扫描 ",-1)])]),_:1}),_(a,{type:"default",onClick:et},{default:j(()=>[...e[6]||(e[6]=[f(" 自定义词库 ",-1)])]),_:1}),_(a,{type:"default",onClick:at},{default:j(()=>[...e[7]||(e[7]=[f(" 检测历史 ",-1)])]),_:1}),_(a,{type:"default",onClick:lt},{default:j(()=>[...e[8]||(e[8]=[f("风险列表",-1)])]),_:1})]),"header-right":j(()=>[_(i,{onRefresh:Z})]),content:j(()=>[k(_(s,{column:g(it),data:g(q)},null,8,["column","data"]),[[A,g(z)]])]),popup:j(()=>[_(m,{title:"自定义扫描",modelValue:g(M),"onUpdate:modelValue":e[2]||(e[2]=t=>x(M)?M.value=t:null),area:42,onConfirm:nt,onCancel:ot,showFooter:""},{default:j(()=>[V("div",F,[_(u,{"label-position":"right",model:g(Q),ref_key:"scanRef",ref:X},{default:j(()=>[_(d,{label:"扫描违规词",prop:"word"},{default:j(()=>[_(r,{modelValue:g(Q).word,"onUpdate:modelValue":e[1]||(e[1]=t=>g(Q).word=t),placeholder:"请输入要扫描的词汇",width:"24rem"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"]),_(m,{title:"扫描结果",modelValue:g(W),"onUpdate:modelValue":e[3]||(e[3]=t=>x(W)?W.value=t:null),area:52},{default:j(()=>[V("div",U,[_(w,null,{content:j(()=>[k(_(s,{column:g(B),data:g(G),"max-height":400},null,8,["column","data"]),[[A,g(K)]])]),_:1})])]),_:1},8,["modelValue"])]),_:1})):(y(),v(O,{key:1,data:g(Y),class:""},null,8,["data"]))])}}});export{H as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
