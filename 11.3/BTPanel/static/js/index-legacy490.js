!function(){function n(n){return function(n){if(Array.isArray(n))return t(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,e){if(n){if("string"==typeof n)return t(n,e);var r={}.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(n,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=Array(t);e<t;e++)r[e]=n[e];return r}function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var n,t,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",u=a.toStringTag||"@@toStringTag";function c(e,a,o,u){var c=a&&a.prototype instanceof l?a:l,s=Object.create(c.prototype);return r(s,"_invoke",function(e,r,a){var o,u,c,l=0,s=a||[],f=!1,p={p:0,n:0,v:n,a:v,f:v.bind(n,4),d:function(t,e){return o=t,u=0,c=n,p.n=e,i}};function v(e,r){for(u=e,c=r,t=0;!f&&l&&!a&&t<s.length;t++){var a,o=s[t],v=p.p,d=o[2];e>3?(a=d===r)&&(c=o[(u=o[4])?5:(u=3,3)],o[4]=o[5]=n):o[0]<=v&&((a=e<2&&v<o[1])?(u=0,p.v=r,p.n=o[1]):v<d&&(a=e<3||o[0]>r||r>d)&&(o[4]=e,o[5]=r,p.n=d,u=0))}if(a||e>1)return i;throw f=!0,r}return function(a,s,d){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&v(s,d),u=s,c=d;(t=u<2?n:c)||!f;){o||(u?u<3?(u>1&&(p.n=-1),v(u,c)):p.n=c:p.v=c);try{if(l=2,o){if(u||(a="next"),t=o[a]){if(!(t=t.call(o,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,u<2&&(u=0)}else 1===u&&(t=o.return)&&t.call(o),u<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),u=1);o=n}else if((t=(f=p.n<0)?c:e.call(r,p))!==i)break}catch(t){o=n,u=1,c=t}finally{l=1}}return{value:t,done:f}}}(e,o,u),!0),s}var i={};function l(){}function s(){}function f(){}t=Object.getPrototypeOf;var p=[][o]?t(t([][o]())):(r(t={},o,function(){return this}),t),v=f.prototype=l.prototype=Object.create(p);function d(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,r(n,u,"GeneratorFunction")),n.prototype=Object.create(v),n}return s.prototype=f,r(v,"constructor",f),r(f,"constructor",s),s.displayName="GeneratorFunction",r(f,u,"GeneratorFunction"),r(v),r(v,u,"Generator"),r(v,o,function(){return this}),r(v,"toString",function(){return"[object Generator]"}),(e=function(){return{w:c,m:d}})()}function r(n,t,e,a){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}r=function(n,t,e,a){function u(t,e){r(n,t,function(n){return this._invoke(t,e,n)})}t?o?o(n,t,{value:e,enumerable:!a,configurable:!a,writable:!a}):n[t]=e:(u("next",0),u("throw",1),u("return",2))},r(n,t,e,a)}function a(n,t,e,r,a,o,u){try{var c=n[o](u),i=c.value}catch(n){return void e(n)}c.done?t(i):Promise.resolve(i).then(r,a)}function o(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var u=n.apply(t,e);function c(n){a(u,r,o,c,i,"next",n)}function i(n){a(u,r,o,c,i,"throw",n)}c(void 0)})}}System.register(["./index-legacy109.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./index-legacy119.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./column-legacy.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./ace-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792"],function(t,r){"use strict";var a,u,c,i,l,s,f,p,v,d,m,h,y,g,b,w,x,_,j,k,C,O,T,S,I,A,E,F,q,G,P,V,z,D;return{setters:[function(n){a=n._},function(n){u=n.p,c=n.Q,i=n.b8,l=n.ho,s=n.cO,f=n.d,p=n.l,v=n.ah,d=n.j,m=n.ay,h=n.iT,y=n.b},function(n){g=n.B},function(n){b=n.c,w=n.r,x=n.o,_=n.v,j=n.x,k=n.y,C=n.A,O=n.z,T=n.e,S=n.G,I=n.O,A=n.D,E=n.B,F=n.C,q=n.R,G=n.H,P=n.b2},function(n){V=n.a,z=n.u,D=n.c},null,null,null],execute:function(){var r={class:"p-[2rem]"},U={class:"title-box flex items-center justify-between"},B={class:"flex items-center"},H={key:0,class:"scan-icon relative h-[8rem] w-[8rem]"},M={class:"scan-title flex flex-col items-start ml-[2rem]"},N={class:"font-bold text-large text-default"},J={class:"text-danger"},Q={class:"text-small text-secondary mt-[1.2rem]"},R={class:"flex items-center ml-[1.2rem]"},$={class:"p-[2rem]"};t("default",b({__name:"index",props:{compData:{default:function(){}}},setup:function(t){var b,K,L,W,X,Y,Z=t,nn=y(),tn=w("loading"),en=w(!1),rn=w(""),an={},on=null,un=x({scanInfo:"",scanCount:0,scanningCount:0,scanningText:"进行中"}),cn=w(),ln=w([]),sn=function(){var n=o(e().m(function n(t,r,a,u){var c,i,l;return e().w(function(n){for(;;)switch(n.n){case 0:return c=u.label,i=u.value,l=function(){var n=o(e().m(function n(t,r){var a,o,u;return e().w(function(n){for(;;)switch(n.n){case 0:a=t.path,u=i,n.n="delete"===u?1:3;break;case 1:return n.n=2,h({path:a,type:"File"});case 2:return(o=n.v).status&&(ln.value=ln.value.filter(function(n){return n.path!==a})),n.a(2,o);case 3:return n.a(2)}},n)}));return function(t,e){return n.apply(this,arguments)}}(),n.n=1,t({title:"批量".concat(c,"文件"),content:"批量".concat(c,"已选的文件，是否继续操作！"),column:[{label:"文件名",prop:"name"},D()],onConfirm:function(){var n=o(e().m(function n(){return e().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,r(l);case 1:return n.a(2,!1)}},n)}));return function(){return n.apply(this,arguments)}}()});case 1:return n.a(2)}},n)}));return function(t,e,r,a){return n.apply(this,arguments)}}(),fn=[{label:"删除",value:"delete",event:sn}],pn=function(){on=m({route:"/ws_panel",onMessage:vn})},vn=function(n,t){var e;if("token error"===t.data)return nn.error("token error"),void(null===(e=on)||void 0===e||e.close());var r,a=JSON.parse(t.data);(un.scanInfo=a.info,a.is_count&&(un.scanCount=a.count,un.scanningCount=a.is_count),a.path&&ln.value.push({path:a.path,name:a.path.substring(a.path.lastIndexOf("/")+1)}),a.result)&&(tn.value="success",un.scanningText="已完成",un.scanInfo="扫描已完成",un.scanningCount=un.scanCount,a.result.length>0&&(tn.value="danger"),null===(r=on)||void 0===r||r.close())},dn=function(){var n=o(e().m(function n(){var t;return e().w(function(n){for(;;)switch(n.n){case 0:ln.value=[],pn(),tn.value="loading",un.scanningText="进行中",null===(t=on)||void 0===t||t.send({def_name:"ws_webshell_check",mod_name:"files",path:Z.compData.row.path,ws_callback:"1"});case 1:return n.a(2)}},n)}));return function(){return n.apply(this,arguments)}}(),mn=function(){var n=o(e().m(function n(){var t;return e().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,u({title:"提示",content:"查杀正在进行中，确定要停止扫描吗？",icon:"question-filled"});case 1:un.scanningText="已取消",tn.value="success",null===(t=on)||void 0===t||t.close();case 2:return n.a(2)}},n)}));return function(){return n.apply(this,arguments)}}(),hn=function(){var n=o(e().m(function n(){return e().w(function(n){for(;;)switch(n.n){case 0:c({request:i({path:an.path,data:rn.value,encoding:"utf-8"}),message:!0});case 1:return n.a(2)}},n)}));return function(){return n.apply(this,arguments)}}(),yn=function(){var n=o(e().m(function n(t){var r=arguments;return e().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=1,n.n=2,u({title:"提示",content:"确定删除文件【"+t.path+"】?删除后文件将移至回收站，是否继续操作?",icon:"question-filled",type:"calc"});case 2:c({request:h({path:t.path,type:"File"}),message:!0,success:function(n){n.status&&(ln.value=ln.value.filter(function(n){return n.path!==t.path}))}}),n.n=4;break;case 3:n.p=3,n.v;case 4:return n.a(2)}},n,null,[[1,3]])}));return function(t){return n.apply(this,arguments)}}(),gn=(b={openFileEvent:(Y=o(e().m(function n(t){return e().w(function(n){for(;;)switch(n.n){case 0:c({request:l({path:t.path}),success:function(n){rn.value=n.data.data,en.value=!0,an=t}});case 1:return n.a(2)}},n)})),function(n){return Y.apply(this,arguments)}),falseAlarmEvent:(X=o(e().m(function n(t){return e().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,u({title:"提示",content:"是否确定提交误报反馈",icon:"question-filled",type:"calc"});case 1:c({request:s({filename:t.path}),message:!0,success:function(){ln.value=ln.value.filter(function(n){return n.path!==t.path})}}),n.n=3;break;case 2:n.p=2,n.v;case 3:return n.a(2)}},n,null,[[0,2]])})),function(n){return X.apply(this,arguments)}),deleteEvent:yn},K=b.openFileEvent,L=b.falseAlarmEvent,W=b.deleteEvent,[V(),{label:"文件名",prop:"name",width:160},{label:"文件路径",prop:"path"},z([{onClick:L,title:"误报"},{onClick:K,title:"打开文件",width:70},{onClick:W,title:"删除"}])]);return _(function(){dn()}),function(t,e){var o=f,u=G,c=P,i=p,l=v,s=g,m=d,h=a;return j(),k("div",r,[C("div",U,[C("div",B,["loading"==O(tn)?(j(),k("div",H,[e[3]||(e[3]=C("div",{class:"animate-spin absolute top-0 border-primary border-b-2 rounded-full h-full w-full"},null,-1)),T(o,{icon:"scanning-scan",size:60,color:"var(--el-color-primary)",class:"absolute top-0 left-0 right-0 bottom-0 m-[auto] h-[8rem] w-[6rem]"})])):S("",!0),"success"==O(tn)?(j(),I(o,{key:1,icon:"scanning-success",size:60,color:"var(--el-color-primary)"})):S("",!0),"danger"==O(tn)?(j(),I(o,{key:2,icon:"scanning-danger",size:60,color:"var(--el-color-danger)"})):S("",!0),C("div",M,[C("span",N,[A(" 查杀"+E(O(un).scanningText)+" ，已扫描文件 "+E(O(un).scanningCount)+" /"+E(O(un).scanCount)+" 个；发现木马文件 ",1),C("span",J,E(O(ln).length),1),e[4]||(e[4]=A(" 个 ",-1))]),C("span",Q,E(O(un).scanInfo.length>70?"..."+O(un).scanInfo.substring(O(un).scanInfo.length-70):O(un).scanInfo),1)])]),C("div",R,["loading"===O(tn)?(j(),I(u,{key:0,type:"default",onClick:mn},{default:F(function(){return n(e[5]||(e[5]=[A(" 取消 ",-1)]))}),_:1})):S("",!0),"loading"!=O(tn)?(j(),I(u,{key:1,type:"primary",onClick:e[0]||(e[0]=function(n){return dn()})},{default:F(function(){return n(e[6]||(e[6]=[A(" 重新查杀 ",-1)]))}),_:1})):S("",!0)])]),T(c),T(h,null,{content:F(function(){return[T(i,{ref_key:"safeTable",ref:cn,column:O(gn),data:O(ln)},null,8,["column","data"])]}),"footer-left":F(function(){return[T(l,{"table-ref":O(cn),options:fn},null,8,["table-ref"])]}),popup:F(function(){return[T(m,{title:"在线编辑",showFooter:"",modelValue:O(en),"onUpdate:modelValue":e[2]||(e[2]=function(n){return q(en)?en.value=n:null}),area:70,onConfirm:hn},{default:F(function(){return[C("div",$,[T(s,{modelValue:O(rn),"onUpdate:modelValue":e[1]||(e[1]=function(n){return q(rn)?rn.value=n:null}),class:"!h-[40rem]"},null,8,["modelValue"])])]}),_:1},8,["modelValue"])]}),_:1})])}}}))}}})}();
