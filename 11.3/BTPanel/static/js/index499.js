import{Q as e,n as a,H as t,y as s,b as i,p as r,aj as l}from"./utils-lib.js?v=1763689792";import{r as n,o,c as p,w as c,x as u,O as m,z as _}from"./base-lib.js?v=1763689792";import{proxyGetGlobal as g,proxyGlobalCompress as h,proxyGlobalAddLimit as d,proxyGlobalSetLogs as y,proxyGlobalSetWebsocket as b,proxyGlobalDelBasic as v,proxyGlobalEditBasic as w,proxyGlobalAddBasic as k,proxyGlobalBatchDelLimit as f,proxyGlobalDelLimit as E}from"./site.js?v=1763689792";import{a as L,u as z,c as P}from"./column.js?v=1763689792";import{f as j}from"./validator.js?v=1763689792";import{u as I}from"./useStore4.js?v=1763689792";const q=i(),{siteInfo:T}=I(),A=n("compress"),O=n({site_name:"",domain_list:[],site_port:[],port_conf:"",ssl_port_conf:"",site_path:"",ssl_info:{},err_age_404:"",err_age_502:"",ip_limit:{ip_black:[],ip_white:[]},basic_auth:[],proxy_cache:{},gzip:{},sub_filter:{},websocket:{},security:{},redirect:{},proxy_log:{},http_block:"",server_block:"",remark:"",proxy_info:[]}),x=async()=>{const e=await g({site_name:T.value.name});e.status?O.value=e.data:q.error(e.msg)},D=n(!1),R=n(!1);n(),o({status:!1,time:"",unit:"m"});const B=n(),V=o({status:!1,type:"",level:1,minLength:"",unit:"m"}),C=[{label:"k",value:"k"},{label:"m",value:"m"}],N=[{content:"用于对 HTTP 响应的内容进行压缩，以减少数据传输量，提高网站性能和加载速度"},{content:"压缩级别1-9，例如：1为压缩速度最快，但压缩率较低；9为压缩速度最慢，但压缩率最高，建议默认"},{content:"如果开启gzip后影响网站正常访问，请关闭此功能 和请求参数组成"}],S={type:[{required:!0,message:"请输入压缩类型",trigger:["blur","change"]}],minLength:[{required:!0,message:"请输入正确的压缩最小长度",trigger:"blur",validator:(e,a,t)=>{a?isNaN(Number(a))?t(new Error("请输入数字")):Number(a)<1?t(new Error("请输入正确数字")):t():t(new Error("压缩最小长度不能为空"))}},{}]},H=e=>{V.status=e.gzip_status,V.type=e.gzip_types,V.level=e.gzip_comp_level;let a="",t="m";e.gzip_min_length&&e.gzip_min_length.length>1&&(a=e.gzip_min_length.slice(0,-1),t=e.gzip_min_length.slice(-1)),V.minLength=a,V.unit=t},M=async()=>{const a={site_name:T.value.name,gzip_status:V.status?1:0,gzip_min_length:"".concat(V.minLength).concat(V.unit),gzip_comp_level:V.level,gzip_types:V.type};await B.value.validate();return(await e({loading:R,request:h(a),message:!0})).status},Q=o({loading:!1,type:"black",white:[],black:[]}),W=n(),F=n(),G=e=>{Q.type="ipBlackList"===A.value?"black":"white",Q.white=e.ip_white.map(e=>({ip:e,type:"white"})),Q.black=e.ip_black.map(e=>({ip:e,type:"black"}))},J=async a=>{const t=!!Array.isArray(a);await r({title:"".concat(t?"批量删除IP":"删除".concat("white"===a.type?"白名单":"黑名单","【").concat(a.ip,"】")),content:t?"批量删除选中的IP，是否继续操作？":"删除".concat("white"===a.type?"白名单":"黑名单","【").concat(a.ip,"】，是否继续操作？")});let s={site_name:T.value.name};t?(s.ip_type="ipBlackList"===A.value?"black":"white",s.ips=a.map(e=>e.ip).join("\n")):(s.ip_type=a.type,s.ip=a.ip);const i=t?f:E;(await e({loading:"正在删除，请稍后...",request:i(s),message:!0})).status&&x()},K=n([L({key:"ip"}),{label:"IP",prop:"ip",minWidth:120},z([{title:"删除",onClick:e=>{J(e)}}])]),U=[{label:"删除IP",value:"delete",event:async(e,a,t,s,i)=>{const r=async e=>await E({site_name:T.value.name,ip:e.ip,ip_type:"ipBlackList"===A.value?"black":"white"});await e({title:"批量删除",content:"批量删除选中的ip，是否继续操作？",column:[{prop:"ip",label:"IP"},P()],onConfirm:async()=>(await a(r),x(),!1)})}}],X=()=>{Y.value.address="",a({isAsync:!0,title:"添加IP".concat("ipBlackList"===A.value?"黑":"白","名单"),area:40,btn:"确认",component:()=>t(()=>import("./add-ip2.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:{listType:Q.type,refreshEvent:()=>{x()}}})},Y=n({types:Q.type,address:""}),Z=[{content:"一行一条配置，多个IP请换行"}],$=n(),ee={address:[{validator:(e,a,t)=>{a.length>0?t():t(new Error("请输入IP地址"))},trigger:["blur","change"]}]},ae=async()=>{const{address:a}=Y.value,t={site_name:T.value.name,ip_type:"ipBlackList"===A.value?"black":"white",ips:a},s=await e({loading:R,request:d(t),message:!0});return s.status&&x(),s.status},te=n([]),se=e=>{le.value=e||!1,a({isAsync:!0,title:"".concat(e?"编辑":"添加","http认证").concat(e?"【".concat(e.auth_name,"】"):""),area:48,btn:"确认",component:()=>t(()=>import("./http-auth-add2.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:{refreshEvent:x,proxy_info:O.value.proxy_info,isEdit:!!e,row:e}})},ie=n([{label:"名称",prop:"auth_name"},{label:"路径",prop:"auth_path"},z([{onClick:se,title:"编辑"},{onClick:async a=>{await r({title:"删除http认证【".concat(a.auth_name,"】"),content:"删除http认证【".concat(a.auth_name,"】，是否继续操作？")});(await e({loading:"正在删除http认证，请稍候...",request:v({site_name:T.value.name,auth_path:a.auth_path,name:a.auth_name}),message:!0})).status&&x()},title:"删除"}])]),re=e=>{te.value=e||[]},le=n(),ne=n({name:s(5),path:"",user:"",password:""}),oe=[{content:"例如我设置了加密访问/test/,那我访问http://aaa.com/test/时就要输入账号密码才能访问"}],pe=n(),ce={name:[{required:!0,message:"请输入名称",trigger:["blur","change"]}],path:[{required:!0,message:"请输入路径",trigger:["blur","change"]}],user:[{required:!0,message:"请输入用户名",trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:["blur","change"]}]},ue=(e,a)=>{const t=O.value.proxy_info.map(e=>({value:e.proxy_path}));a(e?t.filter(a=>a.value.includes(e)):t)},me=async()=>{let a=ne.value;await pe.value.validate();const t={site_name:T.value.name,auth_path:a.path,username:a.user,password:a.password,name:a.name},s=le.value?w:k,i=await e({loading:R,request:s(t)});return i.status&&x(),i.status},_e=()=>{Object.assign(ne.value,{name:le.value?le.value.auth_name:s(5),path:le.value?le.value.auth_path:"",user:"",password:""})},ge=n(),he=o({type:"default",accessLog:"",address:"",port:"514"}),de={accessLog:[{validator:(e,a,t)=>{"file"!==he.type||a?t():t(new Error("请选择日志目录"))},trigger:["blur","change"]}],address:[{validator:(e,a,t)=>{"rsyslog"!==he.type||a?t():t(new Error("请输入接收地址"))},trigger:["blur","change"]}]},ye=[{content:"指定目录可选择自定义的日志存储目录，请注意此目录必须www用户可写"},{content:"发送到远程服务器设置之后本地不会保存日志内容，填写前请确保日志接收端可正常访问"}],be=[{label:"默认",value:"default"},{label:"不记录日志",value:"off"},{label:"指定目录",value:"file"},{label:"发送到远程服务器",value:"rsyslog"}],ve=e=>{j({type:"dir",path:"/www/wwwroot",change:e=>{he.accessLog=e}})},we=e=>{e?(he.type=e.log_type,he.accessLog=e.log_path,he.address=e.rsyslog_host):he.type="default"},ke=async()=>{await ge.value.validate();const a={site_name:T.value.name,log_type:he.type,log_path:"file"==he.type?he.accessLog:he.address};return(await e({loading:R,request:y(a),message:!0})).status},fe=o({websocket:!1}),Ee=async a=>{(await e({loading:R,request:b({site_name:T.value.name,websocket_status:a?1:0}),message:!0})).status||(fe.websocket=!a)},Le=e=>{fe.websocket=!!e&&e.websocket_status},ze=p({__name:"index",setup(e){const{BtTabs:a}=l({type:"card",value:A,options:[{label:"内容压缩",name:"compress",lazy:!0,render:()=>t(()=>import("./content-compression.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)},{label:"IP黑名单",name:"ipBlackList",lazy:!0,render:()=>t(()=>import("./ip-list.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)},{label:"IP白名单",name:"ipWhiteList",lazy:!0,render:()=>t(()=>import("./ip-list.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)},{label:"http认证",name:"basicauth",lazy:!0,render:()=>t(()=>import("./http-auth.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)},{label:"日志",name:"siteLogs",lazy:!0,render:()=>t(()=>import("./log.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)},{label:"websocket",name:"websocket",lazy:!0,render:()=>t(()=>import("./websocket.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)}]});return c(()=>A.value,e=>{x()}),x(),(e,t)=>(u(),m(_(a)))}}),Pe=Object.freeze(Object.defineProperty({__proto__:null,default:ze},Symbol.toStringTag,{value:"Module"}));export{ge as A,de as B,ye as C,Le as D,fe as E,Ee as F,ae as G,Y as H,Z as I,$ as J,ee as K,_e as L,me as M,ne as N,le as O,ue as P,oe as Q,pe as R,ce as S,U as T,Pe as U,B as a,S as b,V as c,R as d,N as e,D as f,O as g,W as h,F as i,X as j,G as k,C as l,Q as m,K as n,M as o,re as p,te as q,ie as r,H as s,A as t,se as u,we as v,ke as w,he as x,be as y,ve as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
