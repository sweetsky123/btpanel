!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){l(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(t,n,r){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,n||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function l(n,r,a,l){var i=r&&r.prototype instanceof c?r:c,s=Object.create(i.prototype);return u(s,"_invoke",function(n,r,a){var l,i,u,c=0,s=a||[],f=!1,d={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return l=t,i=0,u=e,d.n=n,o}};function m(n,r){for(i=n,u=r,t=0;!f&&c&&!a&&t<s.length;t++){var a,l=s[t],m=d.p,v=l[2];n>3?(a=v===r)&&(u=l[(i=l[4])?5:(i=3,3)],l[4]=l[5]=e):l[0]<=m&&((a=n<2&&m<l[1])?(i=0,d.v=r,d.n=l[1]):m<v&&(a=n<3||l[0]>r||r>v)&&(l[4]=n,l[5]=r,d.n=v,i=0))}if(a||n>1)return o;throw f=!0,r}return function(a,s,v){if(c>1)throw TypeError("Generator is already running");for(f&&1===s&&m(s,v),i=s,u=v;(t=i<2?e:u)||!f;){l||(i?i<3?(i>1&&(d.n=-1),m(i,u)):d.n=u:d.v=u);try{if(c=2,l){if(i||(a="next"),t=l[a]){if(!(t=t.call(l,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,i<2&&(i=0)}else 1===i&&(t=l.return)&&t.call(l),i<2&&(u=TypeError("The iterator does not provide a '"+a+"' method"),i=1);l=e}else if((t=(f=d.n<0)?u:n.call(r,d))!==o)break}catch(t){l=e,i=1,u=t}finally{c=1}}return{value:t,done:f}}}(n,a,l),!0),s}var o={};function c(){}function s(){}function f(){}t=Object.getPrototypeOf;var d=[][r]?t(t([][r]())):(u(t={},r,function(){return this}),t),m=f.prototype=c.prototype=Object.create(d);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,u(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return s.prototype=f,u(m,"constructor",f),u(f,"constructor",s),s.displayName="GeneratorFunction",u(f,a,"GeneratorFunction"),u(m),u(m,a,"Generator"),u(m,r,function(){return this}),u(m,"toString",function(){return"[object Generator]"}),(i=function(){return{w:l,m:v}})()}function u(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}u=function(e,t,n,r){function l(t,n){u(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(l("next",0),l("throw",1),l("return",2))},u(e,t,n,r)}function o(e,t,n,r,a,l,i){try{var u=e[l](i),o=u.value}catch(e){return void n(e)}u.done?t(o):Promise.resolve(o).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var l=e.apply(t,n);function i(e){o(l,r,a,i,u,"next",e)}function u(e){o(l,r,a,i,u,"throw",e)}i(void 0)})}}System.register(["./index-legacy119.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./index-legacy109.js?v=1763689792","./index-legacy344.js?v=1763689792","./column-legacy.js?v=1763689792","./validator-legacy.js?v=1763689792","./useStore-legacy4.js?v=1763689792","./useMethod-legacy8.js?v=1763689792","./ace-legacy.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./index-legacy107.js?v=1763689792","./site-legacy.js?v=1763689792","./firewall-legacy.js?v=1763689792","./useStore-legacy6.js?v=1763689792"],function(e,n){"use strict";var r,l,u,o,s,f,d,m,v,p,y,b,h,w,g,x,_,j,k,O,S,P,C,V,T,D,A,E,M,q,F,G,H,I,U,N,z,L,J,B,R,Q,Y,$,K,W,X;return{setters:[function(e){r=e.B},function(e){l=e.u,u=e.p,o=e.Q,s=e.ax,f=e.l,d=e.ah,m=e.e,v=e.j,p=e.b,y=e._},function(e){b=e.c,h=e.t,w=e.s,g=e.r,x=e.g,_=e.e,j=e.be,k=e.w,O=e.I,S=e.x,P=e.y,C=e.A,V=e.z,T=e.F,D=e.B,A=e.b1,E=e.M,M=e.R,q=e.C,F=e.D,G=e.J,H=e.H,I=e.ap,U=e.b2,N=e.f,z=e.aY},function(e){L=e._},function(e){J=e.H},function(e){B=e.a,R=e.u},function(e){Q=e.dd,Y=e.de,$=e.df,K=e.c_},function(e){W=e.S},function(e){X=e.f},null,null,null,null,null,null,null],execute:function(){var n={class:"text-right text-secondary mb-2"},Z={class:"flex mb-[1.6rem] p-[1.6rem] border-[0.1rem] border-lighter rounded-base"},ee={class:"text-small text-secondary mb-[1.6rem]"},te={class:"flex justify-between items-center"},ne={class:"flex items-center"},re={class:"flex items-center"},ae={key:1,class:"p-[1rem]"},le={class:"flex justify-between items-center px-4"},ie={class:"text-extraLarge"},ue=["innerHTML"],oe={class:"text-medium mt-[1.2rem]"},ce={class:"text-base"},se={class:"flex justify-center"},fe={class:"p-[2rem]"},de={class:"flex items-center mb-[1.6rem]"},me={class:"flex-1 truncate"},ve={class:"flex items-center mb-[1.6rem]"},pe={class:"flex-1 truncate"},ye={class:"flex items-center mb-[1.6rem]"},be={class:"flex-1 truncate"},he={class:"flex items-center mb-[1.6rem]"},we={class:"flex-1 truncate"},ge={class:"flex items-center mb-[1.6rem]"},xe={class:"flex-1 truncate"},_e={class:"flex items-center mb-[1.6rem]"},je={class:"flex-1 truncate"},ke={class:"flex items-center"},Oe={class:"flex-1"},Se={class:"p-20px"},Pe=b({__name:"malware",setup:function(e){var y=l().payment,b=h(y.value).authType,Pe=J(),Ce=w(Pe),Ve=Ce.repairTypeActive,Te=Ce.tootipTotal,De=Ce.malwareData,Ae=Pe.getScanTotal,Ee=Pe.openPayView,Me=Pe.convertDataStructure,qe=Pe.malwareAdvanced,Fe=Pe.setMalwareConfig,Ge=p(),He=W(),Ie=He.getFileEvent,Ue=He.saveFileEvent,Ne=g(),ze=g([{title:"总检测文件数",value:0,style:"color: var(--el-color-text-primary)"},{title:"高危",value:0,style:"color: var(--el-color-danger);",id:2},{title:"中危",value:0,style:"color: var(--el-color-warning)",id:1},{title:"低危",value:0,style:"color: var(--el-color-warning-light-3)",id:0}]),Le=[{label:"不限时间",value:""},{label:"最近1天",value:1},{label:"最近7天",value:7},{label:"最近30天",value:30}],Je=g("");g(!1);var Be,Re=g(!1),Qe=g(!1),Ye=g({filename:"",filepath:"",threat_type:"",md5:"",risk_level:0,time:"",quarantined:!1,rule:"",processed:0,risk_level_desc:""}),$e=g(""),Ke=g(""),We=g(!1),Xe=g({total:0,loading:!1,data:[]}),Ze=function(){var e=c(i().m(function e(t){return i().w(function(e){for(;;)switch(e.n){case 0:Ye.value=t,Qe.value=!0;case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),et=x(function(){var e=Te.value.malware;return e?'<span class="text-danger">'.concat(e,"</span>个高危文件待处理！总扫描文件数量").concat(ze.value[0].value,"个"):"已完成".concat(ze.value[0].value,"个文件深度扫描，未发现任何恶意文件或异常行为")}),tt=function(){var e=c(i().m(function e(t){return i().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,u({title:"忽略恶意文件",content:"是否忽略该文件？",onConfirm:function(){var e=c(i().m(function e(){var n,r,a,l,u;return i().w(function(e){for(;;)switch(e.n){case 0:return n=t.filepath,r=t.md5,a=t.filename,l=t.risk_level,e.n=1,o({loading:"正在保存配置，请稍后...",request:Q({filepath:n,md5:r,filename:a,risk:l})});case 1:return(u=e.v).status?Ge.success("忽略成功"):Ge.error(u.msg),e.n=2,ft();case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}()});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),nt=function(){var e=c(i().m(function e(t){return i().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,u({title:"处理恶意文件",content:"是否要删除关联的源文件？",onConfirm:function(){var e=c(i().m(function e(){return i().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,o({loading:"正在保存配置，请稍后...",request:Y({file_list:JSON.stringify([{filepath:t.filepath,md5:t.md5}]),action_type:"delete"}),message:!0});case 1:return e.n=2,ft();case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}()});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),rt=[B({key:"keyid"}),{label:"文件名",prop:"filename"},{label:"威胁标签",prop:"threat_type",width:86,render:function(e){return _(j,{type:"info",effect:"plain"},{default:function(){return["网站后门"]}})}},{label:"MD5",prop:"md5",width:140,render:function(e){return _("div",{class:"truncate w-[15rem]",title:e.md5},[e.md5])}},{label:"等级",prop:"risk_level_desc",width:50,render:function(e){var t,n=null===(t=ze.value.find(function(t){return t.id===e.risk_level}))||void 0===t?void 0:t.style;return _("span",{style:n},[e.risk_level_desc])}},{label:"检测时间",prop:"time",width:140},R([{onClick:tt,title:"忽略"},{onClick:nt,title:"处理"},{onClick:Ze,title:"详情"}])],at=function(){var e=c(i().m(function e(t){return i().w(function(e){for(;;)switch(e.n){case 0:return Je.value=t,e.n=1,it();case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),lt=function(){var e=c(i().m(function e(t){var n,r;return i().w(function(e){for(;;)switch(e.n){case 0:return n=t?"开启":"关闭",r=t?"将全天候检测系统是否存在恶意文件":"将不再检测系统是否存在恶意文件",e.n=1,u({title:"".concat(n,"动态查杀"),content:"".concat(n,"后，").concat(r,"，是否继续？")});case 1:return Re.value=t,e.n=2,Fe({dynamic_detection:Re.value});case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),it=function(){var e=c(i().m(function e(){var t,n,r,l,u;return i().w(function(e){for(;;)switch(e.n){case 0:return Xe.value.loading=!0,t=""!==Je.value?{day:Number(Je.value)}:void 0,e.n=1,$(t);case 1:n=e.v,r=n.data,Xe.value.loading=!1,Xe.value.data=r.detected.map(function(e,t){return a(a({},e),{},{keyid:t})}),$e.value=r.last_scan_time,l=r.total_scanned_files,u=r.risk_stats,ze.value[0].value=l,ze.value[1].value=u[2],ze.value[2].value=u[1],ze.value[3].value=u[0];case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),ut=function(){var e=c(i().m(function e(){var t,n,r;return i().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,K();case 1:t=e.v,n=t.data,r=n.data,Re.value=r.dynamic_detection,De.value.autoIntercept=r.quarantine,De.value.ossConfig={status:r.scan_oss,isHasMounts:r.has_oss_mounts},De.value.exclude_dirs=Me(r.exclude_dirs),De.value.monitor_dirs=Me(r.monitor_dirs);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),ot=function(){var e=c(i().m(function e(){var t;return i().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Ie({path:Ye.value.filepath});case 1:if((t=e.v).status){e.n=2;break}return Ge.error(t.data.msg),e.a(2,!1);case 2:Ke.value=t.data.data||t.msg,We.value=!0;case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),ct=function(){var e=c(i().m(function e(){var t;return i().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Ue({path:Ye.value.filepath,data:Ke.value,encoding:"utf-8"});case 1:t=e.v,Ge.request(t);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),st=[{label:"处理恶意文件",value:"delete",event:(Be=c(i().m(function e(t,n){var r;return i().w(function(e){for(;;)switch(e.n){case 0:return r=function(){var e=c(i().m(function e(t){var n;return i().w(function(e){for(;;)switch(e.n){case 0:return n={filepath:t.filepath,md5:t.md5},e.n=1,Y({file_list:JSON.stringify([n]),action_type:"delete"});case 1:return e.a(2,e.v)}},e)}));return function(t){return e.apply(this,arguments)}}(),e.n=1,X(t,n,r,{label:"文件名",prop:"filename"},ft);case 1:return e.a(2)}},e)})),function(e,t){return Be.apply(this,arguments)})}],ft=function(){var e=c(i().m(function e(){var t,n=arguments;return i().w(function(e){for(;;)switch(e.n){case 0:return t=n.length>0&&void 0!==n[0]&&n[0],e.n=1,ut();case 1:return e.n=2,it();case 2:if(t){e.n=3;break}return e.n=3,Ae();case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();return k(Ve,function(e){"malware"===e&&ft(!0)}),function(e,a){var l=s,i=H,u=I,o=f,c=d,p=L,y=U,h=N,w=m,g=z,x=v,j=r,k=O("bt-loading");return S(),P("div",null,[a[20]||(a[20]=C("div",{class:"text-large mb-6"},"恶意文件检测",-1)),"ltd"===V(b)?(S(),P(T,{key:0},[C("div",n,"最近一次扫描时间："+D(V($e)),1),C("div",Z,[(S(!0),P(T,null,A(V(ze),function(e){return S(),P("div",{class:"flex-1",key:e.title},[C("div",ee,D(e.title),1),C("div",{class:"text-subtitleLarge",style:E(e.style)},D(e.value),5)])}),128))]),C("div",te,[_(l,{modelValue:V(Je),"onUpdate:modelValue":a[0]||(a[0]=function(e){return M(Je)?Je.value=e:null}),options:Le,onChange:at,class:"mr-[1rem] !w-[12rem]","empty-values":[null,void 0]},null,8,["modelValue"]),C("div",ne,[_(i,{size:"small",onClick:V(qe)},{default:q(function(){return t(a[5]||(a[5]=[F("高级设置",-1)]))}),_:1},8,["onClick"]),a[7]||(a[7]=C("span",{class:"text-tertiary mx-[1.2rem]"},"|",-1)),C("div",re,[a[6]||(a[6]=C("span",{class:"mr-[.8rem]"},"动态查杀开关",-1)),_(u,{modelValue:V(Re),"onUpdate:modelValue":a[1]||(a[1]=function(e){return M(Re)?Re.value=e:null}),size:"small",onChange:lt},null,8,["modelValue"])])])]),_(p,null,{content:q(function(){return[G(_(o,{ref_key:"malwareTable",ref:Ne,column:rt,data:V(Xe).data,"max-height":"270",description:"文件列表为空"},null,8,["data"]),[[k,V(Xe).loading],[k,"正在获取恶意文件列表，请稍后...","title"]])]}),"footer-left":q(function(){return[_(c,{"table-ref":V(Ne),options:st},null,8,["table-ref"])]}),_:1}),a[8]||(a[8]=C("ul",{class:"ml-6 mt-6 list-disc leading-10"},[C("li",{class:"text-secondary"},"恶意文件检测每6小时自动运行，24小时不间断保护您的系统安全，无需任何手动操作！")],-1))],64)):(S(),P("div",ae,[C("div",le,[C("div",ie,[C("span",{class:"font-bold",innerHTML:V(et)},null,8,ue),C("p",oe,"上一次扫描时间："+D(V($e)),1)]),_(i,{type:"primary",onClick:V(Ee),class:"h-[4rem] w-[10rem]",size:"large"},{default:q(function(){return[C("span",ce,D(V(Te).malware>0?"立即处理":"立即开启"),1)]}),_:1},8,["onClick"])]),_(y),C("div",se,[_(h,{class:"w-[63rem] mr-[2rem]",fit:"scale-down",src:"https://www.bt.cn/Public/new/plugin/introduce/home/malware.png"}),a[9]||(a[9]=C("div",{class:"max-w-[22rem]"},[C("span",{class:"text-large font-bold"},"恶意文件检测工具介绍"),C("ul",{class:"block leading-[2.6rem] mx-[2rem] list-square mt-[2rem]"},[C("li",null,[F("支持检测21种恶意文件类型： "),C("br"),F("反弹Shell后门、DDoS木马、下载器木马、 黑客工具、高危程序、被污染的基础软件、 恶意脚本、恶意程序、挖矿程序、 代理工具、勒索病毒、高危软件、 Rootkit、窃密工具、恶意扫描器、 可疑程序、感染型病毒、网站后门、 蠕虫病毒、广告程序、破解程序")])])],-1))])])),_(x,{modelValue:V(Qe),"onUpdate:modelValue":a[2]||(a[2]=function(e){return M(Qe)?Qe.value=e:null}),title:"[".concat(V(Ye).filename,"]详情"),area:54},{default:q(function(){return[C("div",fe,[C("div",de,[a[10]||(a[10]=C("div",{class:"text-small text-black w-[10rem]"},"文件名称",-1)),C("div",me,D(V(Ye).filename),1)]),C("div",ve,[a[11]||(a[11]=C("div",{class:"text-small text-black w-[10rem]"},"文件路径",-1)),C("div",pe,D(V(Ye).filepath),1)]),C("div",ye,[a[12]||(a[12]=C("div",{class:"text-small text-black w-[10rem]"},"MD5",-1)),C("div",be,D(V(Ye).md5),1)]),C("div",he,[a[13]||(a[13]=C("div",{class:"text-small text-black w-[10rem]"},"威胁标签",-1)),C("div",we,D(V(Ye).threat_type),1)]),C("div",ge,[a[14]||(a[14]=C("div",{class:"text-small text-black w-[10rem]"},"是否已进行隔离",-1)),C("div",xe,D(V(Ye).quarantined?"是":"否"),1)]),C("div",_e,[a[16]||(a[16]=C("div",{class:"text-small text-black w-[10rem]"},"样本文件",-1)),C("div",je,[_(w,{onClick:ot},{default:q(function(){return t(a[15]||(a[15]=[F("查看",-1)]))}),_:1})])]),a[19]||(a[19]=C("div",{class:"mb-[1rem] mt-[4rem] font-bold text-default text-base"},"事件说明",-1)),C("div",ke,[C("div",Oe,[_(g,{style:{width:"480px"},shadow:"always",class:"p-[1rem]"},{default:q(function(){return[a[17]||(a[17]=F(" 发现了一个可疑文件，建议您先确认文件合法性并进行处理 ",-1)),_(y,{class:"!my-1.2rem"}),a[18]||(a[18]=C("div",{class:"flex flex-wrap"},[C("div",null,"处置建议:"),C("div",null,"如果您确认该文件不是自己部署的业务所需文件，请隔离该文件，或直接删除。如果您确定为误报，请先忽略该告警。")],-1))]}),_:1})])])])]}),_:1},8,["modelValue","title"]),_(x,{title:"在线编辑",showFooter:"",modelValue:V(We),"onUpdate:modelValue":a[4]||(a[4]=function(e){return M(We)?We.value=e:null}),area:70,onConfirm:ct},{default:q(function(){return[C("div",Se,[_(j,{modelValue:V(Ke),"onUpdate:modelValue":a[3]||(a[3]=function(e){return M(Ke)?Ke.value=e:null}),class:"!h-[40rem]"},null,8,["modelValue"])])]}),_:1},8,["modelValue"])])}}});e("default",y(Pe,[["__scopeId","data-v-c7e16b8f"]]))}}})}();
