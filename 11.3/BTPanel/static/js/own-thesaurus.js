import{_ as e}from"./index109.js?v=1763689792";import{b as a,Q as s,l,k as t,j as o}from"./utils-lib.js?v=1763689792";import{c as r,r as n,o as u,x as i,y as d,e as p,C as c,J as m,z as f,H as _,b4 as y,K as b,W as g,v as k,I as w,O as h,D as v,A as x,R as j,ad as q,ab as C}from"./base-lib.js?v=1763689792";import{bq as V,br as z,bs as R,bt as U,bu as A}from"./firewall.js?v=1763689792";import{u as D}from"./column.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";const H=r({__name:"upload-thesaurus",emits:["upload-success"],setup(e,{expose:s,emit:l}){const t=a(),o=n(),r=n(),g=l,k=window.location.protocol+"//"+window.location.host+"/project/content/in_thesaurus",w=u({f_size:0,f_path:"/tmp/",f_name:"inthesaurus.txt",f_start:0}),h=n([]),v=[".txt"].join(","),x=()=>{g("upload-success")},j=()=>{t.error("导入失败")},q={"x-http-token":window.vite_public_request_token},C=e=>{e.value=e,w.f_size=e.size,w.f_start=0},V=(e,a)=>{h.value=a},z=(e,a,s)=>{w.f_start=e.percent,h.value=s.map(s=>(s.uid===a.uid&&(s.percentage=e.percent),s))};return s({onConfirm:()=>{r.value.submit()},open:()=>{o.value.$el.click()},fileData:w}),(e,a)=>{const s=_,l=y;return i(),d("div",null,[p(l,{class:"upload-demo",ref_key:"uploadRef",ref:r,name:"blob",data:f(w),action:k,headers:q,accept:f(v),"on-error":j,multiple:!1,"show-file-list":!1,"auto-upload":!0,"on-success":x,"on-progress":z,"file-list":f(h),"on-change":V,"before-upload":C},{default:c(()=>[m(p(s,{ref_key:"openRef",ref:o,size:"small",type:"primary"},null,512),[[b,!1]])]),_:1},8,["data","accept","file-list"])])}}}),I=r({__name:"own-thesaurus",setup(a){const r=n(null),d=g([]),y=n(!1),b=n(null),I=n(!1),S=u({key:""}),F=u({key:[{trigger:["blur","change"],required:!0,message:"请输入关键词"}]}),J=async()=>{r.value.open()},K=async()=>{const e=await s({loading:"正在导出关键词文件，请稍后...",request:V(),data:{msg:String}});window.open("/download?filename="+e.msg,"_blank","noopener,noreferrer")},O=async e=>{W()},Q=[{label:"关键词\t",render:e=>p("span",null,[e])},D([{onClick:async e=>{await s({loading:"正在删除关键词，请稍后...",request:z({key:e}),message:!0}),W()},title:"删除"}])],T=async()=>{await s({loading:"正在清空自定义词库，请稍后...",request:R(),message:!0}),W()},W=async()=>{await s({loading:"正在加载词库列表，请稍后...",request:U(),data:[Array,d]})},$=async e=>{await b.value.validate(),await s({loading:"正在添加关键词，请稍候...",request:A(S),message:!0}),S.key="",I.value=!1,W()};return k(()=>W()),(a,s)=>{const n=_,u=l,g=t,k=q,V=C,z=o,R=e,U=w("bt-loading");return i(),h(R,{class:"px-[1.6rem] py-[1.6rem]"},{"header-left":c(()=>[p(n,{onClick:s[0]||(s[0]=e=>I.value=!0),type:"primary"},{default:c(()=>[...s[3]||(s[3]=[v("添加",-1)])]),_:1}),p(n,{onClick:J},{default:c(()=>[...s[4]||(s[4]=[v("导入",-1)])]),_:1}),p(n,{onClick:K},{default:c(()=>[...s[5]||(s[5]=[v("导出",-1)])]),_:1}),p(n,{onClick:T},{default:c(()=>[...s[6]||(s[6]=[v("清空",-1)])]),_:1}),p(H,{ref_key:"fileIpRef",ref:r,onUploadSuccess:O},null,512)]),content:c(()=>[m(p(u,{"max-height":"260",column:Q,data:f(d),description:"词库列表为空"},null,8,["data"]),[[U,f(y)],[U,"正在加载词库列表，请稍后...","title"]])]),popup:c(()=>[p(z,{title:"添加自定义词库",modelValue:f(I),"onUpdate:modelValue":s[2]||(s[2]=e=>j(I)?I.value=e:null),area:42,onConfirm:$,showFooter:""},{default:c(()=>[p(V,{ref_key:"addThesaurusRef",ref:b,rules:f(F),model:f(S),class:"p-[2rem]","label-width":"5rem"},{default:c(()=>[p(k,{label:"关键词",prop:"key"},{default:c(()=>[p(g,{modelValue:f(S).key,"onUpdate:modelValue":s[1]||(s[1]=e=>f(S).key=e),width:"20rem",placeholder:"请输入你需要扫描的关键词"},null,8,["modelValue"])]),_:1}),s[7]||(s[7]=x("ul",{class:"leading-8 text-small list-disc ml-20px"},[x("li",null,"关键字小于2时会引起大量误报，请设置大于等于2个关键字！")],-1))]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])]),_:1})}}});export{I as default};
