import{c as e,v as l,I as a,x as o,y as s,J as t,z as d,O as n,C as u,e as r,G as i,A as m,V as p,be as c,D as _,B as f,F as V,K as y,S as b,ap as v,ad as g,bc as h,bd as k,U,ab as x}from"./base-lib.js?v=1763689792";import{_ as j}from"./validator.js?v=1763689792";import{ag as C,k as F,ax as w,_ as D}from"./utils-lib.js?v=1763689792";import{u as I,b as L,c as S,d as z,f as A,h as O,j as B,t as G}from"./index333.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";import"./useStore9.js?v=1763689792";const H={class:"px-[2rem] py-[2.4rem]"},J={class:"condition-risk"},K={class:"flex items-center"},M={class:"tip"},P={key:0},T=D(e({__name:"timed-scan",setup(e,{expose:D}){const{isAutoScan:T,ruleForm:q,userOptions:E,isLoading:N,addFtpInfo:Q}=I();return l(L),D({onConfirm:S}),(e,l)=>{const D=v,I=g,L=C,S=F,R=w,W=h,X=k,Y=U,Z=j,$=x,ee=a("bt-loading");return o(),s("div",H,[t((o(),n($,{ref_key:"addFtpInfo",ref:Q,model:d(q),class:"btCustomForm p-0","label-width":"4rem",rules:d(G),onSubmit:l[13]||(l[13]=b(()=>{},["prevent"]))},{default:u(()=>[d(T)?(o(),n(I,{key:0,label:"告警状态"},{default:u(()=>[r(D,{modelValue:d(q).status,"onUpdate:modelValue":l[0]||(l[0]=e=>d(q).status=e),"active-color":"var(--el-color-primary)","inactive-color":"#cdcdcd"},null,8,["modelValue"])]),_:1})):i("",!0),r(I,{label:"安全风险项",prop:"risk"},{default:u(()=>[m("div",J,[r(d(p),{modelValue:d(q).login_error,"onUpdate:modelValue":l[1]||(l[1]=e=>d(q).login_error=e)},{default:u(()=>[l[14]||(l[14]=m("span",null,"多次登录失败",-1)),r(d(c),{type:"info",class:"risk-tag",title:d(q).config.login_error_des},{default:u(()=>[_(f(d(q).config.login_error_des),1)]),_:1},8,["title"])]),_:1},8,["modelValue"]),r(d(p),{modelValue:d(q).time,"onUpdate:modelValue":l[2]||(l[2]=e=>d(q).time=e)},{default:u(()=>{var e;return[l[15]||(l[15]=m("span",null,"登录时间异常",-1)),r(d(c),{type:"info",class:"risk-tag",title:null==(e=d(q).config)?void 0:e.time_des},{default:u(()=>{var e;return[_(f(null==(e=d(q).config)?void 0:e.time_des),1)]}),_:1},8,["title"])]}),_:1},8,["modelValue"]),r(d(p),{modelValue:d(q).area,"onUpdate:modelValue":l[3]||(l[3]=e=>d(q).area=e)},{default:u(()=>{var e;return[l[16]||(l[16]=m("span",null,"登录地区异常",-1)),r(d(c),{type:"info",class:"risk-tag",title:null==(e=d(q).config)?void 0:e.area_des},{default:u(()=>{var e,l,a;return[_(f((null==(l=null==(e=d(q).config)?void 0:e.area)?void 0:l.country.length)?null==(a=d(q).config)?void 0:a.area_des:"未配置"),1)]}),_:1},8,["title"])]}),_:1},8,["modelValue"]),r(d(p),{modelValue:d(q).anonymous,"onUpdate:modelValue":l[4]||(l[4]=e=>d(q).anonymous=e),disabled:"other"===d(q).user&&!d(T)},{default:u(()=>[...l[17]||(l[17]=[m("span",null,"匿名用户登录",-1)])]),_:1},8,["modelValue","disabled"]),r(d(p),{modelValue:d(q).upload_shell,"onUpdate:modelValue":l[5]||(l[5]=e=>d(q).upload_shell=e)},{default:u(()=>{var e;return[l[18]||(l[18]=m("span",null,"上传脚本文件",-1)),r(d(c),{type:"info",class:"risk-tag",title:null==(e=d(q).config)?void 0:e.upload_shell_des},{default:u(()=>{var e,l,a;return[_(f((null==(l=null==(e=d(q).config)?void 0:e.upload_shell)?void 0:l.length)?null==(a=d(q).config)?void 0:a.upload_shell_des:"未配置"),1)]}),_:1},8,["title"])]}),_:1},8,["modelValue"]),m("span",{class:"bt-link",onClick:l[6]||(l[6]=(...e)=>d(z)&&d(z)(...e))}," 【设置扫描触发条件】 ")])]),_:1}),d(T)?(o(),s(V,{key:2},[t(r(I,{label:"周期",prop:"cycle"},{default:u(()=>[r(Y,{class:"max-w-[16rem]",modelValue:d(q).cycle,"onUpdate:modelValue":l[11]||(l[11]=e=>d(q).cycle=e),min:1,type:"number"},{append:u(()=>[r(X,{type:"flex"},{default:u(()=>[r(W,null,{default:u(()=>[...l[19]||(l[19]=[m("span",null,"天",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},512),[[y,!1]]),r(I,{label:"告警方式",prop:"channel"},{default:u(()=>[r(Z,{modelValue:d(q).channel,"onUpdate:modelValue":l[12]||(l[12]=e=>d(q).channel=e),multiple:!0,class:"!w-30rem",limit:["wx_account","sms"]},null,8,["modelValue"])]),_:1})],64)):(o(),s(V,{key:1},[r(I,{label:"扫描日志天数",prop:"otherDay"},{default:u(()=>[r(L,{type:"button",size:"small",modelValue:d(q).day,"onUpdate:modelValue":l[7]||(l[7]=e=>d(q).day=e),options:d(A)},null,8,["modelValue","options"]),"other"===d(q).day?(o(),n(S,{key:0,type:"number",modelValue:d(q).otherDay,"onUpdate:modelValue":l[8]||(l[8]=e=>d(q).otherDay=e),modelModifiers:{number:!0},class:"!inline-block ml-[1rem]"},null,8,["modelValue"])):i("",!0)]),_:1}),r(I,{label:"FTP用户",prop:"userList"},{default:u(()=>[m("div",K,[r(R,{class:"!w-[16rem]",modelValue:d(q).user,"onUpdate:modelValue":l[9]||(l[9]=e=>d(q).user=e),options:d(O),onChange:d(B)},null,8,["modelValue","options","onChange"]),"other"===d(q).user?(o(),n(R,{key:0,class:"ml-[1rem]",multiple:"","collapse-tags":"",filterable:"",modelValue:d(q).userList,"onUpdate:modelValue":l[10]||(l[10]=e=>d(q).userList=e),options:d(E)},null,8,["modelValue","options"])):i("",!0)])]),_:1})],64))]),_:1},8,["model","rules"])),[[ee,d(N)]]),m("div",M,[m("ul",null,[d(T)?(o(),s("li",P,"默认扫描全部用户30天的日志")):i("",!0),l[20]||(l[20]=m("li",null,"【多次登录失败】检测时间为：5分钟",-1))])])])}}}),[["__scopeId","data-v-87d76c83"]]);export{T as default};
