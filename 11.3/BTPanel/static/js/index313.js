import{n as e,H as a,M as s,Q as l,e as t,V as i,iS as n,_ as r}from"./utils-lib.js?v=1763689792";import{c as o,r as m,v as d,I as u,J as c,z as v,x as p,y as g,A as y,e as w,R as f,D as h,G as x,O as _,C as k,F as b,b1 as P,L as j,ap as C,H,ay as q,B,M as V,aA as A}from"./base-lib.js?v=1763689792";import{_ as D}from"./index110.js?v=1763689792";import{g as I}from"./useStore6.js?v=1763689792";import{as as E,at as L,au as R,av as M,aw as O}from"./firewall.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";const S={class:"sn-home"},T={class:"sn-home-switch"},U={class:"flex items-center"},z={key:0,class:"sn-home-note flex items-center !text-small"},F={key:1},G={class:"mt-[2rem]"},J={class:"sn-home-overview-item-title"},Q={key:0,class:"sn-home-list"},K={class:"sn-home-list-item flex items-center"},N={class:"ml-[0.4rem] truncate flex-1"},W={class:"text-right"},X={class:"text-tertiary leading-2.2rem"},Y={class:"mt-1rem"},Z={class:"flex justify-end items-center"},$={key:1,class:"sn-home-list"},ee=r(o({__name:"index",setup(r){const{refs:{phpTabActive:o}}=I(),ee=m(!1),ae=m(!1),se=m(!1),le=m(!1),te=m([]),ie=m(!1),ne=[{title:"高风险",value:0,style:"color: var(--el-color-danger);",name:"risk_high"},{title:"中危",value:0,style:"color: var(--el-color-warning)",name:"risk_mod"},{title:"低危",value:0,style:"color: var(--el-color-warning-light-3)",name:"risk_low"},{title:"网站数量",value:0,style:"color: var(--el-color-text-primary)",name:"site_count"},{title:"告警次数",value:0,style:"color: var(--el-color-text-primary)",name:"risk_count"}],re=async()=>{const{data:e}=await l({loading:ae,request:R()});te.value=e.logs,ne.forEach(a=>{a.value=e[a.name]})},oe=()=>{e({title:"模拟攻击",area:60,compData:()=>ue(),component:()=>a(()=>import("./simulate-attack.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},me=async e=>{if(ee.value=!e,!se.value||!le.value)return ee.value=!1,void s.error("请先开启PHP模块设置");await l({loading:"正在"+(e?"开启":"关闭")+"监控，请稍后...",request:E({status:e?"start":"stop"}),message:!0,data:{status:[Boolean,a=>{a&&(ee.value=e)}]}})},de=()=>o.value="php",ue=()=>{(async()=>{await l({request:L(),data:{status:[Boolean,ee],send:[Boolean,se],php_status:[Boolean,le]}}),se.value&&le.value?ie.value=!1:ie.value=!0})(),re()};return d(()=>ue()),(e,a)=>{const s=C,r=t,o=H,m=D,d=A,I=q,E=u("bt-loading");return c((p(),g("div",S,[y("div",T,[y("div",U,[a[1]||(a[1]=y("div",{class:"mr-4 text-small"},"监控开关",-1)),w(s,{modelValue:v(ee),"onUpdate:modelValue":a[0]||(a[0]=e=>f(ee)?ee.value=e:null),width:36,onChange:me,disabled:v(ie)},null,8,["modelValue","disabled"])]),v(ie)?(p(),g("div",z,[a[3]||(a[3]=y("i",{class:"svgtofont-el-warning-filled text-warningDark"},null,-1)),a[4]||(a[4]=h(" 无法使用PHP安全告警，请开启 ",-1)),v(le)?x("",!0):(p(),g("span",{key:0,class:"bt-link !text-danger underline",onClick:de,title:"点击跳转PHP模块页面"}," PHP模块 ")),v(le)||v(se)?x("",!0):(p(),g("span",F,"、")),v(se)?x("",!0):(p(),_(r,{key:2,title:"点击跳转告警设置页面",type:"danger",class:"underline"},{default:k(()=>[...a[2]||(a[2]=[h(" 设置告警 ",-1)])]),_:1}))])):x("",!0),v(se)&&v(le)?(p(),_(o,{key:1,type:"primary",onClick:oe},{default:k(()=>[...a[5]||(a[5]=[h("模拟攻击",-1)])]),_:1})):x("",!0)]),y("div",{class:j(["sn-home-overview",ne[0].value?"sn-home-overview-red":ne[1].value?"sn-home-overview-yellow":"sn-home-overview-green"])},[a[6]||(a[6]=y("div",{class:"text-secondary text-base"},"风险等级概览",-1)),y("div",G,[(p(),g(b,null,P(ne,(e,a)=>y("div",{class:j(["sn-home-overview-item",a<3?"line-border":""]),key:a},[y("div",J,B(e.title),1),y("div",{class:"sn-home-overview-item-num",style:V(e.style)},B(e.value),5)],2)),64))])],2),v(te).length?(p(),g("div",Q,[(p(!0),g(b,null,P(v(te),(e,s)=>(p(),_(d,{key:s,placement:"bottom",width:260,trigger:"hover",offset:0,"show-after":300},{reference:k(()=>[y("div",K,[y("div",null,[y("div",{class:j(["sn-home-list-item-type max-w-[12rem] w-max flex items-center",1===e.risk?"green":2===e.risk?"org":"red"])},[a[7]||(a[7]=y("i",{class:"svgtofont-el-warning !text-medium w-[16px]"},null,-1)),y("span",N,B(e.intercept),1)],2)]),y("span",null,"攻击者IP："+B(e.address),1),y("span",null,"网站："+B(e.domain),1),y("span",null,"路径："+B(e.url),1),y("div",W,"触发时间："+B(v(i)(e.addtime)),1)])]),default:k(()=>{return[y("div",X,[y("div",null,"【"+B(e.domain)+"】",1),y("div",Y,[a[8]||(a[8]=h(" 路径： ",-1)),y("span",{class:j((t=e.risk,3===t?"text-danger":2===t?"text-warning":"text-[var(--el-color-warning-light-3)]"))},B(e.intercept),3)]),y("div",null,"路径："+B(v(n)(e.url)),1),y("div",null,[a[9]||(a[9]=h(" 解决方案： ",-1)),(p(!0),g(b,null,P((s=e.solution,(null==s?void 0:s.split("|split|"))||[]),(e,a)=>(p(),g("p",{key:a},B(e),1))),128))]),y("div",Z,[w(r,{onClick:a=>(async e=>{await l({loading:"正在加入URL白名单...",request:M({url_rule:e}),message:!0}),await re()})(e.url)},{default:k(()=>[...a[10]||(a[10]=[h("误报",-1)])]),_:1},8,["onClick"]),w(m),w(r,{onClick:a=>(async e=>{await l({loading:"正在处理，请稍候...",request:O({operation:1,id:e}),message:!0}),await re()})(e.id)},{default:k(()=>[...a[11]||(a[11]=[h("已处理",-1)])]),_:1},8,["onClick"])])])];var s,t}),_:2},1024))),128))])):(p(),g("div",$,[w(I,{description:"暂无数据"})])),a[12]||(a[12]=y("div",{class:"text-disabled mt-[1rem]"},"以上仅提供最新的前100条风险数据",-1))])),[[E,v(ae)]])}}}),[["__scopeId","data-v-173cac3f"]]);export{ee as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
