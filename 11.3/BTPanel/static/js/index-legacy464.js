!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?t(Object(o),!0).forEach(function(t){r(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function r(t,n,r){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,n||"default");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function o(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function u(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return i(s,"_invoke",function(n,r,o){var a,u,i,c=0,s=o||[],p=!1,f={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,u=0,i=e,f.n=n,l}};function d(n,r){for(u=n,i=r,t=0;!p&&c&&!o&&t<s.length;t++){var o,a=s[t],d=f.p,v=a[2];n>3?(o=v===r)&&(i=a[(u=a[4])?5:(u=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(u=0,f.v=r,f.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,f.n=v,u=0))}if(o||n>1)return l;throw p=!0,r}return function(o,s,v){if(c>1)throw TypeError("Generator is already running");for(p&&1===s&&d(s,v),u=s,i=v;(t=u<2?e:i)||!p;){a||(u?u<3?(u>1&&(f.n=-1),d(u,i)):f.n=i:f.v=i);try{if(c=2,a){if(u||(o="next"),t=a[o]){if(!(t=t.call(a,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,u<2&&(u=0)}else 1===u&&(t=a.return)&&t.call(a),u<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),u=1);a=e}else if((t=(p=f.n<0)?i:n.call(r,f))!==l)break}catch(t){a=e,u=1,i=t}finally{c=1}}return{value:t,done:p}}}(n,o,a),!0),s}var l={};function c(){}function s(){}function p(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(i(t={},r,function(){return this}),t),d=p.prototype=c.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,i(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=p,i(d,"constructor",p),i(p,"constructor",s),s.displayName="GeneratorFunction",i(p,o,"GeneratorFunction"),i(d),i(d,o,"Generator"),i(d,r,function(){return this}),i(d,"toString",function(){return"[object Generator]"}),(u=function(){return{w:a,m:v}})()}function i(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}i=function(e,t,n,r){function a(t,n){i(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},i(e,t,n,r)}function l(e,t,n,r,o,a,u){try{var i=e[a](u),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){l(a,r,o,u,i,"next",e)}function i(e){l(a,r,o,u,i,"throw",e)}u(void 0)})}}System.register(["./index-legacy109.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./column-legacy.js?v=1763689792","./site-legacy.js?v=1763689792","./index-legacy423.js?v=1763689792","./useStore-legacy4.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792"],function(e,t){"use strict";var r,a,i,l,s,p,f,d,v,m,y,b,h,g,w,_,j,O,k,S,D,P,V,x,z,C,T,U,q,E,A,F,I,G,R,B,H,M;return{setters:[function(e){r=e._},function(e){a=e._,i=e.al,l=e.j,s=e.b,p=e.b3,f=e.p,d=e.l,v=e.k,m=e.$},function(e){y=e.c,b=e.r,h=e.w,g=e.x,w=e.y,_=e.A,j=e.B,O=e.z,k=e.e,S=e.o,D=e.C,P=e.J,V=e.R,x=e.H,z=e.b4,C=e.K,T=e.v,U=e.I,q=e.ad,E=e.ab},function(e){A=e.u},function(e){F=e.removeVersionProject,I=e.recoverVersionProject,G=e.setVersionPs,R=e.getVersionProject,B=e.nowFileBack},function(e){H=e._},function(e){M=e.u},null,null],execute:function(){var t={class:"download-speed"},$={class:"download-speed-top"},N={class:"download-speed-top-title"},W={class:"download-speed-top-score"},J=a(y({__name:"upload-speed",props:{compData:{default:function(){return{}}}},setup:function(e){var n=e,r=b(0);return h(function(){return n.compData},function(e){r.value=e.percentum}),function(n,o){var a=H;return g(),w("div",t,[_("div",$,[_("div",N,j(e.compData.title),1),_("div",W,j(O(r))+"%",1)]),k(a,{strokeWidth:5,percentage:O(r),showText:!1},null,8,["percentage"])])}}}),[["__scopeId","data-v-cfdd07ba"]]),K={class:"p-2rem"},L=y({__name:"upload-version-file",props:{compData:{default:{}}},setup:function(e,t){var n=t.expose,r=e,o=b(),a=b(),u=s(),c=window.location.protocol+"//"+window.location.host+"/mod/php/php_async/upload_version",p=b(!1),f=[".tar.gz",".gz",".zip",".tar",".bz2","xz"].join(","),d=S({f_size:0,f_path:"/tmp/",f_name:"",f_start:0,ps:r.compData.ps,version:r.compData.version,sitename:r.compData.sitename,blob:""}),v=b([]),m=b(0),y=function(e){var t=e.file,n=e.onProgress,o=e.onSuccess,a=e.onError,l=new FormData,c=Math.min(t.size,d.f_start+2097152);l.append("f_name",t.name),l.append("f_size",t.size),l.append("f_start",d.f_start.toString()),l.append("ps",r.compData.ps),l.append("version",r.compData.version),l.append("sitename",r.compData.sitename),l.append("blob",t.slice(d.f_start,c)),l.append("f_path",d.f_path);var s=i.CancelToken.source();return m.value||(p.value=!0),m.value=Math.round(d.f_start/t.size*100),i.post(r.compData.uploadUrl?r.compData.uploadUrl:"/mod/php/php_async/upload_version",l,{headers:{"Content-Range":"bytes ".concat(d.f_start,"-").concat(t.size,"/"),"x-http-token":window.vite_public_request_token,"Content-Type":"application/x-www-form-urlencoded"},onUploadProgress:function(e){e.event.lengthComputable&&n({percent:Math.round(100*e.loaded/e.total)})},cancelToken:s.token}).then(function(e){"number"==typeof e.data?(d.f_start=e.data,y({file:t,onProgress:n,onSuccess:o,onError:a})):(m.value=0,p.value=!1,u.request(e.data),r.compData.getVersion(),r.compData.close(),o(e.data))}).catch(function(e){m.value=0,p.value=!1,u.error("导入失败"),a(e)}),{abort:function(){s.cancel("Upload cancelled")}}},h=function(e,t){v.value=t},j=function(e,t,n){d.f_start=e.percent,v.value=n.map(function(n){return n.uid===t.uid&&(n.percentage=e.percent),n})},T=function(){o.value.submit()};return n({onConfirm:T,open:function(){a.value.$el.click()},fileData:d}),function(e,t){var n=x,r=z,u=l;return g(),w("div",null,[k(r,{"show-file-list":!1,class:"upload-demo",ref_key:"upload",ref:o,name:"blob",accept:O(f),action:c,"auto-upload":!0,multiple:!1,"file-list":O(v),"on-progress":j,"on-change":h,"http-request":y},{default:D(function(){return[P(k(n,{ref_key:"openRef",ref:a,size:"small",type:"primary"},null,512),[[C,!1]]),P(k(n,{style:{"margin-left":"10px"},size:"small",type:"success",onClick:T},null,512),[[C,!1]])]}),_:1},8,["accept","file-list"]),k(u,{title:!1,modelValue:O(p),"onUpdate:modelValue":t[0]||(t[0]=function(e){return V(p)?p.value=e:null}),area:40},{default:D(function(){return[_("div",K,[k(J,{compData:{title:"正在上传文件，请稍后...",percentum:O(m)}},null,8,["compData"])])]}),_:1},8,["modelValue"])])}}});e("default",y({__name:"index",setup:function(e,t){var a=t.expose,i=M(),y=i.siteInfo,h=i.activeType.value,_=s(),j=b(),x=b([]),z=b(!1),C=b(!1),H=b(),$=S({name:"",version:"",ps:""}),N={version:[{required:!0,message:"请输入版本号",trigger:"blur"}]},W=b(!1),J=b(),K=S({version:""}),Q=p({options:[{label:"添加版本",type:"button",active:!0,onClick:function(){$.ps="",$.version="",C.value=!0}},{label:"当前目录生成版本",type:"button",onClick:function(){K.version="",W.value=!0}}]}).BtOperation,X=function(){var e=c(u().m(function e(t){var n;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,f({title:"删除版本【".concat(t.version,"】"),isHtml:!1,content:"删除版本，是否继续操作？",icon:"warning-filled"});case 1:return e.n=2,F({sitename:y.value.name,version:t.version},h);case 2:n=e.v,_.request(n),n.status&&te(),e.n=4;break;case 3:e.p=3,e.v;case 4:return e.a(2)}},e,null,[[0,3]])}));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=c(u().m(function e(t){var n,r;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,f({title:"恢复版本【".concat(t.version,"】"),isHtml:!1,content:"恢复版本，会删除目录下所有文件后恢复，请将【当前目录生成版本】备份后继续操作？",type:"calc",icon:"warning-filled"});case 1:return n=_.load("正在恢复版本，请稍后..."),e.n=2,I({sitename:y.value.name,version:t.version},h);case 2:r=e.v,_.request(r),e.n=4;break;case 3:e.p=3,e.v;case 4:return e.p=4,n.close(),e.f(4);case 5:return e.a(2)}},e,null,[[0,3,4,5]])}));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=c(u().m(function e(t){var n;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,G({sitename:y.value.name,version:t.version,ps:t.ps},h);case 1:n=e.v,_.request(n),te(),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}(),ee=b([{label:"版本号",prop:"version"},{label:"备注",prop:"ps",minWidth:120,isCustom:!0,showOverflowTooltip:!1,render:function(e){var t,n={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return e.ps=null===(t=e.ps)||void 0===t?void 0:t.replace(/&(lt|gt|nbsp|amp|quot);/gi,function(e,t){return n[t]}),k("input",{type:"text",value:e.ps,class:"bt-table-input w-full !whitespace-pre-line",placeholder:"点击编辑备注",onBlur:function(t){if(e.ps===t.target.value)return!1;e.ps=t.target.value,Z(e)}},null)}},A([{onClick:Y,title:"恢复"},{onClick:X,title:"删除"}])]),te=function(){var e=c(u().m(function e(){var t,n;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return z.value=!0,e.p=1,e.n=2,R({sitename:y.value.name},h);case 2:t=e.v,n=t.data,x.value=n.data,z.value=!1,e.n=4;break;case 3:e.p=3,e.v;case 4:return e.a(2)}},e,null,[[1,3]])}));return function(){return e.apply(this,arguments)}}(),ne=function(){var e=c(u().m(function e(){var t,n;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,J.value.validate();case 1:return e.p=1,t=_.load("正在生成版本，请稍后..."),e.n=2,B({sitename:y.value.name,version:K.version},h);case 2:n=e.v,_.request(n),n.status&&(W.value=!1,te()),e.n=4;break;case 3:e.p=3,e.v;case 4:return e.p=4,t.close(),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),re=function(){var e=c(u().m(function e(){return u().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,H.value.validate();case 1:return j.value.open(),e.a(2,!1)}},e)}));return function(){return e.apply(this,arguments)}}(),oe=function(){var e=c(u().m(function e(t){return u().w(function(e){for(;;)if(0===e.n)return e.a(2)},e)}));return function(t){return e.apply(this,arguments)}}();return T(te),a({init:te}),function(e,t){var a=d,u=v,i=q,c=m,s=E,p=l,f=r,b=U("bt-loading");return g(),w("div",null,[k(f,null,{"header-left":D(function(){return[k(O(Q))]}),"header-right":D(function(){return o(t[5]||(t[5]=[]))}),content:D(function(){return[P(k(a,{"max-height":"500",column:O(ee),data:O(x)},null,8,["column","data"]),[[b,O(z)]])]}),"footer-left":D(function(){return o(t[6]||(t[6]=[]))}),"footer-right":D(function(){return o(t[7]||(t[7]=[]))}),popup:D(function(){return[k(p,{title:"添加版本",area:44,modelValue:O(C),"onUpdate:modelValue":t[2]||(t[2]=function(e){return V(C)?C.value=e:null}),"show-footer":"",confirmText:"上传文件",onConfirm:re},{default:D(function(){return[k(s,{class:"p-[2rem]",ref_key:"addFromRef",ref:H,model:O($),rules:N},{default:D(function(){return[k(i,{label:"版本号",prop:"version"},{default:D(function(){return[k(u,{modelValue:O($).version,"onUpdate:modelValue":t[0]||(t[0]=function(e){return O($).version=e}),placeholder:"请输入版本号",width:"24rem"},null,8,["modelValue"])]}),_:1}),k(i,{label:"备注",prop:"ps"},{default:D(function(){return[k(u,{modelValue:O($).ps,"onUpdate:modelValue":t[1]||(t[1]=function(e){return O($).ps=e}),placeholder:"请输入备注",width:"24rem"},null,8,["modelValue"])]}),_:1}),k(L,{ref_key:"fileIpRef",ref:j,onUploadSuccess:oe,compData:n(n({},O($)),{},{sitename:O(y).name,getVersion:te,close:function(){C.value=!1}})},null,8,["compData"]),k(c,{options:[{content:"支持zip,tar.gz,tar,bz2,gz,xz格式"}],class:"list-disc ml-[7rem]"})]}),_:1},8,["model"])]}),_:1},8,["modelValue"]),k(p,{title:"当前目录生成版本",area:44,modelValue:O(W),"onUpdate:modelValue":t[4]||(t[4]=function(e){return V(W)?W.value=e:null}),"show-footer":"",onConfirm:ne},{default:D(function(){return[k(s,{class:"p-2rem",ref_key:"nowFromRef",ref:J,model:O(K),rules:N},{default:D(function(){return[k(i,{label:"版本号",prop:"version"},{default:D(function(){return[k(u,{modelValue:O(K).version,"onUpdate:modelValue":t[3]||(t[3]=function(e){return O(K).version=e}),placeholder:"请输入版本号",width:"26rem"},null,8,["modelValue"])]}),_:1})]}),_:1},8,["model"])]}),_:1},8,["modelValue"])]}),_:1})])}}}))}}})}();
