!function(){function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var n,r,a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function i(e,a,l,o){var i=a&&a.prototype instanceof s?a:s,c=Object.create(i.prototype);return t(c,"_invoke",function(e,t,a){var l,o,i,s=0,c=a||[],d=!1,p={p:0,n:0,v:n,a:f,f:f.bind(n,4),d:function(e,t){return l=e,o=0,i=n,p.n=t,u}};function f(e,t){for(o=e,i=t,r=0;!d&&s&&!a&&r<c.length;r++){var a,l=c[r],f=p.p,v=l[2];e>3?(a=v===t)&&(i=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=n):l[0]<=f&&((a=e<2&&f<l[1])?(o=0,p.v=t,p.n=l[1]):f<v&&(a=e<3||l[0]>t||t>v)&&(l[4]=e,l[5]=t,p.n=v,o=0))}if(a||e>1)return u;throw d=!0,t}return function(a,c,v){if(s>1)throw TypeError("Generator is already running");for(d&&1===c&&f(c,v),o=c,i=v;(r=o<2?n:i)||!d;){l||(o?o<3?(o>1&&(p.n=-1),f(o,i)):p.n=i:p.v=i);try{if(s=2,l){if(o||(a="next"),r=l[a]){if(!(r=r.call(l,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,o<2&&(o=0)}else 1===o&&(r=l.return)&&r.call(l),o<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),o=1);l=n}else if((r=(d=p.n<0)?i:e.call(t,p))!==u)break}catch(r){l=n,o=1,i=r}finally{s=1}}return{value:r,done:d}}}(e,l,o),!0),c}var u={};function s(){}function c(){}function d(){}r=Object.getPrototypeOf;var p=[][l]?r(r([][l]())):(t(r={},l,function(){return this}),r),f=d.prototype=s.prototype=Object.create(p);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=d,t(f,"constructor",d),t(d,"constructor",c),c.displayName="GeneratorFunction",t(d,o,"GeneratorFunction"),t(f),t(f,o,"Generator"),t(f,l,function(){return this}),t(f,"toString",function(){return"[object Generator]"}),(e=function(){return{w:i,m:v}})()}function t(e,n,r,a){var l=Object.defineProperty;try{l({},"",{})}catch(e){l=0}t=function(e,n,r,a){function o(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?l?l(e,n,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[n]=r:(o("next",0),o("throw",1),o("return",2))},t(e,n,r,a)}function n(e,t,n,r,a,l,o){try{var i=e[l](o),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,a)}function r(e){return function(){var t=this,r=arguments;return new Promise(function(a,l){var o=e.apply(t,r);function i(e){n(o,a,l,i,u,"next",e)}function u(e){n(o,a,l,i,u,"throw",e)}i(void 0)})}}System.register(["./base-lib-legacy.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./form-item-legacy.js?v=1763689792","./index-legacy68.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./index-legacy109.js?v=1763689792","./column-legacy.js?v=1763689792","./useController-legacy6.js?v=1763689792","./site-legacy.js?v=1763689792","./validator-legacy.js?v=1763689792","./index-legacy107.js?v=1763689792","./useStore-legacy4.js?v=1763689792"],function(t,n){"use strict";var a,l,o,i,u,s,c,d,p,f,v,g,m,y,b,h,x,_,w,j,k,O,L,S,T,C,G,P,R,q,D,F;return{setters:[function(e){a=e.c,l=e.g,o=e.e,i=e.D,u=e.H,s=e.J,c=e.I,d=e.az,p=e.ax,f=e.aT,v=e.b2,g=e.a8,m=e.x,y=e.y,b=e.A,h=e.z},function(e){x=e.M,_=e.h8,w=e.n,j=e.H,k=e.p,O=e.Q,L=e.h9,S=e.la,T=e.lb,C=e.h6,G=e.L,P=e._},function(e){R=e.h},function(e){q=e.u,D=e.h,F=e.f},null,null,null,null,null,null,null,null,null],execute:function(){var I=q(),z=I.redisGroupDetail,E=I.isRedisRefreshList,H=function(){var t=r(e().m(function t(n){var a,l,o,i,u,s,c,d;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:if(a=n.row,l=n.slaveListLoad,o=n.api,i=n.loadingText,u=n.needConfirm,s=n.confirmOptions,c=a.data.node_id,d=z.value.group_info.group_id,t.p=1,!u||!s){t.n=2;break}return t.n=2,k(s);case 2:return t.n=3,O({loading:i,request:o({group_id:d,slave_node_id:c}),message:!0,success:function(){var t=r(e().m(function t(n){var r,a;return e().w(function(e){for(;;)switch(e.n){case 0:return l.value=!0,e.n=1,L({group_id:d});case 1:r=e.v,a=r.data,z.value.slave_details=a.data.slave_details,l.value=!1,E.value=!0;case 2:return e.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}()});case 3:t.n=5;break;case 4:t.p=4,t.v;case 5:return t.a(2)}},t,null,[[1,4]])}));return function(e){return t.apply(this,arguments)}}(),Q=function(){var t=r(e().m(function t(r){var a,l,o,i,u,s;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return l=null===(a=r.group_info)||void 0===a?void 0:a.group_id,o=x.load("正在获取可用从节点，请稍后..."),e.p=1,e.n=2,_();case 2:i=e.v,(u=i.data).status||x.error(u.msg||"获取可用节点数据失败！"),s=u.data.filter(function(e){return null===e.group_info}),w({title:"添加从节点",area:50,btn:["添加从节点","取消"],component:function(){return j(function(){return n.import("./add-slave-node-legacy.js?v=1763689792")},void 0,n.meta.url)},compData:{group_id:l,nodes:s||[]}}),e.n=4;break;case 3:e.p=3,e.v;case 4:return e.p=4,null==o||o.close(),e.f(4);case 5:return e.a(2)}},t,null,[[1,3,4,5]])}));return function(e){return t.apply(this,arguments)}}(),A={class:"p-[2rem] redis-mgt-group-page"},B=a({__name:"index",setup:function(e){var t=q(),n=t.redisGroupDetail,r=t.slaveListLoad,a=l(function(){var e,t,r,a,l,u,s=(null===(e=n.value)||void 0===e||null===(e=e.master_detail)||void 0===e?void 0:e.data)||{},c=s.memory||{},d=s.performance||{},p=o("span",{class:"text-tertiary"},[i("...")]);return[{label:"节点地址",value:null!==(t=s.address)&&void 0!==t?t:p},{label:"Redis版本",value:null!==(r=s.redis_version)&&void 0!==r?r:p},{label:"运行天数",value:C(s.uptime_days)?p:s.uptime_days+"天"},{label:"内存使用",value:null!==(a=c.used_memory_human)&&void 0!==a?a:p},{label:"当前QPS",value:null!==(l=d.qps)&&void 0!==l?l:p},{label:"连接数",value:null!==(u=s.connected_slaves)&&void 0!==u?u:p}]}),x=G({data:n.value,options:function(e){return l(function(){return[R("",function(){return o("div",{class:"w-full mb-[32px]"},[o("div",{class:"flex items-center mb-[20px]"},[o("span",{class:"text-base mr-[1rem]"},[i("基本信息")]),o(u,{disabled:r.value,type:"default",class:"!h-[28px] !text-small",onClick:function(){return D(n,"master")}},{default:function(){return[i("查看详细信息")]}})]),o("div",{class:"grid grid-cols-2 gap-x-[24px] gap-y-[12px] text-secondary"},[a.value.map(function(e){return o("div",{class:"flex justify-between items-center bg-lighter rounded-medium px-[16px] py-[8px]"},[o("span",{class:"font-bold w-[90px] flex-shrink-0"},[e.label]),o("span",{class:"flex-1 text-right"},[e.value])])})])])},"base_info"),R("",function(){var e;return o("div",{class:"w-full"},[o("div",{class:"flex items-center mb-[12px]"},[o("span",{class:"text-base"},[i("从节点列表")]),o(u,{type:"primary",class:"ml-auto !h-[28px] !px-[12px] !text-small",onClick:function(){return Q(n.value)}},{default:function(){return[i("添加从节点")]}})]),s(o(d,{data:n.value.slave_details,"table-layout":"auto",height:(null===(e=n.value.slave_details)||void 0===e?void 0:e.length)>10?"40rem":"auto",class:"w-full"},{default:function(){return[o(p,{prop:"server_ip",label:"地址","min-width":"140"},{default:function(e){var t=e.row;return o("span",{class:"text-small"},[t.data.server_ip])}}),o(p,{prop:"status",label:"状态",width:"80"},{default:function(e){var t=e.row;return"online"===t.data.status?o("span",{class:"bg-[var(--el-color-success-light-8)] text-primary px-[8px] py-[2px] rounded"},[i("在线")]):o("span",{class:"bg-light text-danger cursor-pointer px-[8px] py-[2px] rounded"},[i("离线"),o(f,{content:t.data.replication.error,placement:"top"},{default:function(){return[o("span",{class:"ml-4px bt-ico-ask"},[i("?")])]}})])}}),o(p,{prop:"health_score",label:"健康度",width:"80"},{default:function(e){var t=e.row,n=t.data.health_score||0,r="online"===t.data.status;return o("span",{style:{display:"inline-flex",alignItems:"center"}},[o("span",{style:{display:"inline-flex",justifyContent:"center",alignItems:"center",width:"40px",height:"40px",borderRadius:"50%",background:r?"var(--el-color-primary)":"var(--el-color-danger)",color:"var(--el-color-white)",fontWeight:700,fontSize:"12px",marginRight:"4px",transition:"background 0.2s"}},[n,i("%")])])}}),o(p,{prop:"memory",label:"内存",width:"60"},{default:function(e){var t=e.row;return F(t.data.memory.usage_percent)}}),o(p,{prop:"qps",label:"QPS",width:"80"},{default:function(e){return e.row.data.performance.qps||"--"}}),o(p,{prop:"lag",label:"延迟（秒）",width:"80"},{default:function(e){return e.row.data.replication.lag||"--"}}),o(p,{prop:"delay",label:"偏移量",width:"80"},{default:function(e){return e.row.data.replication.repl_offset||"--"}}),o(p,{align:"right",label:"操作",width:"140"},{default:function(e){e.$index;var t=e.row;return o("div",{class:"flex items-center justify-end"},["offline"===t.data.status&&o("span",null,[o("span",{class:"bt-link",onClick:function(){return function(e,t){return H({row:e,slaveListLoad:t,api:T,loadingText:"正在重连，请稍后..."})}(t,r)}},[i("重启")]),o(v,{direction:"vertical"},null)]),o("span",{class:"bt-link",onClick:function(){return D(t,"slave")}},[i("详情")]),"online"===t.data.status&&o("span",null,[o(v,{direction:"vertical"},null),o("span",{class:"bt-link",onClick:function(){return function(e,t){return H({row:e,slaveListLoad:t,api:S,loadingText:"正在移除从节点，请稍后...",needConfirm:!0,confirmOptions:{icon:"warning-filled",title:"移除从节点",content:"即将移除该从节点，是否继续操作？"}})}(t,r)}},[i("移除")])])])}})]}}),[[c("bt-loading"),r.value]])])},"slave_table")]})}}).BtForm;return g(function(){n.value={},r.value=!0}),function(e,t){return m(),y("div",A,[b("div",null,[o(h(x))])])}}});t("default",P(B,[["__scopeId","data-v-f6121d5a"]]))}}})}();
