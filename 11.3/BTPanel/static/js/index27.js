import{_ as e}from"./index109.js?v=1763689792";import{u as t,aH as s,b2 as a,e as l,b as i,aQ as n,b3 as o,an as r,ao as c,ap as m,_ as p}from"./utils-lib.js?v=1763689792";import{u}from"./index147.js?v=1763689792";import{c as d,r as f,o as k,v as y,aG as v,z as x,x as h,O as b,C as g,y as _,A as j,e as w,D as C,G as S,s as B,aE as D,ar as I,at as H,as as L,a8 as O,i as P}from"./base-lib.js?v=1763689792";import{k as R}from"./validator.js?v=1763689792";import"./index.vue_vue_type_style_index_0_scoped_cdc7f4d3_lang.js?v=1763689792";import{a as T,o as q,g as A,u as N}from"./column.js?v=1763689792";import{D as F,u as G,a as W,b as E,c as M,g as z,d as J,o as K,e as Q,f as V,s as U,h as X,i as Y,j as Z}from"./useController4.js?v=1763689792";import{N as $}from"./useMethods.js?v=1763689792";import{B as ee}from"./index138.js?v=1763689792";import{_ as te}from"./index137.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index131.js?v=1763689792";import"./index110.js?v=1763689792";import"./index107.js?v=1763689792";import"./useController5.js?v=1763689792";import"./site.js?v=1763689792";import"./useStore4.js?v=1763689792";import"./useController6.js?v=1763689792";import"./useMethod5.js?v=1763689792";const se={key:0,class:"flex items-center"},ae={key:1,class:"flex items-center"},le=d({__name:"index",emits:["init"],setup(e,{expose:n,emit:o}){const r=i(),c=o,{plugin:m}=t(),p=f(m.value.webserver),u=f(!1),d=f(!1),B=k({title:"",name:"",status:!0,version:"",admin:!1,s_version:"",setup:!1});let D=!1;const I=async(e=!1)=>{try{if(D)return;const{data:t}=await a({name:"web"});t.status||e||setTimeout(()=>{I()},3e3),t.status&&!e&&c("init"),u.value=!t.status,Object.assign(B,t),"nginx"!==t.name&&(u.value=!0,d.value=t.status)}catch(t){e||setTimeout(()=>{I()},3e3)}};return y(()=>{I(!0)}),v(()=>{D=!0}),n({checkInstallStatus:I,pluginInfo:B,maskLayer:u,webServerType:p}),(e,t)=>{const a=l,i=te;return x(u)?(h(),b(i,{key:0,width:"38rem"},{content:g(()=>[x(d)?(h(),_("div",ae,[...t[3]||(t[3]=[j("span",null,"Docker项目只支持nginx环境",-1)])])):(h(),_("div",se,[t[2]||(t[2]=j("span",null,"未安装运行环境，",-1)),w(a,{onClick:t[0]||(t[0]=e=>(async e=>{const{data:t}=await s({sName:e.name});if("-1"===t.task)return r.error("当前插件正在安装，不可重复安装");R({name:null==t?void 0:t.name,type:"i",pluginInfo:t}),I()})({name:"nginx"})),class:"!font-bold !text-base"},{default:g(()=>[...t[1]||(t[1]=[C("安装Nginx",-1)])]),_:1})]))]),_:1})):S("",!0)}}}),ie={class:""},ne={class:"flex items-center ml-1rem"};const oe=p(d({__name:"index",setup(s){const{mainHeight:a}=t(),{getDockerSiteList:i,setDockerSiteStatus:p,setDockerSiteRemark:d,delDockerSite:f,resetData:k}=F(),{refs:{isRefreshSiteList:v}}=n(),{pluginInfo:b,classList:S,statusFilterKey:R}=B(F()),{BtOperation:te}=o({options:[{type:"button",label:"创建",active:!0,onClick:()=>V()},{type:"button",label:"运行环境",onClick:()=>U()},{type:"button",label:"常用设置",onClick:()=>X()},{type:"custom",render:()=>w(ee,{style:"margin-left:1.2rem;",isRequest:!1,pluginInfo:b.value},null)}]}),se=m([Y({callback:()=>{},classList:S}),{label:"删除项目",value:"delete",event:Z}]),ae=u({key:"classify",name:"Docker分类",options:()=>[{label:"全部分类",value:"all"}],event:J,ignore:["0","-2"],field:"name"}),{BtTable:oe,BtPage:re,BtRefresh:ce,BtSearch:me,BtColumn:pe,BtBatch:ue,BtTableCategory:de,refresh:fe}=r({request:e=>i({p:e.p||1,row:e.limit||20,query:e.search||"",...e.classify&&"all"!==e.classify?{classify:e.classify}:{},..."all"!==R.value?{type:R.value}:{}}),columns:[T(),G({onClick:K,openPlugin:Q}),{label:"类型",prop:"type",minWidth:90,renderHeader(){const e=[{title:"全部",key:"all"},{title:"JAVA",key:"java"},{title:"Go",key:"go"},{title:"PHP",key:"php"},{title:"Python",key:"python"},{title:"Node",key:"nodejs"},{title:"反向代理",key:"proxy"},{title:"Docker应用",key:"app"}];return D("div",{class:"flex items-center flex-nowrap"},["",D(I,{onCommand:e=>{R.value=e,fe()}},{default:()=>D("span",{class:"text-small flex items-center"},[[w("span",{class:"status-header-text leading-[1.5] whitespace-nowrap"},[C("类型"),"all"===R.value?"":"(".concat(e.find(e=>e.key===R.value).title,")")])],D("i",{class:"svgtofont-el-arrow-down "})]),dropdown:()=>{let t;return w(L,null,"function"==typeof(s=t=e.map(e=>w(H,{command:e.key},{default:()=>[e.title]})))||"[object Object]"===Object.prototype.toString.call(s)&&!P(s)?t:{default:()=>[t]});var s}})])}},W({prop:"status",onClick:e=>{const t="1"===e.status?0:1;p({status:t,id:e.id,site_name:e.name,edate:e.edate})},onFilterEvent:e=>{R.value=e,fe()}}),{label:"根目录",prop:"path",minWidth:200,isCustom:!0,render:e=>w("div",null,[w("span",{class:"w-full whitespace-pre-line inline-block bt-link leading-[16px]",onClick:()=>q(e,"path"),title:"点击打开目录"},[e.path])])},E(),A({request:(e,t)=>{d({remark:t,id:e.id,site_name:e.name})},prop:"remark",width:200}),M({onClick:e=>K(e,"ssl")}),N([{onClick:e=>{Q(e,"monitor-setting")},title:"统计"},{onClick:e=>{Q(e,"bt_waf")},title:"WAF"},{title:"设置",onClick:K},{title:"删除",onClick:e=>{f(e)}}])],extension:[ae,se,c(v)]});return y(()=>{z()}),O(()=>{k()}),(t,s)=>{const i=l,n=e;return h(),_("div",ie,[w(le,{ref:"envRef",onInit:x(fe)},null,8,["onInit"]),w(n,null,{"header-left":g(()=>[w(x(te)),j("div",ne,[j("div",{class:"flex items-center",onClick:s[0]||(s[0]=(...e)=>x($)&&x($)(...e))},[...s[1]||(s[1]=[j("i",{class:"svgtofont-desired text-medium"},null,-1),j("span",{class:"bt-link"},"需求反馈",-1)])]),w(i,{href:"https://www.bt.cn/bbs/thread-140664-1-1.html",class:"ml-10px"},{default:g(()=>[...s[2]||(s[2]=[C(">>使用帮助",-1)])]),_:1})])]),"header-right":g(()=>[w(x(de),{class:"!w-[160px] mr-[10px]"}),w(x(me),{class:"mr-[10px] !w-[26rem]",placeholder:"请输入项目名称或备注"}),w(x(ce),{class:"mr-[10px]"}),w(x(pe))]),content:g(()=>[w(x(oe),{"max-height":x(a)},null,8,["max-height"])]),"footer-left":g(()=>[w(x(ue))]),"footer-right":g(()=>[w(x(re))]),_:1})])}}}),[["__scopeId","data-v-05143921"]]);export{oe as default};
