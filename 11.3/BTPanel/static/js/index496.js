import{c as e,g as a,x as t,y as s,A as l,D as r,B as i,z as n,G as o,L as c,s as d,F as m,b1 as u,e as p,b2 as v,o as _,b8 as f,C as y,aT as g,r as b,I as x,J as h,R as w,aD as k,aF as D,bP as V,bO as S,w as j,n as A,bc as C,bd as L}from"./base-lib.js?v=1763689792";import{H as T}from"./store6.js?v=1763689792";import{_ as z,u as I,p as M,Q as E,n as H,H as O,M as U,bK as N,aw as P,V as B,l as F,j as Q}from"./utils-lib.js?v=1763689792";import{c$ as R,d7 as W,d8 as q,l as G,d9 as J,da as K}from"./validator.js?v=1763689792";import{getPluginInfo as $}from"./site.js?v=1763689792";import{H as X}from"./index344.js?v=1763689792";import{u as Y}from"./column.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./index107.js?v=1763689792";const Z={class:"risk-chart"},ee={class:"circle-box"},ae={class:"circle-box-inner"},te={class:"circle-box-value"},se={class:"circle-box-desc"},le={class:"flex-1 ml-[2rem] mr-[4rem] mt-[2rem]"},re={key:0,class:"mb-[1rem]"},ie=z(e({__name:"totalScore",setup(e){const d=T(),{scoreData:m}=d,u=[{color:"var(--el-color-danger)",percentage:60,type:"danger"},{color:"var(--el-color-warning)",percentage:80,type:"warn"},{color:"var(--el-color-warning-light-3)",percentage:90,type:"alert"},{color:"var(--el-color-primary)",percentage:100,type:"safe"}],p=a(()=>u.find(e=>m.score<e.percentage));return(e,a)=>{var d;return t(),s("div",{class:c(["flex mt-[2rem] ml-[1rem] items-center","circle-".concat(null==(d=n(p))?void 0:d.type)])},[l("div",Z,[l("div",ee,[a[1]||(a[1]=l("div",{class:"circle-box-bg"},null,-1)),l("div",ae,[l("div",te,[r(i(n(m).score)+" ",1),a[0]||(a[0]=l("div",{class:"unit"},"分",-1))]),l("div",se,i(n(m).scoreLevel),1)])])]),l("div",le,[n(m).riskNum>0?(t(),s("div",re,[a[2]||(a[2]=r(" 发现",-1)),l("span",null,i(n(m).riskNum),1),a[3]||(a[3]=r("条风险 ",-1))])):o("",!0),a[4]||(a[4]=l("template",null,[l("div",{class:"mb-[1rem]"},"无风险")],-1)),l("p",null,i(n(m).subtitle),1)])],2)}}}),[["__scopeId","data-v-d8c72a17"]]),ne={class:"flex items-center justify-between text-small"},oe={class:"text-iconLarge mx-[0.4rem] text-primary"},ce={class:"leading-[2rem]"},de={class:"flex items-center"},me={class:"flex ml-[0.6rem]"},ue={class:"mr-[0.1rem]"},pe=["title","src"],ve={class:"flex ml-[1rem] text-base text-bold"},_e={class:"flex items-center mr-[2rem]"},fe={class:"flex items-center mr-[2rem]"},ye={class:"flex items-center"},ge=e({__name:"defenseInfo",setup(e){I();const a=T(),{capabilitySwitch:o}=a,{safeDay:c,scanTime:_,virusUpdateTime:f,isMalwareConfirm:y}=d(a),g=async e=>{let a=e?"开启":"关闭",t=e?"将全天候检测系统是否存在恶意文件":"将不再检测系统是否存在恶意文件";try{await M({title:"".concat(a,"动态查杀"),content:"".concat(a,"后，").concat(t,"，是否继续？")}),o.file_detection.status=e,await E({loading:"正在保存配置，请稍后...",request:R({dynamic_detection:e}),message:!0})}catch(s){o.file_detection.status=!e}},b=()=>{H({title:"设置自动扫描",area:54,component:()=>O(()=>import("./index523.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),showFooter:!0,close:()=>{y.value?y.value=!1:o.vul_scan.status=!o.vul_scan.status}})},x=async e=>{if(e){const{data:e}=await $({sName:"bt_hids"});e.setup?await a():(U.error("请先安装入侵检测插件"),o.hids.status=!1)}else await a();async function a(){const e=await W();U.request(e)}};return(e,a)=>{const d=v,y=N;return t(),s("div",null,[l("div",ne,[l("div",null,[a[3]||(a[3]=r(" 已累计保护您的资产",-1)),l("strong",oe,i(n(c)),1),a[4]||(a[4]=r("天 ",-1))]),l("div",ce,[l("div",de,[a[5]||(a[5]=l("span",null,"已开启安全能力",-1)),l("ul",me,[(t(!0),s(m,null,u(n(o),(e,a)=>(t(),s("li",ue,[l("img",{alt:"",title:e.name,src:"/static/images/home/".concat(e.icon).concat(e.status?"-active":"",".svg"),width:"14"},null,8,pe)]))),256))])]),l("div",null,"首页风险扫描时间："+i(n(_)),1),l("div",null,"病毒库版本更新时间："+i(n(f)),1)])]),p(d,{direction:"horizontal",class:"!mb-[1.8rem] !mt-0"}),l("div",ve,[l("div",_e,[a[6]||(a[6]=l("span",{class:"mr-2"},"恶意文件检测",-1)),p(y,{size:"small",modelValue:n(o).file_detection.status,"onUpdate:modelValue":a[0]||(a[0]=e=>n(o).file_detection.status=e),onChange:g},null,8,["modelValue"])]),l("div",fe,[a[7]||(a[7]=l("span",{class:"mr-2"},"漏洞扫描",-1)),p(y,{size:"small",modelValue:n(o).vul_scan.status,"onUpdate:modelValue":a[1]||(a[1]=e=>n(o).vul_scan.status=e),onChange:b},null,8,["modelValue"])]),l("div",ye,[a[8]||(a[8]=l("span",{class:"mr-2"},"入侵检测",-1)),p(y,{size:"small",modelValue:n(o).hids.status,"onUpdate:modelValue":a[2]||(a[2]=e=>n(o).hids.status=e),onChange:x},null,8,["modelValue"])])])])}}}),be={class:"my-10"},xe={class:"flex h-[3.2rem]"},he={class:"text-iconLarge mr-[2rem]"},we={class:"flex items-end alertNum"},ke={class:"bg-danger"},De={class:"bg-warning"},Ve={class:"bg-darkTertiary"},Se=z(e({__name:"pendingAlarm",setup(e,{expose:a}){const r=_({total:0,high_risk:0,medium_risk:0,low_risk:0}),o=f({tooltip:{trigger:"axis",axisPointer:{type:"line",lineStyle:{width:1,type:"solid"}}},grid:{top:"16%",left:"-8%",right:"0%",bottom:"0%",containLabel:!1},xAxis:{data:[],show:!1},yAxis:{show:!1},series:[]}),{BtECharts:c,getEChart:d,setOption:m,setQuickOption:u}=P({options:{}});return a({setData:async()=>{try{const{data:e}=await q(),a=e.trend_list.map(e=>B(e.timestamp)),t=e.trend_list.map(e=>e.count);o.xAxis={data:a,show:!1},o.series=((e=[0,0,0,0,0,0])=>[{name:"风险数量",type:"line",data:e,itemStyle:{color:"#ec958d"},smooth:!0,showSymbol:!1,sampling:"average",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"#fcdcd5"},{offset:1,color:"#fcdcd5"}]}}}])(t),r.total=e.total,r.high_risk=e.high_risk,r.medium_risk=e.medium_risk,r.low_risk=e.low_risk,m(o)}catch(e){}}}),(e,a)=>(t(),s("div",be,[a[0]||(a[0]=l("div",null,"待处理风险",-1)),l("div",xe,[l("span",he,i(n(r).total),1),l("div",we,[l("span",ke,i(n(r).high_risk),1),l("span",De,i(n(r).medium_risk),1),l("span",Ve,i(n(r).low_risk),1)])]),p(n(c),{style:{height:"60px"}})]))}}),[["__scopeId","data-v-b2bac4f2"]]),je={class:"flex flex-wrap mt-4"},Ae={class:"flex flex-col items-center w-[11rem] mb-[1rem]"},Ce=["onClick"],Le=z(e({__name:"pendingRisk",setup(e){const a=T(),{risk_details:r}=d(a),{riskInstallDetails:o}=a,{repairTypeActive:v}=d(X());return(e,a)=>{const d=g;return t(),s("div",je,[(t(!0),s(m,null,u(n(r),(e,r)=>(t(),s("div",Ae,[l("div",null,[l("span",null,i(e.title),1),p(d,{content:e.tips,placement:"top"},{default:y(()=>[...a[0]||(a[0]=[l("span",{class:"ml-4px bt-ico-ask"},"?",-1)])]),_:1},8,["content"])]),l("div",{class:c(["text-subtitleLarge cursor-pointer",e.value>0?"text-default":"text-secondary"]),onClick:a=>(e=>{switch(e.type){case"vul_scan":v.value="web";break;case"file_detection":v.value="malware";break;case"homepage_risk":v.value="risk";break;case"safe_detect":v.value="safeDetect";break;case"hids":if(!o.hids)return U.error("请先安装入侵检测插件");G({name:"bt_hids"});break;case"tamper":if(!o.tamper)return U.error("请先安装堡塔企业级防篡改插件");G({name:"tamper_core"})}})(e)},i(e.value),11,Ce)]))),256))])}}}),[["__scopeId","data-v-ca9a2035"]]),Te={class:""},ze=e({__name:"securityTrend",setup(e,{expose:a}){const r=f({tooltip:{trigger:"axis",axisPointer:{type:"shadow",label:{show:!0}}},legend:{bottom:0,itemWidth:12,itemHeight:10,itemGap:10,textStyle:{fontSize:10,color:"#666666"},data:[]},grid:{top:"4%",right:"10%",bottom:"24%"},xAxis:[{type:"category",axisTick:{alignWithLabel:!0},axisLabel:{textStyle:{color:"#666666"}},data:[]}],yAxis:[{type:"value",min:0,axisLabel:{textStyle:{color:"#666666"}}}],series:[]}),{BtECharts:i,getEChart:o,setOption:c,setQuickOption:d}=P({options:{}}),m=(e,a=[],t)=>[{name:e,type:"line",lineStyle:{normal:{}},smooth:!0,showSymbol:!1,sampling:"average",data:a}],u=(e,a=[],t)=>[{name:e,type:"bar",barWidth:"8px",itemStyle:{normal:{color:t}},data:a}];return a({setData:async()=>{try{const{data:e}=await J(),a=[],t=[],s=[],l=[],i=[];e.trend_list.forEach(e=>{a.push(e.unhandled_risks),t.push(e.handled_risks),s.push(e.risk_scan),l.push(e.vul_scan),i.push(e.server_risks)}),r.xAxis[0].data=e.trend_list.map(e=>B(e.timestamp,"MM/dd")),r.series=[...m("未处理风险",a),...m("已处理风险",t),...u("首页",s,"rgb(29, 159, 234, 1)"),...u("漏洞",l,"rgb(30,67,180,1)"),...u("基线",i,"rgb(70,44,104,1)")],r.legend.data=["未处理风险","已处理风险","首页","漏洞","基线"],c(r)}catch(e){}}}),(e,a)=>(t(),s("div",Te,[a[0]||(a[0]=l("div",{class:"h-[4rem] leading-[4rem]"},"安全趋势",-1)),p(n(i),{class:"!h-[20rem]"})]))}}),Ie={class:"p-[2rem]"},Me=z(e({__name:"securityDynamic",setup(e,{expose:a}){const o=b("safeDynamic"),c=b(!1),d=b({type:"",behavior:"",level:0,time:"",scan_type:"",description:"",solution:""}),m=b({total:0,loading:!1,data:[]}),u=[{label:"风险行为",prop:"description",render:e=>p("span",{class:"truncate !w-[12rem]",title:e.description},[e.description])},{label:"风险等级",prop:"level",width:64,render:e=>{const{text:a,style:t}=v(e.level);return p("span",{style:t},[r("["),a,r("]")])}},{label:"发现时间",prop:"time",width:64,render:e=>B(e.time,"MM-dd")},Y([{onClick:e=>{c.value=!0,d.value=e},title:"详情"}])],v=e=>{switch(e){case 2:return{text:"中危",style:"color: var(--el-color-warning-light-3)"};case 3:return{text:"高危",style:"color: var(--el-color-danger)"};case 4:return{text:"紧急",style:"color: var(--el-color-danger-dark-2)"};default:return{text:"--",style:"color: var(--el-color-black)"}}};return a({getListData:async()=>{m.value.loading=!0;try{const{data:e}=await K();m.value.data=e.events}finally{m.value.loading=!1}}}),(e,a)=>{const _=F,f=k,g=D,b=V,j=S,A=Q,C=x("bt-loading");return t(),s("div",null,[p(g,{modelValue:n(o),"onUpdate:modelValue":a[0]||(a[0]=e=>w(o)?o.value=e:null),class:"dynamic-tabs"},{default:y(()=>[p(f,{label:"安全动态",name:"safeDynamic"},{default:y(()=>[h(p(_,{ref:"malwareTable",column:u,data:n(m).data,"max-height":"185"},null,8,["data"]),[[C,n(m).loading],[C,"正在获取安全动态列表，请稍后...","title"]])]),_:1})]),_:1},8,["modelValue"]),p(A,{title:"【".concat(n(d).scan_type,"】详情"),modelValue:n(c),"onUpdate:modelValue":a[1]||(a[1]=e=>w(c)?c.value=e:null),area:53},{default:y(()=>[l("div",Ie,[p(j,{column:2,size:"small",border:"",class:"table-descriptions"},{default:y(()=>[p(b,{label:"风险行为："},{default:y(()=>[r(i(n(d).behavior),1)]),_:1}),p(b,{label:"风险等级："},{default:y(()=>[r(i(v(n(d).level).text),1)]),_:1}),p(b,{label:"发现时间："},{default:y(()=>[r(i(n(B)(n(d).time,"yyyy-MM-dd HH:mm:ss")),1)]),_:1}),p(b,{label:"扫描类型："},{default:y(()=>[r(i(n(d).scan_type),1)]),_:1}),p(b,{label:"描述：",span:2},{default:y(()=>[r(i(n(d).description),1)]),_:1}),p(b,{label:"解决方案：",span:2},{default:y(()=>[r(i(n(d).solution),1)]),_:1})]),_:1})])]),_:1},8,["title","modelValue"])])}}}),[["__scopeId","data-v-df55157c"]]),Ee=e({__name:"index",setup(e){const a=X(),r=T(),{repairTypeActive:i}=d(a),n=b(),o=b(),c=b();return j(i,e=>{"overview"===e&&A(()=>{r.getSafeOverviewData(),n.value.setData(),o.value.setData(),c.value.getListData()})},{immediate:!0}),(e,a)=>{const r=C,i=L,d=v;return t(),s("section",null,[a[0]||(a[0]=l("div",{class:"text-large mb-6"},"安全总览",-1)),p(i,null,{default:y(()=>[p(r,{span:13},{default:y(()=>[p(ie)]),_:1}),p(r,{span:11},{default:y(()=>[p(ge)]),_:1})]),_:1}),p(i,null,{default:y(()=>[p(r,{span:13},{default:y(()=>[p(Se,{ref_key:"pendingAlarm",ref:n},null,512)]),_:1}),p(r,{span:11},{default:y(()=>[p(Le)]),_:1})]),_:1}),p(d,{direction:"horizontal",class:"!my-0"}),p(i,null,{default:y(()=>[p(r,{span:14},{default:y(()=>[p(ze,{ref_key:"securityTrend",ref:o},null,512)]),_:1}),p(r,{span:10},{default:y(()=>[p(Me,{ref_key:"securityDynamic",ref:c},null,512)]),_:1})]),_:1})])}}});export{Ee as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
