!function(){function t(n){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(n)}function n(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var e,o,a,u,i=[],c=!0,s=!1;try{if(a=(r=r.call(t)).next,0===n){if(Object(r)!==r)return;c=!1}else for(;!(c=(e=a.call(r)).done)&&(i.push(e.value),i.length!==n);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(s)throw o}}return i}}(t,n)||function(t,n){if(t){if("string"==typeof t)return r(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,e=Array(n);r<n;r++)e[r]=t[r];return e}function e(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,e)}return r}function o(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach(function(n){a(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function a(n,r,e){return(r=function(n){var r=function(n,r){if("object"!=t(n)||!n)return n;var e=n[Symbol.toPrimitive];if(void 0!==e){var o=e.call(n,r||"default");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(n)}(n,"string");return"symbol"==t(r)?r:r+""}(r))in n?Object.defineProperty(n,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[r]=e,n}function u(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,n,r="function"==typeof Symbol?Symbol:{},e=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function a(r,e,o,a){var u=e&&e.prototype instanceof s?e:s,l=Object.create(u.prototype);return i(l,"_invoke",function(r,e,o){var a,u,i,s=0,l=o||[],f=!1,p={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(n,r){return a=n,u=0,i=t,p.n=r,c}};function y(r,e){for(u=r,i=e,n=0;!f&&s&&!o&&n<l.length;n++){var o,a=l[n],y=p.p,v=a[2];r>3?(o=v===e)&&(i=a[(u=a[4])?5:(u=3,3)],a[4]=a[5]=t):a[0]<=y&&((o=r<2&&y<a[1])?(u=0,p.v=e,p.n=a[1]):y<v&&(o=r<3||a[0]>e||e>v)&&(a[4]=r,a[5]=e,p.n=v,u=0))}if(o||r>1)return c;throw f=!0,e}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&y(l,v),u=l,i=v;(n=u<2?t:i)||!f;){a||(u?u<3?(u>1&&(p.n=-1),y(u,i)):p.n=i:p.v=i);try{if(s=2,a){if(u||(o="next"),n=a[o]){if(!(n=n.call(a,i)))throw TypeError("iterator result is not an object");if(!n.done)return n;i=n.value,u<2&&(u=0)}else 1===u&&(n=a.return)&&n.call(a),u<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),u=1);a=t}else if((n=(f=p.n<0)?i:r.call(e,p))!==c)break}catch(n){a=t,u=1,i=n}finally{s=1}}return{value:n,done:f}}}(r,o,a),!0),l}var c={};function s(){}function l(){}function f(){}n=Object.getPrototypeOf;var p=[][e]?n(n([][e]())):(i(n={},e,function(){return this}),n),y=f.prototype=s.prototype=Object.create(p);function v(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,i(t,o,"GeneratorFunction")),t.prototype=Object.create(y),t}return l.prototype=f,i(y,"constructor",f),i(f,"constructor",l),l.displayName="GeneratorFunction",i(f,o,"GeneratorFunction"),i(y),i(y,o,"Generator"),i(y,e,function(){return this}),i(y,"toString",function(){return"[object Generator]"}),(u=function(){return{w:a,m:v}})()}function i(t,n,r,e){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}i=function(t,n,r,e){function a(n,r){i(t,n,function(t){return this._invoke(n,r,t)})}n?o?o(t,n,{value:r,enumerable:!e,configurable:!e,writable:!e}):t[n]=r:(a("next",0),a("throw",1),a("return",2))},i(t,n,r,e)}function c(t,n,r,e,o,a,u){try{var i=t[a](u),c=i.value}catch(t){return void r(t)}i.done?n(c):Promise.resolve(c).then(e,o)}function s(t){return function(){var n=this,r=arguments;return new Promise(function(e,o){var a=t.apply(n,r);function u(t){c(a,e,o,u,i,"next",t)}function i(t){c(a,e,o,u,i,"throw",t)}u(void 0)})}}System.register(["./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./validator-legacy.js?v=1763689792","./useStore-legacy4.js?v=1763689792","./site-legacy.js?v=1763689792","./useController-legacy6.js?v=1763689792"],function(t,r){"use strict";var e,a,i,c,l,f,p,y,v,m,d,h,g,b,w,_,j,x,S,O,P,E,T,k,N,C;return{setters:[function(t){e=t.Q,a=t.aK,i=t.M,c=t.u,l=t.n,f=t.H,p=t.aS,y=t.p},function(t){v=t.j,m=t.r,d=t.s,h=t.e,g=t.D,b=t.F,w=t.n,_=t.o},function(t){j=t.l,x=t.f},function(t){S=t.u,O=t.S},function(t){P=t.delProxyProject,E=t.batchDelNginx,T=t.addProxyProject,k=t.proxyTcpAction,N=t.getProxyConfigFile},function(t){C=t.o}],execute:function(){var A=t("S",v("SITE-PROXY-STORE",function(){var t=S().isRefreshList,n=m("http"),r=function(){var n=s(u().m(function n(r,o){var a,i;return u().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,a={remove_path:o?1:0,id:r.id,site_name:r.name},n.n=1,e({loading:"正在删除反向代理项目，请稍候...",request:P(a),message:!0});case 1:return i=n.v,t.value=!0,n.a(2,{status:i.status,msg:i.msg});case 2:return n.p=2,n.v,n.a(2,{status:!1,msg:"删除项目失败"})}},n,null,[[0,2]])}));return function(t,r){return n.apply(this,arguments)}}(),c=function(){var n=s(u().m(function n(r){var a;return u().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,e({loading:"正在删除反向代理项目，请稍候...",request:E(r),message:!1});case 1:return a=n.v,t.value=!0,n.a(2,{status:a.status,msg:a.msg,data:a.data.data.map(function(t){return o(o({},t),{},{name:t.site_name})})});case 2:return n.p=2,n.v,n.a(2,{status:!1,msg:"删除项目失败",data:[]})}},n,null,[[0,2]])}));return function(t){return n.apply(this,arguments)}}(),l=function(){var t=s(u().m(function t(n){var r,e;return u().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,T(n);case 1:return r=t.v,t.a(2,o({},r));case 2:t.p=2,e=t.v,a(e);case 3:return t.a(2)}},t,null,[[0,2]])}));return function(n){return t.apply(this,arguments)}}(),f=function(){var t=s(u().m(function t(n){var r,e;return u().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,k(n);case 1:return r=t.v,t.a(2,o({},r));case 2:t.p=2,e=t.v,a(e);case 3:return t.a(2)}},t,null,[[0,2]])}));return function(n){return t.apply(this,arguments)}}(),p=function(){var t=s(u().m(function t(n){var r,e;return u().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,N(n);case 1:return r=t.v,(e=r.data).status||i.error(e.msg),t.a(2,{data:e.data,status:e.status});case 2:return t.p=2,t.v,t.a(2,{msg:"获取配置失败",status:!1})}},t,null,[[0,2]])}));return function(n){return t.apply(this,arguments)}}();return{proxyType:n,deleteProxySiteEvent:r,multDeleteProxySiteEvent:c,addProxySiteEvent:l,addProxyTcpEvent:f,getConfigEvent:p}},{persist:[{storage:localStorage,paths:["proxyType"]}]})),D=c().plugin,I=S().isRefreshList,L=O().setSiteInfo,U=A(),R=U.deleteProxySiteEvent,q=U.multDeleteProxySiteEvent,F=U.addProxySiteEvent,G=U.addProxyTcpEvent,M=(U.getConfigEvent,d(A()).proxyType),H=(t("b",function(){l({title:"添加反向代理项目",area:62,component:function(){return f(function(){return r.import("./index-legacy376.js?v=1763689792")},void 0,r.meta.url)},showFooter:!0})}),t("a",function(t){L(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:""),l({title:"反向代理项目管理["+t.name+"] -- 添加时间["+t.addtime+"]",area:[84,70],component:function(){return f(function(){return r.import("./index-legacy377.js?v=1763689792")},void 0,r.meta.url)}})}),t("o",function(){var t=s(u().m(function t(n,r){var e,o,a;return u().w(function(t){for(;;)switch(t.n){case 0:return"monitor"===r&&p("total_website",n.name),o=null===(e=D.value)||void 0===e||null===(e=e.web)||void 0===e?void 0:e.type,a="nginx"===o?"btwaf":"btwaf_httpd",t.n=1,j({name:"total"===r?"total":"monitor"===r?"monitor":a,callback:function(t){if("monitor"!==r&&t&&!["total","monitor"].includes(r)&&"btwaf"===a)var e=setInterval(function(){var r=t.document.getElementsByClassName("layui-layer-page")[0];if(t.site_waf_config&&r){clearInterval(e),r&&(r.style.display="none"),t.site_waf_config(n.name);var o,a=t.document.getElementsByClassName("layui-layer-page")[1];if(a)null===(o=a.querySelector(".layui-layer-close"))||void 0===o||o.addEventListener("click",function(){var t;null===(t=r.querySelector(".layui-layer-close"))||void 0===t||t.click()})}},50)}});case 1:return t.a(2)}},t)}));return function(n,r){return t.apply(this,arguments)}}()),t("d",function(){var t=s(u().m(function t(n){return u().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,y({title:"".concat("删除反向代理项目【".concat(n.name,"】")),content:"".concat("风险操作，此操作不可逆，删除【".concat(n.name,"】项目后您将无法管理该项目，是否继续操作？")),type:"check",check:{content:"同时删除网站根目录",onConfirm:function(){var t=s(u().m(function t(r){return u().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,R(n,r);case 1:return t.a(2,t.v)}},t)}));return function(n){return t.apply(this,arguments)}}()}});case 1:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}()),t("m",function(){var t=s(u().m(function t(n,r){return u().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,y({title:"批量删除反向代理项目",content:"批量删除选中的项目后，项目将无法恢复，是否继续操作？",type:"check",check:{content:"同时删除网站根目录",onConfirm:function(){var t=s(u().m(function t(e){var o,a,i;return u().w(function(t){for(;;)switch(t.n){case 0:return o={remove_path:e?1:0,site_list:JSON.stringify(n.map(function(t){return{id:t.id,site_name:t.name}}))},t.n=1,q(o);case 1:a=t.v,i=a.data,C({resultData:i,resultTitle:"批量删除反向代理项目"}),r();case 2:return t.a(2)}},t)}));return function(n){return t.apply(this,arguments)}}()}});case 1:return t.a(2)}},t)}));return function(n,r){return t.apply(this,arguments)}}()),t("h",[{content:"目标：可以填写你需要代理的站点，目标如果选URL地址则必须为可正常访问的URL，如果选UNIX则必须是套接字文件"},{content:"http地址示例：http://127.0.0.1:15700"},{content:"unix地址示例：/tmp/panel.sock"},{content:function(){return h(b,null,[g("发送域名：将域名添加到请求头传递到后端服务器，默认为目标URL域名，若设置不当可能导致代理无法正常访问，例如："),h("br",null,null),g("http://192.168.100.20:19888，则发送域名保持$http_host即可"),h("br",null,null),g("http://www.bt.cn，则发送域名应当改为www.bt.cn"),h("br",null,null),g("上面例子仅为常见情况，请以实际为准")])}}]),t("t",[{value:"url",label:"URL地址"},{value:"unix",label:"unix地址"}]),t("r",m(!1)));t("j",function(){var t=s(u().m(function t(n,r,e){var o,a,c,s,l,f,p,y,v,m;return u().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,r();case 1:return a=n.value,c=a.ps,s=a.listen_port,l=a.protocol,f=a.proxy_pass,p=a.isEdit,y={ps:c,listen_port:s,protocol:l,proxy_pass:f,handle:p?"update":"create"},o=i.load("正在"+(p?"编辑":"添加")+"项目，请稍后..."),t.n=2,G(y);case 2:return v=t.v,i.msg({dangerouslyUseHTMLString:!0,message:v.msg,type:v.status?"success":"error",duration:v.status?2e3:0,showClose:!v.status,customClass:"!max-w-[66rem] bt-message-error-html"}),v.status&&(H.value=!0),t.a(2,v.status);case 3:return t.p=3,t.v,t.a(2,!1);case 4:return t.p=4,null===(m=o)||void 0===m||m.close(),t.f(4);case 5:return t.a(2)}},t,null,[[0,3,4,5]])}));return function(n,r,e){return t.apply(this,arguments)}}()),t("g",function(){var t=s(u().m(function t(r){var a;return u().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,e({request:k({handle:"list"}),data:{data:Array}});case 1:if(a=t.v,Array.isArray(a.data)){t.n=2;break}return t.a(2,{data:[],total:0});case 2:return t.a(2,{data:a.data.map(function(t){var r=n(t.listen_port.split(" "),2),e=r[0],a=r[1];return o(o({},t),{},{listen_port:e,protocol:a||"tcp"})}).filter(function(t){return!r.search||t.listen_port.toString().includes(r.search)}).sort(function(t,n){try{var r=parseInt(t.id),e=parseInt(n.id);return isNaN(r)&&isNaN(e)?0:isNaN(r)?1:isNaN(e)?-1:e-r}catch(o){return 0}}),total:a.data.length});case 3:return t.p=3,t.v,t.a(2,{data:[],total:0})}},t,null,[[0,3]])}));return function(n){return t.apply(this,arguments)}}()),t("e",function(){var t=s(u().m(function t(n,r){return u().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,y({title:"删除代理【".concat(n.listen_port,"】"),width:"35rem",icon:"warning-filled",content:"您真的要删除代理【".concat(n.listen_port,"】吗？")});case 1:return t.n=2,e({loading:"正在删除，请稍后...",request:k({handle:"delete",protocol:n.protocol,listen_port:n.listen_port,proxy_pass:n.proxy_pass}),message:!0});case 2:t.v.status&&r();case 3:return t.a(2)}},t)}));return function(n,r){return t.apply(this,arguments)}}()),t("c",function(t){l({isAsync:!0,title:"".concat(t.protocol.toUpperCase(),"代理设置【").concat(t.listen_port,"】"),area:[76,60],component:function(){return f(function(){return r.import("./setting-legacy2.js?v=1763689792").then(function(t){return t.s})},void 0,r.meta.url)},compData:{row:t}})}),t("f",function(){var t=s(u().m(function t(n,r,e){var o,a,c,s,l,f,p,y,v,m;return u().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,r();case 1:return a=n.value,c=a.remark,s=a.targetType,l=a.proxysite,f=a.domains,p=a.todomain,y={remark:c,proxy_type:"url"===s?"http":"unix",proxy_pass:l,domains:f,proxy_host:p},o=i.load("正在添加项目，请稍后..."),t.n=2,F(y);case 2:return v=t.v,i.msg({dangerouslyUseHTMLString:!0,message:v.msg,type:v.status?"success":"error",duration:v.status?2e3:0,showClose:!v.status,customClass:"!max-w-[66rem] bt-message-error-html"}),v.status&&(M.value="http",w(function(){I.value=!0})),t.a(2,v.status);case 3:return t.p=3,t.v,t.a(2,!1);case 4:return t.p=4,null===(m=o)||void 0===m||m.close(),t.f(4);case 5:return t.a(2)}},t,null,[[0,3,4,5]])}));return function(n,r,e){return t.apply(this,arguments)}}()),t("i",function(t){x({type:"file",path:t.proxysite,change:function(n){t.proxysite=n}})}),t("k",_({title:"标题",body:"网页内",keywords:"关键词",descriptions:"描述",title_update:"标题更新",keywords_update:"关键词更新",description_update:"描述更新",tail_hash_update:"尾部script代码块更新",title_hash_update:"头部head代码块更新"}))}}})}();
