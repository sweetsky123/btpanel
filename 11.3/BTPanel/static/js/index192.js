import{j as e,b as s,_ as l}from"./utils-lib.js?v=1763689792";import{c as a,s as t,o as n,v as r,aG as i,I as o,x as c,y as m,e as u,C as d,D as f,z as p,A as g,O as y,G as v,B as b,J as x,Q as _,R as k,H as j,aZ as S,T as h}from"./base-lib.js?v=1763689792";import{H as w}from"./store.js?v=1763689792";import{H as R}from"./store2.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./validator.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";const C={class:"flex justify-between items-center h-full px-[3rem] reset"},M={class:"p-[1.5rem]"},V={class:"text-small leading-[2.6rem]"},H={id:"SafeRestart",class:"flex justify-between"},z={key:0,class:"info"},L={key:1,class:"info"},Q={key:2,class:"info"},T={key:3,class:"info"},D={key:4,class:"info"},G={key:5,class:"info"},I={key:6,class:"info"},P={key:7,class:"info"},U={key:0,class:"flex items-center tips mb-[12px]"},W={class:"vcode flex items-center h-[4.8rem] mt-4 pl-[1.2rem] text-base"},q={class:"mx-[1rem]"},A={class:"el-dialog__footer absolute bottom-0 w-full flex justify-end"},B=l(a({__name:"index",setup(l){const a=w(),{showFooter:B,showServer:F,serverRestartRef:J,courseList:K}=t(a),O=R(),{isDockerPanel:Z}=t(O),E=n({num1:0,num2:0,gentle:void 0}),N=e=>{E.num1=Math.round(9*Math.random()+1),E.num2=Math.round(9*Math.random()+1),E.gentle=void 0,!0!==e&&(F.value=!0)},X=()=>{if(E.gentle!==E.num1+E.num2&&(s().error("计算错误，请重新计算！"),1))return;const e=setTimeout(()=>{a.onRestartServer(),clearTimeout(e)},0)};return r(()=>{N(!0)}),i(()=>{a.clearRestart()}),(s,l)=>{const t=j,n=S,r=h,i=e,w=o("focus");return c(),m("div",C,[u(t,{type:"danger",class:"danger-btn",onClick:N},{default:d(()=>[...l[3]||(l[3]=[f("重启服务器",-1)])]),_:1}),u(t,{size:"default",onClick:p(a).onRestartPanel},{default:d(()=>[...l[4]||(l[4]=[f("重启面板",-1)])]),_:1},8,["onClick"]),u(i,{title:"安全重启服务器",modelValue:p(F),"onUpdate:modelValue":l[2]||(l[2]=e=>k(F)?F.value=e:null),area:[46.6,p(B)?52:49]},{default:d(()=>[g("div",{class:"relative h-full",ref_key:"serverRestartRef",ref:J},[g("div",M,[p(Z)?(c(),y(n,{key:0,title:"危险操作警告：当前服务器疑似运行在容器环境中！",type:"warning",closable:!1,class:"mb-3"},{default:d(()=>[...l[5]||(l[5]=[g("p",{class:"font-medium mb-2 text-base text-secondary"},"重启服务器将造成：",-1),g("ul",{class:"list-disc list-inside space-y-1 ml-2 text-small text-secondary"},[g("li",{class:"font-medium"},"容器实例立即销毁"),g("li",{class:"font-medium"},"所有未挂载数据永久丢失"),g("li",{class:"font-medium"},"网站服务完全中断"),g("li",{class:"font-medium"},"可能需要重新部署和配置")],-1),g("p",{class:"mt-2 font-medium text-base text-secondary"},'建议：如仅需重启面板服务，请选择"重启面板服务"',-1)])]),_:1})):(c(),y(n,{key:1,type:"warning",closable:!1,title:"即将重启服务器",class:"mb-3 px-[2rem]"},{default:d(()=>[...l[6]||(l[6]=[g("p",{class:"font-medium mb-2 text-base text-secondary leading-[2.6rem]"},"影响范围：",-1),g("ul",{class:"list-disc list-inside space-y-1 ml-2 text-small text-secondary leading-[2.6rem]"},[g("li",null,"所有网站服务临时中断（1-5分钟）"),g("li",null,"正在进行的用户会话将断开"),g("li",null,"未保存的临时数据可能丢失"),g("li",null,"SSH连接将断开")],-1),g("p",{class:"mt-2 font-medium text-base text-secondary leading-[2.6rem]"},'建议：如仅需重启面板服务，请选择"重启面板服务"',-1)])]),_:1})),g("div",V,[l[16]||(l[16]=g("p",{class:"mt-[1rem] mb-[1rem]"},"面板重启服务器将执行以下操作：",-1)),g("div",H,[p(K).webServe?(c(),m("div",L,[...l[8]||(l[8]=[g("span",{class:"green-bg"},null,-1),g("p",{class:"green-font"},"正在停止Web服务...",-1)])])):(c(),m("div",z,[...l[7]||(l[7]=[g("span",{class:"gray-bg"},null,-1),g("p",null,"1. 停止Web服务",-1)])])),p(K).mysqlServe?(c(),m("div",T,[...l[10]||(l[10]=[g("span",{class:"green-bg circle-green"},null,-1),g("p",{class:"green-font"},"正在停止MySQL服务...",-1)])])):(c(),m("div",Q,[...l[9]||(l[9]=[g("span",{class:"gray-bg circle-gray"},null,-1),g("p",null,"2. 停止MySQL服务",-1)])])),p(K).restartServe?(c(),m("div",G,[...l[12]||(l[12]=[g("span",{class:"green-bg circle-green"},null,-1),g("p",{class:"green-font"},"正在重启服务器...",-1)])])):(c(),m("div",D,[...l[11]||(l[11]=[g("span",{class:"gray-bg circle-gray"},null,-1),g("p",null,"3. 开始重启服务器",-1)])])),p(K).serveStart?(c(),m("div",P,[...l[14]||(l[14]=[g("span",{class:"green-bg circle-green"},null,-1),g("p",{class:"green-font"},"4. 等待服务器启动",-1),g("i",{class:"svgtofont-el-loading animate-spin"},null,-1)])])):(c(),m("div",I,[...l[13]||(l[13]=[g("span",{class:"gray-bg circle-gray"},null,-1),g("p",null,"4. 等待服务器启动",-1)])]))]),p(K).serveStart?(c(),m("div",U,[...l[15]||(l[15]=[g("p",null,"重启进行中时，请勿随意进行刷新，若长时间未响应，可以进行刷新尝试。",-1)])])):v("",!0)]),g("div",W,[l[17]||(l[17]=g("span",null,"计算结果：",-1)),g("span",q,b(p(E).num1)+" + "+b(p(E).num2),1),l[18]||(l[18]=g("span",{class:"mr-[1rem]"},"=",-1)),x(u(r,{modelValue:p(E).gentle,"onUpdate:modelValue":l[0]||(l[0]=e=>p(E).gentle=e),autofocus:"true","controls-position":"right",size:"small",onKeydown:_(X,["native","enter"])},null,8,["modelValue"]),[[w]])])]),g("div",A,[u(t,{type:"warning",onClick:l[1]||(l[1]=e=>F.value=!1)},{default:d(()=>[...l[19]||(l[19]=[f("取消",-1)])]),_:1}),u(t,{type:"primary",onClick:X},{default:d(()=>[...l[20]||(l[20]=[f("确认",-1)])]),_:1})])],512)]),_:1},8,["modelValue","area"])])}}}),[["__scopeId","data-v-fdd120fb"]]);export{B as default};
