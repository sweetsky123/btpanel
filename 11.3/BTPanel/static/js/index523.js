import{c as a,s as e,o as s,r as l,v as t,x as r,y as o,e as n,C as c,z as i,D as u,A as m,ap as d,ad as p,ab as f}from"./base-lib.js?v=1763689792";import{_ as y}from"./validator.js?v=1763689792";import{u as v,Q as _,k as b,b as h,_ as j}from"./utils-lib.js?v=1763689792";import{b2 as x,b3 as w}from"./firewall.js?v=1763689792";import{H as V}from"./index344.js?v=1763689792";import{H as g}from"./store6.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";const k={class:"p-[2rem]"},C={class:"tip"},D=j(a({__name:"index",emits:["close"],setup(a,{expose:j,emit:D}){const H=V(),S=g(),{repairTypeActive:T}=e(H),{isMalwareConfirm:U}=e(S),A=D,{payment:q}=v(),{authType:z}=q.value,F=h(),I=s({cycle:"0",channel:[],status:!1}),M=l(),N=l(!1),O=async(a=!1)=>{const{data:e}=await x();I.cycle=e.cycle,I.channel=""===e.channel?[]:e.channel.split(","),I.status=!!e.status,a&&F.success("刷新成功")};return j({onConfirm:async()=>{if("ltd"!==z)return F.error("抱歉！该功能为企业版专享功能！");I.channel=I.channel.filter(a=>a);let a=I.channel.join(",");a||!I.status?(await M.value.validate(),_({loading:N,request:w({day:Number(I.cycle),channel:a,status:I.status?1:0}),message:!0,success:a=>{a.status&&(O(),"overview"===T.value&&(U.value=!0,S.capabilitySwitch.vul_scan.status=I.status,S.getSafeOverviewData()),A("close"))}})):F.error("请选择告警方式")}}),t(()=>{O()}),(a,e)=>{const s=d,l=p,t=b,v=y,_=f;return r(),o("div",k,[n(_,{model:i(I),ref_key:"safeScanForm",ref:M,disabled:i(N)},{default:c(()=>[n(l,{label:"自动扫描"},{default:c(()=>[n(s,{modelValue:i(I).status,"onUpdate:modelValue":e[0]||(e[0]=a=>i(I).status=a)},null,8,["modelValue"])]),_:1}),n(l,{label:"周期",prop:"cycle"},{default:c(()=>[n(t,{class:"!w-[14rem]",modelValue:i(I).cycle,"onUpdate:modelValue":e[1]||(e[1]=a=>i(I).cycle=a),min:0,type:"number",textType:"天"},{append:c(()=>[...e[4]||(e[4]=[u(" 天 ",-1)])]),_:1},8,["modelValue"])]),_:1}),n(l,{label:"告警方式",prop:"give"},{default:c(()=>[n(v,{class:"!w-[36rem]",modelValue:i(I).channel,"onUpdate:modelValue":e[2]||(e[2]=a=>i(I).channel=a),limit:["sms","wx_account"]},null,8,["modelValue"])]),_:1})]),_:1},8,["model","disabled"]),m("div",C,[m("ul",null,[m("li",null,[e[5]||(e[5]=u(" 点击配置后状态未更新，尝试点击【 ",-1)),m("span",{class:"text-primary hover:text-primaryDark cursor-pointer",onClick:e[3]||(e[3]=a=>O(!0))},"手动刷新"),e[6]||(e[6]=u(" 】 ",-1))])])])])}}}),[["__scopeId","data-v-609551c0"]]);export{D as default};
