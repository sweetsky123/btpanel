!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n="function"==typeof Symbol?Symbol:{},u=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function i(n,r,u,a){var i=r&&r.prototype instanceof c?r:c,s=Object.create(i.prototype);return o(s,"_invoke",function(n,r,o){var u,a,i,c=0,s=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return u=e,a=0,i=t,p.n=n,l}};function d(n,r){for(a=n,i=r,e=0;!f&&c&&!o&&e<s.length;e++){var o,u=s[e],d=p.p,y=u[2];n>3?(o=y===r)&&(i=u[(a=u[4])?5:(a=3,3)],u[4]=u[5]=t):u[0]<=d&&((o=n<2&&d<u[1])?(a=0,p.v=r,p.n=u[1]):d<y&&(o=n<3||u[0]>r||r>y)&&(u[4]=n,u[5]=r,p.n=y,a=0))}if(o||n>1)return l;throw f=!0,r}return function(o,s,y){if(c>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),a=s,i=y;(e=a<2?t:i)||!f;){u||(a?a<3?(a>1&&(p.n=-1),d(a,i)):p.n=i:p.v=i);try{if(c=2,u){if(a||(o="next"),e=u[o]){if(!(e=e.call(u,i)))throw TypeError("iterator result is not an object");if(!e.done)return e;i=e.value,a<2&&(a=0)}else 1===a&&(e=u.return)&&e.call(u),a<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),a=1);u=t}else if((e=(f=p.n<0)?i:n.call(r,p))!==l)break}catch(e){u=t,a=1,i=e}finally{c=1}}return{value:e,done:f}}}(n,u,a),!0),s}var l={};function c(){}function s(){}function f(){}e=Object.getPrototypeOf;var p=[][u]?e(e([][u]())):(o(e={},u,function(){return this}),e),d=f.prototype=c.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,o(t,a,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=f,o(d,"constructor",f),o(f,"constructor",s),s.displayName="GeneratorFunction",o(f,a,"GeneratorFunction"),o(d),o(d,a,"Generator"),o(d,u,function(){return this}),o(d,"toString",function(){return"[object Generator]"}),(r=function(){return{w:i,m:y}})()}function o(t,e,n,r){var u=Object.defineProperty;try{u({},"",{})}catch(t){u=0}o=function(t,e,n,r){function a(e,n){o(t,e,function(t){return this._invoke(e,n,t)})}e?u?u(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},o(t,e,n,r)}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach(function(e){i(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function i(e,n,r){return(n=function(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,n||"default");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function l(t,e,n,r,o,u,a){try{var i=t[u](a),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(r,o)}function c(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var u=t.apply(e,n);function a(t){l(u,r,o,a,i,"next",t)}function i(t){l(u,r,o,a,i,"throw",t)}a(void 0)})}}System.register(["./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./site-legacy.js?v=1763689792","./useController-legacy6.js?v=1763689792","./useStore-legacy4.js?v=1763689792","./validator-legacy.js?v=1763689792","./useController-legacy16.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./column-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./index-legacy107.js?v=1763689792"],function(t,n){"use strict";var o,u,i,l,s,f,p,d,y,v,m,g,b,h,j,_,w,x,O,S,P,V,E,k,T,R,A,C,D,U,G,L,F,H;return{setters:[function(t){o=t.M,u=t.Q,i=t.aK,l=t.k,s=t.$},function(t){f=t.r,p=t.g,d=t.o,y=t.w,v=t.c,m=t.v,g=t.I,b=t.J,h=t.z,j=t.x,_=t.y,w=t.e,x=t.C,O=t.D,S=t.O,P=t.G,V=t.ad,E=t.V,k=t.H,T=t.ab},function(t){R=t.batchPhpReferer,A=t.setProxyAntiLeech,C=t.setSecurity,D=t.getSecurity},function(t){U=t.o},function(t){G=t.u},function(t){L=t.h,F=t.i},function(t){H=t.p},null,null,null,null],execute:function(){var n=G(),I=n.siteInfo,q=n.isRefreshList,z=f(),M=p(function(){var t,e;return Array.isArray(null===(t=z.value)||void 0===t?void 0:t.selectedList)&&(null===(e=z.value)||void 0===e||null===(e=e.selectedList)||void 0===e?void 0:e.length)>0}),N=f(!1),$=d({fix:"jpg,jpeg,gif,png,js,css",domains:"",return_rule:"404",http_status:!1,status:!1}),J=f(null),K=[{content:'【URL后缀】一般填写文件后缀,每个文件后缀使用","分隔,如: png,jpg'},{content:"【许可域名】允许作为来路的域名，每行一个域名,如: www.bt.cn"},{content:"【响应资源】可设置404/403等状态码，也可以设置一个有效资源，如：/security.png"},{content:"【允许空HTTP_REFERER请求】是否允许浏览器直接访问，若您的网站访问异常，可尝试开启此功能"}],Q=function(t){if(!$.status)return o.error("请先启用防盗链!")},B=function(t){$.status=t,t||($.http_status=!1)},W=function(){var t=c(r().m(function t(e){var n,o,i,l,c,s,f,p,d,y;return r().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,J.value.validate();case 1:return o=a(a({},$),{},{domains:null===(n=$.domains)||void 0===n?void 0:n.replace(/\n/g,",")}),M.value?(i=z.value.config,l=i.enable,c=i.exclude,s=L(z.value.selectedList,c,l,{params:{project_type:"PHP"}}),o=a(a({},o),s)):(o.id=I.value.id,o.site_name=I.value.name),f=M.value?R:"proxy"===I.value.project_type?A:C,t.n=2,u({loading:"正在设置防盗链，请稍后...",request:f(a(a({},o),"proxy"===I.value.project_type?{proxy_path:H.value.proxy_path}:{})),message:!M.value});case 2:p=t.v,M.value?(d=F(p.data),y=d.data,U({resultData:y,title:"批量设置防盗链"}),q.value=!0,Y(),e&&e()):X(z.value);case 3:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}(),X=function(){var t=c(r().m(function t(e){var n,o,u,a,l,c,s;return r().w(function(t){for(;;)switch(t.p=t.n){case 0:if(z.value=e||[],M.value&&Y(),"proxy"!==I.value.project_type){t.n=1;break}return y(function(){return H.value.security_referer},function(t){var e;$.fix=t.fix||"jpg,jpeg,gif,png,js,css",$.domains=(null===(e=t.domains)||void 0===e||null===(e=e.toString())||void 0===e?void 0:e.replace(/,/g,"\n"))||"",$.return_rule=t.return_rule||"404",$.http_status=t.http_status||!1,$.status=t.status||!1}),t.a(2);case 1:if(e){t.n=6;break}return n=I.value,o=n.id,u=n.name,t.p=2,N.value=!0,t.n=3,D({id:o,site_name:u});case 3:a=t.v,(l=a.data)&&($.fix=l.fix||"jpg,jpeg,gif,png,js,css",$.domains=(null===(c=l.domains)||void 0===c||null===(c=c.toString())||void 0===c?void 0:c.replace(/,/g,"\n"))||"",$.return_rule=l.return_rule||"404",$.http_status=l.http_status||!1,$.status=l.status||!1),t.n=5;break;case 4:t.p=4,s=t.v,i(s);case 5:return t.p=5,N.value=!1,t.f(5);case 6:return t.a(2)}},t,null,[[2,4,5,6]])}));return function(e){return t.apply(this,arguments)}}(),Y=function(){$.fix="jpg,jpeg,gif,png,js,css",$.domains="",$.return_rule="404",$.http_status=!1,$.status=!1},Z={fix:[{required:!0,message:"请输入url后缀",trigger:"blur"}],return_rule:[{required:!0,message:"请输入响应资源",trigger:"blur"}]},tt={class:"p-[20px]"};t("default",v({__name:"index",props:{compData:{default:function(){}}},emits:["close"],setup:function(t,n){var r=n.expose,o=(n.emit,t),u=function(){X(o.compData)};return m(u),r({onConfirm:W,init:u}),function(t,n){var r=l,o=V,u=E,a=k,i=T,c=s,f=g("bt-loading");return b((j(),_("div",tt,[w(i,{ref_key:"hotFormRef",ref:J,model:h($),rules:h(Z)},{default:x(function(){return[w(o,{label:"URL后缀",prop:"fix"},{default:x(function(){return[w(r,{modelValue:h($).fix,"onUpdate:modelValue":n[0]||(n[0]=function(t){return h($).fix=t}),width:"30rem"},null,8,["modelValue"])]}),_:1}),w(o,{label:"许可域名"},{default:x(function(){return[w(r,{width:"30rem",modelValue:h($).domains,"onUpdate:modelValue":n[1]||(n[1]=function(t){return h($).domains=t}),type:"textarea",resize:"none",rows:8,placeholder:"默认添加主域名，可追加其他的允许域名，一行一个，可为空"},null,8,["modelValue"])]}),_:1}),w(o,{label:"响应资源",prop:"return_rule"},{default:x(function(){return[w(r,{width:"30rem",modelValue:h($).return_rule,"onUpdate:modelValue":n[2]||(n[2]=function(t){return h($).return_rule=t})},null,8,["modelValue"])]}),_:1}),w(o,{label:" "},{default:x(function(){return[w(u,{modelValue:h($).status,"onUpdate:modelValue":n[3]||(n[3]=function(t){return h($).status=t}),onChange:h(B)},{default:x(function(){return e(n[6]||(n[6]=[O("启用防盗链",-1)]))}),_:1},8,["modelValue","onChange"]),w(u,{disabled:!h($).status,title:"".concat(h($).status?"":"需开启防盗链"),modelValue:h($).http_status,"onUpdate:modelValue":n[4]||(n[4]=function(t){return h($).http_status=t}),onChange:h(Q)},{default:x(function(){return e(n[7]||(n[7]=[O(" 允许空HTTP_REFERER请求 ",-1)]))}),_:1},8,["disabled","title","modelValue","onChange"])]}),_:1}),h(M)?P("",!0):(j(),S(o,{key:0,label:" "},{default:x(function(){return[w(a,{type:"primary",onClick:n[5]||(n[5]=function(t){return h(W)()})},{default:x(function(){return e(n[8]||(n[8]=[O("保存",-1)]))}),_:1})]}),_:1}))]}),_:1},8,["model","rules"]),h(M)?P("",!0):(j(),S(c,{key:0,options:h(K),class:"ml-[20px] mt-[20px]"},null,8,["options"]))])),[[f,h(N)]])}}}))}}})}();
