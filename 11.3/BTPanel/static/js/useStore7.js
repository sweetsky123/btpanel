import{j as t,s as e,r as a,W as s,o,b as c}from"./base-lib.js?v=1763689792";import{o as r,Q as l,aA as g,M as n,S as d}from"./utils-lib.js?v=1763689792";const p=t=>r.post("/mod/ssh/com/get_ssh_list",{data:t,customType:"model",check:"array",skipPending:!0}),u=()=>r.post("monitor/soft/soft_log_list",{customType:"model",check:"array"}),m=t=>r.post("monitor/soft/get_log",{data:t,customType:"model",check:"object"}),i=t=>r.post("logs/panel/get_slow_logs",{data:t,customType:"model",check:"object"}),y=t=>r.post("database/GetErrorLog",{check:"string",data:t}),_=t=>r.post("data/getData",{data:t,check:"object"}),h=t=>r.post("logs/ftp/set_ftp_log",{check:"msg",customType:"model",data:t}),k=t=>r.post("ftp/get_login_logs",{data:t,check:"object"}),b=t=>r.post("logs/ftp/get_action_log",{check:"object",customType:"model",data:t}),T=t=>r.post("monitor/soft/get_docker_log?name=Docker",{data:t,customType:"model",check:"object"}),v=t=>r.post("monitor/soft/get_log",{data:t,customType:"model",check:"array"}),j=t=>r.post("monitor/soft/get_bt_security_log?name=bt_security",{data:t,customType:"model",check:"object"}),f=t=>r.post("monitor/soft/get_syssafe_log?name=syssafe",{data:t,customType:"model",check:"object"}),w=(t,e)=>{const a={};return a.limit=t,e&&(a.search=e),r.post("logs/panel/get_panel_error_logs",{data:a,check:"object",customType:"model"})},L=()=>r.post("/logs/site/get_site_list",{check:"object",customType:"model"}),E=t=>r.post("logs/site/get_site_access_logs",{data:t,customType:"model",check:"msg"}),q=t=>r.post("logs/site/get_site_error_logs",{data:t,customType:"model",check:"msg"}),x=t=>r.post("logs/panel/get_logs_bytype",{data:t,customType:"model",check:"object"}),A=t=>r.post("logs/site/get_site_log_file",{data:t,customType:"model",check:"object"}),S=t=>r.post("ajax/set_cron_task",{check:"msg",data:t}),D=t=>r.post("ajax/get_result",{data:t,check:"object"}),O=t=>r.post("ajax/log_analysis",{data:t,check:"msg"}),F=t=>r.post("ajax/speed_log",{data:t,check:"object"}),z=t=>r.post("ajax/get_detailed",{data:t,check:"object"}),I=t=>r.post("logs/site/download_logs",{data:t,customType:"model",check:"msg"}),M=t=>r.post("logs/site/clear_logs",{data:t,check:"object",customType:"model"}),R=t=>r.post("safe/syslog/export_ssh_log",{data:t,customType:"model",check:"object"}),G=t=>r.post("/logs/panel/get_panel_login_log",{check:"object",customType:"model",data:t,skipPending:!0}),P=()=>r.post("logs/logserver/collect_list",{customType:"model",check:"array"}),N=t=>r.post("logs/logserver/add_source",{data:t,customType:"model",check:"array"}),W=t=>r.post("logs/logserver/remove_source",{data:t,customType:"model",check:"msg"}),B=t=>r.post("logs/logserver/modify_logserver",{data:t,customType:"model",check:"msg"}),C=t=>r.post("logs/logserver/add_logserver",{data:t,customType:"model",check:"msg"}),Q=()=>r.post("logs/logserver/server_list",{customType:"model",check:"array"}),V=t=>r.post("/monitor/sitelogpush/get_site_log_push_status",{data:t,check:"object",customType:"model"}),H=t=>r.post("/monitor/sitelogpush/set_push_task",{data:t,check:"msg",customType:"model"}),J=t=>r.post("/logs/panel/export_domain_log",{data:t,check:"object",customType:"model"}),K=t=>r.post("/ajax?action=remove_analysis",{data:t,check:"object",customType:"model"}),$=t=>r.post("/monitor/soft/del_soft_log",{data:t,check:"msg",customType:"model"}),U=t=>r.post("/logs/panel/export_penel_login_log",{data:t,check:"object",customType:"model"}),X=t=>r.post("safe/syslog/create_ip_rules",{data:t,check:"array",customType:"model"}),Y=t=>r.post("safe/syslog/remove_ip_rules",{data:t,check:"array",customType:"model"}),Z=t("LOG-PANEL-STORE",()=>{const t=et(),{outDataForm:c,searchValue:d}=e(t),p=a(!1),u=a("全部"),m=a(""),i=a(0),y=a(""),h=async t=>{try{await l({loading:"正在获取日志数据，请稍后...",request:w(500,t),data:{data:[String,m],size:[Number,i]},success:t=>({data:t.data,size:t.size})})}catch(e){return{data:"暂无日志",size:0}}},k=a("暂无数据"),b=s({id:0,name:"",type:""}),T=o({time_search:[],type:""}),v=async t=>{try{return{data:(await l({request:(e=t,r.post("crontab/GetLogs",{data:e,check:"object"})),data:{msg:[String,k]}})).msg||"当前日志为空!",status:!0}}catch(a){return{msg:"当前日志为空!",status:!1}}var e};return{isRefreshList:p,logType:u,clearOpLogsEvent:async()=>{try{return await l({loading:"正在清空面板操作日志，请稍后...",request:r.post("ajax/delClose",{check:"msg"}),message:!0}),{msg:"清空日志成功",status:!0}}catch(t){return n.error("清空日志失败"),{data:{},status:!1,msg:"清空错误"}}},getLogsInfoEvent:async t=>{try{const e=await l({request:_(t),data:{data:Array,page:String}});return{data:e.data,total:g(e.page),other:{}}}catch(e){return{data:[],total:0,other:{}}}},getLoginLogsEvent:async t=>{try{const e=await l({request:G(t),data:{data:Array,total:Number}});return{data:e.data,total:e.total,other:{}}}catch(e){return{data:[],total:0,other:{}}}},search:y,logMsg:m,size:i,getRunDataEvent:h,clearRunLogsEvent:async()=>{try{return await l({loading:"正在清空日志，请稍后...",request:r.post("config/clean_panel_error_logs",{check:"msg"}),message:!0,success:h}),{msg:"清空日志成功",status:!0}}catch(t){return{status:!1,msg:"清空日志失败"}}},logsMsg:k,currentItem:b,crontabForm:T,getLogsMenu:async t=>{try{return{data:(await l({request:_({search:d.value,limit:9999,table:"crontab",p:1}),data:{data:Array}})).data,status:!0}}catch(e){return{data:[],status:!1,msg:"获取日志菜单失败"}}},getLogsDataEvent:v,getIpDataEvent:async()=>{try{return{data:await l({loading:"正在获取ip数据，请稍后...",request:r.post("logs/panel/IP_geolocation",{customType:"model",check:"array"}),data:Array}),total:0,other:{}}}catch(t){return{data:[],total:0,other:{}}}},outWebSiteEvent:async(t="")=>{try{return{data:(await l({loading:"正在导出日志，请稍后...",request:(e={search:t},r.post("/logs/panel/export_panel_log",{data:e,check:"object",customType:"model"}))})).data,status:!0}}catch(a){return{data:{},status:!1,msg:"导出错误"}}var e},clearShellLogEvent:async({id:t,day:e})=>{try{const s=await l({loading:"正在清理日志，请稍后...",request:(a={id:t,day:e},r.post("crontab/clear_logs",{data:a,check:"msg"})),message:!0});return v(b.value),{msg:s.msg,status:s.status}}catch(s){return{status:!1,msg:"清理日志失败"}}var a},outShellLogEvent:async()=>{try{const{isOutError:e,day:a}=c.value,s=await l({loading:"正在导出日志，请稍后...",request:(t={type:e?"warring":"",day:"all"===a?"":a,id:b.value.id},r.post("crontab/download_logs",{data:t,check:"msg"})),data:{status:Boolean,msg:String}});return window.open("/download?filename="+s.msg,"_blank","noopener,noreferrer"),{data:s,status:s.status}}catch(e){return{status:!1,msg:"导出日志失败"}}var t},outLoginLogEvent:async t=>{const{count:e,type:a}=t;let s={limit:e,type:a};"all"===s.type&&delete s.type,"Accepted"!==s.type&&"Failed"!==s.type||(s.type={Accepted:"success",Failed:"failure"}[s.type]);try{return l({loading:"正在导出日志，请稍后...",request:U(s),success:t=>{window.open("/download?filename="+t.data.output_file,"_blank","noopener,noreferrer")}}),{status:!0,msg:"导出成功"}}catch(o){return{status:!1,msg:"导出失败"}}},clearLoginLogEvent:async()=>{try{return await l({loading:"正在清空日志，请稍后...",request:r.post("/logs/panel/clear_panel_login_log",{check:"object",customType:"model"}),message:!0}),{msg:"清空日志成功",status:!0}}catch(t){return{status:!1,msg:"清空日志失败"}}}}}),tt=()=>{const t=Z();return e(t)},et=t("LOG-STORE",()=>{const t=a(""),e=a("panel"),r=a("operateLog"),l=a("WebLogs"),g=a(),n=s([{label:"所有日志",value:"all"},{label:"仅保留近7天日志",value:"7"},{label:"仅保留近30天日志",value:"30"},{label:"仅保留近180天日志",value:"180"}]),p=o({type:"access",day:"all"}),u=a(""),m=a(!1),i=a(""),y=a(["ssh","login"]),_=o({type:"all",day:"all",isOutError:"",count:100});return{selectedWebSite:t,tabActive:e,panelTabActive:r,webTabActive:l,cutTabs:t=>{e.value=t,d("/logs/"+t)},init:async()=>{const t=c();e.value=t.name||"panel-log"},clearOptions:n,clearDataForm:p,searchValue:u,logLoading:m,selectedItem:i,searchSubmit:()=>{Z().searchMenuData(u.value)},countType:y,outDataForm:_,configData:g,getType:t=>y.value.includes(t)?"all":"access",$reset_out:()=>{_.type="all",_.day="all",_.isOutError="",_.count=100}}}),at=()=>{const t=et();return e(t)};export{x as A,J as B,W as C,B as D,C as E,N as F,P as G,Q as H,Z as I,tt as J,A as K,et as L,D as M,O as N,F as O,K as P,z as Q,S as R,R as a,G as b,X as c,u as d,v as e,m as f,p as g,$ as h,k as i,b as j,_ as k,T as l,f as m,j as n,i as o,y as p,L as q,Y as r,h as s,M as t,at as u,I as v,q as w,E as x,V as y,H as z};
