import{_ as e,H as a}from"./utils-lib.js?v=1763689792";import{x as t,y as s,A as l,c as n,I as r,z as i,J as o,O as c,C as d,e as m,B as u,D as p,G as f,R as h,U as g}from"./base-lib.js?v=1763689792";import{g as _,a as y,b as v,c as x,d as b,e as w,s as k}from"./api2.js?v=1763689792";const S={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"30",height:"22.8px",viewBox:"0 0 36.1 22.8",style:{overflow:"visible","enable-background":"new 0 0 36.1 22.8"},"xml:space":"preserve"};const P=e({},[["render",function(e,a){return t(),s("svg",S,[...a[0]||(a[0]=[l("defs",null,null,-1),l("g",null,[l("rect",{x:"12",y:"10",class:"st0",width:"12.1",height:"2.8"}),l("path",{class:"st0",d:"M30.1,0h-7.9l2,2.8l5.8,1.8c1,0.3,1.7,1.4,1.7,2.4v8.7c0,1-0.7,2.1-1.7,2.4L24.1,20l-2,2.8h7.9\n\t\tc3.3,0,6-2.6,6-6V6.1C36.1,2.8,33.5,0,30.1,0z"}),l("path",{class:"st0",d:"M6.2,18.2c-1-0.3-1.7-1.4-1.7-2.4V7c0-1,0.7-2.1,1.7-2.4L12,2.8l2-2.8H6C2.6,0,0,2.8,0,6.1v10.6\n\t\tc0,3.3,2.6,6,6,6h7.9l-2-2.8C12,19.9,6.2,18.2,6.2,18.2z"})],-1)])])}]]),T={class:"flex items-center px-[1rem] py-[1.4rem] mx-[1.5rem]"},C={class:"aliyun_division flex items-center pr-[1rem] text-warning"},D={class:"flex h-full items-center justify-center <2xl:flex-col <2xl:items-start"},M={class:"flex <2xl:mb-[.8rem]"},I={class:"mx-[1.5rem] <2xl:mx-[1rem]"},V=["innerHTML"],q={class:"mx-[1.5rem] <2xl:mx-[1rem]"},Y={class:"mx-[1.5rem] <2xl:mx-[1rem]"},H={key:0,class:"mx-[1rem]"},L={key:1,class:"flex-1"},U={key:1,class:"flex 2xl:ml-[4rem]"},E={class:"flex items-center"},j={class:"p-[2rem]"},z={class:"flex items-center justify-between"},B={class:"p-[1rem]"},R={style:{"text-align":"right",margin:"0"}},A={class:"p-[2rem]"},O=n({__name:"statusbar",props:{dependencies:{default:()=>[]}},setup(e){const n=e,{ref:S,reactive:O,unref:K,computed:F,watch:G}=n.dependencies.vueMethods,{BtDialog:J,ElButton:N,ElTable:Q,ElTableColumn:W,BtLink:X,ElCard:Z,ElDivider:$,ElPopover:ee}=K(n.dependencies.components),{getByteUnit:ae}=K(n.dependencies.utils),{useAxios:te,useMessage:se,useConfirm:le,useDialog:ne}=n.dependencies.hooks,re=se(),ie=S(!1),oe=S(!0),ce=S(!1),de=S(!1),me=S(!1),ue=O({secretId:"",secretKey:""}),pe=O({ipInfo:{outside:"",inside:""},region:"--",maturityTime:"--",dataPackage:!1,firstPhotoShow:!1,createSnapshotDisable:!1,snapshot_name:"",snapshotsList:[],requestPack:{has_traffic_package:!1,traffic_info:""}});G(oe,e=>{e&&_e()}),G(ce,e=>{e&&ye()});const fe=F(()=>"<span>".concat(pe.ipInfo.outside,"(外)</span>、<span>").concat(pe.ipInfo.inside,"(内)</span></span>")),he=F(()=>{if(pe.requestPack.traffic_info.length>0){const e=pe.requestPack.traffic_info[0];return"".concat(ae(e.TrafficUsed),"/").concat(ae(e.TrafficPackageTotal))}return"----"}),ge=F(()=>{var e;const a=[];for(let t=0;t<(null==(e=pe.requestPack.traffic_info)?void 0:e.length);t++){const e=pe.requestPack.traffic_info[t];a.push({TrafficPackageTotal:ae(e.TrafficPackageTotal),TrafficUsed:ae(e.TrafficUsed),TrafficPackageRemaining:ae(e.TrafficPackageRemaining)})}return a}),_e=async()=>{try{ie.value=!0;const{data:{secretId:e,secretKey:a}}=await _();ce.value=e&&a}catch(e){}finally{ie.value=!1;const e=document.querySelector(".custom-loading--show");e&&e.classList.remove("custom-loading--show")}},ye=async e=>{ie.value=!0;try{const a=await y(),{expired_time:t,inner_ip_address:s,public_ip_address:l,region_id:n,instance_id:r,image_id:i}=a.data;pe.ipInfo.outside=l||"--",pe.ipInfo.inside=s||"--",pe.region=n||"--",t&&(pe.maturityTime=ve(new Date(t),"YYYY-MM-DD HH:mm:ss")),e&&re.success("刷新成功")}catch(a){}finally{ie.value=!1;const e=document.querySelector(".custom-loading--show");e&&e.classList.remove("custom-loading--show")}},ve=(e,a)=>{const t={YYYY:e.getFullYear().toString(),MM:(e.getMonth()+1).toString().padStart(2,"0"),DD:e.getDate().toString().padStart(2,"0"),HH:e.getHours().toString().padStart(2,"0"),mm:e.getMinutes().toString().padStart(2,"0"),ss:e.getSeconds().toString().padStart(2,"0")};return a.replace(/YYYY|MM|DD|HH|mm|ss/g,e=>t[e])},xe=e=>{e||(ue.secretId="",ue.secretKey=""),ne({component:()=>a(()=>import("./bind-api.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:{...ue,dependencies:n.dependencies,isEdit:e||!1},area:[48]})},be=async(e=!1)=>{try{pe.firstPhotoShow=!0;const a=await x();pe.snapshotsList=a.data.value,e&&re.success("刷新成功")}catch(a){}},we=async()=>{if(pe.snapshot_name)try{const e=re.load("正在创建快照，请稍后...");pe.createSnapshotDisable=!0;const{data:a}=await b({snapshot_name:pe.snapshot_name});e.close(),pe.createSnapshotDisable=!1,me.value=!1,re.request(a),pe.snapshot_name="",be()}catch(e){}else re.error("请输入快照名称")},ke=()=>{window.open("https://account.aliyun.com","_blank","noopener,noreferrer")};return k(te),_e().then(()=>{ce.value&&(async()=>{try{const{data:e}=await v();if(!e.status)return;pe.requestPack=e}catch(e){de.value=!0}})()}),(e,a)=>{const n=g,_=r("bt-loading");return t(),s("div",null,[i(oe)?o((t(),c(i(Z),{key:0,class:"aliyun min-h-[5.2rem] module-box"},{default:d(()=>[l("div",T,[l("div",C,[l("div",null,[m(P,{class:"mr-[0.5rem]"})]),a[14]||(a[14]=l("span",{class:"text-base font-semibold"},"阿里云专享版",-1))]),m(i($),{direction:"vertical"}),l("div",D,[l("div",M,[l("div",I,[a[15]||(a[15]=l("span",{class:"font-bold text-secondary"},"主机IPv4：",-1)),l("span",{innerHTML:i(fe)},null,8,V)]),l("div",q,[a[16]||(a[16]=l("span",{class:"font-bold text-secondary"},"区域：",-1)),l("span",null,u(i(pe).region),1)]),l("div",Y,[a[17]||(a[17]=l("span",{class:"font-bold text-secondary"},"到期时间：",-1)),l("span",null,u(i(pe).maturityTime),1)]),i(pe).requestPack.has_traffic_package?(t(),s("div",H,[a[19]||(a[19]=l("span",{class:"font-bold text-secondary"},"流量包：",-1)),l("span",null,u(i(he)),1),m(i(X),{class:"ml-[0.5rem]",onClick:a[0]||(a[0]=e=>i(pe).requestInfoShow=!0)},{default:d(()=>[...a[18]||(a[18]=[p("详情",-1)])]),_:1})])):(t(),s("div",L,[...a[20]||(a[20]=[l("span",{class:"font-bold"},"网络:",-1),l("span",{class:"ml-[1rem]"},"固定带宽",-1)])]))]),i(ce)?f("",!0):(t(),c(i(N),{key:0,type:"primary",class:"!ml-[1rem]",onClick:a[1]||(a[1]=e=>xe(!1))},{default:d(()=>[...a[21]||(a[21]=[p(" 关联阿里云API密钥 ",-1)])]),_:1})),i(ce)?(t(),s("div",U,[m(i(N),{type:"primary",class:"ml-[1rem]",onClick:ke},{default:d(()=>[...a[22]||(a[22]=[p(" 续费 ",-1)])]),_:1}),m(i(N),{class:"ml-[1rem]",onClick:a[2]||(a[2]=e=>xe(!0))},{default:d(()=>[...a[23]||(a[23]=[p(" 密钥管理 ",-1)])]),_:1}),m(i(N),{class:"ml-[1rem]",onClick:a[3]||(a[3]=e=>be())},{default:d(()=>[...a[24]||(a[24]=[p(" 快照 ",-1)])]),_:1}),m(i(N),{class:"ml-[1rem]",onClick:a[4]||(a[4]=e=>(async()=>{await le({title:"更新阿里云专版数据",content:"更新当前阿里专版功能 (面板功能除外，面板更新请使用自带更新功能) ，是否继续操作?"})})())},{default:d(()=>[...a[25]||(a[25]=[p(" 更新 ",-1)])]),_:1}),m(i(N),{class:"ml-[1rem]",onClick:a[5]||(a[5]=e=>ye(!0))},{default:d(()=>[...a[26]||(a[26]=[l("span",null,"刷新",-1),l("i",{class:"svgtofont-el-refresh-right el-icon--right size-[1.3rem]"},null,-1)])]),_:1}),m(i(X),{target:"_blank",class:"ml-[1rem] !text-primary text-small",href:"https://www.bt.cn/bbs/thread-66887-1-1.html"},{default:d(()=>[...a[27]||(a[27]=[p(" 查看教程 ",-1)])]),_:1})])):f("",!0)])])]),_:1})),[[_,i(ie)]]):f("",!0),i(oe)&&i(de)?(t(),c(i(Z),{key:1,shadow:"always","body-style":{padding:"0",display:"flex",minHeight:"5.2rem"},class:"module-box min-h-[5.2rem] !text-danger !bg-[var(--el-color-warning-light-8)] px-1.6rem"},{default:d(()=>[l("div",E,[a[29]||(a[29]=p(" 密钥连接错误，请重新绑定或取消当前密钥关联! ",-1)),m(i(X),{class:"ml-1rem",onClick:a[6]||(a[6]=e=>xe(i(ce)))},{default:d(()=>[...a[28]||(a[28]=[p("[ 密钥管理 ]",-1)])]),_:1})])]),_:1})):f("",!0),m(i(J),{modelValue:i(pe).firstPhotoShow,"onUpdate:modelValue":a[12]||(a[12]=e=>i(pe).firstPhotoShow=e),title:"阿里云硬盘快照",area:[62]},{default:d(()=>[l("div",j,[a[36]||(a[36]=l("div",{class:"alert alert-danger leading-2rem mb-1rem"},[p(" 温馨提示： "),l("div",null,[p("1、每个地域的免费快照配额为已创建实例数"),l("span",{style:{"font-weight":"600"}},"(待回收实例和存储型套餐实例除外)乘以2"),p("，且最多不超过4个。")]),l("div",null,"2、使用存储型套餐的实例不支持创建快照。"),l("div",null,"3、创建快照通常可以在5分钟内完成，请耐心等待，创建过程中无需关机。")],-1)),l("div",z,[m(i(ee),{modelValue:i(me),"onUpdate:modelValue":a[10]||(a[10]=e=>h(me)?me.value=e:null),placement:"right","popper-class":"myPopover",width:"200"},{reference:d(()=>[m(i(N),{type:"primary",onClick:a[9]||(a[9]=e=>me.value=!0)},{default:d(()=>[...a[32]||(a[32]=[p("创建快照",-1)])]),_:1})]),default:d(()=>[l("div",B,[m(n,{modelValue:i(pe).snapshot_name,"onUpdate:modelValue":a[7]||(a[7]=e=>i(pe).snapshot_name=e),disabled:i(pe).createSnapshotDisable,size:"small",class:"mb-[1rem]",placeholder:"请输入快照名称"},null,8,["modelValue","disabled"]),l("div",R,[m(i(N),{type:"default",onClick:a[8]||(a[8]=e=>me.value=!1)},{default:d(()=>[...a[30]||(a[30]=[p("取消",-1)])]),_:1}),m(i(N),{type:"primary",loading:i(pe).createSnapshotDisable,onClick:we},{default:d(()=>[...a[31]||(a[31]=[p("确定",-1)])]),_:1},8,["loading"])])])]),_:1},8,["modelValue"]),m(i(N),{type:"default",icon:"svgtofont-el-refresh",onClick:a[11]||(a[11]=e=>be(!0))})]),m(i(Q),{data:i(pe).snapshotsList,border:"","max-height":250,class:"mt-[1rem]"},{default:d(()=>[m(i(W),{prop:"snapshot_name",label:"快照名称",width:"120"}),m(i(W),{prop:"creation_time",label:"创建时间",formatter:e=>(e=>{if(!e)return"--";const a=new Date(e),t=a.getFullYear(),s=String(a.getMonth()+1).padStart(2,"0"),l=String(a.getDate()).padStart(2,"0"),n=String(a.getHours()).padStart(2,"0"),r=String(a.getMinutes()).padStart(2,"0"),i=String(a.getSeconds()).padStart(2,"0");return"".concat(t,"-").concat(s,"-").concat(l," ").concat(n,":").concat(r,":").concat(i)})(e.creation_time)},null,8,["formatter"]),m(i(W),{prop:"TrafficUsed",label:"操作",align:"right"},{default:d(e=>[m(i(X),{href:"https://console.cloud.aliyun.com/cvm/snapshot/list"},{default:d(()=>[...a[33]||(a[33]=[p("回滚",-1)])]),_:1}),a[35]||(a[35]=l("div",{class:"el-divider el-divider--vertical"},null,-1)),m(i(X),{onClick:a=>(async e=>{try{await le({icon:"warning",title:"删除[".concat(e.snapshot_name,"]快照"),content:"是否删除当前【".concat(e.snapshot_name,"】快照，删除后将无法恢复，是否继续？")});const a=re.load("正在删除快照，请稍后..."),t=await w({snapshot_id:e.snapshot_id});a.close(),re.request(t),await be()}catch(a){}})(e.row)},{default:d(()=>[...a[34]||(a[34]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1},8,["modelValue"]),m(i(J),{modelValue:i(pe).requestInfoShow,"onUpdate:modelValue":a[13]||(a[13]=e=>i(pe).requestInfoShow=e),title:"流量包管理",area:[60,30]},{default:d(()=>[l("div",A,[m(i(Q),{data:i(ge),border:"","max-height":250},{default:d(()=>[m(i(W),{prop:"TrafficPackageTotal",label:"总量"}),m(i(W),{prop:"TrafficUsed",label:"已用"}),m(i(W),{prop:"TrafficPackageRemaining",label:"剩余"})]),_:1},8,["data"])])]),_:1},8,["modelValue"])])}}}),K=Object.freeze(Object.defineProperty({__proto__:null,default:O},Symbol.toStringTag,{value:"Module"}));export{P as a,K as s};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
