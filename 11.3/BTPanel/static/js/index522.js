import{u as a,n as t,H as e,Q as s,l,j as o,b as i,p as n}from"./utils-lib.js?v=1763689792";import{_ as r}from"./index124.js?v=1763689792";import{_ as u}from"./index109.js?v=1763689792";import{B as m}from"./index119.js?v=1763689792";import{_ as d}from"./index130.js?v=1763689792";import{c as p,r as c,o as h,v as f,I as v,x as y,y as g,z as _,O as x,C as j,A as w,e as V,D as b,R as k,J as C,H as A,ap as q}from"./base-lib.js?v=1763689792";import{_ as E}from"./index110.js?v=1763689792";import{d as F,u as I}from"./column.js?v=1763689792";import{checkMonitorDir as S,setMonitorDir as H,webshellFileSingle as O,setHandleFile as R}from"./site.js?v=1763689792";import{S as T,u as U}from"./useStore4.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./validator.js?v=1763689792";import"./index107.js?v=1763689792";import"./ace.js?v=1763689792";const D={class:"flex items-center"},J={class:"p-20px"},P=p({__name:"index",setup(p){const{getFileEvent:P,saveFileEvent:z}=T(),B=i(),{payment:L}=a(),{siteInfo:N}=U(),Q=c([]),G=c(!1),K=c(""),M=c(!1),W=c({}),X=c(!1),Y=h({title:"动态查杀-功能介绍",ps:"当查杀站点目录中的文件发生修改就会自动的进行木马查杀并进行隔离",source:185,desc:["网页内容修改检测","木马查杀隔离"],tabImgs:[{title:"概览",imgSrc:"https://www.bt.cn/Public/new/plugin/introduce/site/dynamic_kill.png"}]}),Z=()=>{t({isAsync:!0,title:"白名单",area:[70,55],component:()=>e(()=>import("./index489.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),showFooter:!1})},$=async()=>{try{const a=await S({path:N.value.path});X.value=a.data.is_run}catch(a){}},aa=async a=>{await s({loading:"正在设置中，请稍后...",request:H(!a,{path:N.value.path}),message:!0}),$()},ta=async()=>{const a=await z({path:W.value.path,data:K.value,encoding:"utf-8"});B.request(a)},ea=async()=>{G.value=!0;try{const a=await O({path:(N.value.path+"/").replace("//","/")});Q.value=Array.isArray(a.data)?a.data:[]}catch(a){}G.value=!1},sa=c([{label:"隔离时间",prop:"time"},F(),I([{width:80,onClick:async a=>{W.value=a;const t=await P({path:a.path});if(!t.status)return B.request(t),!1;K.value=t.data.data||t.msg,M.value=!0},title:"样本文件"},{onClick:a=>{n({title:"删除文件",content:"是否要删除关联的源文件?",type:"check",icon:"warning",check:{content:"源文件",onConfirm:t=>{s({loading:"正在删除文件中，请稍后...",request:R({data:JSON.stringify({path:a.path,md5:a.md5,type:t?"delete":""})}),message:!0,success:a=>{a.status&&ea()}})}}})},title:"删除"}])]);return f(()=>{"ltd"===L.value.authType&&($(),ea())}),(a,t)=>{const e=A,s=E,i=q,n=d,p=l,c=m,h=o,f=u,F=r,I=v("bt-loading");return y(),g("div",null,["ltd"===_(L).authType?(y(),x(f,{key:0},{"header-left":j(()=>[w("div",D,[V(e,{type:"default",onClick:Z},{default:j(()=>[...t[3]||(t[3]=[b(" 白名单 ",-1)])]),_:1}),V(s),t[4]||(t[4]=w("div",{class:"mr-8px"},"动态查杀站点",-1)),w("div",null,[V(i,{modelValue:_(X),"onUpdate:modelValue":t[0]||(t[0]=a=>k(X)?X.value=a:null),width:36,onChange:aa},null,8,["modelValue"])])])]),"header-right":j(()=>[V(n,{onRefresh:ea})]),content:j(()=>[C(V(p,{column:_(sa),"max-height":400,data:_(Q)},null,8,["column","data"]),[[I,_(G)]])]),"footer-left":j(()=>[...t[5]||(t[5]=[w("ul",{class:"mt-8px leading-8 text-small list-disc ml-20px"},[w("li",null,"注意：隔离文件后的数字表示隔离文件总数。"),w("li",{class:"text-warning"},"动态查杀开启后，当查杀目录中的文件发生修改就会自动的进行木马查杀并进行隔离")],-1)])]),"footer-right":j(()=>[...t[6]||(t[6]=[])]),popup:j(()=>[V(h,{title:"在线编辑",showFooter:"",modelValue:_(M),"onUpdate:modelValue":t[2]||(t[2]=a=>k(M)?M.value=a:null),area:70,onConfirm:ta},{default:j(()=>[w("div",J,[V(c,{modelValue:_(K),"onUpdate:modelValue":t[1]||(t[1]=a=>k(K)?K.value=a:null),class:"!h-[40rem]"},null,8,["modelValue"])])]),_:1},8,["modelValue"])]),_:1})):(y(),x(F,{key:1,data:_(Y)},null,8,["data"]))])}}});export{P as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
