!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach(function(e){o(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function o(e,n,r){return(n=function(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,n||"default");if("object"!=t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function o(n,r,a,o){var i=r&&r.prototype instanceof l?r:l,s=Object.create(i.prototype);return u(s,"_invoke",function(n,r,a){var o,i,u,l=0,s=a||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return o=e,i=0,u=t,d.n=n,c}};function p(n,r){for(i=n,u=r,e=0;!f&&l&&!a&&e<s.length;e++){var a,o=s[e],p=d.p,v=o[2];n>3?(a=v===r)&&(u=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=t):o[0]<=p&&((a=n<2&&p<o[1])?(i=0,d.v=r,d.n=o[1]):p<v&&(a=n<3||o[0]>r||r>v)&&(o[4]=n,o[5]=r,d.n=v,i=0))}if(a||n>1)return c;throw f=!0,r}return function(a,s,v){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,v),i=s,u=v;(e=i<2?t:u)||!f;){o||(i?i<3?(i>1&&(d.n=-1),p(i,u)):d.n=u:d.v=u);try{if(l=2,o){if(i||(a="next"),e=o[a]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,i<2&&(i=0)}else 1===i&&(e=o.return)&&e.call(o),i<2&&(u=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=t}else if((e=(f=d.n<0)?u:n.call(r,d))!==c)break}catch(e){o=t,i=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,a,o),!0),s}var c={};function l(){}function s(){}function f(){}e=Object.getPrototypeOf;var d=[][r]?e(e([][r]())):(u(e={},r,function(){return this}),e),p=f.prototype=l.prototype=Object.create(d);function v(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,u(t,a,"GeneratorFunction")),t.prototype=Object.create(p),t}return s.prototype=f,u(p,"constructor",f),u(f,"constructor",s),s.displayName="GeneratorFunction",u(f,a,"GeneratorFunction"),u(p),u(p,a,"Generator"),u(p,r,function(){return this}),u(p,"toString",function(){return"[object Generator]"}),(i=function(){return{w:o,m:v}})()}function u(t,e,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}u=function(t,e,n,r){function o(e,n){u(t,e,function(t){return this._invoke(e,n,t)})}e?a?a(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},u(t,e,n,r)}function c(t,e,n,r,a,o,i){try{var u=t[o](i),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(r,a)}function l(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function i(t){c(o,r,a,i,u,"next",t)}function u(t){c(o,r,a,i,u,"throw",t)}i(void 0)})}}System.register(["./index-legacy109.js?v=1763689792","./index-legacy260.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./column-legacy.js?v=1763689792"],function(t,n){"use strict";var r,o,u,c,s,f,d,p,v,m,y,b,h,_,g,w,j,O,k,S,T,A,x,P,E,C,M,R,q,B,L,N;return{setters:[function(t){r=t._},function(t){o=t._},function(t){u=t.p,c=t.Q,s=t.hr,f=t.M,d=t.gZ,p=t.h0,v=t.n,m=t.H,y=t.hs,b=t.u,h=t.an,_=t.ht,g=t.ao,w=t.ap},function(t){j=t.s,O=t.j,k=t.r,S=t.c,T=t.e,A=t.aT,x=t.x,P=t.y,E=t.C,C=t.A,M=t.z,R=t.L},function(t){q=t.c,B=t.a,L=t.b,N=t.u}],execute:function(){var D=O("NODE-ALARM-STORE",function(){var t=k(),e=k(!1);return{alarmRowData:t,nodeAlarmRefresh:k(!1),isAlarmEdit:e}}),G=t("u",function(){return j(D())}),z=G(),I=z.alarmRowData,F=z.isAlarmEdit,H=z.nodeAlarmRefresh,J=function(){var t=l(i().m(function t(e,n,r,a){var o,u,c;return i().w(function(t){for(;;)switch(t.n){case 0:return o=function(){var t=l(i().m(function t(e,n){var r,a,o,u;return i().w(function(t){for(;;)switch(t.n){case 0:r=e.id,e.status,a=new Map([["delete",s],["start",y],["stop",y]]),o=a.get(c),u=c,t.n="start"===u?1:"stop"===u?4:"delete"===u?7:10;break;case 1:if(!o){t.n=3;break}return t.n=2,o({task_id:r,status:1});case 2:case 5:case 8:return t.a(2,t.v);case 3:case 6:case 9:return t.a(3,10);case 4:if(!o){t.n=6;break}return t.n=5,o({task_id:r,status:0});case 7:if(!o){t.n=9;break}return t.n=8,o({task_id:r});case 10:return t.a(2)}},t)}));return function(e,n){return t.apply(this,arguments)}}(),u=a.label,c=a.value,t.n=1,e({title:"批量".concat(u,"告警"),content:"即将批量".concat(u,"告警，是否继续操作?"),column:[{label:"告警名称",prop:"title"},q()],onConfirm:function(){var t=l(i().m(function t(){return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,n(o);case 1:return H.value=!0,t.a(2,!1)}},t)}));return function(){return t.apply(this,arguments)}}()});case 1:return t.a(2)}},t)}));return function(e,n,r,a){return t.apply(this,arguments)}}(),Q=(t("a",function(){try{var t,e,n,r,a,o,i,u="clb";if(F.value)u=["222","223"].includes(null===(i=I.value)||void 0===i||null===(i=i.task_data)||void 0===i?void 0:i.tid)?"master":"clb";return{alarmType:u,lcbType:0,sendTimes:(null===(t=I.value)||void 0===t||null===(t=t.number_rule)||void 0===t?void 0:t.day_num)||3,failTimes:(null===(e=I.value)||void 0===e||null===(e=e.task_data)||void 0===e?void 0:e.err_num)||3,successCode:(null===(n=I.value)||void 0===n||null===(n=n.task_data)||void 0===n?void 0:n.codes)||"200,301,302,403,404",name:F.value?null===(r=I.value)||void 0===r||null===(r=r.task_data)||void 0===r?void 0:r.project:"",type:(null===(a=I.value)||void 0===a?void 0:a.sender)||[],masterType:(null===(o=I.value)||void 0===o?void 0:o.template_id)||"222"}}catch(c){return{}}}),function(){var t=l(i().m(function t(e){return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,u({icon:"warning-filled",title:"删除告警任务",content:"删除后将不再告警此条任务，是否继续？"});case 1:return t.n=2,c({loading:"正在删除告警任务，请稍候...",request:s({task_id:e.id}),message:!0,success:function(){H.value=!0}});case 2:t.n=4;break;case 3:t.p=3,t.v;case 4:return t.a(2)}},t,null,[[0,3]])}));return function(e){return t.apply(this,arguments)}}()),U=function(){var t=l(i().m(function t(e){var r,a,o,u,c;return i().w(function(t){for(;;)switch(t.n){case 0:return I.value=e||{},F.value=!!e,r=f.load("正在加载数据，请稍后..."),t.n=1,d({page:1,page_size:100});case 1:return a=t.v,o=a.data.data,t.n=2,p({page:1,page_size:100});case 2:u=t.v,c=u.data.data,r.close(),e||(I.value={clbList:[],tcpList:[]}),I.value.clbList=o.map(function(t){return{label:t.ps,value:t.load_id}}),I.value.tcpList=c.map(function(t){return{label:t.ps,value:t.load_id}}),v({isAsync:!0,title:"".concat(e?"修改":"添加","告警"),area:48,btn:!0,component:function(){return m(function(){return n.import("./index-legacy382.js?v=1763689792")},void 0,n.meta.url)}});case 3:return t.a(2)}},t)}));return function(e){return t.apply(this,arguments)}}(),W=function(){var t=l(i().m(function t(e){return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,u({title:"".concat(e.status?"禁用":"启用","【").concat(e.title,"】任务"),content:"您真的要".concat(e.status?"禁用":"启用","【").concat(e.title,"】这个任务吗？")});case 1:return t.n=2,c({loading:"正在修改告警任务状态，请稍候...",request:y({task_id:e.id,status:Number(!e.status)}),message:!0,success:function(){H.value=!0}});case 2:t.n=4;break;case 3:t.p=3,t.v;case 4:return t.a(2)}},t,null,[[0,3]])}));return function(e){return t.apply(this,arguments)}}(),Z=[{label:"启动",value:"start",event:J},{label:"停止",value:"stop",event:J},{label:"删除",value:"delete",event:J}],$=(t("g",function(t){var e=t.alarmType,n=t.lcbType,r=t.sendTimes,o=t.failTimes,i=t.successCode,u=t.name,c=t.type,l=t.masterType,s={sender:c,number_rule:{day_num:Number(r),total:2},time_rule:{send_interval:0,time_range:[0,86399]}},f={status:!0,count:0,interval:600};switch(!0){case"clb"===e&&0===n:return{template_id:"220",task_data:JSON.stringify(a(a({},s),{},{task_data:a(a({},f),{},{tid:"220",type:"nodes_nginx_http_load_push",title:"节点管理-负载均衡",project:u,codes:i})}))};case"clb"===e&&1===n:return{template_id:"221",task_data:JSON.stringify(a(a({},s),{},{task_data:a(a({},f),{},{tid:"221",type:"nodes_nginx_tcp_load_push",title:"节点管理-tcp负载均衡",project:u,err_num:o})}))};case"master"===e:return{template_id:l,task_data:JSON.stringify(a(a({},s),{},{task_data:a(a({},f),{},{tid:"mysql"===l?"222":"223",type:"mysql"===l?"nodes_mysql_slave_err_push":"nodes_redis_slave_err_push",title:"mysql"===l?"节点管理-Mysql主从告警":"节点管理-Redis主从告警",project:""})}))};default:return null}}),{class:"node-clb-http module-ui"}),K={class:"flex items-center"},V={class:"flex items-center"},X=S({__name:"index",setup:function(t){var n,u=G().nodeAlarmRefresh,c=b(),s=c.mainHeight,f=c.push,d=c.getSenderAlarmListInfo,p=[{content:"添加告警",dropdownClass:"bg-white",splitButton:!0,active:!0,event:function(){return U()}}],v=w(Z),m=new Map([["wx_account","微信公众号"],["feishu","飞书"],["mail","邮箱"],["sms","短信通知"],["dingding","钉钉"],["weixin","企业微信"],["webhook","自定义消息通道"]]),y=!0,j=h({request:(n=l(i().m(function t(e){var n,r,o;return i().w(function(t){for(;;)switch(t.n){case 0:if(!y){t.n=2;break}return t.n=1,d();case 1:y=!1;case 2:return t.n=3,_({keyword:e.search,template_ids:'["220", "221", "222", "223"]'});case 3:return r=t.v,o=r.data,t.a(2,{data:null===(n=o.data)||void 0===n?void 0:n.map(function(t){var e=t.sender;return a(a({},t),{},{alarmAccounts:e.map(function(t){var e=f.value.config.find(function(e){return e.id===t});return e?"sms"===e.sender_type?{id:t,type:e.sender_type,title:"短信"}:{id:t,type:e.sender_type,title:m.get(e.sender_type)||"",account:e.data.title}:null})})}),total:0,other:{}})}},t)})),function(t){return n.apply(this,arguments)}),columns:[B({type:"page",key:"id"}),{label:"名称",prop:"title"},L({minWidth:100,event:W,data:["停用","正常"]}),{label:"告警方式",width:260,render:function(t){var e=(t.alarmAccounts||[]).filter(function(t){return null!==t}),n=e.map(function(t){return"sms"===(null==t?void 0:t.type)?"短信通知":"".concat((null==t?void 0:t.account)||"","(").concat((null==t?void 0:t.title)||"",")")}).join(","),r=e.map(function(t){return"sms"===(null==t?void 0:t.type)?"短信通知":"".concat(null==t?void 0:t.account,"(").concat(t.title,")")}).join(",");return T(A,{content:n,placement:"top","open-delay":500},{default:function(){return[T("span",null,[r])]}})}},{label:"告警条件",prop:"view_msg",render:function(t){return T("span",{innerHTML:t.view_msg},null)}},N([{onClick:U,title:"修改"},{onClick:Q,title:"删除"}])],extension:[v,g(u)]}),O=j.BtTable,k=(j.BtRefresh,j.BtSearch),S=j.BtColumn,q=j.BtBatch;j.BtErrorMask,j.refresh;return function(t,n){var a=o,i=r;return x(),P("div",$,[T(i,null,{"header-left":E(function(){return[C("div",K,[T(a,{options:p})])]}),"header-right":E(function(){return[C("div",V,[T(M(k),{class:R(["mr-[10px]","!w-[210px]"]),placeholder:"请输入节点地址或备注"}),T(M(S))])]}),content:E(function(){return[T(M(O),{"min-height":M(s)},null,8,["min-height"])]}),"footer-left":E(function(){return[T(M(q))]}),"footer-right":E(function(){return e(n[0]||(n[0]=[]))}),_:1})])}}}),Y=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"}));t("i",Y)}}})}();
