import{c as e,s as a,o as s,r as t,v as r,x as l,y as i,e as o,C as n,z as c,F as d,b1 as m,S as p,an as u,ad as f,ab as h,O as b,A as _,B as y,am as v}from"./base-lib.js?v=1763689792";import{O as w,Q as N,R as k,S as x}from"./ssl.js?v=1763689792";import{setSslInfo as I}from"./site.js?v=1763689792";import{b as O}from"./utils-lib.js?v=1763689792";import{u as j}from"./useStore11.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";const R={class:"p-[16px]"},D={style:{float:"left"}},S=e({__name:"index",props:{compData:{type:Object,default:()=>{}}},setup(e,{expose:S}){const{activeTabs:z,sslIsRefresh:V,testIsRefresh:C,encryptIsRefresh:g,otherIsRefresh:q,btIsRefresh:A}=a(j()),B=O(),F=e,H=s({siteName:"",ssl_hash:"",oid:"",partnerOrderId:"",index:""}),Q=t([]),T=async e=>{let a;try{switch(e){case"1":a=await x({siteName:H.siteName,oid:H.oid});break;case"2":a=await k({siteName:H.siteName,partnerOrderId:H.partnerOrderId});break;case"3":let e={siteName:H.siteName,ssl_hash:H.ssl_hash,index:H.index};F.compData.row.order_status?delete e.ssl_hash:delete e.index,a=await N(e);break;case"bt":a=await I({type:0,siteName:H.siteName,key:H.key,csr:H.csr},"default")}}catch(s){}return a},U=()=>{H.siteName="",H.ssl_hash="",H.oid="",H.partnerOrderId="",H.index="",H.key="",H.csr=""};return r(()=>{(async()=>{const{data:e}=await w();Q.value=e})(),(e=>{switch(e.type){case"1":H.oid=e.oid;break;case"2":H.partnerOrderId=e.partnerOrderId;break;case"3":H.ssl_hash=e.hash,H.index=e.index;break;case"bt":const a=e.cert_info.certificate+"\n"+e.cert_info.ca_certificate,s=e.cert_info.private_key;H.key=s,H.csr=a}})(F.compData.row)}),S({onConfirm:async e=>{var a;if(!H.siteName)return void B.error("请选择部署网站");let s;try{s=B.load("正在部署证书,请稍后...");const t=await T(F.compData.row.type);if(B.request(t),t.status){U();const s={ssl:()=>V.value=!0,test:()=>C.value=!0,encrypt:()=>g.value=!0,other:()=>q.value=!0,bt:()=>A.value=!0};null==(a=s[z.value])||a.call(s),e&&e()}}catch(t){}finally{s&&s.close()}}}),(e,a)=>{const s=v,t=u,r=f,w=h;return l(),i("div",R,[o(w,{model:c(H),class:"relative w-full","label-position":"right",size:"small",onSubmit:a[1]||(a[1]=p(()=>{},["prevent"]))},{default:n(()=>[o(r,{label:"部署网站",prop:"dns_name"},{default:n(()=>[o(t,{modelValue:c(H).siteName,"onUpdate:modelValue":a[0]||(a[0]=e=>c(H).siteName=e),class:"!w-[33rem]",filterable:"","default-first-option":"",size:"default",placeholder:"请选择部署网站"},{default:n(()=>[(l(!0),i(d,null,m(c(Q),e=>(l(),b(s,{key:e.id,label:e.name,value:e.name},{default:n(()=>[_("span",D,y(e.name),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])])}}});export{S as default};
