!function(){function n(n){return function(n){if(Array.isArray(n))return t(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,e){if(n){if("string"==typeof n)return t(n,e);var r={}.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(n,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=Array(t);e<t;e++)r[e]=n[e];return r}function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var n,t,o="function"==typeof Symbol?Symbol:{},u=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function i(e,o,u,a){var i=o&&o.prototype instanceof l?o:l,f=Object.create(i.prototype);return r(f,"_invoke",function(e,r,o){var u,a,i,l=0,f=o||[],s=!1,p={p:0,n:0,v:n,a:d,f:d.bind(n,4),d:function(t,e){return u=t,a=0,i=n,p.n=e,c}};function d(e,r){for(a=e,i=r,t=0;!s&&l&&!o&&t<f.length;t++){var o,u=f[t],d=p.p,y=u[2];e>3?(o=y===r)&&(i=u[(a=u[4])?5:(a=3,3)],u[4]=u[5]=n):u[0]<=d&&((o=e<2&&d<u[1])?(a=0,p.v=r,p.n=u[1]):d<y&&(o=e<3||u[0]>r||r>y)&&(u[4]=e,u[5]=r,p.n=y,a=0))}if(o||e>1)return c;throw s=!0,r}return function(o,f,y){if(l>1)throw TypeError("Generator is already running");for(s&&1===f&&d(f,y),a=f,i=y;(t=a<2?n:i)||!s;){u||(a?a<3?(a>1&&(p.n=-1),d(a,i)):p.n=i:p.v=i);try{if(l=2,u){if(a||(o="next"),t=u[o]){if(!(t=t.call(u,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,a<2&&(a=0)}else 1===a&&(t=u.return)&&t.call(u),a<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),a=1);u=n}else if((t=(s=p.n<0)?i:e.call(r,p))!==c)break}catch(t){u=n,a=1,i=t}finally{l=1}}return{value:t,done:s}}}(e,u,a),!0),f}var c={};function l(){}function f(){}function s(){}t=Object.getPrototypeOf;var p=[][u]?t(t([][u]())):(r(t={},u,function(){return this}),t),d=s.prototype=l.prototype=Object.create(p);function y(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,s):(n.__proto__=s,r(n,a,"GeneratorFunction")),n.prototype=Object.create(d),n}return f.prototype=s,r(d,"constructor",s),r(s,"constructor",f),f.displayName="GeneratorFunction",r(s,a,"GeneratorFunction"),r(d),r(d,a,"Generator"),r(d,u,function(){return this}),r(d,"toString",function(){return"[object Generator]"}),(e=function(){return{w:i,m:y}})()}function r(n,t,e,o){var u=Object.defineProperty;try{u({},"",{})}catch(n){u=0}r=function(n,t,e,o){function a(t,e){r(n,t,function(n){return this._invoke(t,e,n)})}t?u?u(n,t,{value:e,enumerable:!o,configurable:!o,writable:!o}):n[t]=e:(a("next",0),a("throw",1),a("return",2))},r(n,t,e,o)}function o(n,t,e,r,o,u,a){try{var i=n[u](a),c=i.value}catch(n){return void e(n)}i.done?t(c):Promise.resolve(c).then(r,o)}function u(n){return function(){var t=this,e=arguments;return new Promise(function(r,u){var a=n.apply(t,e);function i(n){o(a,r,u,i,c,"next",n)}function c(n){o(a,r,u,i,c,"throw",n)}i(void 0)})}}System.register(["./utils-lib-legacy.js?v=1763689792","./index-legacy109.js?v=1763689792","./index-legacy118.js?v=1763689792","./index-legacy130.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./column-legacy.js?v=1763689792","./useController-legacy6.js?v=1763689792","./site-legacy.js?v=1763689792","./useStore-legacy4.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./validator-legacy.js?v=1763689792","./index-legacy107.js?v=1763689792"],function(t,r){"use strict";var o,a,i,c,l,f,s,p,d,y,m,v,b,h,g,w,_,j,k,x,S,O,A,T,C,G,H,P,D,R,q,E,I,B,F;return{setters:[function(n){o=n.p,a=n.n,i=n.H,c=n.Q,l=n.bb,f=n.W,s=n.l,p=n.ah,d=n.b},function(n){y=n._},function(n){m=n._},function(n){v=n._},function(n){b=n.c,h=n.r,g=n.o,w=n.v,_=n.I,j=n.x,k=n.y,x=n.e,S=n.C,O=n.D,A=n.J,T=n.z,C=n.W,G=n.H},function(n){H=n.c,P=n.a,D=n.h,R=n.g,q=n.u},function(n){E=n.q},function(n){I=n.DelBackup,B=n.BackupSite},function(n){F=n.u},null,null,null,null],execute:function(){var U={class:"h-full"};t("default",b({__name:"index",props:{compData:{default:function(){return[]}}},setup:function(t){var b,z=t,W=F().isRefreshList,$=d(),J=h(!1),L=h(),M=h([]),N=h(),Q=[{label:"删除",value:"delete",event:(b=u(e().m(function n(t,r,o,a){var i;return e().w(function(n){for(;;)switch(n.n){case 0:return i=function(){var n=u(e().m(function n(t){return e().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,I({id:t.id});case 1:return n.a(2,n.v)}},n)}));return function(t){return n.apply(this,arguments)}}(),n.n=1,t({title:"批量删除备份文件",content:"批量删除已选备份文件，是否继续操作？",column:[{prop:"filename",label:"文件名"},H()],onConfirm:function(){var n=u(e().m(function n(){return e().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,r(i);case 1:return n.n=2,en();case 2:return W.value=!0,n.a(2,!1)}},n)}));return function(){return n.apply(this,arguments)}}()});case 1:return n.a(2)}},n)})),function(n,t,e,r){return b.apply(this,arguments)})}],K=z.compData,V=K.id,X=(K.name,g({p:1,limit:10,search:V,type:0,table:"backup",total:0})),Y=function(n){n.backup_status?$.error("备份中的文件不可下载"):window.open("/download?filename="+n.filename,"_self","noopener,noreferrer")},Z=function(){var n=u(e().m(function n(t){var r,u,a=arguments;return e().w(function(n){for(;;)switch(n.p=n.n){case 0:if(r=a.length>1&&void 0!==a[1]&&a[1],n.p=1,"boolean"!=typeof r&&(r=!1),r){n.n=2;break}return n.n=2,o({width:"40rem",title:"删除备份",content:'<p>删除选中站点备份文件后，<span class="text-danger">该站点备份文件将永久消失</span>，是否继续？</p>',icon:"warning-filled",isHtml:!0});case 2:return n.n=3,I({id:t.id});case 3:return u=n.v,r||($.request(u),W.value=!0),n.n=4,en();case 4:return 0===M.value.length&&(X.p=1,en()),n.a(2,u);case 5:n.p=5,n.v;case 6:return n.a(2)}},n,null,[[1,5]])}));return function(t){return n.apply(this,arguments)}}(),nn=function(n){a({isAsync:!0,title:"备份日志",area:64,compData:n,component:function(){return i(function(){return r.import("./backup-log-legacy.js?v=1763689792")},void 0,r.meta.url)}})},tn=function(){var n=u(e().m(function n(){return e().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,c({loading:"正在备份站点...",request:B({id:V,backstage:1}),message:!0});case 1:n.v.status&&(en(),W.value=!0);case 2:return n.a(2)}},n)}));return function(){return n.apply(this,arguments)}}(),en=function(){var n=u(e().m(function n(){var t,r,o=arguments;return e().w(function(n){for(;;)switch(n.n){case 0:return t=o.length>0&&void 0!==o[0]&&o[0],(r=!(o.length>1&&void 0!==o[1])||o[1])&&(J.value=!0),n.n=1,c({request:l({p:X.p,limit:X.limit,search:V,type:X.type.toString(),table:"backup"}),data:{data:[Array,M],page:f(X)}});case 1:r&&(J.value=!1),t&&$.success("刷新成功"),clearTimeout(N.value),M.value.some(function(n){return 1===n.backup_status})&&(N.value=setTimeout(function(){en(!1,!1)},3e3));case 2:return n.a(2)}},n)}));return function(){return n.apply(this,arguments)}}(),rn=C([P(),{label:"文件名称",prop:"name"},{label:"存储位置",width:100,render:function(n){if(-1!=n.filename.indexOf("|")){var t=n.filename.match(/\|(.+)\|/,"$1");return x("span",null,[E[t[1]]])}return x("span",null,[O("本地")])}},D({prop:"size"}),{width:160,prop:"addtime",label:"备份时间"},R({table:"backup"}),q([{isHide:function(n){return 1===n.backup_status},onClick:Y,title:"下载"},{isHide:function(n){return 1===n.backup_status},render:function(n){return x("span",{class:"cursor-pointer text-".concat(n.backup_status?"danger":"primary"),onClick:function(){n.backup_status?nn(n):Z(n)}},[n.backup_status?"备份中":"删除",n.backup_status?x("span",{class:"omit"},null):""])}}])]);return w(function(){en()}),function(t,e){var r=G,o=v,u=s,a=p,i=m,c=y,l=_("bt-loading");return j(),k("div",U,[x(c,null,{"header-left":S(function(){return[x(r,{type:"primary",onClick:tn},{default:S(function(){return n(e[3]||(e[3]=[O("备份站点",-1)]))}),_:1})]}),"header-right":S(function(){return[x(o,{onRefresh:e[0]||(e[0]=function(){return en(!0)})})]}),content:S(function(){return[A(x(u,{ref_key:"routeBackupRef",ref:L,data:T(M),"max-height":408,column:T(rn)},null,8,["data","column"]),[[l,T(J)],[l,"正在加载中，请稍后...","title"]])]}),"footer-left":S(function(){return[x(a,{options:Q,tableRef:T(L)},null,8,["tableRef"])]}),"footer-right":S(function(){return[x(i,{page:T(X).p,"onUpdate:page":e[1]||(e[1]=function(n){return T(X).p=n}),row:T(X).limit,"onUpdate:row":e[2]||(e[2]=function(n){return T(X).limit=n}),total:T(X).total,onChange:en},null,8,["page","row","total"])]}),_:1})])}}}))}}})}();
