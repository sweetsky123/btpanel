!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,l)}return n}function n(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?t(Object(a),!0).forEach(function(t){l(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function l(t,n,l){return(n=function(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var l=t[Symbol.toPrimitive];if(void 0!==l){var a=l.call(t,n||"default");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[n]=l,t}function a(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,l=Array(t);n<t;n++)l[n]=e[n];return l}function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},l=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function i(n,l,a,i){var r=l&&l.prototype instanceof c?l:c,u=Object.create(r.prototype);return s(u,"_invoke",function(n,l,a){var i,r,s,c=0,u=a||[],d=!1,f={p:0,n:0,v:e,a:v,f:v.bind(e,4),d:function(t,n){return i=t,r=0,s=e,f.n=n,o}};function v(n,l){for(r=n,s=l,t=0;!d&&c&&!a&&t<u.length;t++){var a,i=u[t],v=f.p,m=i[2];n>3?(a=m===l)&&(s=i[(r=i[4])?5:(r=3,3)],i[4]=i[5]=e):i[0]<=v&&((a=n<2&&v<i[1])?(r=0,f.v=l,f.n=i[1]):v<m&&(a=n<3||i[0]>l||l>m)&&(i[4]=n,i[5]=l,f.n=m,r=0))}if(a||n>1)return o;throw d=!0,l}return function(a,u,m){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&v(u,m),r=u,s=m;(t=r<2?e:s)||!d;){i||(r?r<3?(r>1&&(f.n=-1),v(r,s)):f.n=s:f.v=s);try{if(c=2,i){if(r||(a="next"),t=i[a]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,r<2&&(r=0)}else 1===r&&(t=i.return)&&t.call(i),r<2&&(s=TypeError("The iterator does not provide a '"+a+"' method"),r=1);i=e}else if((t=(d=f.n<0)?s:n.call(l,f))!==o)break}catch(t){i=e,r=1,s=t}finally{c=1}}return{value:t,done:d}}}(n,a,i),!0),u}var o={};function c(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][l]?t(t([][l]())):(s(t={},l,function(){return this}),t),v=d.prototype=c.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,a,"GeneratorFunction")),e.prototype=Object.create(v),e}return u.prototype=d,s(v,"constructor",d),s(d,"constructor",u),u.displayName="GeneratorFunction",s(d,a,"GeneratorFunction"),s(v),s(v,a,"Generator"),s(v,l,function(){return this}),s(v,"toString",function(){return"[object Generator]"}),(r=function(){return{w:i,m:m}})()}function s(e,t,n,l){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}s=function(e,t,n,l){function i(t,n){s(e,t,function(e){return this._invoke(t,n,e)})}t?a?a(e,t,{value:n,enumerable:!l,configurable:!l,writable:!l}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},s(e,t,n,l)}function o(e,t,n,l,a,i,r){try{var s=e[i](r),o=s.value}catch(e){return void n(e)}s.done?t(o):Promise.resolve(o).then(l,a)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(l,a){var i=e.apply(t,n);function r(e){o(i,l,a,r,s,"next",e)}function s(e){o(i,l,a,r,s,"throw",e)}r(void 0)})}}System.register(["./base-lib-legacy.js?v=1763689792","./firewall-legacy.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./useController-legacy9.js?v=1763689792","./index-legacy305.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./useStore-legacy7.js?v=1763689792","./useController-legacy8.js?v=1763689792","./useStore-legacy8.js?v=1763689792","./site-legacy.js?v=1763689792","./useStore-legacy6.js?v=1763689792"],function(e,t){"use strict";var l,i,s,o,u,d,f,v,m,p,g,h,b,y,_,w,x,k,S,j,C,O,L,A,P,E,T,M,z,H,I,F,N,R,D,G,q,B,V,W,Q,U,J,X,K,$,Y,Z,ee,te;return{setters:[function(e){l=e.c,i=e.e,s=e.j,o=e.s,u=e.k,d=e.r,f=e.o,v=e.x,m=e.y,p=e.z,g=e.F,h=e.b1,b=e.G,y=e.A,_=e.B,w=e.L,x=e.C,k=e.J,S=e.R,j=e.O,C=e.M,O=e.K,L=e.m,A=e.bo,P=e.aQ,E=e.b2,T=e.bz,M=e.bA,z=e.g,H=e.v,I=e.aG,F=e.w,N=e.D,R=e.ay,D=e.i,G=e.H,q=e.b6,B=e.a8,V=e.by,W=e.bw},function(e){Q=e.v},function(e){U=e.cP,J=e.M,X=e.ay,K=e.f,$=e._,Y=e.cQ,Z=e.an,ee=e.e},function(e){te=e.a},null,null,null,null,null,null,null],execute:function(){var t={beforeEnter:function(e){e.style.height="0",e.style.overflow="hidden"},enter:function(e,t){var n=e.scrollHeight;e.style.transition="height 320ms ease",requestAnimationFrame(function(){e.style.height=n+"px"});var l=function(){e.style.height="",e.style.transition="",e.style.overflow="",e.removeEventListener("transitionend",l),t()};e.addEventListener("transitionend",l)},beforeLeave:function(e){e.style.height=e.scrollHeight+"px",e.style.overflow="hidden"},leave:function(e,t){e.style.transition="height 320ms ease",requestAnimationFrame(function(){e.style.height="0"});var n=function(){e.style.transition="",e.removeEventListener("transitionend",n),t()};e.addEventListener("transitionend",n)}},ne=l({props:{title:{type:String,default:""}},setup:function(e,t){var n=t.slots;return function(){var t;return i("div",{class:"module-ui"},[i("div",{class:"text-medium font-bold text-default"},[e.title]),i("div",{class:"w-full mt-[1rem]"},[null===(t=n.default)||void 0===t?void 0:t.call(n)])])}}}),le=s("SITE-SAFE-STORE",function(){var e=u("firewall-site-safe",!1),t=d(!0),n=d(null),l=U().trigger,i=d(""),s=d({progress:0,msg:"",duration:0,details:{backup:[],fileleak:[],webshell:[],weakpass:[],weblog:[],webscan:[]},detailsNum:{backup:0,fileleak:0,webshell:0,weakpass:0,weblog:0,webscan:0},detailsChecked:{backup:!1,fileleak:!1,webshell:!1,weakpass:!1,weblog:!1,webscan:!1},currentScan:"",ip_top:[],risk_count:{high:0,middle:0,low:0},scan_time:"",score:0,total_attack:{xss:0,sql_injection:0,file_traversal:0,php_execution:0,sensitive_files:0},web_count:0}),o=function(e){var t,n,l,a,i,r,s,o,c,u,d,f,v,m;return{progress:(null==e?void 0:e.progress)||0,msg:(null==e?void 0:e.msg)||"",duration:(null==e?void 0:e.duration)||0,details:(null==e?void 0:e.details)||{backup:[],fileleak:[],webshell:[],weakpass:[],weblog:[],webscan:[]},detailsNum:{backup:(null==e||null===(t=e.details.backup)||void 0===t?void 0:t.length)||0,fileleak:(null==e||null===(n=e.details.fileleak)||void 0===n?void 0:n.length)||0,webshell:(null==e||null===(l=e.details.webshell)||void 0===l?void 0:l.length)||0,weakpass:(null==e||null===(a=e.details.weakpass)||void 0===a?void 0:a.length)||0,weblog:(null==e||null===(i=e.details.weblog)||void 0===i?void 0:i.length)||0,webscan:(null==e||null===(r=e.details.webscan)||void 0===r?void 0:r.length)||0},detailsChecked:{backup:!!e,fileleak:!!e,webshell:!!e,weakpass:!!e,weblog:!!e,webscan:!!e},currentScan:"",ip_top:(null==e?void 0:e.ip_top)||[],risk_count:{high:(null==e||null===(s=e.risk_count)||void 0===s?void 0:s.high)||0,middle:(null==e||null===(o=e.risk_count)||void 0===o?void 0:o.middle)||0,low:(null==e||null===(c=e.risk_count)||void 0===c?void 0:c.low)||0},scan_time:(null==e?void 0:e.scan_time)||"",score:(null==e?void 0:e.score)||0,total_attack:{xss:(null==e||null===(u=e.total_attack)||void 0===u?void 0:u.xss)||0,sql_injection:(null==e||null===(d=e.total_attack)||void 0===d?void 0:d.sql_injection)||0,file_traversal:(null==e||null===(f=e.total_attack)||void 0===f?void 0:f.file_traversal)||0,php_execution:(null==e||null===(v=e.total_attack)||void 0===v?void 0:v.php_execution)||0,sensitive_files:(null==e||null===(m=e.total_attack)||void 0===m?void 0:m.sensitive_files)||0},web_count:(null==e?void 0:e.web_count)||0}},f=function(){var n=c(r().m(function n(){var a,c,u=arguments;return r().w(function(n){for(;;)switch(n.p=n.n){case 0:return a=u.length>0&&void 0!==u[0]&&u[0],n.p=1,n.n=2,Q();case 2:c=n.v,s.value=o(c.data),e.value=!!c.data.scan_time,!0===a&&c.data.score>=90&&setTimeout(function(){l()},500),n.n=4;break;case 3:n.p=3,n.v,s.value=o(null),e.value=!1,i.value&&J.error(i.value);case 4:return n.p=4,setTimeout(function(){return t.value=!1},500),n.f(4);case 5:return n.a(2)}},n,null,[[1,3,4,5]])}));return function(){return n.apply(this,arguments)}}(),v=function(e,t){var l=JSON.parse(t.data);if(l.hasOwnProperty("end")){var r,o,c;if(s.value.progress=l.bar,s.value.msg=l.info,l.type&&(s.value.currentScan=l.type,s.value.detailsChecked[l.type]||(s.value.detailsChecked[l.type]=!0)),null!==(r=l.results)&&void 0!==r&&r.length)(o=s.value.details[l.type]).push.apply(o,a(l.results)),s.value.detailsNum[l.type]+=l.results.length;if(l.end)return null===(c=n.value)||void 0===c||c.close(),f(!0),void(i.value=l.info)}},m=function(){var t;e.value=!0,s.value=o(null),i.value="",null===(t=n.value)||void 0===t||t.close(),n.value=X({route:"/ws_project",onMessage:v,onConnected:function(){var e;null===(e=n.value)||void 0===e||e.send({model_index:"safe",mod_name:"webbasicscanning",def_name:"ScanAllSite",ws_callback:"123"})}})},p=function(){var t;null===(t=n.value)||void 0===t||t.close(),e.value=!1,s.value=o(null)};return{scanEvent:function(){s.value.scan_time?m():e.value?p():m()},scanStatus:e,getLastSiteSafeScanResult:f,scanResult:s,stopScan:p,loading:t}}),ae={class:"progress-cont-list"},ie=["onClick"],re={class:"progress_type"},se={class:"flex-1"},oe={key:0},ce={key:1},ue={key:2,class:"text-danger mr-[4px]"},de={key:3,class:"text-primary"},fe={class:"progress_fold text-small flex items-center"},ve={class:"mr-4px"},me={class:"progress_item_body"},pe={class:"flex items-center justify-between w-full"},ge={class:"flex items-center ml-12px"},he=["innerHTML"],be={class:"flex flex-col py-[1rem] px-[1.6rem] text-small progress_item_info"},ye={class:"flex items-center"},_e=["innerHTML"],we={class:"flex"},xe=["innerHTML"],ke=l({__name:"scan-result",setup:function(e){var n=le(),l=o(n),a=l.scanStatus,r=l.scanResult,s=d(["item"]),c=f({active:{backup:!1,fileleak:!1,webshell:!1,weakpass:!1,weblog:!1,webscan:!1}}),u=[{name:"webscan",title:"网站配置安全性",icon:"webscan"},{name:"fileleak",title:"文件泄露检测",icon:"filescan"},{name:"webshell",title:"木马检测",icon:"webhorse"},{name:"backup",title:"备份文件",icon:"backup"},{name:"weakpass",title:"弱口令检测",icon:"backend"},{name:"weblog",title:"网站日志",icon:"ftps"}],z={0:{text:"警告",bg:"rgba(252, 109, 38, 0.1)",color:"#fc6d26"},1:{text:"低风险",bg:"rgba(232, 213, 68, 0.1)",color:"#D4BB00"},2:{text:"中风险",bg:"rgba(240, 173, 78, 0.14)",color:"#E97B00"},3:{text:"高风险",bg:"rgba(239, 8, 8, 0.1)",color:"#CC1515"}};return function(e,n){var l=K,o=E,d=T,f=M;return v(),m("div",ae,[p(a)?(v(),m(g,{key:0},h(u,function(e,u){return y("div",{key:u,class:w([e.name+"_item "+(p(c).active[e.name]?"active":""),"progress_item"])},[y("div",{class:"progress_item_header",onClick:function(t){return function(e){c.active[e]||(c.active[e]=!1),c.active[e]=!c.active[e]}(e.name)}},[y("div",re,[i(l,{class:"mr-12px w-[2rem]",src:(b=e.icon,"/scan/scanning-".concat(b,"-ico.svg"))},null,8,["src"]),y("span",null,_(e.title),1)]),y("div",se,[p(a)&&p(r).currentScan==e.name?(v(),m("span",oe," 正在扫描... ")):!p(a)||p(r).detailsChecked[e.name]||p(r).detailsNum[e.name]?p(r).detailsNum[e.name]?(v(),m("span",ue," 发现"+_(p(r).detailsNum[e.name])+"项风险 ",1)):(v(),m("span",de,"无风险项")):(v(),m("span",ce," 等待扫描 "))]),y("div",fe,[y("span",ve,_(p(c).active[e.name]?"收起":"展开"),1),y("i",{class:w(p(c).active[e.name]?"svgtofont-el-arrow-up":"svgtofont-el-arrow-down")},null,2)])],8,ie),i(P,L({css:!1},A(p(t))),{default:x(function(){return[k(y("div",me,[i(f,{modelValue:p(s),"onUpdate:modelValue":n[0]||(n[0]=function(e){return S(s)?s.value=e:null})},{default:x(function(){return[(v(!0),m(g,null,h(p(r).details[e.name],function(e,t){return v(),j(d,{key:t,name:"item",disabled:""},{title:x(function(){return[y("div",pe,[y("div",ge,[y("span",{class:"text-small h-[2.2rem] flex items-center px-[8px] rounded-small mr-[1rem]",style:C({color:z[e.dangerous||0].color,backgroundColor:z[e.dangerous||0].bg})},_(z[e.dangerous||0].text),5),y("span",{style:C({color:z[e.dangerous||0].color}),innerHTML:e.name},null,12,he)])])]}),default:x(function(){return[y("div",be,[y("div",ye,[n[1]||(n[1]=y("span",{class:"w-[6rem] flex-shrink-0 inline-block font-bold text-right whitespace-nowrap"}," 详情： ",-1)),y("span",{class:"leading-[1.6rem] text-tertiary",innerHTML:e.info},null,8,_e)]),i(o,{class:"!my-8px"}),y("div",we,[n[2]||(n[2]=y("span",{class:"w-[6rem] flex-shrink-0 inline-block font-bold whitespace-nowrap"}," 修复方案： ",-1)),y("span",{class:"text-tertiary",innerHTML:e.repair},null,8,xe)])])]}),_:2},1024)}),128))]}),_:2},1032,["modelValue"])],512),[[O,p(c).active[e.name]]])]}),_:2},1040)],2);var b}),64)):b("",!0)])}}}),Se=$(ke,[["__scopeId","data-v-c5b14139"]]),je=$(l({__name:"score-chart",props:{high:{},medium:{},low:{},score:{default:0},colors:{default:function(){return{high:"#ff6b81",medium:"#ffb84d",low:"#F7E459"}}},successColor:{default:"#52c41a"},gapDeg:{default:10},startAngle:{default:180},endAngle:{default:0},radius:{default:"122%"},barWidth:{default:14},backgroundColor:{default:"transparent"},fontSize:{default:44},subtext:{default:"正在扫描..."}},setup:function(e){var t=e,n=d(null),l=null,a=z(function(){return[{value:Math.max(0,t.high),color:t.colors.high,name:"高风险"},{value:Math.max(0,t.medium),color:t.colors.medium,name:"中风险"},{value:Math.max(0,t.low),color:t.colors.low,name:"低风险"}]}),i=z(function(){return a.value.filter(function(e){return e.value>0})});function r(){var e=i.value.length>0,n=t.radius,l=t.barWidth,a=t.startAngle-t.endAngle,r=[{type:"gauge",startAngle:t.startAngle,endAngle:t.endAngle,radius:n,pointer:{show:!1},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{show:!1},progress:{show:!1},axisLine:{lineStyle:{width:l,color:[[1,t.backgroundColor]]}},detail:{show:!1},center:["50%","70%"],data:[{value:0}]}];if(!e)return r.push({type:"gauge",name:"安全",startAngle:t.startAngle,endAngle:t.endAngle,radius:n,pointer:{show:!1},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{show:!1},axisLine:{lineStyle:{width:l,color:[[1,t.backgroundColor]]}},center:["50%","70%"],progress:{show:!0,width:l,roundCap:!0,itemStyle:{color:t.successColor}},detail:{show:!1},data:[{value:100}]}),r;var s=i.value.reduce(function(e,t){return e+t.value},0),o=t.startAngle,c=i.value.length>1?Math.max(0,t.gapDeg):0;return i.value.forEach(function(e,u){var d=u===i.value.length-1?o-t.endAngle:a*(e.value/s)-c,f=o,v=Math.max(t.endAngle,o-Math.max(0,d));o=v-c,r.push({type:"gauge",name:"".concat(e.name,": ").concat(e.value),min:0,max:100,startAngle:f,endAngle:v,radius:n,pointer:{show:!1},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{show:!1},axisLine:{lineStyle:{width:l,color:[[1,t.backgroundColor]]}},progress:{show:!0,width:l,roundCap:!0,itemStyle:{color:e.color}},detail:{show:!1},center:["50%","70%"],data:[{value:100}]})}),r}var s=getComputedStyle(document.documentElement).getPropertyValue("--el-color-text-primary").trim(),o=getComputedStyle(document.documentElement).getPropertyValue("--el-color-text-tertiary").trim();function c(){var e;l&&l.setOption({title:{text:String(null!==(e=t.score)&&void 0!==e?e:""),subtext:t.subtext,left:"center",top:"45%",textStyle:{fontSize:t.fontSize,fontWeight:600,color:s},subtextStyle:{color:o}},legend:{bottom:"0%",orient:"horizontal",selectedMode:!1,itemWidth:14,itemHeight:14,data:[{name:"高风险: ".concat(t.high),icon:"rect",textStyle:{color:"#ff6b81",fontSize:14},itemStyle:{color:"#ff6b81"}},{name:"中风险: ".concat(t.medium),icon:"rect",textStyle:{color:"#ffb84d",fontSize:14},itemStyle:{color:"#ffb84d"}},{name:"低风险: ".concat(t.low),icon:"rect",textStyle:{color:"#F7E459",fontSize:14},itemStyle:{color:"#F7E459"}}]},series:r()},{notMerge:!0,lazyUpdate:!0})}return H(function(){if(n.value){l=Y(n.value),c();var e=function(){var e;return null===(e=l)||void 0===e?void 0:e.resize()};window.addEventListener("resize",e),I(function(){var t;window.removeEventListener("resize",e),null===(t=l)||void 0===t||t.dispose(),l=null})}}),F(function(){return{high:t.high,medium:t.medium,low:t.low,score:t.score,subtext:t.subtext}},function(){return c()},{deep:!0}),function(e,t){return v(),m("div",{ref_key:"chartEl",ref:n,class:"risk-gauge"},null,512)}}}),[["__scopeId","data-v-cc603ee8"]]),Ce={key:0,class:"mt-[1rem]"},Oe={class:"grid grid-cols-3 gap-4 h-[29.5rem]"},Le={class:"col-span-1"},Ae={class:"col-span-2"},Pe={class:"grid grid-cols-5 gap-4 mt-[1rem]"},Ee={class:"mb-[1.4rem] text-secondary text-medium font-bold"},Te={class:"mb-[1.4rem]"},Me={class:"text-extraLarge font-bold"},ze={class:"text-base"},He={class:"text-extraLarge font-bold"},Ie={class:"text-small text-tertiary"};var Fe=l({__name:"index",setup:function(e){var t=le(),l=o(t),a=l.scanStatus,s=l.scanResult,u=z(function(){return[{id:1,title:"耗时",value:s.value.duration,unit:"秒",description:"本次网站扫描总耗时",iconClass:"card-icon-1"},{id:2,title:"XSS",value:s.value.total_attack.xss,unit:"",description:"本次网站扫描XSS攻击数量",iconClass:"card-icon-2"},{id:3,title:"SQL",value:s.value.total_attack.sql_injection,unit:"",description:"本次网站扫描SQL注入攻击数量",iconClass:"card-icon-3"},{id:4,title:"恶意扫描",value:s.value.total_attack.file_traversal,unit:"",description:"本次网站扫描恶意扫描数量",iconClass:"card-icon-4"},{id:5,title:"PHP攻击",value:s.value.total_attack.php_execution,unit:"",description:"本次网站扫描PHP攻击数量",iconClass:"card-icon-5"}]}),d=Z({request:function(){return{data:s.value.ip_top||[]}},columns:[{label:"IP地址",prop:"ip",minWidth:100,render:function(e){var l,a,s=e.ip;return i(ee,{class:e.deny_status?"line-through !text-tertiary":"",onClick:(a=c(r().m(function l(){return r().w(function(l){for(;;)switch(l.n){case 0:return l.n=1,te(n(n({},e),{},{address:s}));case 1:l.v.status&&t.getLastSiteSafeScanResult();case 2:return l.a(2)}},l)})),function(){return a.apply(this,arguments)})},"function"==typeof(l=s)||"[object Object]"===Object.prototype.toString.call(l)&&!D(l)?s:{default:function(){return[s]}})}},{label:"访问次数",prop:"count"}],empty:function(){return i(g,null,[a&&!s.value.scan_time&&i("div",{class:"flex flex-col items-center justify-center h-[19rem]"},[i("i",{class:"svgtofont-el-loading text-secondary !text-large50 animate-spin"},null),i("span",{class:"text-tertiary text-medium mt-[1rem]"},[N("正在扫描...")])]),!(a&&!s.value.scan_time)&&i(R,{description:"暂无数据"},null)])}}),f=d.BtTable,S=d.refresh;return F(function(){return s.value.ip_top},function(){S()},{deep:!0}),function(e,t){return p(a)?(v(),m("section",Ce,[y("div",Oe,[y("div",Le,[i(p(ne),{title:"网站安全评分"},{default:x(function(){return[i(je,{class:"h-[22rem] w-full",high:p(s).risk_count.high,medium:p(s).risk_count.middle,low:p(s).risk_count.low,subtext:p(a)&&p(s).scan_time?"评分":"正在扫描...",score:p(a)&&p(s).scan_time?p(s).score:"..."},null,8,["high","medium","low","subtext","score"])]}),_:1})]),y("div",Ae,[i(p(ne),{title:"IP (TOP 5排行)",class:"h-[29.5rem]"},{default:x(function(){return[i(p(f))]}),_:1})])]),y("div",Pe,[(v(!0),m(g,null,h(p(u),function(e){return v(),m("div",{key:e.id,class:"module-ui relative col-span-1"},[y("div",{class:w(["absolute top-[.8rem] right-[1.2rem] card-icon",e.iconClass])},null,2),y("div",Ee,_(e.title),1),y("div",Te,[k(y("div",Me,[N(_(e.value),1),y("span",ze,_(e.unit),1)],512),[[O,p(s).scan_time]]),k(y("div",He,"正在扫描...",512),[[O,!p(s).scan_time]])]),y("div",Ie,_(e.description),1)])}),128))]),i(p(ne),{title:"安全项目",class:"mt-[1rem]"},{default:x(function(){return[i(Se)]}),_:1})])):b("",!0)}}}),Ne=$(Fe,[["__scopeId","data-v-bada991c"]]),Re={class:"w-full h-[50px] flex flex-col justify-center items-center"},De={class:"description-header w-full flex"},Ge={class:"header-left"},qe={class:"header-left"},Be={class:"header-left-scan-title"},Ve={class:"header-scan-desc"},We={class:"text-base text-secondary"},Qe={class:"header-right ml-[5rem]"},Ue={key:0},Je={class:"flex items-center justify-evenly py-[2rem]"},Xe={class:"flex flex-col"},Ke={class:"feature-title"},$e={class:"feature-desc"},Ye=$(l({__name:"index",setup:function(e){var n=le(),l=n.scanEvent,r=o(n),s=r.scanStatus,c=r.scanResult,u=[{id:1,iconClass:"feature-icon-1",title:"免费且强大的全能网站入侵扫描",desc:"免费全能扫描，全面拦截网站入侵风险"},{id:2,iconClass:"feature-icon-2",title:"深度检测是否存在危险木马",desc:"深度木马检测，精准排查隐藏威胁程序"},{id:3,iconClass:"feature-icon-3",title:"专业分析网站访问日志",desc:"通过日志分析，挖掘访问异常与安全隐患"}];return function(e,n){var r=G,o=q,d=E;return v(),m("section",{class:w(["module-ui",{"!p-[1.6rem]":p(s)}])},[y("div",Re,[y("div",De,[k(y("div",Ge,a(n[0]||(n[0]=[y("div",{class:"header-left-title"},[y("span",null,"智能网站安全")],-1),y("div",{class:"header-left-description"},[y("span",null,"基于强大引擎打造的免费网站安全，一键即可检查网站风险信号，宝塔自动给出优化和修复建议，用户仅需简单操作即可加固网站。")],-1)])),512),[[O,!p(s)]]),k(y("div",qe,[y("div",Be,[y("span",null,_(p(c).scan_time?"上次扫描时间：":"正在扫描"),1),y("div",Ve,[y("span",We,_(p(c).scan_time?"".concat(p(c).scan_time):p(c).msg),1)])])],512),[[O,p(s)]]),y("div",Qe,[i(r,{type:p(s)&&!p(c).scan_time?"warning":"primary",plain:p(s)&&!p(c).scan_time,size:"large",style:{padding:"0.8rem 3.6rem !important"},onClick:p(l)},{default:x(function(){return[N(_(p(s)&&!p(c).scan_time?"取消扫描":"立即扫描"),1)]}),_:1},8,["type","plain","onClick"])])]),k(i(o,{percentage:p(c).progress||0,color:"#20a53a","show-text":!1,"stroke-width":6,class:"w-full mt-[1.2rem]"},null,8,["percentage"]),[[O,p(s)&&!p(c).scan_time]])]),i(P,L({css:!1},A(p(t))),{default:x(function(){return[p(s)?b("",!0):(v(),m("div",Ue,[n[1]||(n[1]=y("div",{class:"w-full h-[1rem]"},null,-1)),i(d),y("div",Je,[(v(),m(g,null,h(u,function(e){return y("div",{key:e.id,class:"flex items-start gap-[1.5rem]"},[y("div",{class:w(["feature-icon",e.iconClass])},null,2),y("div",Xe,[y("div",Ke,_(e.title),1),y("div",$e,_(e.desc),1)])])}),64))]),i(d),n[2]||(n[2]=y("div",{class:"overview"},[y("div",{class:"flex items-center justify-center"},[y("span",{class:"overview-icon"}),y("div",{class:"text-extraLarge font-bold ml-[1rem] text-default"},"功能概览")]),y("div",{class:"flex items-center justify-center mt-[2.4rem]"},[y("img",{class:"w-[90rem] h-[120rem]",src:"https://www.bt.cn/Public/new/plugin/site_safe/siteSafe.png",alt:"介绍图片"})])],-1))]))]}),_:1},16)],2)}}}),[["__scopeId","data-v-20e8ef87"]]),Ze={class:"module-ui site-safe-skeleton__control"},et={class:"site-safe-skeleton__header"},tt={class:"flex flex-col gap-[0.8rem] flex-1"},nt={class:"site-safe-skeleton__scan"},lt={class:"grid grid-cols-3 gap-4"},at={class:"module-ui site-safe-skeleton__card"},it={class:"module-ui site-safe-skeleton__card col-span-2"},rt={class:"site-safe-skeleton__table"},st={class:"grid grid-cols-5 gap-4 mt-[1rem]"},ot={class:"module-ui site-safe-skeleton__card mt-[1rem]"},ct={class:"site-safe-skeleton__list"},ut=l({__name:"index",setup:function(e){var l,a=le(),r=a.getLastSiteSafeScanResult,s=a.stopScan,c=(l=le(),n({refs:o(l)},l)).refs.loading;return r(),B(function(){s(),c.value=!0}),function(e,n){var l=V,a=W;return v(),m("div",{class:w(["max-w-[137rem]",{"h-[calc(100vh-200px)]":p(c),"overflow-hidden":p(c)}])},[p(c)?(v(),j(a,{key:0,animated:"",class:"site-safe-skeleton"},{template:x(function(){return[y("section",Ze,[y("div",et,[y("div",tt,[i(l,{variant:"text",class:"site-safe-skeleton__title"}),i(l,{variant:"text",class:"site-safe-skeleton__subtitle"})]),i(l,{variant:"button",class:"site-safe-skeleton__action"})])]),y("div",nt,[y("div",lt,[y("div",at,[i(l,{variant:"text",class:"site-safe-skeleton__card-title"}),i(l,{variant:"rect",class:"site-safe-skeleton__chart"})]),y("div",it,[i(l,{variant:"text",class:"site-safe-skeleton__card-title"}),y("div",rt,[(v(),m(g,null,h(4,function(e){return i(l,{key:"table-".concat(e),variant:"text",class:"site-safe-skeleton__table-row"})}),64))])])]),y("div",st,[(v(),m(g,null,h(5,function(e){return y("div",{key:"stat-".concat(e),class:"module-ui site-safe-skeleton__stats-card"},[i(l,{variant:"text",class:"site-safe-skeleton__stats-title"}),i(l,{variant:"text",class:"site-safe-skeleton__stats-value"}),i(l,{variant:"text",class:"site-safe-skeleton__stats-desc"})])}),64))]),y("div",ot,[i(l,{variant:"text",class:"site-safe-skeleton__card-title"}),y("div",ct,[(v(),m(g,null,h(6,function(e){return i(l,{key:"list-".concat(e),variant:"text",class:"site-safe-skeleton__list-row"})}),64))])])])]}),_:1})):(v(),m(g,{key:1},[i(Ye),i(P,L({css:!1},A(p(t))),{default:x(function(){return[i(Ne)]}),_:1},16)],64))],2)}}});e("default",$(ut,[["__scopeId","data-v-8a31db53"]]))}}})}();
