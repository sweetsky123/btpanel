import{bH as e,aS as t,r as l,bI as a,b as n,bJ as s,B as o,d as r,q as i,b4 as u,x as d,bK as c,e as p}from"./utils-lib.js?v=1763689792";import{c as m,r as b,aJ as v,w as f,g as h,e as y,D as g,m as w,V as k,ar as x,as as C,at as _,aE as V,i as H}from"./base-lib.js?v=1763689792";import{_ as j}from"./index110.js?v=1763689792";const S=n(),q=(a,n="path")=>{e(),t("Path",a[n]),l.push({path:"/files"})},B=m({props:{onClickPwd:{type:Function,required:!0},modelValue:{type:String,default:""}},setup(e){const t=s("copy",16),l=b(!1),a=b(!0);v(()=>{a.value=!!e.modelValue}),f(()=>e.modelValue,()=>{l.value=!1});const n=h(()=>l.value?"svgtofont-icon-eye-close":"svgtofont-icon-browse"),r=()=>e.onClickPwd();return()=>y("div",null,[a.value?y("div",{class:"flex items-center"},[l.value?y("span",{class:"block truncate max-w-[140px]"},[e.modelValue]):y("span",null,[g("**********")]),y("i",{class:"mx-4 cursor-pointer text-default text-medium ".concat(n.value),title:"显示密码",onClick:()=>l.value=!l.value},null),y("i",{id:t,"data-clipboard-text":e.modelValue,class:"svgtofont-el-document-copy cursor-pointer text-default text-medium copy svgtofont-icon-copy",title:"复制密码",onClick:()=>{return t=e.modelValue,void o({value:t});var t}},null)]):y("div",null,[y("span",{class:"text-tertiary"},[g("无法获取密码，请点击"),y("span",{class:"text-danger cursor-pointer",onClick:r},[g("改密")]),g("重置密码!")])])])}}),O=m({name:"BtTableStatus",props:{data:{type:Array,default:()=>["未启动","运行中"]},isIcon:{type:Boolean,default:!0},modelValue:{type:[Boolean,Number],default:!0}},setup:(e,{attrs:t})=>()=>y("span",w({class:"bt-".concat(e.modelValue?"link":"danger")},t),[y("span",{class:"flex items-center"},[y("span",null,[e.data[Number(e.modelValue)]]),e.isIcon&&y("i",{class:"ml-[2px] text-small svgtofont-icon-".concat(e.modelValue?"start":"stop")},null)])])});function P(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!H(e)}const z=(e={type:"page",key:"id",isHide:!1,disableds:()=>{}})=>({type:"CheckBox",width:"all"===e.type?42:36,isHide:e.isHide,renderHeader:(t,l)=>{const a=[{label:"全选当前页",command:"page-select"},{label:"全选所有项",command:"all-select"},{label:"清空选中项",command:"clear-select"}],{checkAllCheckbox:n,checkAllIndeterminate:s,handleAllChange:o,handleCommandChange:i}=l;return y("div",{class:"flex items-center justify-center"},[y(k,{modelValue:n.value,"onUpdate:modelValue":e=>n.value=e,indeterminate:s.value,onChange:t=>o(t,!1,e.key),class:"!mr-[4px]"},null),"all"===(null==e?void 0:e.type)?y(x,{onCommand:i},{default:()=>y(r,{icon:"el-arrow-down"},null),dropdown:()=>{let e;return y(C,null,P(e=a.map(e=>y(_,e,{default:()=>[e.label]})))?e:{default:()=>[e]})}}):null])},render:(t,l,{handleScopeChange:a})=>{var n;const s=(null==(n=e.disabled)?void 0:n.call(e,t))||!1;return s&&(t.disable_check=!0),y(k,{modelValue:t.keys_scopes_status,"onUpdate:modelValue":e=>t.keys_scopes_status=e,disabled:s,onChange:n=>a(n,t,l,e.key||"")},null)}}),I=(e={prop:"path"})=>({label:e.label||"根目录",prop:e.prop,minWidth:e.width||200,isCustom:!0,render:t=>y("span",{class:"flex !justify-start inline-block bt-link leading-[16px]",onClick:()=>q(t,e.prop),title:"点击打开目录"},[t[e.prop]])}),W=(e,t)=>({width:22,type:"toping",label:e.label||"",subtitle:"置顶",className:"cols-toping",render:l=>{t||(t="sort");const a=e.param||t||"",n=Boolean(l[a])&&"0"!==l[a];return y("div",{onClick:()=>e.event(l,n?"untop":"top")},[y("i",{style:"color:".concat(n?"#EFB958":"#C7BDA9"),class:"svgtofont-icon-top cursor-pointer text-medium ".concat(n?"":"table-no-top opacity-80")},null)])}}),N=e=>({label:"备注",prop:"ps",isCustom:!0,showOverflowTooltip:!1,width:e.width||120,minWidth:e.minWidth||120,render:t=>{var l;const n={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"',"#x27":"'",apos:"'"},s=e.prop?e.prop:"ps";let o=(null==(l=t[s])?void 0:l.replace(/&(lt|gt|nbsp|amp|quot|#x27);/gi,function(e,t){return n[t]}))||"";return y("input",{type:"text",value:o,class:"bt-table-input w-full",placeholder:"点击编辑备注",onBlur:l=>{const n=l.target;o!==(null==n?void 0:n.value)&&(o=n.value,e.request?e.request(t,o):(async({id:e,ps:t},l)=>{const n=S.load("正在修改备注信息，请稍后...");try{const n=await a({id:e,table:l,ps:t});S.request(n)}catch(s){}finally{n.close()}})({id:t.id,ps:o},e.table))},onKeyup:e=>{if("Enter"===e.key){const t=e.target;null==t||t.blur()}}},null)}}),A=e=>(i(e.prop)&&(e.prop="status"),i(e.data)&&(e.data=["未启动","运行中"]),{label:"状态",prop:e.prop,width:e.width||80,minWidth:e.sortable?80:70,isCustom:!0,sortable:e.sortable||!1,render:t=>{let l=!!Number(t[e.prop]);return e.function?e.function(t):(["running","start"].includes(t[e.prop])&&(l=!0),["exited","stop","created"].indexOf(t[e.prop])>-1&&(l=!1),y(O,{modelValue:l,data:e.data,onClick:()=>e.event(t)},null))}}),M=(e={prop:"password"})=>({label:"密码",prop:e.prop||"password",minWidth:130,width:e.width,isCustom:!0,render:t=>y(B,{modelValue:t[e.prop||"password"],onClickPwd:()=>e.event&&e.event(t)},null)}),E=e=>({label:"容量",isLtd:!0,minWidth:80,width:e.width||"auto",isCustom:!(null==e?void 0:e.hasOwnProperty("isCustom"))||e.isCustom,render:t=>{var l;if("PHPMOD"===(null==(l=null==t?void 0:t.project_config)?void 0:l.type))return"--";let a=!1;const{quota:n}=t,s=!(null==n?void 0:n.size);if(s)return y("span",{class:"bt-link",onClick:()=>{e.event(t,s)}},["未配置"]);const o=1024*n.size*1024,r=Number((n.used/o*100).toFixed(2))||0,i=n.used/1024/1024>0?(n.used/1024/1024).toFixed(2):"0.00";return n.size>0&&n.used>=o&&(a=!0),a?y("span",{class:"bt-link !text-danger",onClick:()=>{e.event(t,s)}},["容量已满"]):y("span",{class:r>80?"el-link--danger bt-link":"el-link--primary bt-link",onClick:()=>{e.event(t,s)}},[i,g(" / "),n.size,g(" MB")])}}),F=e=>({label:"备份",prop:e.prop,minWidth:180,isCustom:!0,render:t=>y("div",{class:"flex items-center"},[y("span",{class:t.backup_count>0?"text-primary cursor-pointer":"text-warning cursor-pointer",onClick:()=>e.event?e.event(t,"back"):null},[t.backup_count>0?"有备份(".concat(t.backup_count,")"):"点击备份"]),y("span",{class:"mx-[4px]"},[g("|")]),y("span",{class:"bt-link",onClick:()=>e.event?e.event(t,"import"):null},[g("导入")])])}),T=e=>({isCustom:!0,...e,render:t=>y("span",{class:"bt-link",onClick:()=>e.event?e.event(t):null,title:e.title},[e.text])}),U=(e,t)=>{let l=0;return u(e)||(l=e.reduce((e,t)=>e+(t.width||40),0)+20),{label:(null==t?void 0:t.label)||"操作",align:"right",fixed:t&&"boolean"==typeof t.fixed?t.fixed:"right",width:(null==t?void 0:t.width)||l,render:(t,l)=>{const a=[];let n=e;return u(e)&&(n=e(t)),n.forEach((e,s)=>{if(e.render)return a.push(e.render(t,l));if(e.isHide&&e.isHide(t))return!1;if(e.isMore){const l=e.menu.filter(e=>"function"==typeof e.isHide?!e.isHide(t):!e.isHide);return a.push(y(x,{class:"h-[1.6rem]",onCommand:l=>e.onClick(l,t)},{default:()=>y("span",{class:"text-primary flex items-center"},[g("更多"),y("span",{class:"svgtofont-el-arrow-down"},null)]),dropdown:()=>y(C,null,{default:()=>l.map(e=>y(_,{command:e.key},{default:()=>[e.title]}))})})),!1}const o="function"==typeof e.isHide&&e.isHide(t);a.push(y("span",{onClick:a=>e.onClick(t,l,a),title:e.title,class:o?"hidden":"bt-link"},[e.title])),n.length-1!==s&&a.push(y(j,null,null))}),V("div",a)}}},D=e=>({label:"大小",prop:e.prop,width:e.width||80,render:t=>d(Number(t[e.prop||"size"]),!0)}),K=()=>({label:"操作结果",prop:"batchStatus",width:124,showOverflowTooltip:!0,render:e=>{const t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#x27;":"'"},l=(()=>{switch(e.batchStatus){case 0:return"等待执行";case 1:return"执行成功";case 2:return(null==e?void 0:e.message)||(null==e?void 0:e.msg)||"执行失败"}return"-"})().replace(/&amp;|&lt;|&gt;|&quot;|&#39;|&#x27;/g,e=>t[e]);return y("div",{innerHTML:l,class:"inline-clock truncate !w-[10rem] ".concat(e.batchStatus?1===e.batchStatus?"text-primary":"text-danger":"text-warning")},null)}}),J=e=>({label:e.label||"状态",prop:e.prop||"status",width:80,render:t=>{const l=e.prop||"status";return y(c,{modelValue:t[l],"onUpdate:modelValue":e=>t[l]=e,onChange:l=>e.event(l,t),size:e.size||"small"},null)}}),L=e=>{const{storageKey:t,defaultMetric:l="one_day_total_flow",onClick:a,width:n=80,metricOptions:s=[{label:"日流量",value:"one_day_total_flow"},{label:"日IP",value:"one_day_total_ip"},{label:"日PV",value:"one_day_total_pv"},{label:"日请求",value:"one_day_total_request"},{label:"日UV",value:"one_day_total_uv"}]}=e,o=b(localStorage.getItem(t)||l);return{label:"日统计",align:"center",renderHeader:()=>y("div",{class:"flex items-center"},[y(x,{trigger:"hover",onCommand:e=>{return l=e,o.value=l,void localStorage.setItem(t,l);var l}},{default:()=>{var e;return y("div",{class:"!w-[5.4rem] not-select flex items-center justify-between cursor-pointer"},[y("span",null,[(null==(e=s.find(e=>e.value===o.value))?void 0:e.label)||"选择"]),y("span",{class:"ml-1"},[g("▾")])])},dropdown:()=>{let e;return y(C,null,P(e=s.map(e=>y(_,{command:e.value,key:e.value,disabled:e.value===o.value},{default:()=>[e.label]})))?e:{default:()=>[e]})}})]),width:n,isCustom:!0,render:e=>{const t=(e=>{const t=o.value,l=(null==e?void 0:e.net)||{};if(!Object.prototype.hasOwnProperty.call(l,t))return"--";const a=l[t]||0;return"one_day_total_flow"===t?d(a||0,!0,2):String(a||0)})(e);return a?y(p,{onClick:()=>a("site",e.name)},P(t)?t:{default:()=>[t]}):y("span",null,[t])}}};export{O as B,z as a,A as b,K as c,I as d,W as e,F as f,N as g,D as h,M as i,T as j,E as k,L as l,J as m,q as o,U as u};
