import{Q as e,$ as a,b as l}from"./utils-lib.js?v=1763689792";import{c as s,r as t,o,v as r,x as i,y as n,e as u,C as m,z as p,F as c,b1 as d,O as f,am as v,an as j,ad as _,ab as b}from"./base-lib.js?v=1763689792";import{h as P,i as h,o as y}from"./validator.js?v=1763689792";import{batchPhpVersion as V,getPhpVersion as g}from"./site.js?v=1763689792";import{u as x}from"./useStore4.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";const H={class:"p-2rem"},w=s({__name:"index",props:{compData:{default:()=>{}}},setup(s,{expose:w}){const D=l(),C=s,{isRefreshList:O,batchConfig:k}=x(),q=t(),M=o({selectValue:""}),R=o({selectValue:[{required:!0,message:"请选择PHP版本",trigger:"change"}]}),z=t([]);return w({onConfirm:async e=>{let a;try{await q.value.validate(),a=D.load("正在调整php版本，请稍后...");let l=[];const s=C.compData.filter(e=>{var a;return"PHPMOD"!==(null==(a=null==e?void 0:e.project_config)?void 0:a.type)});C.compData.forEach(e=>{var a;"PHPMOD"===(null==(a=null==e?void 0:e.project_config)?void 0:a.type)&&l.push({name:e.name,msg:"异步项目不支持",status:!1})});const{enable:t,exclude:o}=k.value,r=P(s,o,t,{params:{project_type:"PHP",version:M.selectValue}}),i=await V(r),{data:n}=h(i.data);y(n,{title:"设置php版本"}),e(),O.value=!0}catch(l){}finally{null==a||a.close()}}}),r(()=>{(async()=>{var a;await e({request:g(),data:[Array,z]}),M.selectValue=(null==(a=z.value[0])?void 0:a.version)||""})()}),(e,l)=>{const s=v,t=j,o=_,r=b,P=a;return i(),n("div",H,[u(r,{ref_key:"formRef",ref:q,model:p(M),"label-width":"80px",rules:p(R)},{default:m(()=>[u(o,{label:"PHP版本",prop:"selectValue"},{default:m(()=>[u(t,{modelValue:p(M).selectValue,"onUpdate:modelValue":l[0]||(l[0]=e=>p(M).selectValue=e),placeholder:"请选择PHP版本",class:"!w-24rem"},{default:m(()=>[(i(!0),n(c,null,d(p(z),e=>(i(),f(s,{key:e.version,label:e.name,value:e.version},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),u(P,{options:[{content:"请根据您的程序需求选择版本"}],class:"pl-4rem"})])}}});export{w as default};
