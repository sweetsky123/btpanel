!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function r(e){for(var r=1;r<arguments.length;r++){var u=null!=arguments[r]?arguments[r]:{};r%2?t(Object(u),!0).forEach(function(t){n(e,t,u[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(u)):t(Object(u)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(u,t))})}return e}function n(t,r,n){return(r=function(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var u=n.call(t,r||"default");if("object"!=e(u))return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function u(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",l=r.toStringTag||"@@toStringTag";function o(r,n,u,l){var o=n&&n.prototype instanceof c?n:c,s=Object.create(o.prototype);return a(s,"_invoke",function(r,n,u){var a,l,o,c=0,s=u||[],f=!1,m={p:0,n:0,v:e,a:v,f:v.bind(e,4),d:function(t,r){return a=t,l=0,o=e,m.n=r,i}};function v(r,n){for(l=r,o=n,t=0;!f&&c&&!u&&t<s.length;t++){var u,a=s[t],v=m.p,d=a[2];r>3?(u=d===n)&&(o=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=v&&((u=r<2&&v<a[1])?(l=0,m.v=n,m.n=a[1]):v<d&&(u=r<3||a[0]>n||n>d)&&(a[4]=r,a[5]=n,m.n=d,l=0))}if(u||r>1)return i;throw f=!0,n}return function(u,s,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===s&&v(s,d),l=s,o=d;(t=l<2?e:o)||!f;){a||(l?l<3?(l>1&&(m.n=-1),v(l,o)):m.n=o:m.v=o);try{if(c=2,a){if(l||(u="next"),t=a[u]){if(!(t=t.call(a,o)))throw TypeError("iterator result is not an object");if(!t.done)return t;o=t.value,l<2&&(l=0)}else 1===l&&(t=a.return)&&t.call(a),l<2&&(o=TypeError("The iterator does not provide a '"+u+"' method"),l=1);a=e}else if((t=(f=m.n<0)?o:r.call(n,m))!==i)break}catch(t){a=e,l=1,o=t}finally{c=1}}return{value:t,done:f}}}(r,u,l),!0),s}var i={};function c(){}function s(){}function f(){}t=Object.getPrototypeOf;var m=[][n]?t(t([][n]())):(a(t={},n,function(){return this}),t),v=f.prototype=c.prototype=Object.create(m);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,a(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e}return s.prototype=f,a(v,"constructor",f),a(f,"constructor",s),s.displayName="GeneratorFunction",a(f,l,"GeneratorFunction"),a(v),a(v,l,"Generator"),a(v,n,function(){return this}),a(v,"toString",function(){return"[object Generator]"}),(u=function(){return{w:o,m:d}})()}function a(e,t,r,n){var u=Object.defineProperty;try{u({},"",{})}catch(e){u=0}a=function(e,t,r,n){function l(t,r){a(e,t,function(e){return this._invoke(t,r,e)})}t?u?u(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(l("next",0),l("throw",1),l("return",2))},a(e,t,r,n)}function l(e,t,r,n,u,a,l){try{var o=e[a](l),i=o.value}catch(e){return void r(e)}o.done?t(i):Promise.resolve(i).then(n,u)}function o(e){return function(){var t=this,r=arguments;return new Promise(function(n,u){var a=e.apply(t,r);function o(e){l(a,n,u,o,i,"next",e)}function i(e){l(a,n,u,o,i,"throw",e)}o(void 0)})}}function i(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,u,a,l,o=[],i=!0,c=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;i=!1}else for(;!(i=(n=a.call(r)).done)&&(o.push(n.value),o.length!==t);i=!0);}catch(e){c=!0,u=e}finally{try{if(!i&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw u}}return o}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return f(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}System.register(["./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./form-item-legacy.js?v=1763689792","./database-legacy.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792"],function(e,t){"use strict";var n,a,l,s,f,m,v,d,p,b,y,h,_,g,w,k,j,O,P,S,D;return{setters:[function(e){n=e.L,a=e.V,l=e.Q,s=e._},function(e){f=e.c,m=e.aB,v=e.g,d=e.e,p=e.D,b=e.ba,y=e.c3,h=e.v,_=e.x,g=e.y,w=e.z,k=e.A},function(e){j=e.d,O=e.j,P=e.b,S=e.h},function(e){D=e.addIncrementTask},null,null],execute:function(){var t={class:"my-[1.6rem]"},N=f({__name:"add-increment",props:{compData:{default:function(){}}},setup:function(e,s){var f,N=s.expose,T=e,B=[{label:"每天",value:"daily"},{label:"每周",value:"weekly"},{label:"相隔N天",value:"interval"},{label:"相隔N小时",value:"hours"}],x=[{label:"周一",value:"1"},{label:"周二",value:"2"},{label:"周三",value:"3"},{label:"周四",value:"4"},{label:"周五",value:"5"},{label:"周六",value:"6"},{label:"周日",value:"0"}],A=[{label:"小时",value:"hour"},{label:"分钟",value:"minute"}],E=m("popupClose",function(){}),H=function(e,t,r){!/^\d+$/.test(String(e))||Number(e)<=0?t(new Error(r)):t()},I=n({data:function(){var e,t,r,n,u,a,l,o;return{schedule_time:(null===(e=T.compData)||void 0===e||null===(e=e.backupPlan)||void 0===e||null===(e=e.full_backup_schedule)||void 0===e?void 0:e.type)||"daily",weekday:(null===(t=T.compData)||void 0===t||null===(t=t.backupPlan)||void 0===t||null===(t=t.full_backup_schedule)||void 0===t?void 0:t.weekday)||"1",interval_days:(null===(r=T.compData)||void 0===r||null===(r=r.backupPlan)||void 0===r||null===(r=r.full_backup_schedule)||void 0===r?void 0:r.interval_days)||"1",interval_hours:(null===(n=T.compData)||void 0===n||null===(n=n.backupPlan)||void 0===n||null===(n=n.full_backup_schedule)||void 0===n?void 0:n.interval_hours)||"24",allBackupTime:(o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"08:00:00",t=new Date;if(!e)return t;var r=c(e.split(":").map(Number),3),n=r[0],u=r[1],a=r[2];return t.setHours(isNaN(n)?0:n,isNaN(u)?0:u,isNaN(a)?0:a,0),t}(null===(l=T.compData)||void 0===l||null===(l=l.backupPlan)||void 0===l||null===(l=l.full_backup_schedule)||void 0===l?void 0:l.time),o),start_date:function(e,t){var r=null!==(e=T.compData)&&void 0!==e&&null!==(e=e.backupPlan)&&void 0!==e&&null!==(e=e.full_backup_schedule)&&void 0!==e&&e.start_date?new Date(null===(t=T.compData)||void 0===t||null===(t=t.backupPlan)||void 0===t||null===(t=t.full_backup_schedule)||void 0===t?void 0:t.start_date):new Date;return r.setHours(8,0,0,0),r}(),incrementBackupNum:(null===(u=T.compData)||void 0===u||null===(u=u.backupPlan)||void 0===u?void 0:u.incremental_backup_interval)||"1",incrementBackupType:null!==(a=T.compData)&&void 0!==a&&null!==(a=a.backupPlan)&&void 0!==a&&a.incremental_backup_interval?"minute":"hour"}},options:function(e){return v(function(){return[j([O("全量备份","schedule_time",B,{attrs:{class:"!w-[10rem]"}})].concat(i("weekly"===e.value.schedule_time?[O("","weekday",x,{attrs:{class:"!w-[8rem] ml-[1rem]"}})]:[]),i("interval"===e.value.schedule_time?[P("","interval_days",{attrs:{class:"!w-[8rem] ml-[1rem]"},slots:{unit:function(){return d("span",null,[p("天")])}},rules:[{validator:function(e,t,r){return H(t,r,"请输入正确的整数")},trigger:"blur"}]}),S("开始日期",function(){return d(b,{class:"!w-[13rem]",modelValue:e.value.start_date,"onUpdate:modelValue":function(t){return e.value.start_date=t},format:"YYYY-MM-DD","value-format":"x"},null)},"start_date",{rules:[{required:!0,message:"请选择开始日期",trigger:["blur","change"]}]})]:[]),i("hours"===e.value.schedule_time?[P("","interval_hours",{attrs:{class:"!w-[12rem] ml-[1rem]"},slots:{unit:function(){return d("span",{class:"ml-[1rem] inline-block w-[4rem]"},[p("小时")])}},rules:[{validator:function(e,t,r){return H(t,r,"请输入正确的整数")},trigger:"blur"}]})]:[S("执行时间",function(){return d(y,{class:"!w-[13rem]",modelValue:e.value.allBackupTime,"onUpdate:modelValue":function(t){return e.value.allBackupTime=t},format:"HH:mm:ss"},null)},"allBackupTime",{rules:[{required:!0,message:"请选择执行时间",trigger:["blur","change"]}]})]))),j([S("增量备份",function(){return d("span",null,null)},"null"),P("每隔","incrementBackupNum",{attrs:{class:"!w-[8rem]"},labelAttrs:{labelWidth:"3.5rem"},rules:[{validator:function(e,t,r){return H(t,r,"请输入正确的整数")},trigger:"blur"}]}),O("","incrementBackupType",A,{attrs:{class:"!w-[8rem] ml-[1rem]"}})])]})},submit:(f=o(u().m(function e(t,r,n){return u().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r();case 1:V(t,E);case 2:return e.a(2)}},e)})),function(e,t,r){return f.apply(this,arguments)})}),G=I.BtForm,M=I.submit,V=function(){var e=o(u().m(function e(t,n){var o;return u().w(function(e){for(;;)switch(e.n){case 0:return o=r(r(r({id:T.compData.id,schedule_type:t.value.schedule_time,incremental_backup_interval:"hour"===t.value.incrementBackupType?60*Number(t.value.incrementBackupNum):Number(t.value.incrementBackupNum)},"hours"!==t.value.schedule_time?{schedule_time:a(t.value.allBackupTime,"HH:mm:ss")}:{interval_hours:t.value.interval_hours}),"weekly"===t.value.schedule_time?{weekday:t.value.weekday}:{}),"interval"===t.value.schedule_time?{interval_days:t.value.interval_days,start_date:a(t.value.start_date,"yyyy-MM-dd")}:{}),e.n=1,l({loading:"正在保存，请稍候...",request:D(o),message:!0});case 1:T.compData.refreshEvent(),n();case 2:return e.a(2)}},e)}));return function(t,r){return e.apply(this,arguments)}}(),F=function(){var e=o(u().m(function e(){return u().w(function(e){for(;;)if(0===e.n)return e.a(2)},e)}));return function(){return e.apply(this,arguments)}}();return h(function(){F()}),N({onConfirm:M}),function(e,r){return _(),g("div",t,[d(w(G),{labelWidth:"8rem"}),r[0]||(r[0]=k("ul",{class:"mt-8px leading-8 text-small list-disc ml-[4.5rem]"},[k("li",null,"配置保存后，如果备份任务处于启用状态，将按新配置执行。")],-1))])}}});e("default",s(N,[["__scopeId","data-v-5a6ea0df"]]))}}})}();
