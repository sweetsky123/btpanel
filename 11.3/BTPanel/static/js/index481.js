import{c as e,$ as a,o as s,r as l,v as t,x as n,y as r,e as o,C as c,z as u,D as m,A as i,ap as d,ad as p,ab as f}from"./base-lib.js?v=1763689792";import{_ as y}from"./validator.js?v=1763689792";import{u as _,Q as b,k as h,b as v,_ as j}from"./utils-lib.js?v=1763689792";import{b2 as x,b3 as V}from"./firewall.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";const w={class:"p-[2rem]"},k=j(e({__name:"index",emits:["close"],setup(e,{expose:j,emit:k}){const g=k,{payment:C}=_(),{authType:S}=C.value,U=a("alarmSelectRef"),q=v(),R=s({cycle:"0",channel:[],status:!1}),T=l(),z=l(!1),A=async(e=!1)=>{const{data:a}=await b({request:x()});R.cycle=a.cycle,R.channel=""===a.channel?[]:a.channel.split(","),R.status=!!a.status,e&&q.success("刷新成功")},D=()=>{var e;null==(e=U.value)||e.refresh(),A(!0)};return j({onConfirm:async()=>{if("ltd"!==S)return q.error("抱歉！该功能为企业版专享功能！");R.channel=R.channel.filter(e=>e);let e=R.channel.join(",");e||!R.status?(await T.value.validate(),b({loading:z,request:V({day:Number(R.cycle),channel:e,status:R.status?1:0}),message:!0,success:e=>{e.status&&(A(),g("close"))}})):q.error("请选择告警方式")}}),t(()=>{A()}),(e,a)=>{const s=d,l=p,t=h,_=y,b=f;return n(),r("div",w,[o(b,{model:u(R),ref_key:"safeScanForm",ref:T,disabled:u(z)},{default:c(()=>[o(l,{label:"自动扫描"},{default:c(()=>[o(s,{modelValue:u(R).status,"onUpdate:modelValue":a[0]||(a[0]=e=>u(R).status=e)},null,8,["modelValue"])]),_:1}),o(l,{label:"周期",prop:"cycle"},{default:c(()=>[o(t,{class:"!w-[14rem]",modelValue:u(R).cycle,"onUpdate:modelValue":a[1]||(a[1]=e=>u(R).cycle=e),min:0,type:"number",textType:"天"},{append:c(()=>[...a[3]||(a[3]=[m(" 天 ",-1)])]),_:1},8,["modelValue"])]),_:1}),o(l,{label:"告警方式",prop:"give"},{default:c(()=>[o(_,{ref_key:"alarmSelectRef",ref:U,class:"!w-[36rem]",modelValue:u(R).channel,"onUpdate:modelValue":a[2]||(a[2]=e=>u(R).channel=e),limit:["sms","wx_account"]},null,8,["modelValue"])]),_:1})]),_:1},8,["model","disabled"]),i("div",{class:"tip"},[i("ul",null,[i("li",null,[a[4]||(a[4]=m(" 点击配置后状态未更新，尝试点击【 ",-1)),i("span",{class:"text-primary hover:text-[#1d9534] cursor-pointer",onClick:D},"手动刷新"),a[5]||(a[5]=m(" 】 ",-1))])])])])}}}),[["__scopeId","data-v-03919c49"]]);export{k as default};
