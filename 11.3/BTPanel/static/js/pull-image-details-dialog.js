import{c as a,aB as e,r as l,g as t,v as s,x as n,y as c,A as i,B as m,z as u,e as o,C as r,L as p,D as d,c5 as _,H as g}from"./base-lib.js?v=1763689792";import{kj as v,kk as f,M as x,_ as y}from"./utils-lib.js?v=1763689792";import{p as b}from"./index29.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index109.js?v=1763689792";import"./useMethods.js?v=1763689792";import"./column.js?v=1763689792";import"./index110.js?v=1763689792";const j={class:"flex-wrap p-[2rem]"},V={class:""},w={class:"bg-light p-[2rem] rounded-base"},D={class:"text-medium"},h={class:"mt-[1rem] text-secondary"},k={class:"flex mt8px"},C=["title"],H={class:"max-w-[25rem]"},B={class:"text-base leading-[1.4] max-w-[25rem] truncate"},I={class:"text-small leading-[1.2] text-disabled mt-[1rem]"},L={class:"name"},M=y(a({__name:"pull-image-details-dialog",props:{compData:{default:()=>({name:""})}},setup(a){const y=a;e("popupClose",()=>{});const M=l({id:0,selectValue:"",detail:{name:"",last_updated:"",is_official:!1,pull_count:0}}),S=t(()=>{let a=M.value.detail.pull_count;return a?a.toLocaleString():""}),z=t(()=>"library"===M.value.detail.namespace?"是":"否"),A=l([]),P=a=>{M.value.selectValue=a.tag_name},U=(a,e)=>{(async()=>{await q();const l=A.value,t=M.value.selectValue,s=a===t?l.sort((a,e)=>a.tag_name===t&&e.tag_name!==t?-1:a.tag_name!==t&&e.tag_name===t?1:0):l.filter(e=>e.tag_name.includes(a));e(s)})()},q=async()=>{const{id:a}=M.value,{data:e}=await f({image:y.compData.name,id:a,search:M.value.selectValue}),l=e.data;A.value=l},E=async()=>{const a=M.value.selectValue;if(!a)return x.error("未获取到镜像ID,请选择一个镜像"),!1;await b({name:y.compData.name,tag:a},y.compData.refresh)};return s(async()=>{try{const{data:a}=await v({image:y.compData.name}),e=a.data;M.value.detail=e,M.value.id=e.id,await q()}catch(a){}}),(a,e)=>{const l=_,t=g;return n(),c("div",j,[i("div",V,[i("div",w,[i("strong",D,m(y.compData.name),1),i("ul",h,[i("li",null,[e[1]||(e[1]=i("span",null,"最近一次更新时间：",-1)),i("span",null,m(u(M).detail.last_updated),1)]),i("li",null,[e[2]||(e[2]=i("span",null,"是否为官方镜像：",-1)),i("span",null,m(u(z)),1)]),e[4]||(e[4]=i("li",null,[i("span",null,"来源："),i("span",null,"Docker Hub")],-1)),i("li",null,[e[3]||(e[3]=i("span",null,"Pulls量：",-1)),i("span",null,m(u(S)),1)])])])]),i("div",k,[o(l,{"popper-class":"my-autocomplete",modelValue:u(M).selectValue,"onUpdate:modelValue":e[0]||(e[0]=a=>u(M).selectValue=a),class:"!w-[40rem]","popper-append-to-body":!1,"fetch-suggestions":U,onSelect:P,placeholder:"请选择或搜索镜像"},{default:r(({item:a})=>{var e;return[i("div",{class:p(["flex items-center justify-between py-[1rem]",a.tag_name===u(M).selectValue?" text-primary hover:text-primaryDark":""]),title:"".concat(a.tag_name)},[i("div",H,[i("div",B,m("".concat(a.tag_name)),1),i("div",I,m("".concat((null==(e=a.digest)?void 0:e.slice(0,30))||"")),1)]),i("span",L,m(a.last_updated)+"更新",1)],10,C)]}),_:1},8,["modelValue"]),o(t,{type:"primary",class:"ml-8px",onClick:E},{default:r(()=>[...e[5]||(e[5]=[d("拉取",-1)])]),_:1})])])}}}),[["__scopeId","data-v-01af0ccf"]]);export{M as default};
