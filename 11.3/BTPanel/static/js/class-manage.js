import{_ as a}from"./index109.js?v=1763689792";import{Q as l,p as e,l as s,k as t,j as o,b as i}from"./utils-lib.js?v=1763689792";import{c as u,z as n,r,W as d,v as c,I as m,x as p,y as v,e as f,C as b,R as h,D as g,J as C,A as w,S as y,b2 as _,U as x,H as V,ad as j,ab as k}from"./base-lib.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";const P={class:"p-[20px]"},q={class:"p-[20px]"},U=u({__name:"class-manage",props:{compData:{default:()=>({ignore:[],getClassList:()=>Promise.resolve([]),addClass:()=>Promise.resolve({}),editClass:()=>Promise.resolve({}),deleteClass:()=>Promise.resolve({}),updateOptions:()=>Promise.resolve([]),field:"ps",showEdit:!0})}},setup(u){const U=u,{getClassList:D,addClass:O,editClass:S,deleteClass:E,ignore:H,field:L,updateOptions:z,showEdit:A}=n(U.compData),I=r(""),J=r(""),Q=r(!1),R=r(!1),T=d([]),W=d({label:"",value:0}),B=i(),F=[{label:"分类名称",prop:"label",showOverflowTooltip:!0},{label:"操作",align:"right",render:a=>"all"===a.value||(null==H?void 0:H.includes("".concat(a.value)))?"不可操作":f("div",{class:"flex items-center"},[A&&f("span",{class:"flex items-center"},[f("span",{class:"bt-link",onClick:()=>M(a)},[g("编辑")]),f(_,{direction:"vertical"},null)]),f("span",{class:"bt-link",onClick:()=>X(a)},[g("删除")])])}],G=async()=>{try{Q.value=!0;const a=await D();T.value=a||[],z(T.value)}catch(a){}finally{Q.value=!1}},K=async()=>{try{if(!I.value)return B.error("请输入分类名称");const a={[L]:I.value},e=await l({loading:"正在添加分类，请稍后...",request:O(a)});Y(e),I.value=""}catch(a){}},M=a=>{R.value=!0,W.value=a,J.value=a.label},N=async()=>{try{const a={[L]:J.value,id:W.value.value},e=await l({loading:"正在编辑分类，请稍后...",request:S(a)});e.status&&(R.value=!1),J.value="",Y(e)}catch(a){}},X=async a=>{try{await e({title:"提示",content:"确认删除该分类吗？该分类下的所有数据将会被移动至全部分类下，是否继续？"});const s=await l({loading:"正在删除分类，请稍后...",request:E({id:a.value})});Y(s)}catch(s){}},Y=a=>{a.status&&G(),B.request(a)};return c(()=>{G()}),(l,e)=>{const i=x,u=V,r=s,d=t,c=j,_=k,U=o,D=a,O=m("bt-loading");return p(),v("div",P,[f(D,null,{"header-left":b(()=>[f(i,{modelValue:n(I),"onUpdate:modelValue":e[0]||(e[0]=a=>h(I)?I.value=a:null),placeholder:"请输入分类名称",class:"!w-[41rem]"},null,8,["modelValue"]),f(u,{type:"primary",class:"ml-[1rem]",onClick:K},{default:b(()=>[...e[4]||(e[4]=[g(" 添加分类 ",-1)])]),_:1})]),content:b(()=>[C(f(r,{column:F,data:n(T),"max-height":"250"},null,8,["data"]),[[O,n(Q)]])]),popup:b(()=>[f(U,{modelValue:n(R),"onUpdate:modelValue":e[3]||(e[3]=a=>h(R)?R.value=a:null),area:40,title:"编辑分类","show-footer":"",onConfirm:N},{default:b(()=>[w("div",q,[f(_,{onSubmit:e[2]||(e[2]=y(()=>{},["prevent"]))},{default:b(()=>[f(c,{label:"分类名称",prop:"name"},{default:b(()=>[f(d,{modelValue:n(J),"onUpdate:modelValue":e[1]||(e[1]=a=>h(J)?J.value=a:null),autofocus:"",placeholder:"请输入分类名称",onSubmit:N,width:"22rem"},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1},8,["modelValue"])]),_:1}),e[5]||(e[5]=w("ul",{class:"mt-[8px] leading-8 text-small list-disc ml-[20px]"},[w("li",null,"【批量操作-设置分类】可修改当前分类，仅具备批量操作的列表")],-1))])}}});export{U as default};
