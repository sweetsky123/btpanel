import{_ as e}from"./index109.js?v=1763689792";import{u as a,ci as l,M as t,Q as s,p as r,k as n,l as i,$ as d,_ as o}from"./utils-lib.js?v=1763689792";import{c as m,W as u,r as p,b8 as c,aE as I,v as f,I as y,x as P,y as _,e as w,C as b,z as h,A as x,J as V,K as g,D as j,aD as U,aF as k,H as v}from"./base-lib.js?v=1763689792";import{aC as C,aD as H,aE as q,aF as L,aG as R,aH as A}from"./firewall.js?v=1763689792";import{u as D}from"./column.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";const E={class:"flex w-full p-[2rem]"},F={class:"w-[86%] flex-1"},z={class:"flex items-center"},G={class:"flex items-center"},J=o(m({__name:"index",setup(o){a();const m=u(!1),J=p([]),K=p([]),M=c({type:"url",url:"",startIP:"",endIP:"",urlHelp:[{content:"例子1: bt.cn/admin/admin.php?system=abc 添加地址: ^/admin/admin.php"},{content:"例子2: bt.cn/admin/1 1 为可变 1-99 添加地址为: ^/admin/[1-99]"}],ipHelp:[{content:"添加某个IP：起始IP为192.168.10.6 结束IP为192.168.10.6"},{content:"添加IP段：起始IP为192.168.1.1 结束IP为192.168.1.254"}]}),N=e=>{M.type=e.paneName,W()},Q=async()=>{switch(M.type){case"url":if(!M.url)return t.error("请输入URL地址");await s({loading:"正在添加，请稍后...",request:H({url_rule:M.url}),message:!0}),M.url="";break;case"ip":if(!l(M.startIP)||!l(M.endIP))return t.error("IP地址格式不正确");await s({loading:"正在添加，请稍后...",request:C({start_ip:M.startIP,end_ip:M.endIP}),message:!0}),M.startIP="",M.endIP=""}W()},T=async()=>{await r({title:"清空白名单",content:"是否清空白名单？",icon:"warning-filled"}),await s({loading:"正在清空，请稍后...",request:q({type:M.type+"_white"}),message:!0,success:e=>{e.status&&W()}})},W=async()=>{await s({loading:m,request:L(),data:{ip_white:[Array,J],url_white:[Array,K]}})},$=async(e,a)=>{const l="url"===M.type;l?a-=1:a=J.value.findIndex(a=>a.at(0)===e.at(0)&&a.at(1)===e.at(1)),await s({loading:"正在删除，请稍后...",request:l?R({index:a}):A({index:a}),message:!0,success:e=>{e.status&&W()}})},B=[{label:"起始IP",render:e=>I("span",e[0])},{label:"结束IP",render:e=>I("span",e[1])},D([{onClick:$,title:"删除"}])],O=[{label:"URL",render:e=>I("span",e)},D([{onClick:$,title:"删除"}])];return f(()=>W()),(a,l)=>{const t=U,s=k,r=n,o=v,u=i,p=d,c=e,I=y("bt-loading");return P(),_("div",E,[w(s,{"tab-position":"left",modelValue:h(M).type,"onUpdate:modelValue":l[0]||(l[0]=e=>h(M).type=e),onTabClick:N,class:"w-[8%] mr-[2.4rem]"},{default:b(()=>[w(t,{label:"URL白名单",name:"url"}),w(t,{label:"IP白名单",name:"ip"})]),_:1},8,["modelValue"]),x("div",F,[w(c,{class:"flex-1"},{"header-left":b(()=>[V(x("div",z,[w(r,{modelValue:h(M).url,"onUpdate:modelValue":l[1]||(l[1]=e=>h(M).url=e),width:"30rem",placeholder:"URL地址，例如：/admin/update"},null,8,["modelValue"])],512),[[g,"url"===h(M).type]]),V(x("div",G,[w(r,{modelValue:h(M).startIP,"onUpdate:modelValue":l[2]||(l[2]=e=>h(M).startIP=e),width:"25rem",placeholder:"起始IP地址"},null,8,["modelValue"]),w(r,{modelValue:h(M).endIP,"onUpdate:modelValue":l[3]||(l[3]=e=>h(M).endIP=e),class:"ml-[0.8rem]",width:"25rem",placeholder:"结束IP地址"},null,8,["modelValue"])],512),[[g,"ip"===h(M).type]]),w(o,{type:"primary",title:"添加",onClick:Q,class:"ml-[0.8rem]"},{default:b(()=>[...l[4]||(l[4]=[j(" 添加 ",-1)])]),_:1}),w(o,{onClick:T},{default:b(()=>[...l[5]||(l[5]=[j("清空",-1)])]),_:1})]),content:b(()=>[V(w(u,{column:"url"===h(M).type?O:B,data:"url"===h(M).type?h(K):h(J)},null,8,["column","data"]),[[I,h(m)],[I,"正在加载列表，请稍后...","title"]])]),"footer-left":b(()=>[w(p,{"list-style":"disc",options:"ip"===h(M).type?h(M).ipHelp:h(M).urlHelp,class:"mt-[2rem] ml-[2rem]"},null,8,["options"])]),_:1})])])}}}),[["__scopeId","data-v-dba09103"]]);export{J as default};
