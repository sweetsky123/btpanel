!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,o,s="function"==typeof Symbol?Symbol:{},n=s.iterator||"@@iterator",a=s.toStringTag||"@@toStringTag";function c(e,s,n,a){var c=s&&s.prototype instanceof l?s:l,u=Object.create(c.prototype);return r(u,"_invoke",function(e,r,s){var n,a,c,l=0,u=s||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,r){return n=e,a=0,c=t,p.n=r,i}};function d(e,r){for(a=e,c=r,o=0;!f&&l&&!s&&o<u.length;o++){var s,n=u[o],d=p.p,y=n[2];e>3?(s=y===r)&&(c=n[(a=n[4])?5:(a=3,3)],n[4]=n[5]=t):n[0]<=d&&((s=e<2&&d<n[1])?(a=0,p.v=r,p.n=n[1]):d<y&&(s=e<3||n[0]>r||r>y)&&(n[4]=e,n[5]=r,p.n=y,a=0))}if(s||e>1)return i;throw f=!0,r}return function(s,u,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===u&&d(u,y),a=u,c=y;(o=a<2?t:c)||!f;){n||(a?a<3?(a>1&&(p.n=-1),d(a,c)):p.n=c:p.v=c);try{if(l=2,n){if(a||(s="next"),o=n[s]){if(!(o=o.call(n,c)))throw TypeError("iterator result is not an object");if(!o.done)return o;c=o.value,a<2&&(a=0)}else 1===a&&(o=n.return)&&o.call(n),a<2&&(c=TypeError("The iterator does not provide a '"+s+"' method"),a=1);n=t}else if((o=(f=p.n<0)?c:e.call(r,p))!==i)break}catch(o){n=t,a=1,c=o}finally{l=1}}return{value:o,done:f}}}(e,n,a),!0),u}var i={};function l(){}function u(){}function f(){}o=Object.getPrototypeOf;var p=[][n]?o(o([][n]())):(r(o={},n,function(){return this}),o),d=f.prototype=l.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,r(t,a,"GeneratorFunction")),t.prototype=Object.create(d),t}return u.prototype=f,r(d,"constructor",f),r(f,"constructor",u),u.displayName="GeneratorFunction",r(f,a,"GeneratorFunction"),r(d),r(d,a,"Generator"),r(d,n,function(){return this}),r(d,"toString",function(){return"[object Generator]"}),(e=function(){return{w:c,m:y}})()}function r(t,e,o,s){var n=Object.defineProperty;try{n({},"",{})}catch(t){n=0}r=function(t,e,o,s){function a(e,o){r(t,e,function(t){return this._invoke(e,o,t)})}e?n?n(t,e,{value:o,enumerable:!s,configurable:!s,writable:!s}):t[e]=o:(a("next",0),a("throw",1),a("return",2))},r(t,e,o,s)}function o(t,e,r,o,s,n,a){try{var c=t[n](a),i=c.value}catch(t){return void r(t)}c.done?e(i):Promise.resolve(i).then(o,s)}function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,o)}return r}function n(e,r,o){return(r=function(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var s=o.call(e,r||"default");if("object"!=t(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}System.register(["./base-lib-legacy.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./firewall-legacy.js?v=1763689792","./index-legacy344.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./validator-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./column-legacy.js?v=1763689792","./index-legacy107.js?v=1763689792"],function(t,r){"use strict";var a,c,i,l,u,f,p,d,y,v,g,m,b,h,_,w,k,S,j,O,x,E,T,P,C,D,G,A,F,H,I,J;return{setters:[function(t){a=t.c,c=t.t,i=t.r,l=t.o,u=t.g,f=t.v,p=t.I,d=t.J,y=t.z,v=t.x,g=t.y,m=t.A,b=t.L,h=t.O,_=t.F,w=t.e,k=t.D,S=t.B,j=t.G,O=t.C,x=t.b1,E=t.b6,T=t.H},function(t){P=t.u,C=t.fJ,D=t.V,G=t.aK,A=t.f,F=t.ay,H=t._},function(t){I=t.aa},function(t){J=t.H},null,null,null,null,null],execute:function(){var r={id:"safeDetectList"},M={class:"progress-header"},N={class:"progress-header-cot"},L={key:0,class:"relative"},V={class:"absolute top-[1.6rem] left-[2.6rem] flex flex-col"},z={class:"progress-header-cot"},B={class:"scanning-progress-title"},K={class:"color-org"},q={class:"color-red"},Q={class:"scanning-progress-cont"},R={class:"progress-header-cot"},U={class:"progress-cont-list"},W=["onClick"],X={class:"progress_type"},Y={class:"progress_status"},Z={key:0,class:"text-danger"},$={key:1,class:"text-warning"},tt={key:1},et={key:2,class:"text-secondary"},rt={key:0},ot={key:0,class:"progress_fold"},st={class:"progress_item_body"},nt={class:"info_cont"},at={class:"info_cont_desc"},ct=a({__name:"safeDetect",setup:function(t){var a=P().payment,H=J(),ct=c(a.value).authType,it=i(!1),lt=[{color:"#888",text:"未安装"},{color:"#666",text:"良好"},{color:"#e6a23c",text:"警告"},{color:"red",text:"危险"}],ut={system_account:"系统账户",sshd_service:"SSHD远程服务",file_mode:"重要文件权限及属性",software:"重点软件检测",other:"其他项目检测",backdoor:"后门检测",proc:"恶意进程",history:"历史命令",log:"日志排查",rootkit:"rootkit检测"},ft=i({}),pt=l(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach(function(e){n(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},{scanStatus:!1,isEnd:!1,error:0,warn:0,time:0,progress:0,progressColor:"var(--el-color-primary)",progressConfig:{system_account:[],sshd_service:[],file_mode:[],software:[],other:[],backdoor:[],proc:[],history:[],log:[],rootkit:[]},statusTotal:{},allArr:[],result:{},progressStatus:{},active:{system_account:!1,sshd_service:!1,file_mode:!1,software:!1,other:!1,backdoor:!1,proc:!1,history:!1,log:!1,rootkit:!1}})),dt=function(t){return t+" 分"},yt=null,vt=u(function(){return pt.scanStatus&&!pt.isEnd?"正在扫描":ft.value.status?"上次检测时间 "+("刚刚"===C(ft.value.msg.time)?"一分钟内":C(ft.value.msg.time)):"当前未进行安全检测"}),gt=i(""),mt=i(""),bt=u(function(){return pt.scanStatus&&!pt.isEnd?"正在扫描-".concat(gt.value):pt.isEnd?"检测时间："+D(pt.time/1e3,"yyyy-MM-dd"):ft.value.status?"若长时间未检测，服务器可能存在安全风险，建议立即检测":"当前安全风险未知，请立即检测"}),ht=function(t,e){if(e.data){var r,o=JSON.parse(e.data.replace(/'/g,'"'));if(o.hasOwnProperty("callback"))null===(r=yt)||void 0===r||r.close(),pt.scanStatus=!1,pt.isEnd=!0,pt.time=(new Date).getTime();else gt.value=o.name,mt.value=o.topic,pt.progress=parseInt(o.progress),pt.progressConfig[o.topic].push(o),pt.progressConfig[o.topic].sort(function(t,e){return 1===t.status&&1!==e.status?1:1!==t.status&&1===e.status?-1:e.status-t.status}),pt.statusTotal[o.topic]=_t(pt.progressConfig[o.topic]),pt.allArr.push(o),3===o.status&&pt.error++,2!==o.status&&3!==o.status||pt.warn++,1!==o.status&&(pt.progressColor="#fc6d26")}},_t=function(t){var e={};return t.forEach(function(t){e[t.status]?e[t.status]++:e[t.status]=1}),e},wt=function(){var t,e;return"ltd"!==ct.value?H.openPayView():(pt.scanStatus&&!pt.isEnd||pt.isEnd,pt.scanStatus&&!pt.isEnd?(null===(e=yt)||void 0===e||e.close(),void kt()):(pt.isEnd&&kt(),pt.scanStatus=!0,void(null===(t=yt=F({route:"/ws_project",onMessage:ht}))||void 0===t||t.send({mod_name:"safe_detect",def_name:"get_safe_scan",ws_callback:""}))))},kt=function(){pt.scanStatus=!1,pt.isEnd=!1,pt.error=0,pt.warn=0,pt.time=0,pt.progress=0,pt.progressColor="var(--el-color-primary)",pt.progressConfig={system_account:[],sshd_service:[],file_mode:[],software:[],other:[],backdoor:[],proc:[],history:[],log:[],rootkit:[]},pt.statusTotal={},pt.allArr=[],pt.result={},pt.progressStatus={},pt.active={system_account:!1,sshd_service:!1,file_mode:!1,software:!1,other:!1,backdoor:!1,proc:!1,history:!1,log:!1,rootkit:!1}},St=function(){var t,r=(t=e().m(function t(){var r,o;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,I();case 1:r=t.v,ft.value=r.data,t.n=3;break;case 2:t.p=2,o=t.v,G(o);case 3:return t.a(2)}},t,null,[[0,2]])}),function(){var e=this,r=arguments;return new Promise(function(s,n){var a=t.apply(e,r);function c(t){o(a,s,n,c,i,"next",t)}function i(t){o(a,s,n,c,i,"throw",t)}c(void 0)})});return function(){return r.apply(this,arguments)}}();return f(function(){St()}),function(t,e){var o,s,n,a=A,c=E,i=T,l=p("bt-loading");return d((v(),g("div",r,[e[6]||(e[6]=m("div",{class:"text-large mb-6"},"服务器安全检测",-1)),m("div",M,[m("div",N,[m("div",{class:b("progresscirclebar "+(y(ft).status?"security ":"")+"text-["+(100===(null===(o=y(ft).msg)||void 0===o?void 0:o.security_count)?" var(--el-color-primary) ":" #fc6d26 ")+"]")},[y(ft).status?(v(),g(_,{key:1},[y(pt).scanStatus&&!y(pt).isEnd?(v(),g("div",L,[w(c,{class:"animate-spin",type:"circle",percentage:70,"show-text":!1,"stroke-width":4,"define-back-color":"#fff",color:y(pt).warn||y(pt).error?"#fc6d26":"var(--el-color-primary)",width:100},null,8,["color"]),m("div",V,[w(a,{class:"w-[full] px-[.4rem]",src:"/firewall/icon-safe-detect".concat(y(pt).warn||y(pt).error?"-org":"",".svg")},null,8,["src"]),e[0]||(e[0]=m("span",{class:"text-small font-bold py-[.4rem] leading-none"}," 安全检测 ",-1))])])):(v(),h(c,{key:1,type:"circle",percentage:null===(s=y(ft).msg)||void 0===s?void 0:s.security_count,format:dt,color:100===(null===(n=y(ft).msg)||void 0===n?void 0:n.security_count)?"var(--el-color-primary)":"#fc6d26",width:100},null,8,["percentage","color"]))],64)):(v(),h(a,{key:0,class:"w-[10rem]",src:"/firewall/icon-safe-detect.svg"}))],2)]),m("div",z,[m("div",B,[y(pt).isEnd?(v(),g(_,{key:1},[e[5]||(e[5]=k(" 检测已完成 ",-1)),y(pt).error>0||y(pt).warn>0?(v(),g(_,{key:0},[e[4]||(e[4]=k(" ，一共发现 ",-1)),y(pt).warn>0?(v(),g(_,{key:0},[m("span",K,S(y(pt).warn),1),e[1]||(e[1]=k(" 项风险项 ",-1))],64)):j("",!0),y(pt).error>0?(v(),g(_,{key:1},[e[2]||(e[2]=k(" （包含 ",-1)),m("span",q,S(y(pt).error),1),e[3]||(e[3]=k(" 项危险项，请立即处理） ",-1))],64)):j("",!0)],64)):j("",!0)],64)):(v(),g(_,{key:0},[k(S(y(vt)),1)],64))]),y(pt).scanStatus?(v(),h(c,{key:0,percentage:y(pt).progress,color:y(pt).warn||y(pt).error?"#fc6d26":"var(--el-color-primary)","stroke-width":10},null,8,["percentage","color"])):j("",!0),m("div",Q,S(y(bt)),1)]),m("div",R,[w(i,{type:y(pt).scanStatus&&!y(pt).isEnd?"warning":"primary",onClick:wt,plain:!(!y(pt).scanStatus||y(pt).isEnd)},{default:O(function(){return[k(S(y(pt).scanStatus&&!y(pt).isEnd?"取消扫描":y(pt).isEnd?"重新检测":"立即检测"),1)]}),_:1},8,["type","plain"])])]),m("div",U,[(v(),g(_,null,x(ut,function(t,e){return m("div",{key:e,class:b([e+"_item "+(y(pt).active[e]?"active":""),"progress_item"])},[m("div",{class:"progress_item_header",onClick:function(t){return function(t){pt.active[t]=!pt.active[t]}(e)}},[m("div",X,[w(a,{class:"title-icon",src:"/firewall/icon-"+e+".svg"},null,8,["src"]),m("span",null,S(t),1)]),m("div",Y,[y(pt).statusTotal[e]?(v(),g(_,{key:0},[y(pt).statusTotal[e][3]||y(pt).statusTotal[e][2]?(v(),g(_,{key:0},[y(pt).statusTotal[e][3]?(v(),g("span",Z," 发现"+S(y(pt).statusTotal[e][3])+"项危险 ",1)):j("",!0),y(pt).statusTotal[e][2]?(v(),g("span",$,S((y(pt).statusTotal[e][3]?"":"发现")+y(pt).statusTotal[e][2])+"项警告 ",1)):j("",!0)],64)):y(pt).scanStatus&&y(mt)==e?(v(),g("span",tt," 正在扫描... ")):(v(),g("span",et,"无风险项"))],64)):(v(),g(_,{key:1},[y(pt).scanStatus&&!y(pt).statusTotal[e]?(v(),g("span",rt," 等待扫描 ")):j("",!0)],64))]),y(pt).progressConfig[e]&&y(pt).progressConfig[e].length?(v(),g("div",ot,[w(a,{src:"/firewall/arrow-down.svg",class:"mt-[.6rem]"})])):j("",!0)],8,W),m("div",st,[y(pt).progressConfig[e]&&y(pt).progressConfig[e].length?(v(!0),g(_,{key:0},x(y(pt).progressConfig[e],function(t,e){return v(),g("div",{key:e,class:b([t.info?"active":"","progress_item_info"])},[m("div",nt,[m("div",null,S(t.name.replace("分析网站","")),1),m("div",{class:b("text-["+lt[t.status<0?0:t.status].color+"]")},S(lt[t.status<0?0:t.status].text),3)]),m("div",at,S(t.info||""),1)],2)}),128)):j("",!0)])],2)}),64))])])),[[l,y(it)]])}}});t("default",H(ct,[["__scopeId","data-v-5428693f"]]))}}})}();
