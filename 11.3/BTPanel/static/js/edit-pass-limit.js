import{c as e,o as a,r as s,x as t,y as l,e as r,C as d,A as o,z as m,D as i,ad as u,b2 as p,H as n,ab as c}from"./base-lib.js?v=1763689792";import{an as b,p as _,Q as f,k as g,_ as w}from"./utils-lib.js?v=1763689792";import{u as h}from"./column.js?v=1763689792";import{setPassUserApi as V}from"./site.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";const y={class:"p-[20px]"},D={class:"flex items-center"},x=w(e({__name:"edit-pass-limit",props:{compData:{default:()=>({})}},emits:["close"],setup(e,{emit:w}){const x=e,j=w,v=a({site_dir:x.compData.site_dir||"",name:x.compData.name||"",username:x.compData.username||"",password:x.compData.password||""}),k=s(!1),q=s(),U=a({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,message:"用户名必须大于三位",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:3,message:"密码必须大于三位",trigger:"blur"}]}),{BtTable:C,config:H}=b({request:()=>{const e=x.compData.user_list.map(e=>({user:e}))||[];return{data:e,total:e.length}},columns:[{prop:"user",label:"用户"},h([{title:"删除",onClick:e=>z("remove",e)}])]}),z=async(e,a)=>{const s=H.data.some(e=>e.user===v.username);s&&"add"===e&&await _({title:"提示",content:"用户已存在，继续添加会覆盖同名用户配置，是否继续？"}),1===H.data.length&&"remove"===e&&await _({title:"提示",content:"确认删除用户【".concat(H.data[0].user,"】？此为当前唯一用户，删除后该加密规则将一起被删除，是否继续？")});let t={id:x.compData.id,...v,username:a?a.user:v.username,option:e};delete t.site_dir,f({loading:"正在".concat({add:"添加",remove:"删除"}[e],"，请稍后..."),request:V(t),message:!0,success:t=>{t.status&&("add"===e?(!s&&H.data.push({user:v.username}),v.username="",v.password=""):(H.data=H.data.filter(e=>e.user!==a.user),0===H.data.length&&j("close")),x.compData.refresh())}})};return(a,s)=>{const b=g,_=u,f=p,w=n,h=c;return t(),l("div",y,[r(h,{ref_key:"passwordSiteForm",ref:q,rules:m(U),model:m(v),disabled:m(k)},{default:d(()=>[o("div",D,[r(_,{label:"加密路径",prop:"site_dir"},{default:d(()=>[r(b,{disabled:!!e.compData.name,modelValue:m(v).site_dir,"onUpdate:modelValue":s[0]||(s[0]=e=>m(v).site_dir=e),placeholder:"输入需要加密访问的目录，如：/text/",width:"13rem"},null,8,["disabled","modelValue"])]),_:1}),r(_,{label:"名称",prop:"name"},{default:d(()=>[r(b,{modelValue:m(v).name,"onUpdate:modelValue":s[1]||(s[1]=e=>m(v).name=e),disabled:!!e.compData.name,width:"13rem"},null,8,["modelValue","disabled"])]),_:1})]),r(f,{"border-style":"dashed",class:"!mt-0"}),r(_,{label:"新用户",prop:"username"},{default:d(()=>[r(b,{modelValue:m(v).username,"onUpdate:modelValue":s[2]||(s[2]=e=>m(v).username=e),placeholder:"请输入大于三位的用户名",width:"26rem"},null,8,["modelValue"]),r(w,{type:"primary",onClick:s[3]||(s[3]=e=>z("add")),class:"ml-[8px]"},{default:d(()=>[...s[5]||(s[5]=[i(" 添加 ",-1)])]),_:1})]),_:1}),r(_,{label:"密码",prop:"password"},{default:d(()=>[r(b,{modelValue:m(v).password,"onUpdate:modelValue":s[4]||(s[4]=e=>m(v).password=e),type:"password",placeholder:"请输入大于三位的密码",width:"26rem"},null,8,["modelValue"])]),_:1}),r(f,{"border-style":"dashed"}),r(_,{label:"已有用户",prop:"password"},{default:d(()=>[r(m(C),{class:"!w-[85%]"})]),_:1}),s[6]||(s[6]=o("ul",{class:"ml-6 mt-8 list-disc leading-10"},[o("li",{class:"text-secondary"},"目录设置加密访问后，会导致目录及子目录下的“反向代理”失效"),o("li",{class:"text-secondary"},"目录设置加密访问后，访问时需要输入账号密码才能访问"),o("li",{class:"text-secondary"},"例如我设置了加密访问 /test/ ,那我访问 http://aaa.com/test/ 时就要输入账号密码才能访问")],-1))]),_:1},8,["rules","model","disabled"])])}}}),[["__scopeId","data-v-ddb04fec"]]);export{x as default};
