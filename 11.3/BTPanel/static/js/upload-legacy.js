!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}System.register(["./base-lib-legacy.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792"],function(e,n){"use strict";var r,a,o,u,i,l,s,c,f,p,m,d,v,y,h,_,b,g,w,x,D,k,z,j,A,S,C,O;return{setters:[function(t){r=t.c,a=t.aB,o=t.r,u=t.g,i=t.W,l=t.o,s=t.w,c=t.x,f=t.y,p=t.e,m=t.C,d=t.D,v=t.z,y=t.A,h=t.B,_=t.F,b=t.O,g=t.J,w=t.K,x=t.H,D=t.b4,k=t.ax,z=t.b6,j=t.ay,A=t.az},function(t){S=t.bi,C=t.x,O=t.b},null],execute:function(){var n={class:"p-[2rem]"},q={class:"h-[40rem] border border-lighter mt-[1rem]"},I={class:"ml-[0.5rem]"},E={class:"mt-8px leading-8 text-small list-disc ml-2rem"};e("default",r({__name:"upload",props:{compData:{default:function(){return{path:"",size:100,uploadData:function(){return{multiple:!0,limit:1e3}},refreshEvent:function(){}}}}},setup:function(e,r){var B=r.expose,F=O(),H=e,M=a("popupSetFooter"),T=a("buttonText"),J=a("popupClose"),K=!0,U=o(),W=o([]),$=u(function(){return H.compData.uploadData.accept||i([".json"].join(","))}),G=u(function(){return H.compData.uploadData.multiple}),L=u(function(){return H.compData.uploadData.limit}),N={"x-http-token":window.vite_public_request_token},P=S(),Q=window.location.protocol+"//"+window.location.host+"/files?action=upload",R=l({f_size:0,f_path:H.compData.path,f_name:"",f_start:0,request_time:P.request_time,request_token:P.request_token}),V=function(){F.success("导入成功"),H.compData.refreshEvent&&H.compData.refreshEvent(W.value,J)},X=function(t,e,n){n.push(e),F.error("导入失败")},Y=function(t){R.f_size=t.size,R.f_name=t.name,R.f_start=0},Z=function(t,e){var n=t.name.substring(t.name.lastIndexOf(".")+1),r=$.value;if(-1===r.indexOf(n))return!1;W.value=e.filter(function(t){var e=t.name.substring(t.name.lastIndexOf(".")+1);return-1!==r.indexOf(e)})||[]},tt=function(t,e,n){R.f_start=t.percent,W.value=n.map(function(n){return n.uid===e.uid&&(n.percentage=t.percent),n})};return s(function(){return W.value.length},function(t){if(0!==t){for(var e=["success","fail","ready"],n=0;n<W.value.length;n++)if(!e.includes(W.value[n].status))return void M(!1);W.value.some(function(t){return"success"!==t.status})&&(T.value=K?"开始上传":"重新上传",M(!0))}else M(!1)}),B({onConfirm:function(){W.value.map(function(t){"success"!==t.status&&(t.status="ready")}),K=!1,U.value.submit(),M(!1)}}),function(e,r){var a=x,o=D,u=k,i=z,l=j,s=A;return c(),f("div",n,[p(o,{class:"upload-demo",ref_key:"upload",ref:U,name:"blob",data:v(R),action:Q,headers:N,accept:v($),limit:v(L),multiple:v(G),"show-file-list":!1,"auto-upload":!1,"file-list":v(W),"on-error":X,"on-success":V,"on-progress":tt,"on-change":Z,"before-upload":Y},{default:m(function(){return[p(a,{type:"primary"},{default:m(function(){return t(r[0]||(r[0]=[d("选择文件",-1)]))}),_:1})]}),_:1},8,["data","accept","limit","multiple","file-list"]),y("div",q,[p(s,{height:"400",data:v(W)},{empty:m(function(){return[p(l,{description:"只支持'".concat(v($),"'文件格式导入")},null,8,["description"])]}),default:m(function(){return[p(u,{prop:"name","show-overflow-tooltip":!0,label:"名称"},{default:m(function(t){return[r[1]||(r[1]=y("i",{class:"text-supplement svgtofont-el-document"},null,-1)),y("span",I,h(t.row.name),1)]}),_:1}),p(u,{prop:"name",label:"是否成功",width:"300"},{default:m(function(t){return["success"===t.row.status?(c(),f(_,{key:0},[d("上传成功！")],64)):"fail"===t.row.status?(c(),f(_,{key:1},[d("上传失败!")],64)):"ready"===t.row.status?(c(),f(_,{key:2},[d("等待上传")],64)):(c(),b(i,{key:3,percentage:Math.floor(t.row.percentage)},null,8,["percentage"]))]}),_:1}),p(u,{width:"120",prop:"size",label:"大小"},{default:m(function(t){return[d(h(v(C)(t.row.size)),1)]}),_:1}),p(u,{prop:"name",width:"180",align:"right","show-overflow-tooltip":!0,label:"操作"},{default:m(function(e){return[g(p(a,{type:"text",size:"small",onClick:function(t){return n=e.row,void(W.value=W.value.filter(function(t){return t.name!==n.name}));var n}},{default:m(function(){return t(r[2]||(r[2]=[d("删除",-1)]))}),_:1},8,["onClick"]),[[w,"ready"===e.row.status||"fail"===e.row.status]])]}),_:1})]}),_:1},8,["data"])]),y("ul",E,[y("li",null,"仅支持"+h(v($)),1)])])}}}))}}})}();
