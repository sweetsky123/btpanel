import{Q as e,bR as t,V as r,l as a,i$ as s,i5 as l}from"./utils-lib.js?v=1763689792";import{_ as i}from"./index109.js?v=1763689792";import{c as o,r as n,v as d,x as c,y as m,A as u,F as v,b1 as b,z as f,e as p,O as x,C as y,n as g,D as h,ay as _,L as k,B as w}from"./base-lib.js?v=1763689792";import{al as j}from"./firewall.js?v=1763689792";import{i as S,m as L,o as A}from"./useMethod8.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./column.js?v=1763689792";import"./index110.js?v=1763689792";import"./useStore6.js?v=1763689792";import"./validator.js?v=1763689792";import"./index107.js?v=1763689792";const C={class:"flex"},E={class:"w-[60%] mr-4"},F={class:"flex ml-[0.2rem] mb-[1.6rem]"},R={class:"flex items-center mb-[1.2rem] text-tertiary"},T={class:"border-1 border-lighter rounded-base p-[1.6rem]"},z={key:0,class:"w-full h-[32rem] flex items-center justify-center"},D={class:"border-1 border-lighter rounded-base p-[1.6rem] mt-[1.6rem]"},W={key:0,class:"w-full h-[32rem] flex items-center justify-center"},M={class:"flex-1 ml-4"},O={class:"border-1 border-lighter rounded-base p-[1.6rem]"},P={key:0,class:"w-full h-[24rem]"},I={key:1,class:"w-full h-[24rem] flex items-center justify-center"},N={class:"border-1 border-lighter rounded-base p-[1.6rem] mt-[1.6rem]"},q={class:"w-full h-[24rem]"},B={class:"border-1 border-lighter rounded-base p-[1.6rem] mt-[1.6rem]"},G={key:0,class:"w-full h-[24rem]"},H={key:1,class:"w-full h-[24rem] flex items-center justify-center"},Q=o({__name:"index",setup(o){const Q=n(),V=n(),$=n(),J=n(!1),K=n({}),U=n([]),X=n([]),Y=n([]),Z=n(),ee=n(),te=(e={})=>{let t=[],r=[],a=[];for(var s=0;s<e.length&&!(s>=5);s++){var i=e[s];r.push(i.site_name),t.push(i.end_time-i.start_time),a.push(i.scans)}return{legend:{left:"left",data:["耗时","检测页面"]},grid:{left:45,top:50,right:15,bottom:20,backgroundColor:"#888"},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(e){return e.length?"检测网站: "+e[0].name+(2===e.length?"</br>耗时: "+l(e[0].value)+"</br>检测页面数量: "+e[1].value:e[0].seriesIndex?"</br>检测页面数量: "+e[0].value:"</br>耗时: "+l(e[0].value)):""}},xAxis:{type:"category",data:r,scale:!0,triggerEvent:!0,axisLabel:{formatter:function(e){return e.length>6?e.substr(0,6)+"...":e}}},yAxis:{type:"value"},series:[{type:"bar",name:"耗时",barWidth:24,data:t,itemStyle:{color:"#fcc858"}},{type:"bar",name:"检测页面",barWidth:24,data:a,itemStyle:{color:"#8dcf6e"}}]}},re=(e={})=>{var t,a;return{grid:{left:45,right:15,top:50,bottom:20,backgroundColor:"#888"},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(e){return e[0].name+"</br>风险次数: "+Number(e[0].value||0)}},xAxis:{type:"category",boundaryGap:!1,data:null==(t=Object.keys(e))?void 0:t.map(e=>e).sort((e,t)=>new Date(e).getTime()<new Date(t).getTime()?-1:1),axisLabel:{fontSize:10,color:"#666",formatter:e=>r(new Date(e).getTime()/1e3,"MM-dd")}},axisLabel:{fontSize:10,color:"#666"},axisLine:{show:!1},axisTick:{show:!1},yAxis:{type:"value",splitNumber:5,name:"风险次数/次",min:0,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{fontSize:10,color:"#666"}},series:[{type:"line",smooth:.6,data:null==(a=Object.values(e))?void 0:a.map(e=>e),areaStyle:{normal:{}},itemStyle:{normal:{color:"#FF8585",lineStyle:{color:"#FF8585",type:"solid"}}}}]}},ae=(e={})=>{for(var t=[],r=[],a=0;a<e.length&&!(a>=6);a++){var s=e[a];t.push(s.words),r.push(s.count)}return{grid:{top:10,left:60,right:15,bottom:20,backgroundColor:"#888"},tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:e=>"敏感词: "+e[0].name+"</br>次数: "+e[0].value},xAxis:{type:"value"},yAxis:{type:"category",data:t,scale:!0,triggerEvent:!0,axisLabel:{formatter:function(e){return e.length>4?e.substr(0,4)+"...":e}}},series:[{type:"bar",data:r,barWidth:20,itemStyle:{color:function(e){return["#ffa688","#ffc87d","#98caa5","#acce9b","#cad48f"][e.dataIndex]}}}]}},se=[{label:"巡检时间",prop:"time",render:e=>{const a=t(e.time,"number",0);return p("span",null,[r(a)])}},{label:"检测域名",prop:"site_name"},{label:"检测方式",prop:"method",render:e=>L[e.method]},{label:"检测页面数",prop:"scans"},{label:"巡检结果",render:e=>[0===e.risks?p("span",{class:"text-primary"},[h("无风险 ")]):p("span",{class:"bt-link !text-danger",onClick:()=>A(e)},[e.risks])]}],le=S();return d(async()=>{var r,a;const s=await e({loading:"正在获取数据，请稍后...",request:j()});K.value=s.data,X.value=t(null==(r=null==s?void 0:s.data)?void 0:r.site_info,"array",[]),Y.value=t(null==(a=null==s?void 0:s.data)?void 0:a.risk_info,"array",[]),U.value=[{title:"监控网站",value:K.value.site_count},{title:"总风险次数",value:K.value.risk_count},{title:"今日风险次数",value:K.value.day_risk},{title:"今日巡检次数",value:K.value.today_count}],g(()=>{var e,t;Z.value=null==s?void 0:s.data["7day_risk"],J.value=!(null==(e=null==s?void 0:s.data)?void 0:e.sensitive_word.length),ee.value=null==(t=null==s?void 0:s.data)?void 0:t.sensitive_word})}),(e,t)=>{const r=_,l=a,o=i,n=s;return c(),m("div",C,[u("div",E,[u("div",F,[(c(!0),m(v,null,b(f(U),(e,t)=>(c(),m("div",{key:t,class:k("block-bg "+(t>0?"ml-[5rem]":""))},[u("div",R,[u("span",null,w(e.title),1)]),u("div",{class:k("font-bold text-extraLarge leading-none "+(0!==t&&3!==t&&e.value>0?"text-warning":"text-secondary"))},w(e.value),3)],2))),128))]),u("div",T,[t[0]||(t[0]=u("div",{class:"card_title flex items-center text-secondary text-base mb-[1.2rem]"},"网站内容检测",-1)),0===f(X).length?(c(),m("div",z,[p(r,{description:"网站内容检测为空"})])):(c(),x(o,{key:1},{content:y(()=>[p(l,{"max-height":"320",column:se,data:f(X)},null,8,["data"])]),_:1}))]),u("div",D,[t[1]||(t[1]=u("div",{class:"card_title flex items-center text-secondary text-base mb-[1.2rem]"},"风险动态",-1)),0===f(Y).length?(c(),m("div",W,[p(r,{description:"风险动态为空"})])):(c(),x(o,{key:1},{content:y(()=>[p(l,{"max-height":"320",column:f(le),data:f(Y)},null,8,["column","data"])]),_:1}))])]),u("div",M,[u("div",O,[t[2]||(t[2]=u("div",{class:"card_title flex items-center text-secondary text-base mb-[1.2rem]"},"风险历史",-1)),f(X).length?(c(),m("div",P,[p(n,{ref_key:"riskEchartRef",ref:Q,options:te(f(X))},null,8,["options"])])):(c(),m("div",I,[p(r,{description:"风险历史数据为空"})]))]),u("div",N,[t[3]||(t[3]=u("div",{class:"card_title flex items-center text-secondary text-base mb-[1.2rem]"},"近7日巡检情况",-1)),u("div",q,[p(n,{ref_key:"dayRiskEchartRef",ref:V,options:re(f(Z))},null,8,["options"])])]),u("div",B,[t[4]||(t[4]=u("div",{class:"card_title flex items-center text-secondary text-base mb-[1.2rem]"},"敏感词排行",-1)),f(J)?(c(),m("div",H,[p(r,{description:"敏感词排行数据为空"})])):(c(),m("div",G,[p(n,{ref_key:"sensitiveWordEchartRef",ref:$,options:ae(f(ee))},null,8,["options"])]))])])])}}});export{Q as default};
