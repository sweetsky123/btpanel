!function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=Array(n);t<n;t++)a[t]=e[t];return a}function a(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",l=t.toStringTag||"@@toStringTag";function u(t,a,o,l){var u=a&&a.prototype instanceof c?a:c,s=Object.create(u.prototype);return r(s,"_invoke",function(t,a,r){var o,l,u,c=0,s=r||[],d=!1,m={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(n,t){return o=n,l=0,u=e,m.n=t,i}};function f(t,a){for(l=t,u=a,n=0;!d&&c&&!r&&n<s.length;n++){var r,o=s[n],f=m.p,p=o[2];t>3?(r=p===a)&&(u=o[(l=o[4])?5:(l=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=t<2&&f<o[1])?(l=0,m.v=a,m.n=o[1]):f<p&&(r=t<3||o[0]>a||a>p)&&(o[4]=t,o[5]=a,m.n=p,l=0))}if(r||t>1)return i;throw d=!0,a}return function(r,s,p){if(c>1)throw TypeError("Generator is already running");for(d&&1===s&&f(s,p),l=s,u=p;(n=l<2?e:u)||!d;){o||(l?l<3?(l>1&&(m.n=-1),f(l,u)):m.n=u:m.v=u);try{if(c=2,o){if(l||(r="next"),n=o[r]){if(!(n=n.call(o,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,l<2&&(l=0)}else 1===l&&(n=o.return)&&n.call(o),l<2&&(u=TypeError("The iterator does not provide a '"+r+"' method"),l=1);o=e}else if((n=(d=m.n<0)?u:t.call(a,m))!==i)break}catch(n){o=e,l=1,u=n}finally{c=1}}return{value:n,done:d}}}(t,o,l),!0),s}var i={};function c(){}function s(){}function d(){}n=Object.getPrototypeOf;var m=[][o]?n(n([][o]())):(r(n={},o,function(){return this}),n),f=d.prototype=c.prototype=Object.create(m);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,r(e,l,"GeneratorFunction")),e.prototype=Object.create(f),e}return s.prototype=d,r(f,"constructor",d),r(d,"constructor",s),s.displayName="GeneratorFunction",r(d,l,"GeneratorFunction"),r(f),r(f,l,"Generator"),r(f,o,function(){return this}),r(f,"toString",function(){return"[object Generator]"}),(a=function(){return{w:u,m:p}})()}function r(e,n,t,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}r=function(e,n,t,a){function l(n,t){r(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!a,configurable:!a,writable:!a}):e[n]=t:(l("next",0),l("throw",1),l("return",2))},r(e,n,t,a)}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach(function(n){u(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function u(n,t,a){return(t=function(n){var t=function(n,t){if("object"!=e(n)||!n)return n;var a=n[Symbol.toPrimitive];if(void 0!==a){var r=a.call(n,t||"default");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"==e(t)?t:t+""}(t))in n?Object.defineProperty(n,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[t]=a,n}function i(e,n,t,a,r,o,l){try{var u=e[o](l),i=u.value}catch(e){return void t(e)}u.done?n(i):Promise.resolve(i).then(a,r)}function c(e){return function(){var n=this,t=arguments;return new Promise(function(a,r){var o=e.apply(n,t);function l(e){i(o,a,r,l,u,"next",e)}function u(e){i(o,a,r,l,u,"throw",e)}l(void 0)})}}System.register(["./base-lib-legacy.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./validator-legacy.js?v=1763689792","./site-legacy.js?v=1763689792","./index.vue_vue_type_script_setup_true_lang-legacy13.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./column-legacy.js?v=1763689792","./index-legacy107.js?v=1763689792"],function(e,t){"use strict";var r,o,u,i,s,d,m,f,p,v,_,h,y,b,g,w,V,j,D,O,k,U,x,S,P,T,E,A,C,G,F,I,L,R;return{setters:[function(e){r=e.c,o=e.r,u=e.W,i=e.w,s=e.v,d=e.x,m=e.O,f=e.C,p=e.e,v=e.z,_=e.A,h=e.y,y=e.b1,b=e.F,g=e.G,w=e.D,V=e.B,j=e.ad,D=e.am,O=e.an,k=e.ap,U=e.ak,x=e.aj,S=e.ab},function(e){P=e.a_,T=e.Q,E=e.k,A=e.ax,C=e.ag,G=e.$},function(e){F=e._},function(e){I=e.addMonitor,L=e.getDataList},function(e){R=e._},null,null,null,null],execute:function(){var t={class:"flex"},N={class:"flex"},q={class:"flex min-h-[3.2rem] items-start"},B={class:"items-center h-[3.2rem]"};e("default",r({__name:"add-monitor",props:{compData:{default:function(){}}},setup:function(e,r){var H=r.expose,M=o(null),z=e,J=o({name:"",method:2,site_name:"",site_url:"",access:"http",send_msg:!1,push_method:[],type:"day",week:1,where1:1,hour:1,minute:19,switch_config:!1,scan_config:{thesaurus:1,scan_args:!1,title_hash:!1,tail_hash:!1,keywords:!1,descriptions:!1,title:!1,search_monitor:!1,scan_ua:"Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)"},id:""}),$=u([]),Q=["周一","周二","周三","周四","周五","周六","周日"],W=o(!!z.compData.id),K=[{content:"如果是本机端口转发，目标IP为：127.0.0.1"},{content:"如果目标IP不填写，默认则为本机端口转发!"}],X=[{label:"全站扫描",value:1},{label:"快速扫描",value:2},{label:"单URL",value:3}],Y=[{label:"HTTPS",value:"https"},{label:"HTTP",value:"http"}],Z=[{label:"每天",value:"day"},{label:"N天",value:"day-n"},{label:"每星期",value:"week"},{label:"每月",value:"month"}],ee={name:[{required:!0,trigger:["blur","change"],message:"请输入监控名"}],site_name:[{validator:function(e,n,t){if("auto"!==n)t();else{if(J.value.site_url&&0!==J.value.site_url.length||t(new Error("请输入网站域名")),3!==J.value.method&&!P(J.value.site_url))return t(new Error("检测网站域名格式不正确"));t()}},trigger:["blur","change"]}],push_method:[{validator:function(e,n,t){J.value.send_msg&&(n.length>0&&t(),t(new Error("请选择通知方式"))),t()},trigger:["blur","change"]}],type:[{validator:function(e,n,t){return"day-n"!==n&&"month"!==n||!(J.value.where1<0||J.value.where1>31)?J.value.hour<0||J.value.hour>23?t(new Error("请输入正确小时范围[0-23]")):J.value.minute<0||J.value.minute>59?t(new Error("请输入正确分钟范围[0-59]")):void t():t(new Error("请输入正确天数范围[0-31]"))},trigger:["blur","change"]}]},ne=function(){var e=c(a().m(function e(n){var t,r,o;return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,M.value.validate();case 1:return t="auto"===(t=J.value.site_name)?J.value.site_url:t,r=l({name:J.value.name,method:J.value.method,site_name:t,url:J.value.access+"://"+t,send_msg:Number(J.value.send_msg),type:J.value.type,hour:J.value.hour,minute:J.value.minute,id:J.value.id},"day-n"===J.value.type||"month"===J.value.type?{where1:J.value.where1}:{}),o=J.value,r.send_msg&&(r.send_type=o.push_method.join(",")),"week"===o.type&&(r.week=o.week),o.switch_config&&(r.scan_config=te()),W.value&&(r.id=o.id),e.n=2,T({loading:"正在提交，请稍后...",request:I(W.value,r),message:!0});case 2:z.compData.refreshEvent&&z.compData.refreshEvent(),n();case 3:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),te=function(){var e=J.value.scan_config;return{scan_args:e.scan_args,title:e.title,keywords:e.keywords,descriptions:e.descriptions,title_hash:e.title_hash,tail_hash:e.tail_hash,search_monitor:e.search_monitor,scan_ua:e.scan_ua,thesaurus:e.thesaurus}},ae=function(){var e=c(a().m(function e(){var n;return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,T({loading:"正在获取网站列表，请稍后...",request:L({type:"sites"}),data:{data:[Array,$]}});case 1:J.value.site_name=W.value?z.compData.site_name:$.value[0].name,z.compData.isSite&&(J.value.site_name=(null===(n=z.compData)||void 0===n?void 0:n.site_name)||z.compData.name);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),re=function(e){var n;3===e?J.value.site_name="auto":z.compData.isSite&&(J.value.site_name=(null===(n=z.compData)||void 0===n?void 0:n.site_name)||z.compData.name)};return i(function(){return J.value.site_name},function(){var e,n,t,a,r=(null==X||null===(e=X.find(function(e){return e.value===J.value.method}))||void 0===e?void 0:e.label)||"";J.value.name=("auto"===J.value.site_name?(null===(n=J.value)||void 0===n?void 0:n.site_url)||"":(null===(t=z.compData)||void 0===t?void 0:t.site_name)||(null===(a=z.compData)||void 0===a?void 0:a.name)||"")+r}),H({onConfirm:ne}),s(function(){ae(),W.value&&function(){var e,n,t,a,r,o;J.value=l(l(l(l({},z.compData),z.compData.crontab_info),z.compData.scan_config),{},{access:null===(e=z.compData.url)||void 0===e?void 0:e.split("://")[0],where1:(null===(n=z.compData.crontab_info)||void 0===n?void 0:n.where1)||"1",hour:(null===(t=z.compData.crontab_info)||void 0===t?void 0:t.where_hour)||"",minute:(null===(a=z.compData.crontab_info)||void 0===a?void 0:a.where_minute)||"",send_msg:!!z.compData.send_msg,push_method:null===(r=z.compData.send_type)||void 0===r?void 0:r.split(",").filter(Boolean),id:z.compData.id});var u=null===(o=z.compData.crontab_info)||void 0===o?void 0:o.type;J.value.type="每星期"===u?"week":"每月"===u?"month":"每天"===u?"day":"day-n"}()}),function(a,r){var o=E,l=j,u=A,i=D,c=O,s=C,P=k,T=F,I=U,L=x,H=G,z=S;return d(),m(z,{ref_key:"monitorFormRef",ref:M,rules:ee,model:v(J),class:"p-[2rem] addfrom overflow-auto max-h-[60rem]","label-width":"10rem"},{default:f(function(){return[p(l,{label:"监控名",prop:"name"},{default:f(function(){return[p(o,{modelValue:v(J).name,"onUpdate:modelValue":r[0]||(r[0]=function(e){return v(J).name=e}),width:"26rem",placeholder:"请输入监控名",clearable:""},null,8,["modelValue"])]}),_:1}),p(l,{label:"检测方式"},{default:f(function(){return[p(u,{modelValue:v(J).method,"onUpdate:modelValue":r[1]||(r[1]=function(e){return v(J).method=e}),options:X,onChange:re,class:"!w-[26rem]"},null,8,["modelValue"])]}),_:1}),p(l,{label:"检测网站",prop:"site_name"},{default:f(function(){return[_("div",t,[p(c,{modelValue:v(J).site_name,"onUpdate:modelValue":r[2]||(r[2]=function(e){return v(J).site_name=e}),class:"!w-[20rem] mr-4",disabled:!(3!==v(J).method&&!e.compData.isSite)},{default:f(function(){return[(d(!0),h(b,null,y(v($),function(e,n){return d(),m(i,{key:n,value:e.name,label:"".concat(e.name,"[").concat(e.ps,"]")},null,8,["value","label"])}),128)),p(i,{label:"自定义网站",value:"auto"})]}),_:1},8,["modelValue","disabled"]),"auto"===v(J).site_name?(d(),m(o,{key:0,modelValue:v(J).site_url,"onUpdate:modelValue":r[3]||(r[3]=function(e){return v(J).site_url=e}),width:"20rem",placeholder:"请输入网站域名",clearable:""},null,8,["modelValue"])):g("",!0)])]}),_:1}),p(l,{label:"访问网站方式"},{default:f(function(){return[p(s,{modelValue:v(J).access,"onUpdate:modelValue":r[4]||(r[4]=function(e){return v(J).access=e}),options:Y},null,8,["modelValue"])]}),_:1}),p(l,{label:"发送告警"},{default:f(function(){return[p(P,{modelValue:v(J).send_msg,"onUpdate:modelValue":r[5]||(r[5]=function(e){return v(J).send_msg=e})},null,8,["modelValue"])]}),_:1}),!v(J).send_msg?g("",!0):(d(),m(l,{key:0,label:"通知方式",prop:"push_method"},{default:f(function(){return[p(T,{class:"!w-[26rem]",modelValue:v(J).push_method,"onUpdate:modelValue":r[6]||(r[6]=function(e){return v(J).push_method=e}),limit:["sms","wx_account"],"collapse-tags":"","collapse-tags-tooltip":""},null,8,["modelValue"])]}),_:1})),p(l,{label:"检测频率",prop:"type"},{default:f(function(){return[_("div",N,[p(u,{class:"!w-[8rem] mr-4",modelValue:v(J).type,"onUpdate:modelValue":r[7]||(r[7]=function(e){return v(J).type=e}),options:Z},null,8,["modelValue"]),"week"===v(J).type?(d(),m(c,{key:0,class:"!w-[8rem] mr-4",modelValue:v(J).week,"onUpdate:modelValue":r[8]||(r[8]=function(e){return v(J).week=e})},{default:f(function(){return[(d(),h(b,null,y(Q,function(e,n){return p(i,{key:n,label:e,value:n+1},null,8,["label","value"])}),64))]}),_:1},8,["modelValue"])):g("",!0),"day-n"===v(J).type||"month"===v(J).type?(d(),m(o,{key:1,type:"number",class:"!w-[13rem] mr-4",min:"0",max:"31",modelValue:v(J).where1,"onUpdate:modelValue":r[9]||(r[9]=function(e){return v(J).where1=e}),iconTitle:"day-n"===v(J).type?"天":"日",textType:"day-n"===v(J).type?"天":"日"},{append:f(function(){return[w(V("day-n"===v(J).type?"天":"日"),1)]}),_:1},8,["modelValue","iconTitle","textType"])):g("",!0),p(o,{type:"number",class:"!w-[13rem] mr-4",min:"0",max:"23",modelValue:v(J).hour,"onUpdate:modelValue":r[10]||(r[10]=function(e){return v(J).hour=e}),iconTitle:"时",textType:"时"},{append:f(function(){return n(r[22]||(r[22]=[w(" 时 ",-1)]))}),_:1},8,["modelValue"]),p(o,{type:"number",class:"!w-[13rem]",min:"0",max:"59",modelValue:v(J).minute,"onUpdate:modelValue":r[11]||(r[11]=function(e){return v(J).minute=e}),iconTitle:"分",textType:"分"},{append:f(function(){return n(r[23]||(r[23]=[w(" 分 ",-1)]))}),_:1},8,["modelValue"])])]}),_:1}),p(R,{showConfig:v(J).switch_config,"onUpdate:showConfig":r[21]||(r[21]=function(e){return v(J).switch_config=e})},{config:f(function(){return[p(l,{label:"敏感词库"},{default:f(function(){return[p(L,{modelValue:v(J).scan_config.thesaurus,"onUpdate:modelValue":r[12]||(r[12]=function(e){return v(J).scan_config.thesaurus=e}),class:"border-darker border-1 !w-[26rem] rounded-small px-[1rem] py-[.5rem] flex flex-col !items-start"},{default:f(function(){return[p(I,{value:1},{default:f(function(){return n(r[24]||(r[24]=[w("全选",-1)]))}),_:1}),p(I,{value:2},{default:f(function(){return n(r[25]||(r[25]=[w("自定义词库",-1)]))}),_:1}),p(I,{value:3},{default:f(function(){return n(r[26]||(r[26]=[w("默认词库",-1)]))}),_:1})]}),_:1},8,["modelValue"])]}),_:1}),p(l,{label:"检测带参数的URL"},{default:f(function(){return[_("div",q,[_("div",B,[p(P,{modelValue:v(J).scan_config.scan_args,"onUpdate:modelValue":r[13]||(r[13]=function(e){return v(J).scan_config.scan_args=e})},null,8,["modelValue"])]),r[27]||(r[27]=_("div",{class:"unit"},[_("p",null,"扫描时检测带参数的URL，如URL: https://bt.cn?a=b"),_("p",null,[w(" 开启前 "),_("span",{class:"ml-[2rem]"},"不检测")]),_("p",null,[w(" 开启后 "),_("span",{class:"ml-[2rem]"},"检测")]),_("p",null,"注意，开启后检测页面将成倍增长，可能会导致检测时间大量增加")],-1))])]}),_:1}),p(l,{label:"头部JS检测"},{default:f(function(){return[p(P,{modelValue:v(J).scan_config.title_hash,"onUpdate:modelValue":r[14]||(r[14]=function(e){return v(J).scan_config.title_hash=e})},null,8,["modelValue"]),r[28]||(r[28]=_("span",{class:"unit"},"监控页面源码中的title_hash标签是否有修改",-1))]}),_:1}),p(l,{label:"尾部JS检测"},{default:f(function(){return[p(P,{modelValue:v(J).scan_config.tail_hash,"onUpdate:modelValue":r[15]||(r[15]=function(e){return v(J).scan_config.tail_hash=e})},null,8,["modelValue"]),r[29]||(r[29]=_("span",{class:"unit"},"监控页面源码中的tail_hash标签是否有修改",-1))]}),_:1}),p(l,{label:"关键词检测"},{default:f(function(){return[p(P,{modelValue:v(J).scan_config.keywords,"onUpdate:modelValue":r[16]||(r[16]=function(e){return v(J).scan_config.keywords=e})},null,8,["modelValue"]),r[30]||(r[30]=_("span",{class:"unit"},"监控页面源码中的keywords标签是否有修改",-1))]}),_:1}),p(l,{label:"描述检测"},{default:f(function(){return[p(P,{modelValue:v(J).scan_config.descriptions,"onUpdate:modelValue":r[17]||(r[17]=function(e){return v(J).scan_config.descriptions=e})},null,8,["modelValue"]),r[31]||(r[31]=_("span",{class:"unit"},"监控页面源码中的descriptions标签是否有修改",-1))]}),_:1}),p(l,{label:"标题检测"},{default:f(function(){return[p(P,{modelValue:v(J).scan_config.title,"onUpdate:modelValue":r[18]||(r[18]=function(e){return v(J).scan_config.title=e})},null,8,["modelValue"]),r[32]||(r[32]=_("span",{class:"unit"},"监控页面源码中的title标签是否有修改",-1))]}),_:1}),p(l,{label:"搜索引擎收录监控"},{default:f(function(){return[p(P,{modelValue:v(J).scan_config.search_monitor,"onUpdate:modelValue":r[19]||(r[19]=function(e){return v(J).scan_config.search_monitor=e})},null,8,["modelValue"]),r[33]||(r[33]=_("span",{class:"unit"},"监控搜索引擎是否存在风险关键词",-1))]}),_:1}),p(l,{label:"自定义访问UA"},{default:f(function(){return[p(o,{type:"textarea",modelValue:v(J).scan_config.scan_ua,"onUpdate:modelValue":r[20]||(r[20]=function(e){return v(J).scan_config.scan_ua=e}),width:"36rem",height:"10rem",placeholder:"请输入自定义访问UA",clearable:""},null,8,["modelValue"])]}),_:1})]}),_:1},8,["showConfig"]),p(H,{options:K,class:"pl-[3.6rem]"})]}),_:1},8,["model"])}}}))}}})}();
