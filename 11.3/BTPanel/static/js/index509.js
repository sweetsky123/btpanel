import{r as a,g as e,s,c as t,v as l,a8 as n,x as o,y as i,e as r,C as u,A as c,F as m,b1 as p,L as d,z as v,B as f,D as x,G as _,aZ as y,H as I}from"./base-lib.js?v=1763689792";import{_ as b}from"./index437.js?v=1763689792";import{u as S}from"./useStore12.js?v=1763689792";import{j as w}from"./validator.js?v=1763689792";import{p as j,Q as g,n as T,H as E,b as P,V as C,_ as L}from"./utils-lib.js?v=1763689792";import{u as A}from"./useStore11.js?v=1763689792";import{n as D}from"./ssl.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./site.js?v=1763689792";import"./useStore4.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";const k=P(),B=a({}),M=e(()=>{var a;return(null==(a=B.value.productInfo)?void 0:a.totalPrice)>5e3}),V=a(M.value?"ali":"wx"),H=a(!1),W=a(0),Y=a(!1),{btCertPollingPopup:N,isRefreshBtSSL:R}=S(),{btIsRefresh:h}=s(A()),z=async()=>{(await N.value).unmount()},F=(a,e=!1)=>{M.value&&"wx"===a&&(a="ali",k.error("微信支付单笔限额5000元，请使用支付宝支付")),V.value=a,sessionStorage.setItem("PAY-BT-SSL-VIEW-TIME","".concat((new Date).getTime()/1e3))},q=async a=>{H.value=!1,a&&sessionStorage.setItem("PAY-BT-SSL-VIEW-TIME","".concat(a));const e=sessionStorage.getItem("PAY-BT-SSL-VIEW-TIME");if(e){if(parseInt("".concat((new Date).getTime()/1e3-Number(e)),10)>600&&N.value)return sessionStorage.removeItem("PAY-BT-SSL-VIEW-TIME"),j({title:"支付超时",icon:"warning",content:"由于您长时间未操作，支付超时，请刷新网页重新购买！",onConfirm:()=>{z(),window.location.reload()},onCancel:()=>{z(),window.location.reload()}});N.value||sessionStorage.removeItem("PAY-BT-SSL-VIEW-TIME")}await G(),Y.value?(W.value&&clearTimeout(W.value),W.value=setTimeout(()=>{q()},3e3)):O()},G=async()=>{const{data:a}=await g({request:D({url:"/api/v1/ssl/get_order_status",pay_id:B.value.pay_id})});if(!a.status&&!a.data)return k.error("请求失败，请稍后再试。如有支付问题，请联系客服。"),H.value=!0,Promise.reject({status:!1,msg:"请求失败，请稍后再试。如有支付问题，请联系客服。"});a.data&&0!==a.data&&(B.value.id=a.data),Y.value=0===a.data},O=async()=>{const{id:a,productInfo:e}=B.value,s={...B.value,id:a,product_name:null==e?void 0:e.productName,product_id:null==e?void 0:e.product_id};T({title:"支付成功",area:[60,60],component:()=>E(()=>import("./pay-success.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),compData:s}),R.value=!0,h.value=!0;(await N.value).unmount(),clearTimeout(W.value)},Q={class:"px-[3rem] py-[2rem] pb-[24px]"},Z={class:"ssl-pay-type"},J=["onClick"],K={class:"p-[24px] flex flex-col justify-center items-center"},U={class:"mt-[16px] text-base font-bold flex items-center"},X={class:"text-[2.5rem] ml-[8px] text-orange"},$={key:0,class:"mt-[20px] text-base flex items-center"},aa={class:"ssl-pay-info"},ea={class:"ssl-pay-info-line"},sa={class:"ssl-pay-info-line"},ta={class:"mt-[16px] flex items-center justify-center"},la=L(t({__name:"index",props:{compData:{default:{actual_amount:0,ali:"",discount_amount:0,pay_id:0,total_amount:0,wx:"",productInfo:{}}}},emits:["close"],setup(a,{emit:s}){const{btCertPollingPopup:t}=S(),j=a,g=[{name:"微信支付",label:"wx"},{name:"支付宝支付",label:"ali"}],T=e(()=>B.value[V.value]),E=e(()=>{var a;const{productName:e,years:s,num:t}=(null==(a=B.value)?void 0:a.productInfo)||{};if(!e)return"";const l=s?"".concat(s,"年"):"",n=t?" *".concat(t):"";return"".concat(e).concat(l).concat(n)});return l(()=>{B.value=j.compData,q((new Date).getTime()/1e3)}),n(()=>{t.value=null,Y.value=!1,clearTimeout(W.value)}),(a,e)=>{var s;const t=y,l=b,n=I;return o(),i("div",Q,[r(t,{type:"error",closable:!1},{title:u(()=>[...e[2]||(e[2]=[c("span",{class:"text-small"},[c("i",{calss:"svgtofont-el-warning-outline text-small"}),c("span",null," 禁止含有诈骗、赌博、色情、木马、病毒等违法违规业务信息的站点申请SSL证书，如有违反，撤销申请，停用账号。 ")],-1)])]),_:1}),c("div",Z,[(o(),i(m,null,p(g,a=>c("span",{key:a.name,class:d("ssl-pay-tab-item ".concat(a.label===v(V)?"isActive":"")),onClick:e=>v(F)(a.label)},[c("span",{class:d("pay-icon ".concat(a.label))},null,2),c("span",null,f(a.name),1)],10,J)),64))]),c("div",K,[r(l,{value:v(T),size:160},null,8,["value"]),c("span",U,[e[3]||(e[3]=c("span",null,"总计",-1)),c("span",X,f(Number(null==(s=v(B))?void 0:s.actual_amount).toFixed(2))+" 元 ",1)]),v(H)?(o(),i("span",$,[r(n,{type:"default",onClick:e[0]||(e[0]=()=>v(q)())},{default:u(()=>[...e[4]||(e[4]=[x("刷新支付状态",-1)])]),_:1}),c("span",{class:"bt-link ml-[2rem]",onClick:e[1]||(e[1]=(...a)=>v(w)&&v(w)(...a))},"联系客服")])):_("",!0)]),c("div",aa,[c("div",ea,[e[5]||(e[5]=c("span",{class:"w-[5rem]"},"商品名称",-1)),c("span",null,f(v(E)),1)]),c("div",sa,[e[6]||(e[6]=c("span",{class:"w-[5rem]"},"下单时间",-1)),c("span",null,f(v(C)(v(B).addtime,"yyyy-MM-dd HH:mm:ss")),1)])]),c("div",ta,[e[7]||(e[7]=c("span",{class:"scan-icon"},null,-1)),c("span",null,f("wx"===v(V)?"微信扫一扫支付":"支付宝扫一扫支付"),1)])])}}}),[["__scopeId","data-v-94504324"]]);export{la as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
