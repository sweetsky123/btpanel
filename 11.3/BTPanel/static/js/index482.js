import{c as a,r as e,o as s,v as o,x as t,y as r,e as n,C as l,Q as i,z as u,ab as d,A as p,U as c,ad as m}from"./base-lib.js?v=1763689792";import{b as f,_ as w}from"./utils-lib.js?v=1763689792";import{q as _}from"./useController7.js?v=1763689792";import{u as y}from"./index280.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./validator.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";import"./index109.js?v=1763689792";import"./index130.js?v=1763689792";const b={class:"security-verification-modal"},v=w(a({__name:"index",props:{compData:{default:()=>({})}},setup(a,{expose:w}){var v;const{securityToken:j}=y(),x=a,g=f(),q=e(),h=s({question:(null==(v=x.compData)?void 0:v.questionText)||"",answer:""}),D={answer:[{required:!0,message:"请输入密保答案",trigger:["blur","change"]},{min:1,max:100,message:"密保答案长度在 1 到 100 个字符",trigger:["blur","change"]}]},V=async()=>{var a,e;const s=g.load("正在验证密保答案，请稍候...");try{const s={url:"/api/v1/user/security/verify_security_questions",operation_type:x.compData.operationType,answers:[{question_id:x.compData.questionId,answer:h.answer}]},o=await _(s);if(o.data.status){const s=null==(a=o.data.data)?void 0:a.security_token;if(s)return j.value=s,(null==(e=x.compData)?void 0:e.onSuccess)&&await x.compData.onSuccess(s),!0}return g.error(o.data.msg),o.data.status}catch(o){return!1}finally{s&&s.close()}};return w({onConfirm:V}),o(()=>{}),(a,e)=>{const s=c,o=m;return t(),r("div",b,[n(u(d),{ref_key:"securityFormRef",ref:q,model:h,rules:D,"label-width":"90px",class:"security-form"},{default:l(()=>[n(o,{label:"密保问题",prop:"question"},{default:l(()=>[n(s,{modelValue:h.question,"onUpdate:modelValue":e[0]||(e[0]=a=>h.question=a),disabled:"",placeholder:"密保问题",class:"question-input"},null,8,["modelValue"])]),_:1}),n(o,{label:"密保答案",prop:"answer"},{default:l(()=>[n(s,{modelValue:h.answer,"onUpdate:modelValue":e[1]||(e[1]=a=>h.answer=a),type:"password",placeholder:"请输入密保答案","show-password":"",autofocus:"",class:"answer-input",onKeyup:i(V,["enter"])},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),e[2]||(e[2]=p("div",{class:"forgot-password"},[p("span",null,"忘记密保答案？请联系客服或"),p("a",{href:"https://www.bt.cn/domain/domain-security",class:"bt-link pl-2",target:"_blank"},"前往密保重置页面")],-1))])}}}),[["__scopeId","data-v-7c5a78f3"]]);export{v as default};
