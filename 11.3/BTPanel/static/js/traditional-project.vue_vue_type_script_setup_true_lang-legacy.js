!function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function t(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{};t%2?n(Object(l),!0).forEach(function(n){r(e,n,l[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):n(Object(l)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(l,n))})}return e}function r(n,t,r){return(t=function(n){var t=function(n,t){if("object"!=e(n)||!n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var l=r.call(n,t||"default");if("object"!=e(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(n)}(n,"string");return"symbol"==e(t)?t:t+""}(t))in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function l(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,n,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",a=t.toStringTag||"@@toStringTag";function u(t,r,l,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return o(s,"_invoke",function(t,r,l){var o,a,u,c=0,s=l||[],d=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(n,t){return o=n,a=0,u=e,p.n=t,i}};function f(t,r){for(a=t,u=r,n=0;!d&&c&&!l&&n<s.length;n++){var l,o=s[n],f=p.p,m=o[2];t>3?(l=m===r)&&(u=o[(a=o[4])?5:(a=3,3)],o[4]=o[5]=e):o[0]<=f&&((l=t<2&&f<o[1])?(a=0,p.v=r,p.n=o[1]):f<m&&(l=t<3||o[0]>r||r>m)&&(o[4]=t,o[5]=r,p.n=m,a=0))}if(l||t>1)return i;throw d=!0,r}return function(l,s,m){if(c>1)throw TypeError("Generator is already running");for(d&&1===s&&f(s,m),a=s,u=m;(n=a<2?e:u)||!d;){o||(a?a<3?(a>1&&(p.n=-1),f(a,u)):p.n=u:p.v=u);try{if(c=2,o){if(a||(l="next"),n=o[l]){if(!(n=n.call(o,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,a<2&&(a=0)}else 1===a&&(n=o.return)&&n.call(o),a<2&&(u=TypeError("The iterator does not provide a '"+l+"' method"),a=1);o=e}else if((n=(d=p.n<0)?u:t.call(r,p))!==i)break}catch(n){o=e,a=1,u=n}finally{c=1}}return{value:n,done:d}}}(t,l,a),!0),s}var i={};function c(){}function s(){}function d(){}n=Object.getPrototypeOf;var p=[][r]?n(n([][r]())):(o(n={},r,function(){return this}),n),f=d.prototype=c.prototype=Object.create(p);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,a,"GeneratorFunction")),e.prototype=Object.create(f),e}return s.prototype=d,o(f,"constructor",d),o(d,"constructor",s),s.displayName="GeneratorFunction",o(d,a,"GeneratorFunction"),o(f),o(f,a,"Generator"),o(f,r,function(){return this}),o(f,"toString",function(){return"[object Generator]"}),(l=function(){return{w:u,m:m}})()}function o(e,n,t,r){var l=Object.defineProperty;try{l({},"",{})}catch(e){l=0}o=function(e,n,t,r){function a(n,t){o(e,n,function(e){return this._invoke(n,t,e)})}n?l?l(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r}):e[n]=t:(a("next",0),a("throw",1),a("return",2))},o(e,n,t,r)}function a(e,n,t,r,l,o,a){try{var u=e[o](a),i=u.value}catch(e){return void t(e)}u.done?n(i):Promise.resolve(i).then(r,l)}function u(e){return function(){var n=this,t=arguments;return new Promise(function(r,l){var o=e.apply(n,t);function u(e){a(o,r,l,u,i,"next",e)}function i(e){a(o,r,l,u,i,"throw",e)}u(void 0)})}}function i(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return c(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}System.register(["./base-lib-legacy.js?v=1763689792","./index.vue_vue_type_script_setup_true_lang-legacy13.js?v=1763689792","./utils-lib-legacy.js?v=1763689792","./index-legacy107.js?v=1763689792","./useStore-legacy4.js?v=1763689792","./validator-legacy.js?v=1763689792","./index-legacy76.js?v=1763689792","./site-legacy.js?v=1763689792","./index-legacy119.js?v=1763689792"],function(e,n){"use strict";var r,o,a,c,s,d,p,f,m,v,_,w,g,y,j,b,h,x,V,k,O,U,C,D,S,I,N,P,q,A,B,E,F,T,G,M,R,W,z,L,$,H,J,Q,K,X,Y,Z,ee,ne,te,re;return{setters:[function(e){r=e.c,o=e.r,a=e.aB,c=e.g,s=e.w,d=e.x,p=e.O,f=e.C,m=e.e,v=e.A,_=e.z,w=e.y,g=e.b1,y=e.F,j=e.D,b=e.G,h=e.B,x=e.R,V=e.m,k=e.an,O=e.ad,U=e.aT,C=e.V,D=e.aA,S=e.am,I=e.M,N=e.H,P=e.L,q=e.ap},function(e){A=e._},function(e){B=e.L,E=e.k,F=e.cf,T=e.Q,G=e.bR,M=e.d,R=e.N,W=e.e,z=e.hv,L=e.ho},function(e){$=e._},function(e){H=e.u},function(e){J=e.f},function(e){Q=e.n,K=e.g,X=e.i,Y=e.o,Z=e.u,ee=e.s},function(e){ne=e.checkPathStatus,te=e.getRunList},function(e){re=e.B}],execute:function(){var n={class:"flex items-center"},le={class:"flex items-center"},oe={key:0,class:"text-small ml-[0.8rem] text-tertiary"},ae={key:0,class:"text-danger text-small"},ue=r({__name:"advanced-config",props:{ps:{},rowData:{}},setup:function(e,t){var r,l=t.expose,u=e,I=o(),N=o((null===(r=u.rowData)||void 0===r?void 0:r.project_name)||!1),P=o(!1),q=a("nodeData",{user_list:[]}),A=B({data:function(){var e,n,t,r,l=(null===(e=q.value)||void 0===e||null===(e=e.user_list)||void 0===e?void 0:e.length)&&-1===(null===(n=q.value.user_list)||void 0===n?void 0:n.findIndex(function(e){return"www"===e}));return{run_user:N.value?(null===(t=u.rowData)||void 0===t?void 0:t.run_user)||"":l?q.value.user_list[0]:"www",port:(null===(r=u.rowData)||void 0===r?void 0:r.port)||"",release_firewall:!1,project_ps:(null==u?void 0:u.ps)||"",domains:""}},options:function(){return c(function(){return[{type:"slots",key:"custom",rules:{run_user:[{required:!0,message:"请选择运行用户",trigger:"change"}]}}]})}}),F=A.BtForm,T=A.param;return s(function(){return u.ps},function(e){T.value.project_ps=e||""},{immediate:!0}),l({formData:T,popover:I}),function(e,t){var r=S,l=k,o=O,a=E,c=U,s=C,A=D;return d(),p(_(F),V({class:"mt-2rem"},e.$attrs),{custom:f(function(){return[m(o,{label:"运行用户",prop:"run_user"},{default:f(function(){return[v("div",n,[m(l,{modelValue:_(T).run_user,"onUpdate:modelValue":t[0]||(t[0]=function(e){return _(T).run_user=e}),class:"mr-8px !w-[16rem]"},{default:f(function(){return[(d(!0),w(y,null,g(_(q).user_list,function(e,n){return d(),p(r,{key:n,label:e,value:e},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"]),t[7]||(t[7]=v("span",{class:"text-small text-secondary"},"* 无特殊需求请选择www用户",-1))])]}),_:1}),m(o,{label:"项目端口"},{default:f(function(){var e,n,r;return[v("div",le,[m(a,{width:"20rem",type:"number",class:"mr-12px !w-[20rem]",min:1,max:65535,modelValue:_(T).port,"onUpdate:modelValue":t[1]||(t[1]=function(e){return _(T).port=e}),placeholder:"请输入项目的真实端口"},null,8,["modelValue"]),_(N)?b("",!0):(d(),w(y,{key:0},[""===_(T).port?(d(),w("span",oe,"* 若不清楚端口可不填写")):(d(),p(s,{key:1,modelValue:_(T).release_firewall,"onUpdate:modelValue":t[2]||(t[2]=function(e){return _(T).release_firewall=e})},{default:f(function(){return[t[9]||(t[9]=j(" 放行端口 ",-1)),m(c,{class:"item",effect:"dark",content:"选中将在防火墙安全组放行监听端口，放行后该项目可在外网访问",placement:"right"},{default:f(function(){return i(t[8]||(t[8]=[v("i",{class:"svgtofont-el-question text-warning"},null,-1)]))}),_:1})]}),_:1},8,["modelValue"]))],64))]),!_(N)||null===(e=u.rowData)||void 0===e||null===(e=e.listen)||void 0===e||!e.length||null!==(n=u.rowData)&&void 0!==n&&null!==(n=n.listen)&&void 0!==n&&n.includes(_(T).port)?b("",!0):(d(),w("span",ae," 项目端口可能有误，检测到当前项目监听了以下端口[ "+h(null===(r=u.rowData)||void 0===r||null===(r=r.listen)||void 0===r?void 0:r.join(","))+" ]",1))]}),_:1}),m(o,{label:"项目备注"},{default:f(function(){return[m(a,{modelValue:_(T).project_ps,"onUpdate:modelValue":t[3]||(t[3]=function(e){return _(T).project_ps=e}),placeholder:"请输入项目备注",width:"24rem"},null,8,["modelValue"])]}),_:1}),_(N)?b("",!0):(d(),p(o,{key:0,label:"绑定域名"},{default:f(function(){return[m(A,{ref_key:"popover",ref:I,placement:"top-start","popper-class":"green-tips-popover !p-0",title:"",width:"400",visible:_(P),"onUpdate:visible":t[6]||(t[6]=function(e){return x(P)?P.value=e:null}),"trigger-keys":[],trigger:"focus"},{reference:f(function(){return[m(a,{rows:6,resize:"none",width:"40rem",modelValue:_(T).domains,"onUpdate:modelValue":t[4]||(t[4]=function(e){return _(T).domains=e}),onFocus:t[5]||(t[5]=function(e){return P.value=!0}),type:"textarea",placeholder:"如需填写多个域名，请换行填写，每行一个域名，默认为80端口\nIP地址格式：192.168.1.199\n泛解析添加方法 *.domain.com\n如另加端口格式为 www.domain.com:88"},null,8,["modelValue"])]}),default:f(function(){return[t[10]||(t[10]=v("div",{class:"!p-[12px] bg-primary text-white"},[j(" 如需填写多个域名，请换行填写，每行一个域名，默认为80端口"),v("br"),j(" IP地址格式：192.168.1.199"),v("br"),j(" 泛解析添加方法 *.domain.com"),v("br"),j(" 如另加端口格式为 www.domain.com:88 ")],-1))]}),_:1},8,["visible"])]}),_:1}))]}),_:1},16)}}}),ie={key:0,class:"ml-8px text-small text-danger leading-[2rem]"},ce={class:"flex items-center"},se={class:"flex items-center"},de={class:"flex items-center custom-refresh-select"},pe={class:"el-input-group__append !h-3rem !flex items-center"},fe={class:"flex items-center"},me={key:0,class:"pl-[12rem]"},ve=(e("_",r({__name:"node-project",setup:function(e,n){var r,s,h=n.expose,x=H().siteInfo,V=o(!1),U=o([]),D=o(""),P=o(Q.value.nodejs_versions),q=o(Q.value.package_managers),z=o(),L=a("getNodeData",function(e){}),re=function(){var e=u(l().m(function e(){var n,t;return l().w(function(e){for(;;)switch(e.n){case 0:return t=console,e.n=1,L(!0);case 1:return t.log.call(t,"刷新Node版本",e.v),e.n=2,L(!0);case 2:n=e.v,P.value=n.nodejs_versions;case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),le=function(){var e;J({type:"dir",path:je.value.project_cwd,change:(e=u(l().m(function e(n){var t,r,o,a;return l().w(function(e){for(;;)switch(e.n){case 0:if(je.value.project_cwd=n,X.value){e.n=3;break}return r=null===(t=n.substring(n.lastIndexOf("/")+1))||void 0===t?void 0:t.replace(/\W/g,"_"),je.value.project_name||(je.value.project_name=r),D.value=r,e.n=1,_e(je.value.project_cwd);case 1:return o=e.v,Object.assign(je.value,o),e.n=2,oe(n);case 2:(a=e.v).node_modules&&(je.value.not_install_pkg=!0),V.value=!a.package_json;case 3:return e.a(2)}},e)})),function(n){return e.apply(this,arguments)})})},oe=function(){var e=u(l().m(function e(n){var t,r;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,T({request:ne({path:n})});case 1:return t=e.v,r=t.data,e.a(2,r)}},e)}));return function(n){return e.apply(this,arguments)}}(),ae=function(){J({type:"file",path:je.value.project_cwd,change:function(e){je.value.userCmd=e}})},ve=function(){var e=u(l().m(function e(n){var t;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Z(n);case 1:t=e.v,q.value=t,je.value.pkg_manager=t[0]||"";case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),_e=function(){var e=u(l().m(function e(n){var t,r,o,a,u;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return t={},e.p=1,e.n=2,te({data:JSON.stringify({project_cwd:n})});case 2:return r=e.v,o=G(r.data,"object",{}),0===Object.keys(o).length?t.project_script="0":(a=Object.keys(o),U.value=a.map(function(e){return{label:e+":"+o[e],value:e}}),t.project_script=a[0]||""),X.value&&(u=x.value.project_config.project_script,t.project_script=u,t.userCmd=u,!U.value.find(function(e){return e.value===u})&&(t.project_script="0")),e.a(2,t);case 3:return e.p=3,e.v,e.a(2,t)}},e,null,[[1,3]])}));return function(n){return e.apply(this,arguments)}}(),we=B({data:(s=u(l().m(function e(){var n,r,o,a,u,i;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,K();case 1:if(q.value=Q.value.package_managers,P.value=Q.value.nodejs_versions,!X.value){e.n=3;break}return o=x.value,a=o.project_config,u=o.ps,e.n=2,_e(a.project_cwd);case 2:return i=e.v,D.value=u,e.a(2,t(t({},a),{},{project_type:a.project_type||"nodejs",userCmd:""},i));case 3:return e.a(2,{project_name:"",project_script:"",project_cwd:"/www/wwwroot",project_type:"nodejs",pkg_manager:(null===(n=q.value)||void 0===n?void 0:n.at(0))||"",not_install_pkg:!1,run_user:"www",nodejs_version:(null===(r=P.value)||void 0===r?void 0:r.at(0))||"",userCmd:""})}},e)})),function(){return s.apply(this,arguments)}),options:function(e){return c(function(){return[{type:"slots",key:"custom",rules:{project_cwd:[F({message:"请输入项目启动目录"})],project_name:[F({message:"请输入项目名称"})],nodejs_version:[{required:!0,message:"请选择Node版本",trigger:["blur","change"]}],project_script:[F({message:"请选择项目启动脚本"})]}}]})},submit:(r=u(l().m(function e(n,r){var o;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r();case 1:return o=z.value.formData,e.a(2,t(t(t({},n.value),{},{project_script:"0"===n.value.project_script?n.value.userCmd:n.value.project_script},o),{},{domains:o.domains?o.domains.split("\n"):[]}))}},e)})),function(e,n){return r.apply(this,arguments)})}),ge=we.BtForm,ye=we.submit,je=we.param,be=function(){var e=u(l().m(function e(){var n;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,ye();case 1:n=e.v,ee(n);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();return h({submit:ye}),function(e,n){var r=$,l=O,o=E,a=S,u=k,c=M,s=R,h=W,B=C,F=A,T=N;return d(),w("div",{class:"overflow-auto",style:I({"max-height":_(X)?"76rem":"50rem"})},[m(_(ge),{"label-width":"80px"},{custom:f(function(){return[m(l,{label:"项目目录",prop:"project_cwd"},{default:f(function(){return[v("div",null,[m(r,{modelValue:_(je).project_cwd,"onUpdate:modelValue":n[0]||(n[0]=function(e){return _(je).project_cwd=e}),readOnly:"",icon:"el-folder-opened",placeholder:"请选择Node项目目录",onIconClick:le,width:"32rem"},null,8,["modelValue"]),_(V)?(d(),w("div",ie,"* 文件夹中未检测到package.json文件，建议前往传统项目进行项目添加")):b("",!0)])]}),_:1}),m(l,{label:"项目名称",prop:"project_name"},{default:f(function(){return[m(o,{disabled:_(X),modelValue:_(je).project_name,"onUpdate:modelValue":n[1]||(n[1]=function(e){return _(je).project_name=e}),width:"32rem",placeholder:"请输入Node项目名称"},null,8,["disabled","modelValue"])]}),_:1}),m(l,{label:"启动选项",prop:"project_script"},{default:f(function(){return[v("div",ce,[m(u,{placeholder:"请选择项目目录进行操作",modelValue:_(je).project_script,"onUpdate:modelValue":n[2]||(n[2]=function(e){return _(je).project_script=e}),class:"!w-[30rem]",disabled:"/www/wwwroot/"===_(je).project_cwd||"/www/wwwroot"===_(je).project_cwd},{default:f(function(){return[m(a,{label:"自定义启动命令",value:"0"}),(d(!0),w(y,null,g(_(U),function(e){return d(),p(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])}),128))]}),_:1},8,["modelValue","disabled"]),n[7]||(n[7]=v("span",{class:"ml-8px text-small"},"* 自动获取package.json文件中的启动模式",-1))])]}),_:1}),"0"===_(je).project_script?(d(),p(l,{key:0,label:" "},{default:f(function(){return[m(r,{modelValue:_(je).userCmd,"onUpdate:modelValue":n[3]||(n[3]=function(e){return _(je).userCmd=e}),placeholder:"请输入自定义启动命令",icon:"el-folder-opened",onIconClick:ae,width:"32rem"},null,8,["modelValue"])]}),_:1})):b("",!0),m(l,{label:"Node版本",prop:"nodejs_version"},{default:f(function(){return[v("div",se,[v("div",de,[m(u,{modelValue:_(je).nodejs_version,"onUpdate:modelValue":n[4]||(n[4]=function(e){return _(je).nodejs_version=e}),class:"!w-[16rem]",onChange:ve},{default:f(function(){return[(d(!0),w(y,null,g(_(P),function(e){return d(),p(a,{key:e,label:e,value:e},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"]),v("div",pe,[m(s,{title:"刷新Node版本",class:"!flex",onClick:re},{default:f(function(){return[m(c,{icon:"el-refresh",class:"!text-base"})]}),_:1})])]),n[9]||(n[9]=v("span",{class:"ml-8px text-small text-secondary"},"* 请根据项目选择合适的Node版本，",-1)),m(h,{onClick:_(Y)},{default:f(function(){return i(n[8]||(n[8]=[j("安装其他版本",-1)]))}),_:1},8,["onClick"])])]}),_:1}),m(l,{label:"包管理器"},{default:f(function(){return[v("div",fe,[m(u,{modelValue:_(je).pkg_manager,"onUpdate:modelValue":n[5]||(n[5]=function(e){return _(je).pkg_manager=e}),class:"!w-[16rem]"},{default:f(function(){return[(d(!0),w(y,null,g(_(q),function(e,n){return d(),p(a,{key:n,label:e,value:e},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"]),n[11]||(n[11]=v("span",{class:"text-small text-[#666 mx-8px"},"* 请选择项目的包管理器",-1)),_(X)?b("",!0):(d(),p(B,{key:0,modelValue:_(je).not_install_pkg,"onUpdate:modelValue":n[6]||(n[6]=function(e){return _(je).not_install_pkg=e})},{default:f(function(){return i(n[10]||(n[10]=[j(" 不安装node_module ",-1)]))}),_:1},8,["modelValue"]))])]}),_:1})]}),_:1}),m(F,{isShowDivider:!_(X)},{config:f(function(){var e,n;return[m(ue,{ref_key:"advancedConfigRef",ref:z,"label-width":"80px",type:"node",rowData:t(t({},null===(e=_(x))||void 0===e?void 0:e.project_config),{},{listen:null===(n=_(x))||void 0===n?void 0:n.listen}),ps:_(D)},null,8,["rowData","ps"])]}),_:1},8,["isShowDivider"]),_(X)?(d(),w("div",me,[m(T,{type:"primary",onClick:be},{default:f(function(){return i(n[12]||(n[12]=[j("保存修改",-1)]))}),_:1})])):b("",!0),n[13]||(n[13]=v("ul",{class:"mt-[8px] leading-8 text-small list-disc ml-32px"},[v("li",null,"【启动选项】：默认读取package.json中的scripts列表，也可以选择[自定义启动命令]选项来手动输入启动命令"),v("li",null,"【自定义启动命令】：可以选择启动文件，或直接输入启动命令，支持的启动方式：例：npm/node/pm2/yarn"),v("li",null,"【项目端口】：错误的端口会导致访问502，若不知道端口，可先随意填写，启动项目后再改为正确端口"),v("li",null,"【运行用户】：为了安全考虑，默认使用www用户运行，root用户运行可能带来安全风险")],-1))],4)}}})),{class:"flex items-center"}),_e={class:"flex items-center custom-refresh-select"},we={class:"el-input-group__append !h-3rem !flex items-center"},ge={key:1,class:"mt-2rem"},ye={class:"flex items-center"},je={class:"flex items-center"},be={class:"text-small text-secondary ml-[0.8rem]"},he={class:"flex items-center"},xe={key:2,class:"mt-2rem"},Ve={class:"flex items-center"},ke={key:0,class:"mb-[2rem]"},Oe=(e("a",r({__name:"pm-project",props:{compData:{default:function(){return{isEdit:!1}}}},setup:function(e,n){var r,s,x=n.expose,V=H().siteInfo,U=o(Q.value.nodejs_versions),D=o(Q.value.package_managers),T=c(function(){return X.value?V.value.ps:se.value.project_name}),G=o(),ne=a("getNodeData",function(e){}),te=function(){var e=u(l().m(function e(n){var t,r;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,L({path:n});case 1:return t=e.v,r=t.data,e.a(2,r.data);case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(n){return e.apply(this,arguments)}}(),le=function(e,n){var t;J({type:n,path:"file"===e?se.value.project_file:se.value.project_cwd,change:(t=u(l().m(function n(t){var r,o,a,u,i,c;return l().w(function(n){for(;;)switch(n.n){case 0:if(r=se.value.project_name,"cwd"!==e){n.n=1;break}se.value.project_cwd=t,a=null===(o=t.substring(t.lastIndexOf("/")+1))||void 0===o?void 0:o.replace(/\W/g,"_"),r||(se.value.project_name=a),n.n=3;break;case 1:if(se.value.project_cwd=t.substring(0,t.lastIndexOf("/")),i=null===(u=se.value.project_cwd.substring(se.value.project_cwd.lastIndexOf("/")+1))||void 0===u?void 0:u.replace(/\W/g,"_"),r||(se.value.project_name=i),"file"===e&&(se.value.project_file=t),"config_file"!==e){n.n=3;break}return se.value.config_file=t,n.n=2,te(t);case 2:c=n.v,se.value.config_body=c;case 3:return n.a(2)}},n)})),function(e){return t.apply(this,arguments)})})},oe=function(){var e=u(l().m(function e(n){var t;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Z(n);case 1:t=e.v,D.value=t,se.value.pkg_manager=t[0]||"";case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}(),ae=B({data:(s=u(l().m(function e(){var n,r,o,a,u;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,K();case 1:if(D.value=Q.value.package_managers,U.value=Q.value.nodejs_versions,!X.value){e.n=2;break}return o=V.value,a=o.project_config,u=o.ps,e.a(2,t(t({},a),{},{project_ps:z(u),watch:"true"===a.watch}));case 2:return e.a(2,{add_type:0,project_name:"",project_type:"pm2",project_cwd:"",project_file:"",pkg_manager:(null===(n=D.value)||void 0===n?void 0:n.at(0))||"yarn",not_install_pkg:!1,nodejs_version:(null===(r=U.value)||void 0===r?void 0:r.at(0))||"",cluster:1,max_memory_limit:1024,watch:!1,config_file:"",config_body:"",project_args:"",env:""})}},e)})),function(){return s.apply(this,arguments)}),options:function(){return c(function(){return[{type:"slots",key:"custom",rules:{project_name:[F({message:"请输入项目名称"})],project_file:[{required:!0,message:"请输入项目启动文件",trigger:["blur","change"]}],nodejs_version:[{required:!0,message:"请选择Node版本",trigger:["blur","change"]}],project_cwd:[F({message:"请输入项目启动目录"})],cluster:[{required:!0,message:"请输入负载实例数量",trigger:["blur","change"]}],max_memory_limit:[{required:!0,message:"请输入内存上限",trigger:["blur","change"]}]}}]})},submit:(r=u(l().m(function e(n,r){var o,a;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,r();case 1:return a=G.value.formData,0===(o=t(t(t({},n.value),a),{},{domains:a.domains?a.domains.split("\n"):[]})).add_type&&(delete o.config_file,delete o.config_body),delete o.add_type,e.a(2,o)}},e)})),function(e,n){return r.apply(this,arguments)})}),ie=ae.BtForm,ce=ae.submit,se=ae.param,de=(ae.clearValidate,function(){var e=u(l().m(function e(){var n;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,ce();case 1:n=e.v,ee(n);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}());return x({submit:ce}),function(e,n){var t=E,r=O,l=S,o=k,a=M,u=R,c=W,s=$,x=q,B=C,F=re,z=A,L=N;return d(),w("div",{class:"overflow-auto",style:I({"max-height":_(X)?"68rem":"55rem"})},[m(_(ie),{"label-width":"90px"},{custom:f(function(){return[m(r,{label:"项目名称",prop:"project_name"},{default:f(function(){return[m(t,{modelValue:_(se).project_name,"onUpdate:modelValue":n[0]||(n[0]=function(e){return _(se).project_name=e}),width:"32rem",disabled:_(X),placeholder:"请输入Node项目名称"},null,8,["modelValue","disabled"])]}),_:1}),_(X)&&_(se).pm2_name?(d(),p(r,{key:0,label:"PM2服务名"},{default:f(function(){return[m(t,{modelValue:_(se).pm2_name,"onUpdate:modelValue":n[1]||(n[1]=function(e){return _(se).pm2_name=e}),width:"32rem",disabled:""},null,8,["modelValue"])]}),_:1})):b("",!0),m(r,{label:"Node版本",prop:"nodejs_version"},{default:f(function(){return[v("div",ve,[v("div",_e,[m(o,{onChange:oe,modelValue:_(se).nodejs_version,"onUpdate:modelValue":n[2]||(n[2]=function(e){return _(se).nodejs_version=e}),class:"!w-[16rem]"},{default:f(function(){return[(d(!0),w(y,null,g(_(U),function(e){return d(),p(l,{key:e,label:e,value:e},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"]),v("div",we,[m(u,{title:"刷新Node版本",class:"!flex",onClick:n[3]||(n[3]=function(e){return _(ne)(!0)})},{default:f(function(){return[m(a,{icon:"el-refresh",class:"!text-base"})]}),_:1})])]),n[21]||(n[21]=v("span",{class:"ml-8px text-small text-secondary"},"* 请根据项目选择合适的Node版本，",-1)),m(c,{onClick:_(Y)},{default:f(function(){return i(n[20]||(n[20]=[j("安装其他版本",-1)]))}),_:1},8,["onClick"])])]}),_:1}),0===_(se).add_type?(d(),w("div",ge,[m(r,{label:"启动文件",prop:"project_file"},{default:f(function(){return[m(s,{modelValue:_(se).project_file,"onUpdate:modelValue":n[4]||(n[4]=function(e){return _(se).project_file=e}),readOnly:"",icon:"el-folder-opened",placeholder:"请选择项目启动文件",onIconClick:n[5]||(n[5]=function(e){return le("file","file")}),width:"32rem"},null,8,["modelValue"])]}),_:1}),m(r,{label:"运行目录",prop:"project_cwd"},{default:f(function(){return[m(s,{modelValue:_(se).project_cwd,"onUpdate:modelValue":n[6]||(n[6]=function(e){return _(se).project_cwd=e}),readOnly:"",icon:"el-folder-opened",placeholder:"请选择项目运行目录",onIconClick:n[7]||(n[7]=function(e){return le("cwd","dir")}),width:"32rem"},null,8,["modelValue"])]}),_:1}),m(r,{label:"负载实例数量",prop:"cluster"},{default:f(function(){return[v("div",ye,[m(t,{width:"10rem",class:"!w-[10rem]",type:"number",modelValue:_(se).cluster,"onUpdate:modelValue":n[8]||(n[8]=function(e){return _(se).cluster=e}),min:1},null,8,["modelValue"]),n[22]||(n[22]=v("span",{class:"text-small text-secondary ml-[0.8rem]"},"* 若实例数量大于1，则开启集群模式",-1))])]}),_:1}),m(r,{label:"内存上限",prop:"max_memory_limit"},{default:f(function(){return[v("div",je,[m(t,{width:"16rem",class:"!w-[16rem]",type:"number","text-type":"MB",min:1,modelValue:_(se).max_memory_limit,"onUpdate:modelValue":n[9]||(n[9]=function(e){return _(se).max_memory_limit=e})},null,8,["modelValue"]),v("span",be,"* 超过上限PM2会自动重启项目，系统最大可用内存为["+h(_(Q).maximum_memory)+"MB]",1)])]}),_:1}),m(r,{label:"自动重载"},{default:f(function(){return[m(x,{modelValue:_(se).watch,"onUpdate:modelValue":n[10]||(n[10]=function(e){return _(se).watch=e})},null,8,["modelValue"])]}),_:1}),m(r,{label:"包管理器"},{default:f(function(){return[v("div",he,[m(o,{modelValue:_(se).pkg_manager,"onUpdate:modelValue":n[11]||(n[11]=function(e){return _(se).pkg_manager=e}),class:"!w-[16rem]"},{default:f(function(){return[(d(!0),w(y,null,g(_(D),function(e,n){return d(),p(l,{key:n,label:e,value:e},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"]),n[24]||(n[24]=v("span",{class:"text-small text-[#666 mx-8px"},"* 请选择项目的包管理器",-1)),_(X)?b("",!0):(d(),p(B,{key:0,modelValue:_(se).not_install_pkg,"onUpdate:modelValue":n[12]||(n[12]=function(e){return _(se).not_install_pkg=e})},{default:f(function(){return i(n[23]||(n[23]=[j(" 不安装node_module ",-1)]))}),_:1},8,["modelValue"]))])]}),_:1})])):(d(),w("div",xe,[m(r,{label:"配置文件"},{default:f(function(){return[v("div",Ve,[m(s,{modelValue:_(se).config_file,"onUpdate:modelValue":n[13]||(n[13]=function(e){return _(se).config_file=e}),readOnly:"",icon:"el-folder-opened",placeholder:"请选择项目配置文件",onIconClick:n[14]||(n[14]=function(e){return le("config_file","file")}),width:"32rem"},null,8,["modelValue"]),n[25]||(n[25]=v("span",{class:"text-small text-tertiary leading-[18px] ml-4px"},"* 请选择pm2的ecosystem配置文件或粘贴内容",-1))])]}),_:1}),m(r,{label:"运行目录",prop:"project_cwd"},{default:f(function(){return[m(s,{modelValue:_(se).project_cwd,"onUpdate:modelValue":n[15]||(n[15]=function(e){return _(se).project_cwd=e}),readOnly:"",icon:"el-folder-opened",placeholder:"请选择项目运行目录",onIconClick:n[16]||(n[16]=function(e){return le("cwd","dir")}),width:"30rem"},null,8,["modelValue"])]}),_:1}),m(r,{label:"内容",prop:"config_body"},{default:f(function(){return[m(F,{modelValue:_(se).config_body,"onUpdate:modelValue":n[17]||(n[17]=function(e){return _(se).config_body=e}),style:{height:"24rem"},class:"!h-[24rem] w-[58rem]"},null,8,["modelValue"])]}),_:1})])),m(z,{"is-show-divider":!_(X)},{config:f(function(){var e;return[0===_(se).add_type?(d(),w("div",ke,[m(r,{label:"参数"},{default:f(function(){return[m(t,{width:"32rem ",placeholder:"请输入项目参数",modelValue:_(se).project_args,"onUpdate:modelValue":n[18]||(n[18]=function(e){return _(se).project_args=e})},null,8,["modelValue"])]}),_:1}),m(r,{label:"环境变量"},{default:f(function(){return[m(t,{width:"32rem",placeholder:"请输入项目环境变量，一行一个",resize:"none",rows:3,modelValue:_(se).env,"onUpdate:modelValue":n[19]||(n[19]=function(e){return _(se).env=e}),type:"textarea"},null,8,["modelValue"])]}),_:1})])):b("",!0),m(ue,{ref_key:"advanceConfigRef",ref:G,"label-width":"90px",rowData:null===(e=_(V))||void 0===e?void 0:e.project_config,ps:_(T)},null,8,["rowData","ps"])]}),_:1},8,["is-show-divider"])]}),_:1}),_(X)?(d(),p(L,{key:0,type:"primary",class:"!mt-[1.2rem] !ml-10rem",onClick:de},{default:f(function(){return i(n[26]||(n[26]=[j(" 保存修改 ",-1)]))}),_:1})):b("",!0),v("ul",{class:P(["mt-[8px] leading-8 text-small list-disc ml-32px",{"mb-[20px]":_(X)}])},i(n[27]||(n[27]=[v("li",null,"【启动文件】用于启动nodejs项目的启动文件，通常是一个js文件",-1),v("li",null,"【配置文件】用于pm2直接启动服务的文件，通常是名为ecosystem.config.cjs",-1),v("li",null,"【运行目录】运行项目时默认的运行目录，通常为启动文件或配置文件所在目录",-1),v("li",null,"【负载实例数】集群模式，有些项目可能不支持，实例数量>1时为开启集群模式",-1),v("li",null,"【负载均衡】开启集群模式后将根据实例数自动负载均衡",-1)])),2)],4)}}})),{class:"flex items-center"}),Ue={class:"flex items-center custom-refresh-select"},Ce={class:"el-input-group__append !h-3rem !flex items-center"};e("b",r({__name:"traditional-project",props:{compData:{default:function(){return{isEdit:!1}}}},setup:function(e,n){var r=n.expose,s=H().siteInfo,h=o(Q.value.nodejs_versions);o(Q.value.package_managers);var x,V,U=o(),C=a("getNodeData",function(e){}),D=function(){var e=u(l().m(function e(n,t){return l().w(function(e){for(;;)switch(e.n){case 0:J({type:t,path:"file"===n?G.value.project_file:G.value.project_cwd,change:function(){var e=u(l().m(function e(t){var r,o,a,u,i;return l().w(function(e){for(;;)switch(e.n){case 0:"file"===n?G.value.project_file=t:G.value.project_cwd=t,r=G.value.project_name,"cwd"===n&&""===r&&(a=null===(o=t.substring(t.lastIndexOf("/")+1))||void 0===o?void 0:o.replace(/\W/g,"_"),G.value.project_name=a),"file"===n&&(G.value.project_cwd=t.substring(0,t.lastIndexOf("/")),i=null===(u=G.value.project_cwd.substring(G.value.project_cwd.lastIndexOf("/")+1))||void 0===u?void 0:u.replace(/\W/g,"_"),""===r&&(G.value.project_name=i));case 1:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}()});case 1:return e.a(2)}},e)}));return function(n,t){return e.apply(this,arguments)}}(),P=B({data:(V=u(l().m(function e(){var n,t;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,K();case 1:if(h.value=Q.value.nodejs_versions,!X.value){e.n=2;break}return e.a(2,null===(t=s.value)||void 0===t?void 0:t.project_config);case 2:return e.a(2,{project_name:"",nodejs_version:(null===(n=h.value)||void 0===n?void 0:n.at(0))||"",project_file:"",project_cwd:"",project_type:"general",project_args:"",env:""})}},e)})),function(){return V.apply(this,arguments)}),options:function(){return c(function(){return[{type:"slots",key:"custom",rules:{project_name:[F({message:"请输入项目名称"})],nodejs_version:[{required:!0,message:"请选择Node版本",trigger:["blur","change"]}],project_file:[{required:!0,message:"请输入项目启动文件",trigger:["blur","change"]}],project_cwd:[F({message:"请输入项目启动目录"})]}}]})},submit:(x=u(l().m(function e(n,r){var o,a;return l().w(function(e){for(;;)switch(e.n){case 0:return o=!1,e.n=1,r();case 1:return a=U.value.formData,o=t(t(t({},n.value),a),{},{domains:a.domains?a.domains.split("\n"):[]}),e.a(2,o)}},e)})),function(e,n){return x.apply(this,arguments)})}),q=P.BtForm,T=P.submit,G=P.param,z=function(){var e=u(l().m(function e(){var n;return l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,T();case 1:n=e.v,ee(n);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();return r({submit:T}),function(e,n){var r=E,l=O,o=S,a=k,u=M,c=R,x=W,V=$,P=A,B=N;return d(),w("div",{class:"overflow-auto",style:I({"max-height":_(X)?"76rem":"52rem"})},[m(_(q),{"label-width":"80px"},{custom:f(function(){return[m(l,{label:"项目名称",prop:"project_name"},{default:f(function(){return[m(r,{modelValue:_(G).project_name,"onUpdate:modelValue":n[0]||(n[0]=function(e){return _(G).project_name=e}),width:"32rem",disabled:_(X),placeholder:"请输入项目名称"},null,8,["modelValue","disabled"])]}),_:1}),m(l,{label:"Node版本",prop:"nodejs_version"},{default:f(function(){return[v("div",Oe,[v("div",Ue,[m(a,{modelValue:_(G).nodejs_version,"onUpdate:modelValue":n[1]||(n[1]=function(e){return _(G).nodejs_version=e}),class:"!w-[16rem]"},{default:f(function(){return[(d(!0),w(y,null,g(_(h),function(e){return d(),p(o,{key:e,label:e,value:e},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"]),v("div",Ce,[m(c,{title:"刷新Node版本",class:"!flex",onClick:n[2]||(n[2]=function(e){return _(C)(!0)})},{default:f(function(){return[m(u,{icon:"el-refresh",class:"!text-base"})]}),_:1})])]),n[10]||(n[10]=v("span",{class:"ml-8px text-small text-secondary"},"* 请根据项目选择合适的Node版本，",-1)),m(x,{onClick:_(Y)},{default:f(function(){return i(n[9]||(n[9]=[j("安装其他版本",-1)]))}),_:1},8,["onClick"])])]}),_:1}),m(l,{label:"启动文件",prop:"project_file"},{default:f(function(){return[m(V,{modelValue:_(G).project_file,"onUpdate:modelValue":n[3]||(n[3]=function(e){return _(G).project_file=e}),readOnly:"",placeholder:"请选择项目启动文件",icon:"el-folder-opened",onIconClick:n[4]||(n[4]=function(e){return D("file","file")}),width:"32rem"},null,8,["modelValue"])]}),_:1}),m(l,{label:"运行目录",prop:"project_cwd"},{default:f(function(){return[m(V,{modelValue:_(G).project_cwd,"onUpdate:modelValue":n[5]||(n[5]=function(e){return _(G).project_cwd=e}),readOnly:"",placeholder:"请选择项目运行目录",icon:"el-folder-opened",onIconClick:n[6]||(n[6]=function(e){return D("cwd","dir")}),width:"32rem"},null,8,["modelValue"])]}),_:1}),m(l,{label:"参数"},{default:f(function(){return[m(r,{width:"32rem ",placeholder:"请输入项目参数",modelValue:_(G).project_args,"onUpdate:modelValue":n[7]||(n[7]=function(e){return _(G).project_args=e})},null,8,["modelValue"])]}),_:1}),m(l,{label:"环境变量"},{default:f(function(){return[m(r,{width:"32rem",placeholder:"请输入项目环境变量，一行一个，格式参照key=value",resize:"none",rows:3,modelValue:_(G).env,"onUpdate:modelValue":n[8]||(n[8]=function(e){return _(G).env=e}),type:"textarea"},null,8,["modelValue"])]}),_:1})]}),_:1}),m(P,{"is-show-divider":!_(X)},{config:f(function(){var e,n;return[m(ue,{ref_key:"advanceConfigRef",ref:U,"label-width":"80px",rowData:t(t({},null===(e=_(s))||void 0===e?void 0:e.project_config),{},{listen:null===(n=_(s))||void 0===n?void 0:n.listen}),ps:_(G).project_name},null,8,["rowData","ps"])]}),_:1},8,["is-show-divider"]),_(X)?(d(),p(B,{key:0,type:"primary",class:"!mt-[1.2rem] !ml-10rem",onClick:z},{default:f(function(){return i(n[11]||(n[11]=[j(" 保存修改 ",-1)]))}),_:1})):b("",!0),n[12]||(n[12]=v("ul",{class:"mt-8px leading-8 text-small list-disc ml-32px"},[v("li",null,"【启动文件】用于启动nodejs项目的启动文件，通常是一个js文件"),v("li",null,"【运行目录】运行项目时默认的运行目录，通常为启动文件或配置文件所在目录")],-1))],4)}}}))}}})}();
