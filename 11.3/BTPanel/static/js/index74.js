import{u as e,b3 as t,an as a,q as s,ao as l,cN as o,cM as n,H as i,ap as r,j as p}from"./utils-lib.js?v=1763689792";import{_ as c}from"./index109.js?v=1763689792";import{_ as u}from"./index124.js?v=1763689792";import{_ as d}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1763689792";import{delSorted as m,addSiteTypes as _,modifySiteTypes as f,removeSiteType as v}from"./site.js?v=1763689792";import{B as h}from"./index138.js?v=1763689792";import{u as b}from"./index147.js?v=1763689792";import{c as x,t as g,s as k,w as C,e as y,D as j,H as w,v as P,n as S,x as B,y as R,z as H,C as L,A as I,L as T,R as W}from"./base-lib.js?v=1763689792";import"./validator.js?v=1763689792";import"./index.vue_vue_type_style_index_0_scoped_cdc7f4d3_lang.js?v=1763689792";import{a as E,b as A,d as D,k as N,l as V,g as q,u as O}from"./column.js?v=1763689792";import{b as M,c as F,d as z,e as K,f as Q,g as U}from"./useController6.js?v=1763689792";import{S as G}from"./useStore4.js?v=1763689792";import{S as J,a as X,p as Y,b as Z,c as $,d as ee,t as te,e as ae,f as se,g as le,r as oe,h as ne,i as ie,j as re,k as pe,l as ce,m as ue,n as de,q as me}from"./useController5.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index137.js?v=1763689792";import"./index110.js?v=1763689792";import"./index131.js?v=1763689792";import"./index107.js?v=1763689792";import"./useMethod5.js?v=1763689792";const _e={class:"p-[20px] pb-[24px]"},fe=x({__name:"index",setup(x){const{payment:fe,mainHeight:ve,plugin:he,enterpriseRec:be}=e();g(fe.value);const{activeType:xe,isRefreshList:ge,searchWidth:ke}=k(G()),{getClassList:Ce}=G(),{pluginInfo:ye,scanData:je}=k(J()),{getPhpList:we}=J();C(Q,e=>{(null==e?void 0:e.pluginInfo)&&(ye.value=e.pluginInfo)},{immediate:!0,deep:!0});const Pe=b({key:"type",name:"PHP分类",options:()=>[{label:"全部分类",value:"all"}],event:{get:async()=>{const{data:e}=await Ce();return ce.value=e,e},add:e=>_(e,xe.value),update:e=>f(e,xe.value),delete:e=>v(e,xe.value)},ignore:["0","-2"],field:"name"}),Se=r(me),{BtOperation:Be}=t({options:[{type:"button",label:"添加站点",active:!0,onClick:X},{type:"dropdown",label:"高级设置",onClick:Y,options:[{label:"修改默认页面",onClick:Y},{label:"默认站点",onClick:()=>Y("defaultSite")},{label:"PHP命令行版本",onClick:()=>Y("phpCommandLine")},{label:"HTTPS防窜站",onClick:()=>Y("httpsOfficersSite")},{label:"TLS设置",onClick:()=>Y("tlsSetting")},{label:"全局设置",onClick:()=>Y("globalSetting")},{label:"关联数据库",onClick:()=>Y("associatedDatabase")}]},...be.value?[{type:"custom",render:()=>y(w,{onClick:()=>M("all")},{default:()=>[j("网站统计总览")]})},{type:"custom",render:()=>y(w,{onClick:Z},{default:()=>{var e,t;return[j("漏洞扫描"),y("span",{class:"ml-4px py-1px px-4px text-center font-bold ".concat((null==(e=je.value)?void 0:e.loophole_num)>0?"text-danger":"text-warning")},[null==(t=je.value)?void 0:t.loophole_num])]}})},{type:"custom",render:()=>y(w,{onClick:$},{default:()=>{var e,t;return[j("网站安全"),y("span",{class:"ml-4px py-1px px-4px text-center font-bold ".concat((null==(e=je.value)?void 0:e.web_scaning_times)>0?"text-danger":"text-warning")},[null==(t=je.value)?void 0:t.web_scaning_times])]}})}]:[],{type:"custom",render:()=>y(h,{class:"ml-1rem",isRequest:!1,pluginInfo:ye.value},null)}]}),{BtTable:Re,BtPage:He,BtRefresh:Le,BtTableCategory:Ie,BtRecommendSearch:Te,BtColumn:We,BtBatch:Ee,BtErrorMask:Ae,refresh:De,categoryRef:Ne,config:Ve}=a({request:async e=>{const{type:t,...a}=e,l=await we({type:s(t)||"all"===t?"-1":t,...a,table:"sites",order:Ve.order||""}),o=ee("/site/php_column");return l.data.forEach(e=>{e.isWaf=!(null==o?void 0:o.length)||o[1].isCustom}),te.value=l.data,l},sort:async({column:e,prop:t,order:a})=>{let s=t;if(a){let e={orderName:s,orderStatus:"ascending"===a?"asc":"desc"};Ve.order="".concat(e.orderName," ").concat(e.orderStatus)}else s="",await m(),Ve.order="";De()},columns:[E({type:"page",key:"id"}),{subtitle:"WAF图标",isCustom:!0,isLtd:!0,isHide:!0,showClick:e=>{Ve.data.forEach(t=>{t.isWaf=e})}},F({label:"网站名",type:xe.value,openPlugin:ae,onClick:se}),A({width:80,sortable:"custom",event:ue,data:["已停止","运行中"]}),{label:"备份",width:65,isCustom:!0,render:e=>y("span",{onClick:()=>le(e),class:"".concat(e.backup_count?"text-primary":"text-warning"," cursor-pointer")},[e.backup_count?"有(".concat(e.backup_count,")"):"无备份"])},D({prop:"path",labelClassName:"php-table-path",minWidth:140}),...be.value?[{...N({event:e=>se({...e,tabName:"flowQuota"},"directory")}),isCustom:!1},V({storageKey:"/site/php_day_metric",onClick:M})]:[],z(),q({table:"sites",minWidth:110,width:"auto"}),{label:"PHP",isCustom:!0,minWidth:80,width:80,render:e=>{let t=!e.php_version_status;return y("span",{class:"cursor-pointer "+(t&&"静态"!==e.php_version?"bt-warn":"bt-link"),onClick:()=>se(e,"php")},[t&&"静态"!==e.php_version?e.php_version+"[未安装]":"其它"==e.php_version?"自定义":e.php_version])}},K({onClick:e=>{se(e,"ssl")}}),O([{onClick:e=>{ae(e,"monitor-setting")},title:"统计"},{onClick:e=>{ae(e,"bt_waf")},title:"WAF"},{title:"设置",onClick:e=>se(e)},{title:"删除",onClick:e=>de(e)}])],extension:[Pe,Se,l(ge),o("search",{name:"sites",key:"php",list:oe.value}),n()],empty:()=>y("span",null,[j("您的列表为空，您可以"),y("span",{class:"bt-link",onClick:X},[j("添加一个项目")])])});return P(()=>{S(()=>{ne.value=Ne(),i(()=>import("./index383.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),i(()=>import("./index248.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),be.value&&ie()})}),(e,t)=>{const a=u,s=p,l=c;return B(),R("div",null,[y(d,{ref_key:"envRef",ref:Q,onInit:H(De)},null,8,["onInit"]),y(H(Ae)),y(l,null,{"header-left":L(()=>[y(H(Be)),I("div",{class:"flex items-center ml-1rem",onClick:t[0]||(t[0]=(...e)=>H(U)&&H(U)(...e))},[...t[2]||(t[2]=[I("i",{class:"svgtofont-desired text-medium"},null,-1),I("span",{class:"bt-link"},"需求反馈",-1)])])]),"header-right":L(()=>[y(H(Ie),{class:"!w-[140px] mr-[10px]"}),y(H(Te),{type:"php",placeholder:"请输入域名或备注",class:T(["mr-[10px]","!w-[".concat(H(ke),"px]")])},null,8,["class"]),y(H(Le),{class:"mr-[10px]"}),y(H(We))]),content:L(()=>[y(H(Re))]),"footer-left":L(()=>[y(H(Ee))]),"footer-right":L(()=>[y(H(He))]),popup:L(()=>[y(s,{title:"插件预览",modelValue:H(re),"onUpdate:modelValue":t[1]||(t[1]=e=>W(re)?re.value=e:null),area:66},{default:L(()=>[I("div",_e,[y(a,{data:H(pe)},null,8,["data"])])]),_:1},8,["modelValue"])]),_:1})])}}});export{fe as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
