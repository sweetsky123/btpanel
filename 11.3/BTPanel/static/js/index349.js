import{L as e,hy as a,j as s,e as l,ci as t,X as r,_ as o}from"./utils-lib.js?v=1763689792";import{_ as i}from"./index109.js?v=1763689792";import{c as m,s as u,g as n,r as p,w as d,v as c,x as v,y as g,e as f,C as b,D as j,z as h,A as w,R as x,H as _}from"./base-lib.js?v=1763689792";import{b as y,j as S}from"./form-item.js?v=1763689792";import{u as C}from"./column.js?v=1763689792";import{s as F,a as L,b as V,d as q}from"./index56.js?v=1763689792";import{L as D}from"./useController10.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./useStore7.js?v=1763689792";import"./index350.js?v=1763689792";import"./config.js?v=1763689792";import"./index130.js?v=1763689792";import"./index123.js?v=1763689792";import"./validator.js?v=1763689792";import"./index107.js?v=1763689792";import"./firewall.js?v=1763689792";import"./useStore8.js?v=1763689792";const k={class:"p-[20px]"},B={class:"p-[2rem]"},I={class:"p-[2rem]"},E={class:"list-disc mt-[20px] pl-[28px]"},H={class:"h-[2.4rem]"},P=o(m({__name:"index",setup(o){const m=D(),{sForm:P,sendSource:T,logSystemDialog:U,logSystemForm:z,sourceForm:A,logSystemData:O,logSystemLoad:R,logSysForm:X,logSystemList:G}=u(m),{getLogSystemData:J,getLogSystemSite:K,sendSourceConfirm:M}=m,{BtForm:N,submit:Q}=e({data:z.value,options:e=>n(()=>[y("IP","ip",{attrs:{placeholder:"日志服务系统的ip",clearable:!0,class:"!w-22rem"},rules:[{required:!0,validator:(e,a,s)=>{t(a)||s(new Error("请输入正确的IP")),s()},trigger:["blur","change"]}]}),y("端口","port",{attrs:{placeholder:"请输入端口号",clearable:!0,"controls-position":"right",class:"!w-22rem",type:"number"},rules:[{required:!0,validator:(e,a,s)=>{r(a)&&a||s(new Error("请输入正确的端口(范围为1-65535)")),s()},trigger:["blur","change"]}]})]),submit:async(e,a,s)=>(await a(),await F(e.value))}),W=p({site:[],ip:z.value.port?z.value.ip+":"+z.value.port:"未配置"});d(z,e=>{G.value[0].ip,W.value.ip=e.port?e.ip+":"+e.port:"未配置"},{deep:!0});const{BtForm:Y,submit:Z}=e({data:W.value,options:e=>n(()=>[S("网站","site",L.value,{attrs:{multiple:!0,collapseTags:!0,class:"!w-22rem"},rules:[{required:!0,message:"请选择网站",trigger:"change"}]}),y("日志系统","ip",{attrs:{disabled:!0,class:"!w-22rem"}})]),submit:async(e,a,s)=>(await a(),await V({...e.value,server_id:G.value.length?G.value[0].id:""}))}),{BtTable:$}=a({request:J,columns:[{label:"已设置站点",prop:"site_name"},C([{onClick:q,title:"删除"}])]});return c(()=>{K()}),(e,a)=>{const t=_,r=i,o=s,m=l;return v(),g("div",k,[f(r,null,{"header-left":b(()=>[f(t,{onClick:a[0]||(a[0]=e=>T.value=!0),type:"primary"},{default:b(()=>[...a[5]||(a[5]=[j(" 设置发送源 ",-1)])]),_:1}),f(t,{onClick:a[1]||(a[1]=e=>U.value=!0)},{default:b(()=>[...a[6]||(a[6]=[j("日志服务系统配置",-1)])]),_:1})]),content:b(()=>[f(h($),{"max-height":"360"}),a[7]||(a[7]=w("ul",{class:"list-disc w-[50rem] pl-[1rem] mt-[12px] text-secondary"},[w("li",null,"注意：网站被访问后才会在日志服务系统中显示")],-1))]),_:1}),f(o,{title:"设置发送源",modelValue:h(T),"onUpdate:modelValue":a[2]||(a[2]=e=>x(T)?T.value=e:null),"show-footer":!0,area:[40],onConfirm:h(Z)},{default:b(()=>[w("div",B,[f(h(Y),{"label-width":"80px"})])]),_:1},8,["modelValue","onConfirm"]),f(o,{title:"日志服务系统配置",modelValue:h(U),"onUpdate:modelValue":a[3]||(a[3]=e=>x(U)?U.value=e:null),"show-footer":!0,area:[40],onConfirm:h(Q),onCancel:a[4]||(a[4]=e=>(U.value=!1,R.value=!1,void(G.value.length>0&&Object.assign(z.value,G.value[0]))))},{default:b(()=>[w("div",I,[f(h(N),{"label-width":"80px"}),w("ul",E,[w("li",H,[f(m,{href:"https://www.bt.cn/bbs/thread-120054-1-1.html"},{default:b(()=>[...a[8]||(a[8]=[j(" 如何配置日志服务系统 ",-1)])]),_:1})]),a[9]||(a[9]=w("li",null,"端口：日志服务收集端口，请在安装“日志服务系统”的机器通过 btlogs 8 获取",-1))])])]),_:1},8,["modelValue","onConfirm"])])}}}),[["__scopeId","data-v-a699a992"]]);export{P as default};
