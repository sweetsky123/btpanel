import{_ as a,n as e,H as t,p as s,Q as l,b as n,az as o,V as r,l as i,ah as c}from"./utils-lib.js?v=1763689792";import{_ as u}from"./index109.js?v=1763689792";import{c as d,Z as m,x as p,y as v,e as _,C as y,A as f,F as w,al as b,aj as g,ba as h,r as x,v as k,I,J as j,z as V,R as D,D as T,b1 as C,ap as M,b2 as L,H as P,B as H,M as q}from"./base-lib.js?v=1763689792";import{a as S,s as U,e as E}from"./useMethod10.js?v=1763689792";import{a as R,u as A,c as F}from"./column.js?v=1763689792";import{aW as z,aX as O,aY as Z,aZ as B}from"./firewall.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";const J={class:"ml-8px"},Q=a(d({__name:"date",props:{type:{},typeModifiers:{},value:{default:()=>[]},valueModifiers:{}},emits:["update:type","update:value"],setup(a){const e=m(a,"type"),t=m(a,"value");function s(a=new Date){const e=U(a),t=E(a);return[e.getTime(),t.getTime()]}const l=a=>{switch(a){case"today":t.value=s();break;case"yesterday":t.value=s(S(new Date,-1))}},n=a=>{const e=new Date,t=S(e,-30);return U(t).getTime()>a||E(e).getTime()<a},o=a=>{e.value="custom",t.value=[U(a[0]).getTime(),E(a[1]).getTime()]};return(a,s)=>{const r=b,i=g,c=h;return p(),v(w,null,[_(i,{class:"network-custom-radio",modelValue:e.value,"onUpdate:modelValue":s[0]||(s[0]=a=>e.value=a),onChange:l},{default:y(()=>[_(r,{label:"今日",value:"today"}),_(r,{label:"昨日",value:"yesterday"})]),_:1},8,["modelValue"]),f("div",J,[_(c,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=a=>t.value=a),type:"daterange","disabled-date":n,onChange:o},null,8,["modelValue"])])],64)}}}),[["__scopeId","data-v-f355f5ec"]]),W={class:"sn-home"},X={class:"sn-home-switch"},Y={class:"flex items-center"},G={class:"flex items-center"},K={class:"sn-home-overview sn-home-overview-green"},N={class:"mt-[2rem]"},$={class:"sn-home-overview-item-title"},aa=a(d({__name:"index",setup(a){const d=x(!1),m=x(!1),b=x([]),g=x(),h=x([{title:"今日扫描次数",value:0,style:"color: var(--el-color-text-primary)"},{title:"今日扫描IP数",value:0,style:"color: var(--el-color-text-primary)"},{title:"总扫描次数",value:0,style:"color: var(--el-color-text-primary)"}]),S=x({type:"today",data:J()}),U=x(),E=[R({key:"scan_ip"}),{label:"扫描IP",prop:"scan_ip"},{label:"扫描类型",prop:"scan_type"},{label:"今日扫描次数",render:a=>a.scan_count_today.toLocaleString()||0},{label:"总扫描次数",render:a=>a.total_scan_count.toLocaleString()||0},{label:"被扫描的端口",render:a=>_("div",{innerHTML:a.scanned_ports,title:a.scanned_ports,class:"max-w-[25rem] truncate"},null)},{label:"扫描开始时间",prop:"scan_start_time"},{label:"扫描持续时间",render:a=>ra(a.scan_duration)},A([{onClick:a=>{e({title:"".concat(a.scan_ip," 扫描详情"),area:50,compData:{ip:a.scan_ip},showFooter:!1,component:()=>t(()=>import("./datails.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},title:"详情"},{onClick:async a=>{await s({title:"封禁IP",content:"是否封禁【".concat(a.scan_ip,"】24小时？")}),await l({loading:"正在执行，请稍后...",request:z({ip:a.scan_ip,timeout:86400}),success:a=>{n().request(a)}})},title:"封锁"}])];function J(){const{start:a,end:e}=function(a){const e=new Date(a);e.setHours(0,0,0,0);const t=new Date(a);return t.setHours(23,59,59,999),{start:e,end:t}}(new Date);return[a.getTime(),e.getTime()]}const aa=()=>{na()},ea=async()=>{try{await l({loading:"正在设置扫描感知开关,请稍后...",request:O({switch_type:"scan_sensing",status:m.value}),success:a=>{o(a.data.data)&&!a.status?n().error(a.msg+"【"+a.data.data+"】"):n().request(a)}})}catch(a){}},ta=async()=>{await s({title:"导出IP列表",content:"确定要导出当前扫描IP列表吗？"}),await l({loading:"正在执行，请稍后...",request:Z(),success:a=>{a.data.status?window.open("/download?filename="+a.data.url,"_blank","noopener,noreferrer"):n().error(a.data.msg)}})},sa=async()=>{await e({title:"高级配置",area:45,compData:{config:U.value},showFooter:!1,component:()=>t(()=>import("./advanced.js?v=1763689792"),__vite__mapDeps([]),import.meta.url)})},la=[{label:"封锁",value:"lock",event:async(a,e,t,s)=>{const l=async(a,e)=>{const{scan_ip:t}=a,s=new Map([["lock",z]]).get(o);if("lock"===o)if(s)return await s({ip:t,timeout:86400})},{label:n,value:o}=s;await a({title:"批量".concat(n),content:"即将批量".concat(n,"选中的IP，是否继续操作?"),column:[{label:"批量封锁",prop:"scan_ip"},F()],onConfirm:async()=>(await e(l),na(),!1)})}}],na=async()=>{const{data:a}=await B(oa()),e=a.overview;h.value[0].value=e.scan_count_today.toLocaleString(),h.value[1].value=e.ip_count_today.toLocaleString(),h.value[2].value=e.total_scan_count.toLocaleString(),m.value=e.scan_status,U.value=e,b.value=a.scan_info},oa=()=>({start_timestamp:r(S.value.data[0],"yyyy-MM-dd"),end_timestamp:r(S.value.data[1],"yyyy-MM-dd")}),ra=a=>{const e=a.split(":"),t=parseInt(e[0]),s=parseInt(e[1]),l=parseInt(e[2]);return t>999?"999+":"00:00:00"===a?"-":"".concat(60*t+s,"分").concat(l,"秒")},ia=()=>{S.value.data=J(),b.value=[],na()};return k(()=>ia()),(a,e)=>{const t=M,s=L,l=P,n=i,o=c,r=u,x=I("bt-loading");return j((p(),v("div",W,[f("div",X,[f("div",Y,[e[3]||(e[3]=f("div",{class:"mr-4 text-small"},"扫描感知",-1)),_(t,{modelValue:V(m),"onUpdate:modelValue":e[0]||(e[0]=a=>D(m)?m.value=a:null),width:36,onChange:ea},null,8,["modelValue"])]),f("div",null,[f("div",G,[_(Q,{type:V(S).type,"onUpdate:type":e[1]||(e[1]=a=>V(S).type=a),value:V(S).data,"onUpdate:value":[e[2]||(e[2]=a=>V(S).data=a),aa]},null,8,["type","value"]),_(s,{direction:"vertical"}),_(l,{onClick:ia},{default:y(()=>[...e[4]||(e[4]=[T("刷新",-1)])]),_:1}),_(l,{onClick:ta},{default:y(()=>[...e[5]||(e[5]=[T("导出",-1)])]),_:1}),_(l,{onClick:sa},{default:y(()=>[...e[6]||(e[6]=[T("高级配置",-1)])]),_:1})])])]),f("div",K,[e[7]||(e[7]=f("div",{class:"text-secondary text-base"},"扫描概览",-1)),f("div",N,[(p(!0),v(w,null,C(V(h),(a,e)=>(p(),v("div",{class:"sn-home-overview-item",key:e},[f("div",$,H(a.title),1),f("div",{class:"sn-home-overview-item-num",style:q(a.style)},H(a.value),5)]))),128))])]),_(r,null,{content:y(()=>[_(n,{ref_key:"scanListRef",ref:g,column:E,data:V(b),"max-height":"400"},null,8,["data"])]),"footer-left":y(()=>[_(o,{"table-ref":V(g),options:la},null,8,["table-ref"])]),_:1})])),[[x,V(d)]])}}}),[["__scopeId","data-v-22bf9b29"]]);export{aa as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
