!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){u(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function u(t,r,n){return(r=function(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,r||"default");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function l(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function u(r,n,o,u){var l=n&&n.prototype instanceof c?n:c,s=Object.create(l.prototype);return a(s,"_invoke",function(r,n,o){var u,l,a,c=0,s=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,r){return u=t,l=0,a=e,p.n=r,i}};function d(r,n){for(l=r,a=n,t=0;!f&&c&&!o&&t<s.length;t++){var o,u=s[t],d=p.p,v=u[2];r>3?(o=v===n)&&(a=u[(l=u[4])?5:(l=3,3)],u[4]=u[5]=e):u[0]<=d&&((o=r<2&&d<u[1])?(l=0,p.v=n,p.n=u[1]):d<v&&(o=r<3||u[0]>n||n>v)&&(u[4]=r,u[5]=n,p.n=v,l=0))}if(o||r>1)return i;throw f=!0,n}return function(o,s,v){if(c>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,v),l=s,a=v;(t=l<2?e:a)||!f;){u||(l?l<3?(l>1&&(p.n=-1),d(l,a)):p.n=a:p.v=a);try{if(c=2,u){if(l||(o="next"),t=u[o]){if(!(t=t.call(u,a)))throw TypeError("iterator result is not an object");if(!t.done)return t;a=t.value,l<2&&(l=0)}else 1===l&&(t=u.return)&&t.call(u),l<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),l=1);u=e}else if((t=(f=p.n<0)?a:r.call(n,p))!==i)break}catch(t){u=e,l=1,a=t}finally{c=1}}return{value:t,done:f}}}(r,o,u),!0),s}var i={};function c(){}function s(){}function f(){}t=Object.getPrototypeOf;var p=[][n]?t(t([][n]())):(a(t={},n,function(){return this}),t),d=f.prototype=c.prototype=Object.create(p);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,a(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=f,a(d,"constructor",f),a(f,"constructor",s),s.displayName="GeneratorFunction",a(f,o,"GeneratorFunction"),a(d),a(d,o,"Generator"),a(d,n,function(){return this}),a(d,"toString",function(){return"[object Generator]"}),(l=function(){return{w:u,m:v}})()}function a(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}a=function(e,t,r,n){function u(t,r){a(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(u("next",0),u("throw",1),u("return",2))},a(e,t,r,n)}function i(e,t,r,n,o,u,l){try{var a=e[u](l),i=a.value}catch(e){return void r(e)}a.done?t(i):Promise.resolve(i).then(n,o)}function c(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var u=e.apply(t,r);function l(e){i(u,n,o,l,a,"next",e)}function a(e){i(u,n,o,l,a,"throw",e)}l(void 0)})}}System.register(["./utils-lib-legacy.js?v=1763689792","./api-legacy.js?v=1763689792","./store-legacy5.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792"],function(e,r){"use strict";var n,u,a,i,s,f,p,d,v,m,b,y,g,h,P,w,j,O,k,_,S,A,C,V,T,E,x;return{setters:[function(e){n=e.H},function(e){u=e.s,a=e.j,i=e.k,s=e.g,f=e.b,p=e.l},function(e){d=e.a,v=e.t},function(e){m=e.c,b=e.z,y=e.r,g=e.o,h=e.v,P=e.I,w=e.x,j=e.y,O=e.O,k=e.C,_=e.D,S=e.G,A=e.e,C=e.A,V=e.J,T=e.R,E=e.F,x=e.b1},null],execute:function(){var B={class:"p-2rem"};e("default",m({__name:"rules-table",props:{dependencies:{default:function(){return{}}}},setup:function(e,m){var I=m.expose,F=e,D=b(F.dependencies.components),G=D.BtDialog,U=D.ElButton,R=D.BtTable,H=D.BtInput,q=D.BtTableGroup,M=D.ElTooltip,N=D.ElForm,z=D.ElFormItem,J=D.ElSelect,$=D.ElOption,K=b(F.dependencies.hooks),L=K.useAxios,Q=K.useMessage,W=K.useConfirm,X=K.useDialog,Y=b(F.dependencies.custom),Z=Y.setPortConfig,ee=Y.useOperate,te=Y.portsPs,re=[{label:"TCP",value:"tcp"},{label:"UDP",value:"udp"}],ne=Q(),oe=y(!1),ue=y(!1),le=y(!1),ae=y([]),ie=y(!1),ce=y(!1),se=y(),fe=g({Port:"",CidrBlock:"",ps:"",Protocol:""}),pe=y(!1),de=y(!1),ve=g({Port:[{required:!0,message:"请输入端口",trigger:"blur"}],ps:[{validator:function(e,t,r){t&&(null==t?void 0:t.length)>60?r(new Error("备注不能超过60个字符")):r()},trigger:["blur","change"]}]}),me=function(){var e=c(l().m(function e(t){var r,n,o;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.n=1,W({icon:"warning",title:"删除防火墙规则",content:"删除后可能导致服务无法访问，是否继续操作？"});case 1:return e.p=1,r=ne.load("正在删除防火墙规则，请稍后..."),delete(n=t).FirewallRuleDescription,e.n=2,a(n);case 2:o=e.v,r.close(),ne.request(o),o.status&&ye(),e.n=4;break;case 3:e.p=3,e.v;case 4:return e.a(2)}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}(),be=function(){pe.value||de.value?we():(ue.value=!0,ye())},ye=function(){var e=c(l().m(function e(){var t;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return pe.value=!1,e.p=1,le.value=!0,e.n=2,i();case 2:t=e.v,de.value=!Array.isArray(t.data.FirewallRuleSet),ae.value=Array.isArray(t.data.FirewallRuleSet)?t.data.FirewallRuleSet:[],e.n=4;break;case 3:e.p=3,e.v,pe.value=!0;case 4:return e.p=4,le.value=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),ge=function(){var e=c(l().m(function e(){var t,r,n,o;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,s();case 1:return t=e.v,!1===(null==(r=t.data)?void 0:r.status)&&null!=r&&r.msg&&(de.value=!0),e.n=2,f();case 2:n=e.v,"lighthouse"===(null==(o=n.data)?void 0:o.server_type)&&(oe.value=!0),d.value=o,v.value="cvm"===o.server_type,e.n=4;break;case 3:e.p=3,e.v;case 4:return e.a(2)}},e,null,[[0,3]])}));return function(){return e.apply(this,arguments)}}(),he=function(e){return{label:"端口",prop:"Port",renderHeader:function(){return e="防火墙会加载系统所有端口信息，IPV6端口无法与IPV4分开管理，非必要勿删除IPV6端口",A("div",null,[A("span",null,["端口"]),A(M,{content:e,placement:"top"},{default:function(){return[A("span",{class:"ml-4x bt-ico-ask"},["?"])]}})]);var e},width:300,render:function(t){t.brief=t.brief||te[t.Port];var r=ae.value.some(function(e){return e.Port===t.Port}),n=["20","21","22","80","443","8888","3306"].includes(t.Port);return A("div",null,[A("span",{class:"mr-[1rem]"},[t.Port+("ipv6"===t.Family?"（ipv6）":"")]),r||n||!1===e?"":A("span",{class:"bt-link cursor-pointer",onClick:function(){var e;Pe({Port:t.Port,CidrBlock:"all"!==t.Address?t.Address:"",ps:null===(e=t.brief)||void 0===e?void 0:e.substring(0,60),Protocol:t.Protocol})}},[_("点击放行，腾讯云轻量云防火墙端口")])])}}},Pe=function(e){pe.value||de.value?we():(Oe(),ce.value=!!e,e&&Object.assign(fe,e),ie.value=!0)},we=function(e){(e=e||{}).alert=pe.value?"当前密钥错误，请重新关联API密钥":"",X({isAsync:!0,component:function(){return n(function(){return r.import("./config-legacy5.js?v=1763689792")},void 0,r.meta.url)},title:!1,area:[48],compData:o(o({},e),{},{dependencies:F.dependencies})})},je=function(){var e=c(l().m(function e(){var t,r,n;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,se.value.validate();case 1:return t=ne.load("正在添加防火墙规则，请稍后..."),r=o(o({},fe),{},{Protocol:fe.Protocol||"tcp",ActionType:"ACCEPT",CidrBlock:fe.CidrBlock||"0.0.0.0/0"}),e.n=2,p(r);case 2:n=e.v,t.close(),ne.request(n),n.status&&(ie.value=!1,ye()),e.n=4;break;case 3:e.p=3,e.v;case 4:return e.a(2)}},e,null,[[0,3]])}));return function(){return e.apply(this,arguments)}}(),Oe=function(){fe.Port="",fe.CidrBlock="",fe.ps="",fe.Protocol="tcp"},ke=y([{label:"应用类型",prop:"AppType"},{label:"来源",prop:"CidrBlock"},{label:"协议",prop:"Protocol",width:150},{label:"端口",prop:"Port",width:120},{label:"策略",prop:"Action",width:60,render:function(e){var t="ACCEPT"===e.Action;return A("span",{class:t?"text-primary":"text-danger"},[t?"允许":"拒绝"])}},ee([{onClick:me,isHide:function(){return 1===ae.value.length},title:"删除"}])]);return h(c(l().m(function e(){return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,u(L),e.n=1,ge();case 1:if(oe.value){e.n=2;break}return Z(he(!1)),e.a(2);case 2:return e.n=3,ye();case 3:Z(he()),e.n=5;break;case 4:e.p=4,e.v,Z(he(!1)),oe.value=!1;case 5:return e.a(2)}},e,null,[[0,4]])}))),I({getPortConfig:he}),function(e,r){var n=P("bt-loading");return w(),j("div",null,[b(oe)?(w(),O(b(U),{key:0,type:"default",class:"!mr-[1rem]",onClick:be},{default:k(function(){return t(r[7]||(r[7]=[_("轻量云防火墙规则",-1)]))}),_:1})):S("",!0),A(b(G),{modelValue:b(ue),"onUpdate:modelValue":r[1]||(r[1]=function(e){return T(ue)?ue.value=e:null}),title:"轻量云防火墙规则",area:[80]},{default:k(function(){return[C("div",B,[A(b(q),null,{"header-left":k(function(){return[A(b(U),{type:"primary",onClick:r[0]||(r[0]=function(e){return Pe()})},{default:k(function(){return t(r[8]||(r[8]=[_("添加规则",-1)]))}),_:1})]}),"header-right":k(function(){return t(r[9]||(r[9]=[]))}),content:k(function(){return[V(A(b(R),{ref:"ftpTable",column:b(ke),data:b(ae),description:"列表为空","max-height":360},null,8,["column","data"]),[[n,"正在加载轻量云防火墙规则列表，请稍后...","title"],[n,b(le)]])]}),_:1})])]}),_:1},8,["modelValue"]),A(b(G),{modelValue:b(ie),"onUpdate:modelValue":r[6]||(r[6]=function(e){return T(ie)?ie.value=e:null}),title:"添加轻量云防火墙规则","show-footer":!0,area:[48],onConfirm:je},{default:k(function(){return[A(b(N),{ref_key:"addRulesformRef",ref:se,class:"p-2rem",model:b(fe),rules:b(ve)},{default:k(function(){return[A(b(z),{label:"端口",prop:"Port"},{default:k(function(){return[A(b(H),{modelValue:b(fe).Port,"onUpdate:modelValue":r[2]||(r[2]=function(e){return b(fe).Port=e}),width:"30rem",disabled:b(ce),placeholder:"端口范围1到65535之间，支持端口放行范围80-90"},null,8,["modelValue","disabled"])]}),_:1}),A(b(z),{label:"协议",prop:"Protocol"},{default:k(function(){return[A(b(J),{modelValue:b(fe).Protocol,"onUpdate:modelValue":r[3]||(r[3]=function(e){return b(fe).Protocol=e}),class:"!w-[30rem]"},{default:k(function(){return[(w(),j(E,null,x(re,function(e){return A(b($),{key:e.value,label:e.label,value:e.value},null,8,["label","value"])}),64))]}),_:1},8,["modelValue"])]}),_:1}),A(b(z),{label:"允许访问IP"},{default:k(function(){return[A(b(H),{modelValue:b(fe).CidrBlock,"onUpdate:modelValue":r[4]||(r[4]=function(e){return b(fe).CidrBlock=e}),width:"30rem",disabled:b(ce),placeholder:"默认为空，表示所有来源，支持IP网段，可为空"},null,8,["modelValue","disabled"])]}),_:1}),A(b(z),{label:"备注",prop:"ps"},{default:k(function(){return[A(b(H),{modelValue:b(fe).ps,"onUpdate:modelValue":r[5]||(r[5]=function(e){return b(fe).ps=e}),rows:4,type:"textarea",width:"30rem",placeholder:"备注和说明，可为空"},null,8,["modelValue"])]}),_:1}),A(b(z),{label:""},{default:k(function(){return t(r[10]||(r[10]=[C("ul",{class:"pl-[4rem] list-disc text-secondary leading-[2.4rem] text-small"},[C("li",null,"支持添加多个端口，如：80,88"),C("li",null,"支持添加多个端口范围，如：80,88,90-99,110-120")],-1)]))}),_:1})]}),_:1},8,["model","rules"])]}),_:1},8,["modelValue"])])}}}))}}})}();
