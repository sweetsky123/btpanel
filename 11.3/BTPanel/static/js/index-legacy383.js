!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function n(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,r="function"==typeof Symbol?Symbol:{},l=r.iterator||"@@iterator",u=r.toStringTag||"@@toStringTag";function o(n,r,l,u){var o=r&&r.prototype instanceof i?r:i,c=Object.create(o.prototype);return a(c,"_invoke",function(n,a,r){var l,u,o,i=0,c=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return l=t,u=0,o=e,f.n=n,s}};function p(n,a){for(u=n,o=a,t=0;!d&&i&&!r&&t<c.length;t++){var r,l=c[t],p=f.p,m=l[2];n>3?(r=m===a)&&(o=l[(u=l[4])?5:(u=3,3)],l[4]=l[5]=e):l[0]<=p&&((r=n<2&&p<l[1])?(u=0,f.v=a,f.n=l[1]):p<m&&(r=n<3||l[0]>a||a>m)&&(l[4]=n,l[5]=a,f.n=m,u=0))}if(r||n>1)return s;throw d=!0,a}return function(r,c,m){if(i>1)throw TypeError("Generator is already running");for(d&&1===c&&p(c,m),u=c,o=m;(t=u<2?e:o)||!d;){l||(u?u<3?(u>1&&(f.n=-1),p(u,o)):f.n=o:f.v=o);try{if(i=2,l){if(u||(r="next"),t=l[r]){if(!(t=t.call(l,o)))throw TypeError("iterator result is not an object");if(!t.done)return t;o=t.value,u<2&&(u=0)}else 1===u&&(t=l.return)&&t.call(l),u<2&&(o=TypeError("The iterator does not provide a '"+r+"' method"),u=1);l=e}else if((t=(d=f.n<0)?o:n.call(a,f))!==s)break}catch(t){l=e,u=1,o=t}finally{i=1}}return{value:t,done:d}}}(n,l,u),!0),c}var s={};function i(){}function c(){}function d(){}t=Object.getPrototypeOf;var f=[][l]?t(t([][l]())):(a(t={},l,function(){return this}),t),p=d.prototype=i.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,a(e,u,"GeneratorFunction")),e.prototype=Object.create(p),e}return c.prototype=d,a(p,"constructor",d),a(d,"constructor",c),c.displayName="GeneratorFunction",a(d,u,"GeneratorFunction"),a(p),a(p,u,"Generator"),a(p,l,function(){return this}),a(p,"toString",function(){return"[object Generator]"}),(n=function(){return{w:o,m:m}})()}function a(e,t,n,r){var l=Object.defineProperty;try{l({},"",{})}catch(e){l=0}a=function(e,t,n,r){function u(t,n){a(e,t,function(e){return this._invoke(t,n,e)})}t?l?l(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(u("next",0),u("throw",1),u("return",2))},a(e,t,n,r)}function r(e,t,n,a,r,l,u){try{var o=e[l](u),s=o.value}catch(e){return void n(e)}o.done?t(s):Promise.resolve(s).then(a,r)}function l(e){return function(){var t=this,n=arguments;return new Promise(function(a,l){var u=e.apply(t,n);function o(e){r(u,a,l,o,s,"next",e)}function s(e){r(u,a,l,o,s,"throw",e)}o(void 0)})}}System.register(["./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./index-legacy107.js?v=1763689792","./validator-legacy.js?v=1763689792","./site-legacy.js?v=1763689792","./useStore-legacy4.js?v=1763689792","./useController-legacy5.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./column-legacy.js?v=1763689792","./useController-legacy6.js?v=1763689792","./useMethod-legacy5.js?v=1763689792"],function(t,a){"use strict";var r,u,o,s,i,c,d,f,p,m,v,b,y,w,g,h,_,V,x,S,j,P,k,T,O,U,q,C,F,D,A,I,G,H,M,N,E,L,R,z,J,Q,W,B,K,$;return{setters:[function(e){r=e.u,u=e.aH,o=e.bR,s=e.b6,i=e.n,c=e.H,d=e.aK,f=e.k,p=e.ax,m=e.e,v=e.b,b=e._},function(e){y=e.c,w=e.o,g=e.aB,h=e.r,_=e.g,V=e.v,x=e.x,S=e.y,j=e.e,P=e.C,k=e.z,T=e.R,O=e.J,U=e.A,q=e.D,C=e.G,F=e.O,D=e.F,A=e.b1,I=e.aA,G=e.ad,H=e.am,M=e.an,N=e.ab,E=e.c6},function(e){L=e._},function(e){R=e.k,z=e.f},function(e){J=e.addPhpSite,Q=e.GetPHPVersion},function(e){W=e.u},function(e){B=e.l,K=e.v,$=e.h},null,null,null,null,null],execute:function(){var X={class:""},Y={class:"items-center flex"},Z={class:"flex items-center mb-[8px]"},ee={class:"flex items-center"},te={class:"flex items-center mb-[4px]"},ne=y({__name:"index",props:{compData:{default:{}}},setup:function(t,b){var y=b.expose,ne=t,ae=r().panel,re=W().isRefreshList,le=v(),ue=w({database:!1,ftp:!1}),oe=g("popupClose"),se=h(!1),ie=h(),ce=h(!1),de=h({menuType:"addDefault",path:"/www/wwwroot",ftp:!1,type:"PHP",type_id:0,ps:"",port:"",version:"",need_index:0,need_404:0,sql:!1,codeing:"utf8mb4",webname:"",add_dns_record:!1,ftp_username:"",ftp_password:"",datauser:"",datapassword:""}),fe=h({ftp:!0,ftpStatus:!0,ftpData:{username:"",password:""},sql:!0,databaseStatus:!0,sqlData:{username:"",password:""},siteStatus:!1,site:{name:!1},dns:[],title:""}),pe="/www/wwwroot/",me=h([]),ve=_(function(){return B.value.filter(function(e){return"all"!==e.value&&Number(e.value)>=0})}),be=function(){var e;null!==(e=$.value)&&void 0!==e&&e.setClassManage&&$.value.setClassManage()},ye=function(){var e=l(n().m(function e(t){var a,r;return n().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,u({sName:t});case 1:a=e.v,r=a.data,R({name:r.name,type:"i",pluginInfo:r});case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),we=function(){z({type:"dir",path:de.value.path,change:function(e){var t,n=o(e,"string","");de.value.path=n,pe=null===(t=n+"/")||void 0===t?void 0:t.replace(/\/\//g,"/")}})},ge=function(){var e=l(n().m(function e(){var t,a,r;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Q();case 1:a=e.v,me.value=a.data,r="00",null===(t=me.value)||void 0===t||t.forEach(function(e){Number(e.version)>Number(r)&&(r=e.version)}),de.value.version=r,e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}(),he=function(e){var t,n,a,r;"string"==typeof e&&(de.value.ps=e.split("\n")[0],de.value.path=(null===(t=pe)||void 0===t?void 0:t.replace(/\/\//g,"/"))+(null===(n=e.split("\n")[0])||void 0===n||null===(n=n.replace(/:/g,"_"))||void 0===n?void 0:n.trim()),de.value.ftp_username=null===(a=e.split("\n")[0])||void 0===a?void 0:a.replace(/\W/g,"_"),de.value.ftp_password=s(16),de.value.datauser=null===(r=e.split("\n")[0])||void 0===r||null===(r=r.replace(/\W/g,"_"))||void 0===r?void 0:r.substr(0,16),de.value.datapassword=s(16))},_e=function(){var e=l(n().m(function e(t){var r,l,u,o,s;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return(r=Object.assign({},de.value)).ftp?(fe.value.ftpData.username=r.ftp_username,fe.value.ftpData.password=r.ftp_password):(delete r.ftp_username,delete r.ftp_password,fe.value.ftp=!1),r.sql?(fe.value.sqlData.username=r.datauser,fe.value.sqlData.password=r.datapassword):(delete r.datauser,delete r.datapassword,fe.value.sql=!1),-1!==r.webname.split("\n")[0].indexOf(":")?r.port=r.webname.split("\n")[0].split(":")[1]:r.port=80,l=r.webname.split("\n"),u=null==l?void 0:l.map(function(e){return e.split(":")[0]}),l.shift(),r.webname=JSON.stringify({domain:r.webname.split("\n")[0],domainlist:l,count:l.length}),delete r.menuType,e.n=1,ie.value.validate();case 1:return e.p=1,se.value=!0,e.n=2,J(r);case 2:o=e.v,de.value.add_dns_record&&o.status&&(fe.value.dns=u.filter(function(e){return e.length}).map(function(e){return{domain:e,status:!1,msg:""}}),fe.value.title=o.status?"添加网站成功":o.msg),o.status&&oe(),r.ftp||r.sql||fe.value.dns.length?(fe.value.ftpStatus=o.data.ftpStatus,fe.value.databaseStatus=o.data.databaseStatus,fe.value.siteStatus=o.data.siteStatus,fe.value.site.name=!1,i({isAsync:!0,title:"网站添加结果",area:46,component:function(){return c(function(){return a.import("./add-result-legacy.js?v=1763689792")},void 0,a.meta.url)},compData:fe.value})):le.msg({customClass:"bt-message-error-html",dangerouslyUseHTMLString:!0,message:o.status?"添加网站成功":o.msg,type:o.status?"success":"error",duration:o.status?3e3:0,showClose:!o.status}),re.value=!0,e.n=4;break;case 3:e.p=3,s=e.v,d(s);case 4:return e.p=4,se.value=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(t){return e.apply(this,arguments)}}(),Ve=function(){var e=l(n().m(function e(){var t,a,r,l;return n().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,ne.compData.getStatus();case 1:return a=e.v,ue.database=a.mysql,ue.ftp=a.ftp,de.value.type_id=null===(t=ve.value[0])||void 0===t?void 0:t.value,e.n=2,ge();case 2:(r=ae.value.sitePath)&&(de.value.path=r,pe=null===(l=r+"/")||void 0===l?void 0:l.replace(/\/\//g,"/"));case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();return V(Ve),y({init:Ve,onConfirm:_e}),function(t,n){var a=f,r=I,l=G,u=L,o=H,s=M,i=p,c=m,d=N,v=E;return x(),S("div",X,[j(d,{model:k(de),rules:k(K),disabled:k(se),ref_key:"addSiteFormRef",ref:ie},{default:P(function(){return[j(l,{label:"域名",prop:"webname"},{default:P(function(){return[j(r,{ref:"popover",placement:"top-start","popper-class":"green-tips-popover !p-0",title:"",width:"400",visible:k(ce),"onUpdate:visible":n[2]||(n[2]=function(e){return T(ce)?ce.value=e:null}),"trigger-keys":[],trigger:"focus"},{reference:P(function(){return[O(j(a,{onInput:he,modelValue:k(de).webname,"onUpdate:modelValue":n[0]||(n[0]=function(e){return k(de).webname=e}),type:"textarea",width:"52rem",rows:7,resize:"none",onFocus:n[1]||(n[1]=function(e){return ce.value=!0}),placeholder:"如需填写多个域名，请换行填写，每行一个域名，默认为80端口\nIP地址格式：192.168.1.199\n泛解析添加方法 *.domain.com\n如另加端口格式为 www.domain.com:88"},null,8,["modelValue"]),[[v,void 0,"popover"]])]}),default:P(function(){return[n[16]||(n[16]=U("div",{class:"!p-[12px] bg-primary text-white"},[q(" 如需填写多个域名，请换行填写，每行一个域名，默认为80端口 "),U("br"),q(" IP地址格式：192.168.1.199 "),U("br"),q(" 泛解析添加方法 *.domain.com "),U("br"),q(" 如另加端口格式为 www.domain.com:88 ")],-1))]}),_:1},8,["visible"])]}),_:1}),j(l,{label:"备注"},{default:P(function(){return[j(a,{modelValue:k(de).ps,"onUpdate:modelValue":n[3]||(n[3]=function(e){return k(de).ps=e}),placeholder:"请输入备注,可为空",width:"52rem"},null,8,["modelValue"])]}),_:1}),j(l,{label:"根目录",prop:"path"},{default:P(function(){return[j(u,{modelValue:k(de).path,"onUpdate:modelValue":n[4]||(n[4]=function(e){return k(de).path=e}),placeholder:"请输入根目录",icon:"el-folder-opened",width:"52rem",onIconClick:we},null,8,["modelValue"])]}),_:1}),j(l,{label:"FTP"},{default:P(function(){return[U("div",Y,[j(s,{class:"!w-[15rem]",modelValue:k(de).ftp,"onUpdate:modelValue":n[5]||(n[5]=function(e){return k(de).ftp=e}),disabled:!k(ue).ftp},{default:P(function(){return[j(o,{label:"不创建",value:!1}),j(o,{label:"创建",value:!0})]}),_:1},8,["modelValue","disabled"]),k(ue).ftp?C("",!0):(x(),S("span",{key:0,onClick:n[6]||(n[6]=function(e){return ye("pureftpd")}),class:"ml-[4px] text-danger cursor-pointer !text-small"},"未安装FTP，点击安装"))])]}),_:1}),k(de).ftp?(x(),F(l,{key:0,label:"FTP账号"},{default:P(function(){return[U("div",Z,[j(l,{prop:"ftp_username"},{default:P(function(){return[j(a,{placeholder:"创建FTP账号",modelValue:k(de).ftp_username,"onUpdate:modelValue":n[7]||(n[7]=function(e){return k(de).ftp_username=e}),width:"24rem"},null,8,["modelValue"])]}),_:1}),j(l,{label:"密码",class:"!mt-0"},{default:P(function(){return[j(a,{placeholder:"FTP密码",modelValue:k(de).ftp_password,"onUpdate:modelValue":n[8]||(n[8]=function(e){return k(de).ftp_password=e}),width:"24rem"},null,8,["modelValue"])]}),_:1})]),n[17]||(n[17]=U("span",{class:"text-tertiary text-small"},"创建站点的同时，为站点创建一个对应FTP帐户，并且FTP目录指向站点所在目录。",-1))]}),_:1})):C("",!0),j(l,{label:"数据库"},{default:P(function(){return[U("div",ee,[j(s,{class:"!w-[15rem]",modelValue:k(de).sql,"onUpdate:modelValue":n[9]||(n[9]=function(e){return k(de).sql=e}),disabled:!k(ue).database},{default:P(function(){return[j(o,{label:"不创建",value:!1}),j(o,{label:"MySQL",value:"MySQL"})]}),_:1},8,["modelValue","disabled"]),k(ue).database?C("",!0):(x(),S("span",{key:0,onClick:n[10]||(n[10]=function(e){return ye("mysql")}),class:"ml-[4px] text-danger cursor-pointer !text-small"},"未安装数据库，点击安装")),k(de).sql?(x(),F(s,{key:1,class:"ml-[8px] !w-[15rem]",modelValue:k(de).codeing,"onUpdate:modelValue":n[11]||(n[11]=function(e){return k(de).codeing=e})},{default:P(function(){return[j(o,{label:"utf8mb4",value:"utf8mb4"}),j(o,{label:"utf8",value:"utf8"}),j(o,{label:"gbk",value:"gbk"}),j(o,{label:"big5",value:"big5"})]}),_:1},8,["modelValue"])):C("",!0)])]}),_:1}),k(de).sql?(x(),F(l,{key:1,label:"数据库账号"},{default:P(function(){return[U("div",te,[j(l,{prop:"datauser"},{default:P(function(){return[j(a,{placeholder:"创建数据库账号",class:"w-[24rem]",modelValue:k(de).datauser,"onUpdate:modelValue":n[12]||(n[12]=function(e){return k(de).datauser=e})},null,8,["modelValue"])]}),_:1}),j(l,{label:"密码",class:"!mt-0"},{default:P(function(){return[j(a,{placeholder:"数据库密码",class:"w-[24rem]",modelValue:k(de).datapassword,"onUpdate:modelValue":n[13]||(n[13]=function(e){return k(de).datapassword=e})},null,8,["modelValue"])]}),_:1})]),n[18]||(n[18]=U("span",{class:"text-tertiary text-small"},"创建站点的同时，为站点创建一个对应的数据库帐户，方便不同站点使用不同数据库。",-1))]}),_:1})):C("",!0),j(l,{label:"PHP版本"},{default:P(function(){return[j(s,{class:"!w-[15rem]",modelValue:k(de).version,"onUpdate:modelValue":n[14]||(n[14]=function(e){return k(de).version=e})},{default:P(function(){return[(x(!0),S(D,null,A(k(me),function(e){return x(),F(o,{key:e.value,label:e.name,value:e.version},null,8,["label","value"])}),128))]}),_:1},8,["modelValue"])]}),_:1}),j(l,{label:"网站分类"},{default:P(function(){return[j(i,{modelValue:k(de).type_id,"onUpdate:modelValue":n[15]||(n[15]=function(e){return k(de).type_id=e}),options:k(ve),class:"!w-[15rem]"},null,8,["modelValue","options"]),j(c,{class:"ml-[8px]",onClick:be},{default:P(function(){return e(n[19]||(n[19]=[q("分类设置",-1)]))}),_:1})]}),_:1})]}),_:1},8,["model","rules","disabled"])])}}});t("default",b(ne,[["__scopeId","data-v-972dc027"]]))}}})}();
