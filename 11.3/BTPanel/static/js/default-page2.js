import{c as a,r as e,I as l,x as t,y as s,e as u,C as n,z as r,R as o,A as m,D as d,G as i,F as v,b1 as c,J as p,aD as w,V as f,an as h,H as y,O as b,am as x}from"./base-lib.js?v=1763689792";import{B as V}from"./index119.js?v=1763689792";import{u as g,Q as _,aC as j,b as C}from"./utils-lib.js?v=1763689792";import{getFileBody as B,getErrorConfig as D,setErrorConfig as S}from"./site.js?v=1763689792";import{S as k}from"./useStore4.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./ace.js?v=1763689792";const z={class:"flex flex-col"},G={class:"flex items-center justify-between mb-[8px]"},U={key:0},q={class:"h-[44rem] w-full"},F=a({__name:"default-page",setup(a,{expose:F}){const{saveFileEvent:H}=k(),E=C(),{plugin:I}=g(),{webserver:R}=I.value,A=e("/www/server/panel/data/defaultDoc.html"),J=e(""),K=e(),N=e("utf-8"),O=e(["utf-8","GBK","GB2312","BIG5"]),Q=e(!1),L=e(!1),M=async()=>{try{L.value=!0;const{data:a}=await B({path:A.value});J.value=a.data,N.value=a.encoding||"utf-8",L.value=!1}catch(a){}},P=async a=>{try{L.value=!0,A.value=a,await M(),"/www/server/panel/data/404.html"===a&&T(),L.value=!1}catch(e){}finally{L.value=!1}},T=async()=>{const{status:a}=await _({request:D(),data:{status:String}});Q.value=Boolean(Number(a))},W=a=>{_({loading:"正在设置，请稍后...",request:S({status:a?1:0}),message:!0})},X=async()=>{const a=await H({path:A.value,data:J.value,encoding:N.value});E.request(a)};return F({onRefresh:()=>{A.value="/www/server/panel/data/defaultDoc.html",M()}}),(a,e)=>{const g=w,_=j,C=f,B=x,D=h,S=V,k=y,F=l("bt-loading");return t(),s("div",z,[u(_,{type:"card",modelValue:r(A),"onUpdate:modelValue":e[0]||(e[0]=a=>o(A)?A.value=a:null),onChange:P},{default:n(()=>[u(g,{label:"新建网站默认页面",name:"/www/server/panel/data/defaultDoc.html"}),u(g,{label:"404错误页",name:"/www/server/panel/data/404.html",lazy:!0}),u(g,{label:"网站不存在页",name:"/www/server/"+r(R)+"/"+("nginx"===r(R)?"html":"htdocs")+"/index.html",lazy:!0},null,8,["name"]),u(g,{label:"网站停用后的提示页",name:"/www/server/stop/index.html",lazy:!0})]),_:1},8,["modelValue"]),m("div",G,["/www/server/panel/data/404.html"===r(A)?(t(),s("div",U,[u(C,{modelValue:r(Q),"onUpdate:modelValue":e[1]||(e[1]=a=>o(Q)?Q.value=a:null),onChange:W},{default:n(()=>[...e[4]||(e[4]=[d("开启404错误页设置",-1)])]),_:1},8,["modelValue"])])):i("",!0),e[5]||(e[5]=d(" 提示：Ctrl+F 搜索关键字，Ctrl+S 保存，Ctrl+H 查找替换 ",-1)),u(D,{class:"!w-[16rem]",modelValue:r(N),"onUpdate:modelValue":e[2]||(e[2]=a=>o(N)?N.value=a:null),onChange:X},{default:n(()=>[(t(!0),s(v,null,c(r(O),a=>(t(),b(B,{key:a,value:a,label:a},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),p((t(),s("div",q,[u(S,{ref_key:"aceEditor",ref:K,"file-path":r(A),modelValue:r(J),"onUpdate:modelValue":e[3]||(e[3]=a=>o(J)?J.value=a:null),onSave:X,class:"h-[40rem] w-full"},null,8,["file-path","modelValue"]),u(k,{class:"flex !mt-[12px]",type:"primary",onClick:X},{default:n(()=>[...e[6]||(e[6]=[d("保存",-1)])]),_:1})])),[[F,r(L)]])])}}});export{F as default};
