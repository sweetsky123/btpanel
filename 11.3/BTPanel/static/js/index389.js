import{c as e,aB as s,r as a,a0 as o,v as t,x as r,y as l,J as n,K as i,z as u,e as m,G as c,F as p}from"./base-lib.js?v=1763689792";import{aj as d,b as _}from"./utils-lib.js?v=1763689792";import{u as v}from"./use-socket-request.js?v=1763689792";import{u as j}from"./useStore4.js?v=1763689792";import{n as y,g as x}from"./index76.js?v=1763689792";import{_ as f,a as g,b}from"./traditional-project.vue_vue_type_script_setup_true_lang.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./site.js?v=1763689792";import"./index109.js?v=1763689792";import"./index137.js?v=1763689792";import"./index110.js?v=1763689792";import"./validator.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";import"./index.vue_vue_type_style_index_0_scoped_cdc7f4d3_lang.js?v=1763689792";import"./useController6.js?v=1763689792";import"./index147.js?v=1763689792";import"./index131.js?v=1763689792";import"./index.vue_vue_type_script_setup_true_lang13.js?v=1763689792";import"./index119.js?v=1763689792";import"./ace.js?v=1763689792";const w=["innerHTML"],k=e({__name:"index",emits:["showFooterFun"],setup(e,{expose:k,emit:h}){const F=_(),H=h,P=s("popupSetFooter",e=>{}),{isRefreshList:D}=j(),M=a("nodeProject"),R=a(null),T=a(),q=a(!1),z=a("正在执行添加脚本...");o("nodeData",y);const{BtTabs:L,tabsRefs:S}=d({type:"card",value:M,options:[{label:"默认项目",name:"nodeProject",lazy:!0,render:f},{label:"PM2项目",name:"pmProject",lazy:!0,render:g},{label:"传统项目",name:"traditionalProject",lazy:!0,render:b}]}),C=async(e=!1)=>(y.value=await x(),e&&F.success("Node版本，刷新成功"),y.value);return o("getNodeData",C),t(()=>C),k({onConfirm:async e=>{const s=await S()[M.value].submit();if(s){let a={...s,mod_name:"nodejs",sub_mod_name:"com",def_name:"create",ws_callback:"create"};(async()=>{var e;null==(e=R.value)||e.socketDestroy();const{socketRequest:s,socketDestroy:a}=v("/ws_modsoc",!1);R.value={socketRequest:s,socketDestroy:a},new Promise((e,s)=>{e(R.value)})})(),R.value.socketRequest({params:a,onMessage:s=>(async(e,s)=>{var a;e.msg&&(z.value=z.value+"\n"+e.msg,(null==(a=T.value)?void 0:a.scrollHeight)&&(T.value.scrollTop=T.value.scrollHeight)),-1===e.code&&e.status?(F.success("添加成功"),s(),D.value=!0):[2,3,4,5].includes(e.code)&&!e.status&&(F.msg({message:e.msg,type:"error",duration:0,dangerouslyUseHTMLString:!0,showClose:!0}),5===e.code?(q.value=!1,s(),D.value=!0):(q.value=!1,H("showFooterFun",!0)))})(s,e)}),q.value=!0,P(!1),H("showFooterFun",!1)}}}),(e,s)=>(r(),l(p,null,[n(m(u(L),{class:"p-2rem"},null,512),[[i,!u(q)]]),u(q)?(r(),l("pre",{key:0,ref_key:"installShow",ref:T,class:"whitespace-pre-wrap h-[40rem] overflow-auto bg-[#111] p-12px dark:text-[#ccc]",innerHTML:u(z)},null,8,w)):c("",!0)],64))}});export{k as default};
