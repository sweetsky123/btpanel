import{u as e,V as s,f as a,d as t,e as l,_ as i}from"./utils-lib.js?v=1763689792";import{c,t as r,r as n,g as d,v as m,I as o,J as f,z as u,x as v,y as p,A as x,O as b,G as y,B as g,C as w,e as j,bb as h,F as _,b1 as k,R as S,H as T,b2 as V,f as C,bA as H,D as A,be as z,bz as L}from"./base-lib.js?v=1763689792";import{scanSitesVluList as B}from"./site.js?v=1763689792";import{p as F}from"./validator.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";import"./index107.js?v=1763689792";const J={class:"p-2rem"},M={class:"mb-[2rem]"},D={class:"flex flex-row flex-wrap items-center justify-between"},I={class:"flex flex-row flex-wrap justify-center items-center"},N={class:"flex justify-between flex-col px-[2rem]"},R=["innerHTML"],E={class:"text-medium mt-[1.2rem]"},G={class:"justify-end relative"},q={key:0},O={class:"webedit-con flex items-center justify-center"},P={key:1},U={key:0,class:"scan-dangerous"},W={class:"overflow-auto h-[36rem]"},Z={class:"flex items-center"},K={class:"w-[26rem] flex items-center justify-start"},Q={class:"ml-[1.2rem]"},X={class:"flex items-center justify-between w-full"},Y={class:"flex items-center ml-[1.2rem]"},$={class:"text-tertiary ml-[1.2rem]"},ee={class:"bg-light text-tertiary"},se={class:"p-[3rem] bg-light"},ae={class:"flex items-center"},te={class:"collapse-item"},le={class:"flex mt-[10px] items-center"},ie={class:"collapse-item"},ce={class:"flex mt-[10px] items-center"},re={class:"collapse-item"},ne={class:"flex mt-[10px] items-center"},de={class:"collapse-item"},me={class:"flex mt-[10px] items-center"},oe={class:"collapse-item"},fe={class:"flex mt-[10px] items-center"},ue={class:"collapse-item"},ve={key:1,class:"scan-success border-[0.1rem] p-[2rem] h-[38rem] border-light flex items-center justify-center"},pe={class:"flex flex-column items-center"},xe=i(c({__name:"index",setup(i){const{payment:c}=e(),{authType:xe}=r(c.value),be=["danger","高危"],ye=["warning","中危"],ge=["info","低危"],we=n("success"),je=d(()=>ke.value.total>0),he=n({scanTitle:"当前未发现风险项。"}),_e=n(!1),ke=n({list:[],total:0,time:""}),Se=n(["1"]),Te=e=>(e=Number(e))>=0&&e<=3.9?ge:e>=4&&e<=6.9?ye:e>=7&&e<=10?be:["default","未知风险"],Ve=async()=>{_e.value=!0;try{const{data:e}=await B();ke.value.list=e.list,ke.value.total=e.count,ke.value.time=s(e.time),Ce(e.count)}finally{_e.value=!1}},Ce=e=>{e>0?(we.value="danger",he.value.scanTitle="<span class='text-danger'>".concat(e,"</span>个漏洞风险项待处理！")):(we.value="success",he.value.scanTitle="当前未发现风险项。")};return m(Ve),(e,s)=>{const i=t,c=T,r=V,n=C,d=z,m=l,B=L,be=H,ye=a,ge=o("bt-loading");return f((v(),p("div",J,[x("div",M,[x("div",D,[x("div",I,["success"==u(we)?(v(),b(i,{key:0,icon:"scanning-success",size:80,color:"var(--el-color-primary)"})):y("",!0),"danger"==u(we)?(v(),b(i,{key:1,icon:"scanning-danger",size:80,color:"#ef0808"})):y("",!0),x("div",N,[x("div",{class:"text-extraLarge font-bold",innerHTML:u(he).scanTitle},null,8,R),x("div",E,"上一次扫描时间:"+g(u(ke).time),1)])]),x("div",G,["ltd"!==u(xe)?(v(),b(c,{key:0,class:"scan-btn h-[4rem] w-[10rem]",type:"primary",size:"large",onClick:s[0]||(s[0]=e=>u(F)({sourceId:168}))},{default:w(()=>[...s[2]||(s[2]=[x("span",{class:"text-base"},"立即查看",-1)])]),_:1})):y("",!0),j(c,{class:"scan-btn h-[4rem] w-[10rem]",type:"primary",size:"large",onClick:Ve},{default:w(()=>[...s[3]||(s[3]=[x("span",{class:"text-base"},"重新检测",-1)])]),_:1})])])]),j(r,{class:"!mt-0"}),"ltd"!==u(xe)?(v(),p("div",q,[x("div",O,[j(n,{class:"max-w-[90rem] mr-[4rem] w-[36rem]",src:"https://www.bt.cn/Public/new/plugin/introduce/site/javaVulScan.png",custom:!0}),s[4]||(s[4]=h('<div class="thumbnail-introduce mt-[0rem]" data-v-9663f85f><span class="text-large font-bold" data-v-9663f85f>漏洞扫描工具介绍：</span><ul class="block leading-[2.6rem] mx-[2rem] list-square mt-[2rem]" data-v-9663f85f><li data-v-9663f85f> 可识别多款Java组件漏洞，支持如下：<br data-v-9663f85f> Apache Log4j2、Apache Shiro、Fastjson、<br data-v-9663f85f> Spring Boot、Spring Framework、Struts2、<br data-v-9663f85f> Tomcat、Weblogic、JBoss、Hibernate、Nexus<br data-v-9663f85f> Dubbo、Nacos、Druid、MyBatis、Spring Cloud<br data-v-9663f85f> Eureka、Ribbon、Hystrix、Zuul、Gateway<br data-v-9663f85f> Thymeleaf、FreeMarker、Velocity<br data-v-9663f85f></li><li data-v-9663f85f>提供修复/提供付费解决方案</li><li data-v-9663f85f>提供详细的漏洞描述和风险等级(CVSS评分)</li></ul></div>',1))])])):(v(),p("div",P,[u(je)?(v(),p("div",U,[s[13]||(s[13]=x("div",{class:"flex items-center mb-[2rem] text-default"},[x("span",{class:"w-[26rem]"},"项目名称"),x("span",null,"类型")],-1)),x("div",W,[j(be,{modelValue:u(Se),"onUpdate:modelValue":s[1]||(s[1]=e=>S(Se)?Se.value=e:null),accordion:""},{default:w(()=>[(v(!0),p(_,null,k(u(ke).list,(e,a)=>(v(),b(B,{key:a},{title:w(()=>[x("div",Z,[x("div",K,[j(d,{type:"warning",effect:"dark"},{default:w(()=>[A(g(e.list.length)+"项 ",1)]),_:2},1024),x("span",Q,g(e.title),1)]),s[5]||(s[5]=x("div",{class:"text-secondary text-small"},"无法自动修复,请手动处理",-1))])]),default:w(()=>[j(be,{accordion:""},{default:w(()=>[(v(!0),p(_,null,k(e.list,(e,a)=>(v(),b(B,{key:a},{title:w(()=>[x("div",X,[x("div",Y,[j(d,{type:Te(e.cvss)[0]},{default:w(()=>[A(g(Te(e.cvss)[1]),1)]),_:2},1032,["type"]),x("span",$,g(e.desc),1)]),j(m,{class:"mb-[.2rem] mr-[1.6rem]"},{default:w(()=>[...s[6]||(s[6]=[A("详情",-1)])]),_:1})])]),default:w(()=>[x("div",ee,[x("div",se,[x("div",ae,[s[7]||(s[7]=x("div",{class:"text-default collapse-title"},"漏洞编号",-1)),x("div",te,g(e.CVE),1)]),x("div",le,[s[8]||(s[8]=x("div",{class:"text-default collapse-title"},"风险描述",-1)),x("div",ie,g(e.desc),1)]),x("div",ce,[s[9]||(s[9]=x("div",{class:"text-default collapse-title"},"CVSS",-1)),x("div",re,g(e.cvss),1)]),x("div",ne,[s[10]||(s[10]=x("div",{class:"text-default collapse-title"},"JAR",-1)),x("div",de,g(e.jar),1)]),x("div",me,[s[11]||(s[11]=x("div",{class:"text-default collapse-title"},"CLASS",-1)),x("div",oe,g(e.class),1)]),x("div",fe,[s[12]||(s[12]=x("div",{class:"text-default collapse-title"},"HASH(16)",-1)),x("div",ue,g(e.hash256),1)])])])]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"])])])):(v(),p("div",ve,[x("div",pe,[j(ye,{src:"/firewall/secure.png",class:"w-[34.0rem] h-[30.1rem]"}),s[14]||(s[14]=x("span",{class:"absolute mt-[10.5rem] text-extraLarge leading-[0.14rem]"}," 当前处于【安全状态】，请继续保持！ ",-1))])]))]))])),[[ge,u(_e)]])}}}),[["__scopeId","data-v-9663f85f"]]);export{xe as default};
