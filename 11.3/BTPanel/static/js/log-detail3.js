import{c as a,x as e,y as t,e as s,C as l,D as o,B as c,z as i,A as n,bP as r,bO as d,H as m}from"./base-lib.js?v=1763689792";import{V as p,p as f,Q as u,e as _,_ as b}from"./utils-lib.js?v=1763689792";import{av as w}from"./firewall.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";const D={class:"p-[2rem]"},x={class:"mb-[1.2rem] flex flex-col"},v={class:"detail-content"},j={class:"mb-[1.2rem] flex flex-col"},g={class:"detail-content"},U={class:"mb-[1.2rem] flex flex-col"},L={class:"flex justify-between items-end"},R={class:"detail-content"},y={class:"mb-[1.2rem] flex flex-col"},k={class:"detail-content"},C=b(a({__name:"log-detail",props:{compData:{default:{}}},setup(a){const b=a,C=()=>{b.compData.addIpWhiteEvent(b.compData.row)},I=async()=>{await f({title:"加入URL白名单",content:"加入URL白名单后此URL将不再进行防御，是否继续操作？",icon:"warning-filled"}),await u({loading:"正在加入URL白名单...",request:w({url_rule:b.compData.row.url}),message:!0})};return(f,u)=>{const b=r,w=_,h=d,q=m;return e(),t("div",D,[s(h,{title:"",direction:"vertical",column:4,border:"",class:"mb-[1.2rem] table-descriptions"},{default:l(()=>[s(b,{label:"时间"},{default:l(()=>[o(c(i(p)(a.compData.row.addtime)),1)]),_:1}),s(b,{label:"用户Ip"},{default:l(()=>[s(w,{onClick:C},{default:l(()=>[o(c(a.compData.row.address),1)]),_:1})]),_:1}),s(b,{label:"触发函数"},{default:l(()=>[o(c(a.compData.row.fun_name),1)]),_:1}),s(b,{label:"过滤器"},{default:l(()=>[o(c(a.compData.row.intercept),1)]),_:1})]),_:1}),n("div",x,[u[0]||(u[0]=n("span",{class:"detail-title"},"URL地址",-1)),n("span",v,c(a.compData.row.url),1)]),n("div",j,[u[1]||(u[1]=n("span",{class:"detail-title"},"User-Agent",-1)),n("span",g,c(a.compData.row.data_info.data.request.headers["user-agent"]),1)]),n("div",U,[n("div",L,[u[3]||(u[3]=n("span",{class:"detail-title"},"传入值",-1)),s(q,{type:"text",onClick:I},{default:l(()=>[...u[2]||(u[2]=[o("URL加白",-1)])]),_:1})]),n("span",R,c(a.compData.row.data_info.data.args.join("\n")),1)]),n("div",y,[u[4]||(u[4]=n("span",{class:"detail-title"},"调用栈",-1)),n("span",k,c(a.compData.row.data_info.data.stack_trace.join("\n")),1)])])}}}),[["__scopeId","data-v-947d3c38"]]);export{C as default};
