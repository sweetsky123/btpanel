!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function n(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",u=a.toStringTag||"@@toStringTag";function i(n,a,l,u){var i=a&&a.prototype instanceof c?a:c,s=Object.create(i.prototype);return r(s,"_invoke",function(n,r,a){var l,u,i,c=0,s=a||[],f=!1,v={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return l=t,u=0,i=e,v.n=n,o}};function p(n,r){for(u=n,i=r,t=0;!f&&c&&!a&&t<s.length;t++){var a,l=s[t],p=v.p,d=l[2];n>3?(a=d===r)&&(i=l[(u=l[4])?5:(u=3,3)],l[4]=l[5]=e):l[0]<=p&&((a=n<2&&p<l[1])?(u=0,v.v=r,v.n=l[1]):p<d&&(a=n<3||l[0]>r||r>d)&&(l[4]=n,l[5]=r,v.n=d,u=0))}if(a||n>1)return o;throw f=!0,r}return function(a,s,d){if(c>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,d),u=s,i=d;(t=u<2?e:i)||!f;){l||(u?u<3?(u>1&&(v.n=-1),p(u,i)):v.n=i:v.v=i);try{if(c=2,l){if(u||(a="next"),t=l[a]){if(!(t=t.call(l,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,u<2&&(u=0)}else 1===u&&(t=l.return)&&t.call(l),u<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),u=1);l=e}else if((t=(f=v.n<0)?i:n.call(r,v))!==o)break}catch(t){l=e,u=1,i=t}finally{c=1}}return{value:t,done:f}}}(n,l,u),!0),s}var o={};function c(){}function s(){}function f(){}t=Object.getPrototypeOf;var v=[][l]?t(t([][l]())):(r(t={},l,function(){return this}),t),p=f.prototype=c.prototype=Object.create(v);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,r(e,u,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=f,r(p,"constructor",f),r(f,"constructor",s),s.displayName="GeneratorFunction",r(f,u,"GeneratorFunction"),r(p),r(p,u,"Generator"),r(p,l,function(){return this}),r(p,"toString",function(){return"[object Generator]"}),(n=function(){return{w:i,m:d}})()}function r(e,t,n,a){var l=Object.defineProperty;try{l({},"",{})}catch(e){l=0}r=function(e,t,n,a){function u(t,n){r(e,t,function(e){return this._invoke(t,n,e)})}t?l?l(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(u("next",0),u("throw",1),u("return",2))},r(e,t,n,a)}function a(e,t,n,r,a,l,u){try{var i=e[l](u),o=i.value}catch(e){return void n(e)}i.done?t(o):Promise.resolve(o).then(r,a)}function l(e){return function(){var t=this,n=arguments;return new Promise(function(r,l){var u=e.apply(t,n);function i(e){a(u,r,l,i,o,"next",e)}function o(e){a(u,r,l,i,o,"throw",e)}i(void 0)})}}System.register(["./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792"],function(t,r){"use strict";var a,u,i,o,c,s,f,v,p,d,m,h,y,b,g,w,x,k,_,C,S,j,D,A,I,O,P,R,T,F,V,E,G,q,H;return{setters:[function(e){a=e.ik,u=e.b,i=e._,o=e.u,c=e.il,s=e.V,f=e.im,v=e.d,p=e.k,d=e.P,m=e.l,h=e.N},function(e){y=e.c,b=e.r,g=e.I,w=e.x,x=e.y,k=e.A,_=e.J,C=e.e,S=e.z,j=e.R,D=e.Q,A=e.C,I=e.D,O=e.L,P=e.U,R=e.H,T=e.W,F=e.g,V=e.a3,E=e.B,G=e.F,q=e.b1,H=e.G},null],execute:function(){var r={class:"create-file-view flex"},U={class:"flex-1 flex items-center"},B=y({__name:"create-file",props:{type:{default:"Dir"},path:{},filelist:{}},emits:["createStatus"],setup:function(t,i){var o=i.emit,c=u().error,s=o,f=t,v=b(""),p=b(),d=function(){var e=l(n().m(function e(){var t,r;return n().w(function(e){for(;;)switch(e.n){case 0:if(t=p.value,v.value){e.n=1;break}return c("".concat("Dir"===f.type?"文件夹":"文件","名称不能为空")),e.a(2);case 1:return e.n=2,a({type:f.type,path:f.path+"/"+v.value});case 2:(r=e.v).status?m():(c(r.msg),t.$el.querySelector("input").focus());case 3:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),m=function(){f.filelist.value.shift(),s("createStatus")},h=function(e){v.value=e,/(\\|\/|\<|\>|\"|\&|\;)/g.test(e)&&(c('名称不能含有 /\\<>"&;符号'),v.value=e.replace(/(\\|\/|\<|\>|\"|\&|\;)/g,""))};return function(n,a){var l=P,u=R,i=g("focus");return w(),x("div",r,[k("div",{class:O(["flex","".concat("Dir"===t.type?"bt-open-dir folder-open-icon":"bt-open-dir file-text-icon")])},[a[4]||(a[4]=k("i",{class:"icon"},null,-1)),k("div",U,[_(C(l,{class:"!w-[22rem] mr-[1.6rem]",clearable:"",modelValue:S(v),"onUpdate:modelValue":a[0]||(a[0]=function(e){return j(v)?v.value=e:v=e}),ref_key:"createfile",ref:p,onInput:h,onKeyup:a[1]||(a[1]=D(function(e){return e.target.blur()},["enter","native"]))},null,8,["modelValue"]),[[i]]),C(u,{type:"primary",class:"!mr-[.8rem]",onClick:d},{default:A(function(){return e(a[2]||(a[2]=[I(" 创建 ",-1)]))}),_:1}),C(u,{type:"default",onClick:m},{default:A(function(){return e(a[3]||(a[3]=[I("取消",-1)]))}),_:1})])],2)])}}}),z=i(B,[["__scopeId","data-v-c17175a3"]]),K={class:"text-black text-base pl-[1.6rem] pt-[1.6rem]"},M={class:"p-[1.6rem] flex justify-between"},N={class:"file-selector-head"},$=["onClick"],L={class:"truncate max-w-[8rem]"},J={class:"ml-[0.4rem] flex items-align"},Q={class:"ml-[1.6rem] mb-[1.6rem]"},W={class:"flex h-[48rem] file-selector-main"},X={class:"w-[16rem] h-full pt-[1.2rem] text-xl inline-block overflow-auto disk-list"},Y={class:"flex items-center flex-col"},Z=["onClick"],ee=["title"],te={class:"h-full w-full inline-block flex w-[59rem]"},ne={class:"flex justify-between bg-light p-[1.2rem] pr-[1.6rem] rounded-base"},re={class:"ml-[9.6rem]"},ae={key:0,class:"flex align-middle items-center"},le={class:"bg- rounded-large px-4 h-12 leading-[2.8rem] w-[30rem] inline-block border-light border-1 border-opacity-20 truncate"},ue={class:"flex"},ie=y({__name:"index",props:{compData:{default:function(){return{type:"all",path:"/www/wwwroot",change:function(){},confirmText:"确认",customRequest:!1,disabledCreate:!1,customRequestApi:function(){return Promise.resolve({status:!0,data:{}})}}}}},emits:["close"],setup:function(t,r){var a=r.expose,i=r.emit,y=t,O=y.compData,P=O.type,U=O.path,B=O.change,ie=O.disabledCreate,oe=u(),ce=oe.error,se=oe.request,fe=o().panel,ve=b(),pe=b(),de=b(0),me=b(0),he=b(""),ye=b(),be=b(P),ge=b(!1),we=b(!0),xe=b(!1),ke=b(U||fe.value.sitePath),_e=b(U||fe.value.sitePath),Ce=T([]),Se=T([]),je=b([]),De=b(""),Ae=b(),Ie=b(),Oe=F(function(){return"file"===be.value?"文件":"dir"===be.value?"文件夹":"文件/文件夹"});V(pe,function(e){var t=e[0].contentRect.width;de.value=t}),V(ve,function(e){var t=e[0].contentRect.width;me.value=t,me.value>de.value&&(Se.value=Ce.value.slice(-4))});var Pe=b([{label:"名称",prop:"name",showOverflowTooltip:!1,render:function(e){return e.create&&qe?C(z,{type:e.type,path:ke.value,filelist:Ie,onCreateStatus:function(){Ue()}},null):C("span",{class:"bt-open-dir"},[C("i",{class:"svgtofont".concat("dir"===e.type?"-icon-file_mode":"-file-text")},null),C("span",{onClick:function(t){"dir"===e.type&&Ne(e,t)}},[e.name])])}},{label:"修改时间",width:160,prop:"mtime"},{label:"权限/所有者",width:125,prop:"accept"}]),Re=function(e){var t=e.row,n=(e.column,e.rowIndex);e.columnIndex;if(0===n&&t.create&&qe)return[1,3]},Te=function(){1!==Ce.value.length&&(ke.value=Ce.value[Ce.value.length-2].path,Be())},Fe=function(){we.value=!1,_e.value=ke.value},Ve=function(){we.value=!0,setTimeout(function(){_e.value=ke.value},1500)},Ee=function(e){ke.value=_e.value,Be(),e.preventDefault(),e.target.blur()},Ge=function(e){e||(e=""),De.value=e,Be(!0)},qe=b(!1),He=function(e){var t;if(qe.value)return!1;qe.value=!0,null===(t=Ie.value)||void 0===t||t.unshift({title:"",name:"",mtime:"",accept:"",type:e,path:"",create:!0})},Ue=function(){qe.value=!1,Be()},Be=function(){var t=l(n().m(function t(r){var a,l,u,i,o,s,f,v,p;return n().w(function(t){for(;;)switch(t.p=t.n){case 0:if(ge.value=!0,t.p=1,!y.compData.customRequest){t.n=3;break}return t.n=2,null===(a=(l=y.compData).customRequestApi)||void 0===a?void 0:a.call(l,{path:ke.value,disk:!0,search:r?De.value:""});case 2:p=t.v,t.n=5;break;case 3:return t.n=4,c({path:ke.value,disk:!0,search:r?De.value:""});case 4:p=t.v;case 5:if(u=p,Ae.value&&(Ae.value.path=ke.value,Ae.value.title=ke.value.split("/")[ke.value.split("/").length-1]),u.status){t.n=6;break}return Ae.value=void 0,se(u),t.a(2,!1);case 6:i=u.data,o=i.DIR,s=i.FILES,f=i.DISK,v=i.PATH,ze(v),je.value=f,Ie.value=[].concat(e(Ke(o,"dir")),e(Ke(s))),$e(),t.n=8;break;case 7:t.p=7,t.v;case 8:return t.p=8,ge.value=!1,t.f(8);case 9:return t.a(2)}},t,null,[[1,7,8,9]])}));return function(e){return t.apply(this,arguments)}}(),ze=function(e){var t="",n=e.replace(/\/*$/,"");if(ke.value=n,_e.value=n,Ce.value=[],""===n)return Ce.value.push({title:"根目录",path:"/"}),void(Se.value=Ce.value);n.split("/").forEach(function(e,n){t+="".concat(1===n?"":"/").concat(e),Ce.value.push({title:""===e&&0===n?"根目录":e,path:t})}),Se.value=Ce.value},Ke=function(e,t){var n=[];return e.forEach(function(e){var r=e.split(";"),a=r[0];a.length>30&&(a="".concat(a.slice(0,30),"...")),/[\u4E00-\u9FA5\uF900-\uFA2D]/.test(a)&&(a="".concat(a.slice(0,16),"...")),n.push({title:r[0],name:a,mtime:s(1e3*Number(r[2]),"yyyy/MM/dd HH:mm:ss"),accept:"".concat(r[3]," / ").concat(r[4]),type:t||"file",path:"".concat(ke.value,"/").concat(r[0])})}),n},Me=function(e){if(e&&!e.create){if("all"===be.value)Ae.value=e;else{if("dir"!==e.type&&"dir"===be.value)return void ce("请选择文件夹，否则将无法选择");if("file"!==e.type&&"file"===be.value)return;if(be.value!==e.type)return Ae.value=void 0,void f(ye.value).setCurrentRow();null!==e&&(Ae.value=e)}xe.value=!0}},Ne=function(e,t){"dir"!==e.type||e.create||("file"===be.value&&(xe.value=!1),ke.value=e.path,Be(),t.stopPropagation&&t.stopPropagation())},$e=function(){"file"===ye.value.type&&(Ae.value=void 0,xe.value=!1),qe.value=!1},Le=function(){var e=l(n().m(function e(){return n().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Be();case 1:"file"!==be.value&&(Ae.value=Ce.value[Ce.value.length-1],xe.value=!0);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();return a({onOpen:function(){return Le()}}),function(n,r){var a,l=v,u=p,o=d,c=R,s=m,f=h,y=g("bt-loading");return w(),x("section",null,[k("div",K,"选择"+E(S(Oe)),1),k("div",M,[k("div",N,[k("i",{title:"返回上一层",class:"bt-open-icon inline-block !rounded-tl-large !rounded-bl-large",onClick:Te},[C(l,{icon:"el-back",class:"leading-[2rem]"})]),k("div",{ref_key:"pathInputRef",ref:pe,class:"file-selector-input overflow-hidden"},[S(we)?(w(),x("ul",{key:0,ref_key:"pathRef",ref:ve,class:"absolute top-[1px] left-[1px] h-[28px] z-1 flex rounded-none bg-light"},[(w(!0),x(G,null,q(S(Se),function(e,t){return w(),x("li",{key:t,class:"flex items-center px-[1rem]",onClick:function(t){return n=e.path,void(ke.value!==n&&(ke.value=n,_e.value=n,Be()));var n}},[k("span",L,E(e.title),1),k("i",J,[C(l,{icon:"el-arrow-right"})])],8,$)}),128))],512)):H("",!0),C(u,{modelValue:S(_e),"onUpdate:modelValue":r[0]||(r[0]=function(e){return j(_e)?_e.value=e:null}),class:"!w-[400px]",onFocus:Fe,onBlur:Ve,onKeyup:D(Ee,["enter"])},null,8,["modelValue"])],512),k("i",{title:"刷新",class:"bt-open-icon inline-block !rounded-tr-large !rounded-br-large",onClick:r[1]||(r[1]=function(e){return Be()})},[C(l,{icon:"el-refresh-right",class:"leading-[2rem]"})])]),C(o,{modelValue:S(De),"onUpdate:modelValue":r[2]||(r[2]=function(e){return j(De)?De.value=e:null}),placeholder:"搜索文件/目录",class:"!w-[220px]",onSearch:Ge},null,8,["modelValue"])]),k("div",Q,[C(c,{type:"default",disabled:S(ie),onClick:r[3]||(r[3]=function(e){return He("File")})},{default:A(function(){return e(r[7]||(r[7]=[I("新建文件",-1)]))}),_:1},8,["disabled"]),C(c,{type:"default",disabled:S(ie),onClick:r[4]||(r[4]=function(e){return He("Dir")})},{default:A(function(){return e(r[8]||(r[8]=[I("新建文件夹",-1)]))}),_:1},8,["disabled"])]),k("div",W,[k("div",X,[k("ul",Y,[(w(!0),x(G,null,q(S(je),function(e,t){return w(),x("li",{key:t,class:"flex p-[0.8rem] pl-[1.6rem] items-center w-full",onClick:function(t){return n=e.path,ke.value=n,void Be();var n}},[r[9]||(r[9]=k("i",{class:"file-disk-icon mr-[0.8rem] text-base"},null,-1)),k("span",{class:"w-full truncate",title:"/"===e.path?"根目录":e.path},E("/"===e.path?"根目录":e.path)+" ("+E(e.size[2])+") ",9,ee)],8,Z)}),128))])]),k("div",te,[_(C(s,{ref_key:"tableRef",ref:ye,"empty-text":"(空)","max-height":"480","highlight-current-row":"",class:"file-selector-table",column:S(Pe),data:S(Ie),"span-method":Re,border:!1,onCurrentChange:Me,onRowDblclick:Ne},null,8,["column","data"]),[[y,S(ge)],[y,"正在加载文件列表，请稍后...","title"]])])]),k("div",ne,[k("div",re,[S(xe)?(w(),x("div",ae,[k("span",null,"当前选中"+E(S(Oe))+"：",1),k("span",le,E(null===(a=S(Ae))||void 0===a?void 0:a.title),1)])):H("",!0)]),k("span",ue,[C(f,{type:"default",class:"BtButton--cancel",onClick:r[5]||(r[5]=function(e){return i("close")})},{default:A(function(){return e(r[10]||(r[10]=[I(" 取消 ",-1)]))}),_:1}),C(f,{type:"primary",disabled:!S(xe),onClick:r[6]||(r[6]=function(e){return B&&B(Ae.value.path,Ae.value.type),he.value=Ae.value.path,void i("close")})},{default:A(function(){return[I(E(t.compData.confirmText||"确认"),1)]}),_:1},8,["disabled"])])])])}}});t("default",i(ie,[["__scopeId","data-v-d5229c07"]]))}}})}();
