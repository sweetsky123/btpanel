import{_ as a}from"./index137.js?v=1763689792";import{c as s,r as e,p as t,o as n,v as i,aG as o,z as r,x as l,O as m,C as u,y as c,A as p,e as v,D as d,G as f,b2 as x}from"./base-lib.js?v=1763689792";import{u as b,aH as y,b2 as k,e as g,b as _}from"./utils-lib.js?v=1763689792";import{k as w}from"./validator.js?v=1763689792";import{u as j}from"./useStore4.js?v=1763689792";const h={key:0,class:"content-mask"},I={key:1,class:"content-mask"},T=s({__name:"index",props:{compData:{default:{}}},emits:["init"],setup(s,{expose:T,emit:C}){const D=_(),G=C,{plugin:S,getGlobalInfo:A}=b(),{activeType:N}=j(),O=e(S.value.webserver),z=t("_".concat(N.value,"_mask"),!1),H=e(!1),L=n({title:"",name:"",status:!0,version:"",admin:!1,s_version:"",setup:!1}),q=async a=>{const{data:s}=await y({sName:a.name});if("-1"===s.task)return D.error("当前插件正在安装，不可重复安装");w({name:null==s?void 0:s.name,type:"i",pluginInfo:s}),E()};let B=!1;const E=async(a=!1)=>{try{if(B)return;const{data:s}=await k({name:"web"});s.status||a||setTimeout(()=>{E()},3e3),s.status&&!a&&G("init"),z.value=!s.status,Object.assign(L,s),"proxy"===N.value&&"nginx"!==s.name&&(z.value=!0,H.value=s.status)}catch(s){a||setTimeout(()=>{E()},3e3)}};return i(()=>{E(!0)}),o(()=>{B=!0}),T({checkInstallStatus:E,pluginInfo:L,maskLayer:z,webServerType:O}),(e,t)=>{const n=g,i=x,o=a;return r(z)?(l(),m(o,{key:0,width:"38rem"},{content:u(()=>[r(H)?(l(),c("div",I,[...t[6]||(t[6]=[p("span",null,"反向代理项目只支持nginx环境",-1)])])):(l(),c("div",h,[t[4]||(t[4]=p("i",{class:"svgtofont-el-warning text-warning !text-[2.2rem] mr-4px"},null,-1)),t[5]||(t[5]=p("span",null,"未安装运行环境，",-1)),v(n,{onClick:t[0]||(t[0]=a=>q({name:"nginx"})),class:"!font-bold !text-base"},{default:u(()=>[...t[2]||(t[2]=[d("安装Nginx",-1)])]),_:1}),v(i,{direction:"vertical"}),"proxy"!==s.compData.type?(l(),m(n,{key:0,onClick:t[1]||(t[1]=a=>q({name:"apache"})),class:"!font-bold !text-base"},{default:u(()=>[...t[3]||(t[3]=[d("安装Apache",-1)])]),_:1})):f("",!0)]))]),_:1})):f("",!0)}}});export{T as _};
