import{_ as e}from"./index109.js?v=1763689792";import{_ as a}from"./index107.js?v=1763689792";import{o as t,r as i,c as n,e as s,aT as r,be as l,w as o,v as c,a8 as m,x as p,y as u,C as d,A as _,z as h,Q as f}from"./base-lib.js?v=1763689792";import{aQ as b,ap as v,Q as y,cr as C,p as w,cq as g,n as x,H as j,u as k,b3 as R,an as E,B as T,x as D,V as I,R as L,_ as V}from"./utils-lib.js?v=1763689792";import{o as O,b as A,a as P,N as B}from"./useMethods.js?v=1763689792";import{c as N,a as q,u as z}from"./column.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";const{refs:{customLimit:H,isRefreshTableList:Q},getCurrentCon:J}=b(),S=t({search:"",isRefresh:!0}),K=i([]),M=[{active:!0,label:"从仓库中拉取",type:"button",onClick:()=>{x({component:()=>j(()=>import("./index261.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),title:"拉取镜像",area:64})}},{active:!1,label:"导入镜像",type:"button",onClick:()=>{x({component:()=>j(()=>import("./index262.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),title:"导入镜像",area:43,btn:"导入"})}},{active:!1,label:"构建镜像",type:"button",onClick:()=>{x({component:()=>j(()=>import("./index263.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),title:"构建镜像",area:54,btn:"提交"})}},{active:!1,label:"线上镜像",type:"button",onClick:()=>{x({component:()=>j(()=>import("./index29.js?v=1763689792").then(e=>e.a),__vite__mapDeps([]),import.meta.url),title:"Docker线上镜像搜索",area:80})}},{active:!1,label:"清理镜像",type:"button",onClick:async()=>{x({component:()=>j(()=>import("./clear-confirm.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),title:"清理镜像",area:35,btn:!0})}}],U=e=>{x({component:()=>j(()=>import("./index264.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),title:"推送【".concat(e.name,"】到仓库"),area:43,btn:!0,compData:{row:e}})},W=e=>{x({component:()=>j(()=>import("./index265.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),title:"导出【".concat(e.name,"】镜像"),area:43,btn:"导出",compData:{row:e}})},F=async e=>{P({image:e.name})},G=v([{label:"删除项目",value:"delete",event:async(e,a,t,i,n)=>{const{label:s,value:r}=i,l=async(e,a)=>{const{id:t,name:i}=e;if("delete"===r){const e={id:t,name:i,force:"0"};return await g({data:JSON.stringify(e)})}};await e({title:"批量".concat(s,"镜像"),content:"批量".concat(s,"已选的镜像，是否继续操作！"),column:[{label:"镜像名",prop:"name"},N()],onConfirm:async()=>(await a(l),Q.value=!0,!1)})}}]),X=async(e,a)=>{if(Q.value=!1,a)return(async(e,a)=>{try{const t=e.toLowerCase(),i=["name","id","container"],n=K.value.filter(e=>{const a={...e,container:e.containers.map(e=>e.container_name).join("")||""};return i.some(e=>{var i;return null==(i=a[e])?void 0:i.toLowerCase().includes(t)})});return{data:A({limit:a.limit,list:n,p:a.p})||[],total:n.length}}catch(t){return{data:[],total:0}}})(e.search,e);if(!S.isRefresh)return{data:A({limit:e.limit,list:K.value,p:e.p})||[],total:K.value.length};S.isRefresh=!1;const t=await y({request:C(),data:Array});return K.value=t,{data:A({limit:e.limit,list:K.value,p:e.p})||[],total:K.value.length}},Y=(e,a)=>{setTimeout(()=>{H.value.images||((e,a)=>{setTimeout(()=>{e.value>900?a.value.limit=20:a.value.limit=10},0)})(e,a)},0)},Z={class:"relative"},$={class:"flex items-center"},ee=V(n({__name:"index",setup(t){const{refs:{isRefreshTableList:i}}=b(),{mainHeight:n}=k(),{BtOperation:v}=R({options:M});let C=!1;const x=(e,a)=>{S.isRefresh=!0,e&&!isNaN(e)&&(H.value.p=e),a?(H.value.search=a,C=!0):C=!1,N()},{BtTable:j,BtPage:V,BtBatch:A,BtColumn:P,refresh:N,param:H}=E({request:e=>X(e,C),columns:[q(),{label:"ID",prop:"id",width:110,render:e=>{const a=e.id.slice(7);return s(r,{placement:"top"},{default:()=>s("div",{onClick:()=>T({value:e.id})},[a.slice(0,12)]),content:()=>s("div",null,[e.id])})}},{label:"镜像名",prop:"name",isCustom:!0},{label:"大小",prop:"size",width:100,isCustom:!0,render:e=>D(e.size)},{label:"创建时间",prop:"time",width:160,isCustom:!0,render:e=>I(e.time)},{label:"使用镜像的容器",prop:"used",minWidth:180,isCustom:!0,render:e=>1!==e.used?"--":L(e.containers)&&e.containers.length>0?s("span",{class:"flex items-center whitespace-pre-wrap gap-4 min-h-[3rem]"},[e.containers.map(e=>s(l,{class:"mr-1 cursor-pointer",type:"primary",size:"small",onClick:()=>(async e=>{const a={id:e.container_id,name:e.container_name};await J(a.id),O(a)})(e)},{default:()=>[e.container_name]}))]):"--"},z([{onClick:F,width:80,title:"创建容器"},{onClick:U,title:"推送"},{onClick:W,title:"导出"},{onClick:e=>(async(e,a)=>{const t={id:e.id,name:e.name,force:"0"};try{await w({type:"calc",title:"删除镜像【".concat(e.name,"】"),width:"35rem",content:"您真的要删除镜像【".concat(e.name,"】吗？")}),y({request:g({data:JSON.stringify(t)}),message:!0,success:()=>{a()}})}catch(i){}})(e,x),title:"删除"}])],extension:[G]});return o(()=>i.value,e=>{e&&(x(),i.value=!1)}),c(async()=>{Y(n,H)}),m(()=>{S.search="",S.isRefresh=!0,K.value=[]}),(t,i)=>{const r=a,l=e;return p(),u("div",Z,[s(l,null,{"header-left":d(()=>[_("div",$,[s(h(v)),_("a",{class:"ml-[1rem] bt-link",onClick:i[0]||(i[0]=(...e)=>h(B)&&h(B)(...e))},"需求反馈")])]),"header-right":d(()=>[s(r,{icon:"el-search",class:"!mr-[1rem] !w-[26rem]",modelValue:h(S).search,"onUpdate:modelValue":i[1]||(i[1]=e=>h(S).search=e),clearable:"",placeholder:"镜像名、ID、使用的容器",onIconClick:i[2]||(i[2]=e=>x(1,h(S).search)),onClear:i[3]||(i[3]=e=>x(1)),onKeyup:i[4]||(i[4]=f(e=>x(1,h(S).search),["enter"]))},null,8,["modelValue"]),s(h(P))]),content:d(()=>[s(h(j),{key:"ImageTable","max-height":h(n)-220},null,8,["max-height"])]),"footer-left":d(()=>[s(h(A))]),"footer-right":d(()=>[s(h(V))]),popup:d(()=>[...i[5]||(i[5]=[])]),_:1})])}}}),[["__scopeId","data-v-e28839f3"]]);export{ee as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
