!function(){function n(n){return function(n){if(Array.isArray(n))return t(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,e){if(n){if("string"==typeof n)return t(n,e);var r={}.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(n,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=Array(t);e<t;e++)r[e]=n[e];return r}function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var n,t,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",u=o.toStringTag||"@@toStringTag";function c(e,o,a,u){var c=o&&o.prototype instanceof l?o:l,s=Object.create(c.prototype);return r(s,"_invoke",function(e,r,o){var a,u,c,l=0,s=o||[],f=!1,p={p:0,n:0,v:n,a:v,f:v.bind(n,4),d:function(t,e){return a=t,u=0,c=n,p.n=e,i}};function v(e,r){for(u=e,c=r,t=0;!f&&l&&!o&&t<s.length;t++){var o,a=s[t],v=p.p,y=a[2];e>3?(o=y===r)&&(c=a[(u=a[4])?5:(u=3,3)],a[4]=a[5]=n):a[0]<=v&&((o=e<2&&v<a[1])?(u=0,p.v=r,p.n=a[1]):v<y&&(o=e<3||a[0]>r||r>y)&&(a[4]=e,a[5]=r,p.n=y,u=0))}if(o||e>1)return i;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&v(s,y),u=s,c=y;(t=u<2?n:c)||!f;){a||(u?u<3?(u>1&&(p.n=-1),v(u,c)):p.n=c:p.v=c);try{if(l=2,a){if(u||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,u<2&&(u=0)}else 1===u&&(t=a.return)&&t.call(a),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);a=n}else if((t=(f=p.n<0)?c:e.call(r,p))!==i)break}catch(t){a=n,u=1,c=t}finally{l=1}}return{value:t,done:f}}}(e,a,u),!0),s}var i={};function l(){}function s(){}function f(){}t=Object.getPrototypeOf;var p=[][a]?t(t([][a]())):(r(t={},a,function(){return this}),t),v=f.prototype=l.prototype=Object.create(p);function y(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,r(n,u,"GeneratorFunction")),n.prototype=Object.create(v),n}return s.prototype=f,r(v,"constructor",f),r(f,"constructor",s),s.displayName="GeneratorFunction",r(f,u,"GeneratorFunction"),r(v),r(v,u,"Generator"),r(v,a,function(){return this}),r(v,"toString",function(){return"[object Generator]"}),(e=function(){return{w:c,m:y}})()}function r(n,t,e,o){var a=Object.defineProperty;try{a({},"",{})}catch(n){a=0}r=function(n,t,e,o){function u(t,e){r(n,t,function(n){return this._invoke(t,e,n)})}t?a?a(n,t,{value:e,enumerable:!o,configurable:!o,writable:!o}):n[t]=e:(u("next",0),u("throw",1),u("return",2))},r(n,t,e,o)}function o(n,t,e,r,o,a,u){try{var c=n[a](u),i=c.value}catch(n){return void e(n)}c.done?t(i):Promise.resolve(i).then(r,o)}function a(n){return function(){var t=this,e=arguments;return new Promise(function(r,a){var u=n.apply(t,e);function c(n){o(u,r,a,c,i,"next",n)}function i(n){o(u,r,a,c,i,"throw",n)}c(void 0)})}}System.register(["./utils-lib-legacy.js?v=1763689792","./base-lib-legacy.js?v=1763689792","./validator-legacy.js?v=1763689792","./site-legacy.js?v=1763689792","./useStore-legacy4.js?v=1763689792","./useStore-legacy14.js?v=1763689792","./index-legacy119.js?v=1763689792","./__commonjsHelpers__-legacy.js?v=1763689792","./index-legacy110.js?v=1763689792","./column-legacy.js?v=1763689792","./index-legacy107.js?v=1763689792","./ace-legacy.js?v=1763689792"],function(t,r){"use strict";var o,u,c,i,l,s,f,p,v,y,d,m,h,g,b,w,x,_,j,S,k,C,O,A,F,P,T,E,G,I,V,H;return{setters:[function(n){o=n.R,u=n.Q,c=n.b,i=n.p,l=n.V,s=n.hy,f=n.n,p=n.$,v=n._},function(n){y=n.r,d=n.q,m=n.c,h=n.v,g=n.I,b=n.x,w=n.y,x=n.A,_=n.J,j=n.z,S=n.e,k=n.R,C=n.C,O=n.D,A=n.H,F=n.b2},function(n){P=n.d5},function(n){T=n.setProxyConfig,E=n.recoverProxyConfig},function(n){G=n.u,I=n.S},function(n){V=n.S},function(n){H=n.B},null,null,null,null,null],execute:function(){var r=c(),q=G().siteInfo,N=I().getFileEvent;y("master"),y("server_block");y([{content:"保存前请检查输入的配置文件是否正确，错误的配置可能会导致网站访问异常"},{content:"如果您对此配置不熟悉，请勿添加自定义配置"},{isHtml:!0,content:'server块的nginx官方配置文档：<a class="text-primary cursor-pointer" href="https://nginx.org/en/docs/http/ngx_http_core_module.html#server" target="_blank" rel="noreferrer noopener">点击跳转</a>'}]),y("");var U=y(!1),B=function(){var n=a(e().m(function n(){var t,r;return e().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,U.value=!0,n.n=1,N({path:"/www/server/panel/vhost/nginx/".concat(q.value.name,".conf")});case 1:t=n.v,r=t.data,D.value=r.data,o(r.historys)&&(R.value=r.historys),U.value=!1,n.n=3;break;case 2:return n.p=2,n.v,n.a(2,{status:!1,msg:"获取配置文件失败"});case 3:return n.a(2)}},n,null,[[0,2]])}));return function(){return n.apply(this,arguments)}}();d(function(){r.error("主配置文件不允许修改，如需自定义配置请到上方自定义配置文件中操作")},3e3);var D=y(""),R=y(),$=y("");y(""),y(!1);var z=function(){var n=a(e().m(function n(t){var r,o,a;return e().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,r=V(),o=r.viewFileHistoryEvent,n.n=1,o({row:t,path:"/www/server/panel/vhost/nginx/".concat(q.value.name,".conf")});case 1:return a=n.v,$.value=a.status?a.data:"文件不存在",n.a(2,a);case 2:return n.p=2,n.v,n.a(2,{status:!1,msg:"获取文件历史失败"})}},n,null,[[0,2]])}));return function(t){return n.apply(this,arguments)}}(),J=function(){var n=a(e().m(function n(){return e().w(function(n){for(;;)switch(n.n){case 0:try{u({loading:"正在保存，请稍后...",message:!0,request:T({site_name:q.value.name,conf_data:D.value}),success:B})}catch(t){}case 1:return n.a(2)}},n)}));return function(){return n.apply(this,arguments)}}(),M=function(){var n=a(e().m(function n(t){var o;return e().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,i({title:"恢复历史文件",content:"是否恢复历史文件 ".concat(l(t))});case 1:return n.n=2,E({filename:"/www/server/panel/vhost/nginx/".concat(q.value.name,".conf"),history:t,site_name:q.value.name});case 2:return o=n.v,r.request({status:o.status,msg:o.status?"恢复成功":"恢复失败"}),o.status&&B(),n.a(2,o.status);case 3:n.p=3,n.v;case 4:return n.a(2)}},n,null,[[0,3]])}));return function(t){return n.apply(this,arguments)}}(),Q={class:"w-full"},K={class:"my-[12px]"},L=m({__name:"index",props:{compData:{default:function(){return{}}}},setup:function(t,r){var o=r.expose,u=function(){var n,t=s({request:function(){return{data:R.value,total:R.value.length}},columns:[{label:"文件名",render:function(n){return l(Number(n))}},{label:"操作",align:"right",render:function(t){var r,o=Number(t);return S("div",null,[S("span",{class:"cursor-pointer bt-link",onClick:function(){c(t)}},[O("查看")]),S(F,{direction:"vertical"},null),S("span",{class:"cursor-pointer bt-link",onClick:(r=a(e().m(function t(){var r;return e().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,M(o);case 1:if(!t.v){t.n=3;break}return t.n=2,n;case 2:null==(r=t.v)||r.unmount();case 3:return t.a(2)}},t)})),function(){return r.apply(this,arguments)})},[O("恢复")])])}}]}),r=t.BtTable;n=f({title:"配置文件历史版本",area:42,showFooter:!1,component:function(){return S("div",{class:"p-[20px]"},[S(r,{"max-height":400},null)])}})},c=function(){var n=a(e().m(function n(t){var r;return e().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,z(t);case 1:r=f({title:"查看文件历史版本",area:64,showFooter:!1,component:function(){return S("div",{class:"p-[20px]"},[S(A,{type:"primary",onClick:(n=a(e().m(function n(){var o;return e().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,M(t);case 1:if(!n.v){n.n=3;break}return n.n=2,r;case 2:null==(o=n.v)||o.unmount();case 3:return n.a(2)}},n)})),function(){return n.apply(this,arguments)})},{default:function(){return[O("恢复文件")]}}),S(H,{class:"!h-[50rem] !w-full my-[12px]",modelValue:$.value,"onUpdate:modelValue":function(n){return $.value=n},editorOption:P({readonly:!0})},null)]);var n}});case 2:return n.a(2)}},n)}));return function(t){return n.apply(this,arguments)}}();return h(function(){B()}),o({init:B}),function(t,e){var r=p,o=g("bt-loading");return b(),w("div",null,[x("div",Q,[e[3]||(e[3]=x("span",{class:"my-[4px] text-secondary"},"提示：Ctrl+F 搜索关键字，Ctrl+S 保存，Ctrl+H 查找替换",-1)),x("div",K,[_(S(j(H),{class:"!h-[54rem] border border-base rounded-base",modelValue:j(D),"onUpdate:modelValue":e[0]||(e[0]=function(n){return k(D)?D.value=n:null}),onSave:j(J),id:"configContent",editorOption:{mode:"ace/mode/nginx"}},null,8,["modelValue","onSave"]),[[o,j(U)]])]),x("div",null,[S(j(A),{type:"primary",onClick:j(J)},{default:C(function(){return n(e[1]||(e[1]=[O("保存",-1)]))}),_:1},8,["onClick"]),S(j(A),{onClick:u,type:"default"},{default:C(function(){return n(e[2]||(e[2]=[O("历史文件",-1)]))}),_:1})]),S(r,{options:[{content:"此处为站点主配置文件，若您不了解配置规则，请勿随意修改."}],"list-style":"disc",class:"ml-[20px] mt-[20px]"})])])}}});t("default",v(L,[["__scopeId","data-v-cf5126d4"]]))}}})}();
