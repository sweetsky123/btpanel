import{n as a,H as e,Q as s,aK as t,e as l,P as o,l as r,ah as n,W as i}from"./utils-lib.js?v=1763689792";import{_ as u}from"./index109.js?v=1763689792";import{_ as p}from"./index118.js?v=1763689792";import{c as d,o as m,r as c,W as _,g,w as f,v,I as y,x as b,y as h,z as j,O as x,C as w,e as C,G as k,A as q,D as S,R as V,L,F as R,b1 as A,J as D,H,am as O,an as T,B as U}from"./base-lib.js?v=1763689792";import{_ as J}from"./index137.js?v=1763689792";import{a as P,f as E,g as F,u as I}from"./column.js?v=1763689792";import{e as N}from"./validator.js?v=1763689792";import{getModulesCloudServer as W,getModulesList as z}from"./database.js?v=1763689792";import{o as B,a as G,d as K,f as M,i as Q,l as X,g as Y,c as Z,j as $}from"./useMethod4.js?v=1763689792";import{g as aa}from"./useStore2.js?v=1763689792";import{_ as ea}from"./index.vue_vue_type_script_setup_true_lang3.js?v=1763689792";import{_ as sa}from"./index.vue_vue_type_script_setup_true_lang4.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./index.vue_vue_type_style_index_0_scoped_cdc7f4d3_lang.js?v=1763689792";import"./index107.js?v=1763689792";const ta={class:"flex items-center"},la={class:"w-[20rem] truncate inline-block"},oa=d({__name:"index",setup(d){const{refs:{isRefreshTable:oa,isLoading:ra,envStatus:na,isHaveServer:ia},resetRefresh:ua,refreshTableList:pa}=aa(),da=m({total:0,page:1,row:10}),ma=c([]),ca=_([]),_a=c(null),ga=c("all"),fa=c(""),va=c([]),ya=K(),ba=g(()=>!na.value.setup&&!ia.value),ha=()=>{a({title:"管理员密码",area:42,component:()=>e(()=>import("./index143.js?v=1763689792"),__vite__mapDeps([]),import.meta.url),showFooter:!0})},ja=async()=>{try{return await s({request:W({data:JSON.stringify({type:"pgsql"})},"pgsql"),data:[Array,va]}),va.value.length||(ia.value=!1),va.value}catch(a){t(a,"pgsql-getServerList")}},xa=async()=>{try{let a={p:da.page,limit:da.row,tables:"databases",search:fa.value,sid:"all"===ga.value?"":ga.value};""===a.sid&&delete a.sid;await s({loading:ra,request:z({data:JSON.stringify(a)},"pgsql"),data:{data:[Array,ma],page:i(da)}})}catch(a){t(a,"pgsql-getDatabaseList")}},wa=async()=>{xa(),await ja(),ca.value=[P(),...M(Q),E({event:(a,e)=>X(a,e)}),Y(va.value,"pgsql"),F({table:"databases"}),I([{onClick:Z,title:"权限"},{onClick:Q,title:"改密"},{onClick:$,title:"删除"}])]};return f(()=>oa.value,async a=>{a&&await xa(),ua()}),v(()=>wa()),(a,e)=>{const s=J,t=H,i=l,d=O,m=T,c=o,_=r,g=n,f=p,v=u,P=y("bt-loading");return b(),h("div",null,[j(ba)?(b(),x(s,{key:0},{content:w(()=>[C(ea,{type:"PgSql"})]),_:1})):k("",!0),C(v,null,{"header-left":w(()=>[q("div",ta,[C(t,{type:"primary",onClick:e[0]||(e[0]=a=>j(B)(ja))},{default:w(()=>[...e[6]||(e[6]=[S(" 添加数据库 ",-1)])]),_:1}),C(t,{onClick:ha},{default:w(()=>[...e[7]||(e[7]=[S("管理员密码",-1)])]),_:1}),C(t,{onClick:j(G)},{default:w(()=>[...e[8]||(e[8]=[S("远程数据库",-1)])]),_:1},8,["onClick"]),C(sa,{"comp-data":j(va),class:"mx-12px"},null,8,["comp-data"]),C(i,{onClick:e[1]||(e[1]=a=>j(N)({name:"数据库",type:12})),icon:"desired",iconClass:"text-medium"},{default:w(()=>[...e[9]||(e[9]=[S(" 需求反馈 ",-1)])]),_:1})])]),"header-right":w(()=>[C(m,{modelValue:j(ga),"onUpdate:modelValue":e[2]||(e[2]=a=>V(ga)?ga.value=a:null),onChange:j(pa),class:L(["!w-[14rem] mr-[8px]",{"custom-types-bg-green":"all"!==j(ga)}])},{default:w(()=>[C(d,{label:"全部",value:"all"}),(b(!0),h(R,null,A(j(va),(a,e)=>(b(),x(d,{key:e,label:"".concat("all"!==j(ga)?"已选：":"").concat(a.ps),value:a.id},{default:w(()=>[q("span",la,U(a.ps),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","onChange","class"]),C(c,{class:"w-[26rem]",modelValue:j(fa),"onUpdate:modelValue":e[3]||(e[3]=a=>V(fa)?fa.value=a:null),onSearch:j(pa),placeholder:"请输入数据库名称/备注"},null,8,["modelValue","onSearch"])]),content:w(()=>[D(C(_,{ref_key:"pgsqlDbTableRef",ref:_a,column:j(ca),data:j(ma)},null,8,["column","data"]),[[P,j(ra)]])]),"footer-left":w(()=>[C(g,{options:j(ya),"table-ref":j(_a)},null,8,["options","table-ref"])]),"footer-right":w(()=>[C(f,{total:j(da).total,page:j(da).page,"onUpdate:page":e[4]||(e[4]=a=>j(da).page=a),row:j(da).row,"onUpdate:row":e[5]||(e[5]=a=>j(da).row=a),onChange:j(pa)},null,8,["total","page","row","onChange"])]),_:1})])}}});export{oa as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
