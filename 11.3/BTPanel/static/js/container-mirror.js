import{c as e,r as a,o as l,W as s,v as t,x as o,y as r,e as m,C as p,z as d,R as u,A as i,J as n,K as c,D as h,S as f,ad as g,V,ag as y,H as b,ab as v}from"./base-lib.js?v=1763689792";import{_}from"./index107.js?v=1763689792";import{aQ as x,Q as w,cA as U,lp as j,ag as C,k as E,ax as k,_ as D}from"./utils-lib.js?v=1763689792";import{f as q}from"./validator.js?v=1763689792";import"./__commonjsHelpers__.js?v=1763689792";import"./index110.js?v=1763689792";import"./column.js?v=1763689792";const A={class:"container-dialog"},I={class:"flex items-center"},S={class:"mt-[2.4rem]"},z={class:"flex items-center"},H=D(e({__name:"container-mirror",props:{compData:{default:()=>({})}},setup(e){const{refs:{currentConDetail:D},getCurrentCon:H}=x(),J=e,Q=a("easy"),R=[{label:"简单模式",value:"easy"},{label:"高级模式",value:"more"}],F=l({repository:"",tag:"latest",stash:"official",message:"",author:"",isExport:[],path:"",name:""}),K=s([]),N=a(),O={repository:[{required:!0,trigger:["blur","change"],message:"请输入镜像名"}]},P=()=>{q({type:"dir",change:e=>{F.path=e}})},W=async()=>{await N.value.validate();const e={id:J.compData.row.id,repository:F.repository,tag:F.tag};"more"==Q.value&&(e.message=F.message,e.author=F.author,e.repository="".concat(""!=F.stash?F.stash+"/":"").concat(F.repository),F.isExport.length>0&&(e.path=F.path,e.name=F.name)),w({request:j({data:JSON.stringify(e)}),message:!0,success:async e=>{e.status&&(await H(D.value.Id),Q.value="easy",B())}})},B=()=>{F.repository="",F.tag="latest",F.stash="official",F.message="",F.author="",F.isExport=[],F.path="",F.name="",N.value.clearValidate()};return t(async()=>{await w({request:U(),data:Array,success:e=>{K.value=e.map(e=>({label:e.name,value:"docker.io"===e.url?"official":e.namespace}))}})}),(e,a)=>{const l=C,s=g,t=E,x=k,w=V,U=y,j=_,D=b,q=v;return o(),r("div",A,[m(q,{ref_key:"cmdFormRef",ref:N,model:d(F),rules:O,"label-position":"right",onSubmit:a[10]||(a[10]=f(()=>{},["prevent"]))},{default:p(()=>[m(s,{style:{"margin-bottom":"1.5rem"},label:"创建方式"},{default:p(()=>[m(l,{type:"button",modelValue:d(Q),"onUpdate:modelValue":a[0]||(a[0]=e=>u(Q)?Q.value=e:null),options:R},null,8,["modelValue"])]),_:1}),m(s,{prop:"repository",style:{"margin-bottom":"1.5rem"},label:"镜像名"},{default:p(()=>[m(t,{modelValue:d(F).repository,"onUpdate:modelValue":a[1]||(a[1]=e=>d(F).repository=e),width:"24rem",placeholder:"请输入镜像名"},null,8,["modelValue"])]),_:1}),m(s,{prop:"path",label:"版本号",display:"flex"},{default:p(()=>[i("div",I,[m(t,{modelValue:d(F).tag,"onUpdate:modelValue":a[2]||(a[2]=e=>d(F).tag=e),width:"24rem",placeholder:"请输入版本号"},null,8,["modelValue"]),a[11]||(a[11]=i("span",{class:"ml-[1rem] text-secondary text-small whitespace-nowrap"},"默认：latest",-1))])]),_:1}),n(i("div",null,[m(s,{prop:"path",label:"仓库地址"},{default:p(()=>[m(x,{modelValue:d(F).stash,"onUpdate:modelValue":a[3]||(a[3]=e=>d(F).stash=e),options:d(K),class:"!w-[24rem]",placeholder:"请选择仓库地址"},null,8,["modelValue","options"])]),_:1}),m(s,{prop:"path",label:"描述"},{default:p(()=>[m(t,{modelValue:d(F).message,"onUpdate:modelValue":a[4]||(a[4]=e=>d(F).message=e),width:"24rem",placeholder:"描述"},null,8,["modelValue"])]),_:1}),m(s,{prop:"path",label:"作者"},{default:p(()=>[m(t,{modelValue:d(F).author,"onUpdate:modelValue":a[5]||(a[5]=e=>d(F).author=e),width:"24rem",placeholder:"作者"},null,8,["modelValue"])]),_:1}),i("div",S,[m(U,{modelValue:d(F).isExport,"onUpdate:modelValue":a[6]||(a[6]=e=>d(F).isExport=e),class:"mb-[2rem] ml-[10rem]"},{default:p(()=>[m(w,{size:"default",label:"生成镜像并导出压缩包",value:"生成镜像并导出压缩包"})]),_:1},8,["modelValue"]),n(m(s,{label:" "},{default:p(()=>[m(j,{modelValue:d(F).path,"onUpdate:modelValue":a[7]||(a[7]=e=>d(F).path=e),class:"!w-[24rem]",icon:"el-folder-opened",onIconClick:P,onChangePassive:a[8]||(a[8]=e=>{F.path=F.path.replace(/\s+/g,"")}),placeholder:"请输入镜像路径"},null,8,["modelValue"])]),_:1},512),[[c,d(F).isExport.length>0]]),n(m(s,{prop:"path",label:"文件名"},{default:p(()=>[i("div",z,[m(t,{modelValue:d(F).name,"onUpdate:modelValue":a[9]||(a[9]=e=>d(F).name=e),width:"24rem",placeholder:"文件名"},null,8,["modelValue"]),a[12]||(a[12]=i("span",{class:"ml-[1rem]"},".tar",-1))])]),_:1},512),[[c,d(F).isExport.length>0]])])],512),[[c,"more"==d(Q)]]),m(D,{type:"primary",class:"ml-[10rem]",onClick:W},{default:p(()=>[...a[13]||(a[13]=[h("生成镜像",-1)])]),_:1})]),_:1},8,["model"])])}}}),[["__scopeId","data-v-db198e42"]]);export{H as default};
